{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.10", "generated_at": "2024-03-28T22:43:47.315085Z", "invocation_id": "09ccee7d-6f4a-4122-a922-7eceeff9e6a9", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-28T22:43:28.922683Z", "completed_at": "2024-03-28T22:43:28.986473Z"}, {"name": "execute", "started_at": "2024-03-28T22:43:29.003005Z", "completed_at": "2024-03-28T22:43:31.807996Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.8965835571289062, "adapter_response": {"_message": "CREATE TABLE (38.0 rows, 217.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 38, "bytes_processed": 228327837, "bytes_billed": 228589568, "location": "europe-west2", "project_id": "uber-data-pipeline-417021", "job_id": "87111c9e-9edb-4b42-9f49-204a9703f956", "slot_ms": 14948}, "message": "CREATE TABLE (38.0 rows, 217.8 MiB processed)", "failures": null, "unique_id": "model.uber_transformations.pickup_count_vs_average_per_base", "compiled": true, "compiled_code": "-- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?\n\nWITH month_extract AS (\n    SELECT base.base_name AS `Dispatching Base Name`,\n           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,\n           CASE\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'\n            END AS `Month`\n    FROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw\n    JOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.dispatching_base_num\n),\n\nmonthly_counts_and_avg AS (\n    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,\n           month_extract.month_num,\n           month_extract.Month AS `Month`,\n           COUNT(*) AS `Monthly Count`,\n           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`\n    FROM month_extract\n    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num\n)\n\nSELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,\n       monthly_counts_and_avg.month,\n       monthly_counts_and_avg.`Monthly Count`,\n       monthly_counts_and_avg.`Average for Month`,\n       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`\nFROM monthly_counts_and_avg\nORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC", "relation_name": "`uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-28T22:43:31.821138Z", "completed_at": "2024-03-28T22:43:31.833856Z"}, {"name": "execute", "started_at": "2024-03-28T22:43:31.838140Z", "completed_at": "2024-03-28T22:43:36.846187Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.031315088272095, "adapter_response": {"_message": "CREATE TABLE (38.0 rows, 217.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 38, "bytes_processed": 228327837, "bytes_billed": 228589568, "location": "europe-west2", "project_id": "uber-data-pipeline-417021", "job_id": "92778109-ca44-4cab-a93e-6ce052f09079", "slot_ms": 61623}, "message": "CREATE TABLE (38.0 rows, 217.8 MiB processed)", "failures": null, "unique_id": "model.uber_transformations.pickup_percentile_by_base_per_month", "compiled": true, "compiled_code": "-- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?\n\nWITH month_extract AS (\n    SELECT base.base_name AS `Dispatching Base Name`,\n           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,\n           CASE\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'\n            END AS `Month`\n    FROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw\n    JOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.dispatching_base_num\n),\n\ncounting_cte AS (\n    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,\n           month_extract.month_num AS month_num,\n           month_extract.month AS `Month`,\n           COUNT(*) AS `Count per Base per Month`,\n           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`\n    FROM month_extract\n    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num\n)\n\nSELECT counting_cte.`Dispatching Base Name`,\n       counting_cte.month,\n       counting_cte.`Count per Base per Month`,\n       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`\nFROM counting_cte\nORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC", "relation_name": "`uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-28T22:43:36.859619Z", "completed_at": "2024-03-28T22:43:36.868159Z"}, {"name": "execute", "started_at": "2024-03-28T22:43:36.871284Z", "completed_at": "2024-03-28T22:43:39.416821Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.563706636428833, "adapter_response": {"_message": "CREATE TABLE (3.0 rows, 217.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 3, "bytes_processed": 228327837, "bytes_billed": 228589568, "location": "europe-west2", "project_id": "uber-data-pipeline-417021", "job_id": "dd48d748-9990-482c-ba5f-ca3de4de74fa", "slot_ms": 4975}, "message": "CREATE TABLE (3.0 rows, 217.8 MiB processed)", "failures": null, "unique_id": "model.uber_transformations.top_3_base_names_by_total_pickups", "compiled": true, "compiled_code": "-- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.\n\nSELECT base.base_num AS `Dispatching Base Number`,\n       base.base_name AS `Base Name`,\n       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`\nFROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw\nJOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.dispatching_base_num\nGROUP BY base.base_num, base.base_name\nORDER BY COUNT(raw.pickup_date) DESC\nLIMIT 3", "relation_name": "`uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-28T22:43:39.429117Z", "completed_at": "2024-03-28T22:43:39.436767Z"}, {"name": "execute", "started_at": "2024-03-28T22:43:39.439669Z", "completed_at": "2024-03-28T22:43:42.008269Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.585679769515991, "adapter_response": {"_message": "CREATE TABLE (25.0 rows, 217.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 25, "bytes_processed": 228327837, "bytes_billed": 228589568, "location": "europe-west2", "project_id": "uber-data-pipeline-417021", "job_id": "1446b675-1150-472e-a802-4834961cc3d4", "slot_ms": 14486}, "message": "CREATE TABLE (25.0 rows, 217.8 MiB processed)", "failures": null, "unique_id": "model.uber_transformations.top_3_pickup_dates_per_base", "compiled": true, "compiled_code": "-- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?\n\nWITH date_extract_cte AS (\n    SELECT base.base_name AS `base_name`,\n          raw.dispatching_base_num AS `dispatching_base_num`,\n          DATE(raw.pickup_date) AS `pick_up_date`\n    FROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw\n    JOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.dispatching_base_num\n),\nranked_cte AS (\n    SELECT base_name AS `Base Name`,\n           dispatching_base_num AS `Dispatching Base Number`,\n           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,\n           COUNT(*) AS `Count`,\n           pick_up_date AS `Pick Up Date`\n    FROM date_extract_cte\n    GROUP BY base_name, dispatching_base_num, pick_up_date\n)\n\nSELECT *\nFROM ranked_cte\nWHERE ranked_cte.rank IN (1,2,3)\nORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC", "relation_name": "`uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-28T22:43:42.036211Z", "completed_at": "2024-03-28T22:43:42.051443Z"}, {"name": "execute", "started_at": "2024-03-28T22:43:42.056782Z", "completed_at": "2024-03-28T22:43:44.619037Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.5960533618927, "adapter_response": {"_message": "CREATE TABLE (6.0 rows, 217.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 6, "bytes_processed": 228327837, "bytes_billed": 228589568, "location": "europe-west2", "project_id": "uber-data-pipeline-417021", "job_id": "1b0c8ed8-1a52-4f64-9a77-b1d3e5085bdd", "slot_ms": 4574}, "message": "CREATE TABLE (6.0 rows, 217.8 MiB processed)", "failures": null, "unique_id": "model.uber_transformations.total_pickups_in_may_by_base", "compiled": true, "compiled_code": "-- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.\n\nSELECT base.base_name AS `Dispatching Base Name`,\n       COUNT(*) AS `Number of Pick Ups for Base`\nFROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw\nJOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.dispatching_base_num\nWHERE EXTRACT(MONTH FROM raw.pickup_date) = 5\nGROUP BY base.base_name\nORDER BY COUNT(*) DESC", "relation_name": "`uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-28T22:43:44.647939Z", "completed_at": "2024-03-28T22:43:44.690006Z"}, {"name": "execute", "started_at": "2024-03-28T22:43:44.696939Z", "completed_at": "2024-03-28T22:43:47.283970Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.647991895675659, "adapter_response": {"_message": "CREATE TABLE (19.6k rows, 325.4 MiB processed)", "code": "CREATE TABLE", "rows_affected": 19556, "bytes_processed": 341203498, "bytes_billed": 341835776, "location": "europe-west2", "project_id": "uber-data-pipeline-417021", "job_id": "4e32d2f6-2523-4b5b-a7fd-3130328c004b", "slot_ms": 5212}, "message": "CREATE TABLE (19.6k rows, 325.4 MiB processed)", "failures": null, "unique_id": "model.uber_transformations.unter_grun_pickups_in_bronx", "compiled": true, "compiled_code": "-- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.\n\nSELECT raw.pickup_date AS `Pickup Date`,\n       base.base_name AS `Base Name`,\n       t_zone.borough AS `Borough`,\n       t_zone.zone AS `Zone`\nFROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw\nJOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.affiliated_base_num\nJOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`taxi_zone_lookup` AS t_zone ON t_zone.locationid = raw.locationid\nWHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'", "relation_name": "`uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`"}], "elapsed_time": 19.55962347984314, "args": {"log_level": "info", "log_format": "default", "partial_parse_file_diff": true, "resource_types": [], "write_json": true, "cache_selected_only": false, "show_resource_report": false, "print": true, "printer_width": 80, "which": "build", "log_path": "/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs", "show": false, "macro_debugging": false, "strict_mode": false, "version_check": true, "project_dir": "/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations", "introspect": true, "exclude": [], "enable_legacy_logger": false, "log_format_file": "debug", "use_colors_file": true, "favor_state": false, "quiet": false, "select": [], "use_colors": true, "send_anonymous_usage_stats": true, "partial_parse": true, "invocation_command": "dbt build", "populate_cache": true, "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "indirect_selection": "eager", "profiles_dir": "/home/kimiko/.dbt", "vars": {}, "include_saved_query": false, "static_parser": true, "log_level_file": "debug", "defer": false}}