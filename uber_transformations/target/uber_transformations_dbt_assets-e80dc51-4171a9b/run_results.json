{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.10", "generated_at": "2024-03-28T23:56:13.488156Z", "invocation_id": "86b34b8d-b9a0-4866-a4b4-50789e22b42d", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-28T23:55:55.543535Z", "completed_at": "2024-03-28T23:55:55.563683Z"}, {"name": "execute", "started_at": "2024-03-28T23:55:55.567964Z", "completed_at": "2024-03-28T23:55:58.351761Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.8150205612182617, "adapter_response": {"_message": "CREATE TABLE (38.0 rows, 217.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 38, "bytes_processed": 228327837, "bytes_billed": 228589568, "location": "europe-west2", "project_id": "uber-data-pipeline-417021", "job_id": "bfbaf8f4-a860-4398-a7b0-553061b633c3", "slot_ms": 15842}, "message": "CREATE TABLE (38.0 rows, 217.8 MiB processed)", "failures": null, "unique_id": "model.uber_transformations.pickup_count_vs_average_per_base", "compiled": true, "compiled_code": "-- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?\n\nWITH month_extract AS (\n    SELECT base.base_name AS `Dispatching Base Name`,\n           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,\n           CASE\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'\n            END AS `Month`\n    FROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw\n    JOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.dispatching_base_num\n),\n\nmonthly_counts_and_avg AS (\n    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,\n           month_extract.month_num,\n           month_extract.Month AS `Month`,\n           COUNT(*) AS `Monthly Count`,\n           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`\n    FROM month_extract\n    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num\n)\n\nSELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,\n       monthly_counts_and_avg.month,\n       monthly_counts_and_avg.`Monthly Count`,\n       monthly_counts_and_avg.`Average for Month`,\n       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`\nFROM monthly_counts_and_avg\nORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC", "relation_name": "`uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-28T23:55:58.367268Z", "completed_at": "2024-03-28T23:55:58.377209Z"}, {"name": "execute", "started_at": "2024-03-28T23:55:58.380722Z", "completed_at": "2024-03-28T23:56:03.453111Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.095386505126953, "adapter_response": {"_message": "CREATE TABLE (38.0 rows, 217.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 38, "bytes_processed": 228327837, "bytes_billed": 228589568, "location": "europe-west2", "project_id": "uber-data-pipeline-417021", "job_id": "78109a49-56ec-4ca7-860e-42910d8e93f5", "slot_ms": 66033}, "message": "CREATE TABLE (38.0 rows, 217.8 MiB processed)", "failures": null, "unique_id": "model.uber_transformations.pickup_percentile_by_base_per_month", "compiled": true, "compiled_code": "-- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?\n\nWITH month_extract AS (\n    SELECT base.base_name AS `Dispatching Base Name`,\n           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,\n           CASE\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'\n                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'\n            END AS `Month`\n    FROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw\n    JOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.dispatching_base_num\n),\n\ncounting_cte AS (\n    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,\n           month_extract.month_num AS month_num,\n           month_extract.month AS `Month`,\n           COUNT(*) AS `Count per Base per Month`,\n           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`\n    FROM month_extract\n    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num\n)\n\nSELECT counting_cte.`Dispatching Base Name`,\n       counting_cte.month,\n       counting_cte.`Count per Base per Month`,\n       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`\nFROM counting_cte\nORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC", "relation_name": "`uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-28T23:56:03.535357Z", "completed_at": "2024-03-28T23:56:03.549075Z"}, {"name": "execute", "started_at": "2024-03-28T23:56:03.554659Z", "completed_at": "2024-03-28T23:56:05.966461Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.485055446624756, "adapter_response": {"_message": "CREATE TABLE (3.0 rows, 217.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 3, "bytes_processed": 228327837, "bytes_billed": 228589568, "location": "europe-west2", "project_id": "uber-data-pipeline-417021", "job_id": "30b5a952-563c-471b-9a2d-d5ab09275086", "slot_ms": 6579}, "message": "CREATE TABLE (3.0 rows, 217.8 MiB processed)", "failures": null, "unique_id": "model.uber_transformations.top_3_base_names_by_total_pickups", "compiled": true, "compiled_code": "-- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.\n\nSELECT base.base_num AS `Dispatching Base Number`,\n       base.base_name AS `Base Name`,\n       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`\nFROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw\nJOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.dispatching_base_num\nGROUP BY base.base_num, base.base_name\nORDER BY COUNT(raw.pickup_date) DESC\nLIMIT 3", "relation_name": "`uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-28T23:56:05.982461Z", "completed_at": "2024-03-28T23:56:05.990507Z"}, {"name": "execute", "started_at": "2024-03-28T23:56:05.993950Z", "completed_at": "2024-03-28T23:56:08.601151Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.6249399185180664, "adapter_response": {"_message": "CREATE TABLE (25.0 rows, 217.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 25, "bytes_processed": 228327837, "bytes_billed": 228589568, "location": "europe-west2", "project_id": "uber-data-pipeline-417021", "job_id": "a1407d7b-13ed-4606-80aa-da01a60cf629", "slot_ms": 14303}, "message": "CREATE TABLE (25.0 rows, 217.8 MiB processed)", "failures": null, "unique_id": "model.uber_transformations.top_3_pickup_dates_per_base", "compiled": true, "compiled_code": "-- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?\n\nWITH date_extract_cte AS (\n    SELECT base.base_name AS `base_name`,\n          raw.dispatching_base_num AS `dispatching_base_num`,\n          DATE(raw.pickup_date) AS `pick_up_date`\n    FROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw\n    JOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.dispatching_base_num\n),\nranked_cte AS (\n    SELECT base_name AS `Base Name`,\n           dispatching_base_num AS `Dispatching Base Number`,\n           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,\n           COUNT(*) AS `Count`,\n           pick_up_date AS `Pick Up Date`\n    FROM date_extract_cte\n    GROUP BY base_name, dispatching_base_num, pick_up_date\n)\n\nSELECT *\nFROM ranked_cte\nWHERE ranked_cte.rank IN (1,2,3)\nORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC", "relation_name": "`uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-28T23:56:08.614085Z", "completed_at": "2024-03-28T23:56:08.622316Z"}, {"name": "execute", "started_at": "2024-03-28T23:56:08.626099Z", "completed_at": "2024-03-28T23:56:11.130994Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.5231754779815674, "adapter_response": {"_message": "CREATE TABLE (6.0 rows, 217.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 6, "bytes_processed": 228327837, "bytes_billed": 228589568, "location": "europe-west2", "project_id": "uber-data-pipeline-417021", "job_id": "4104c718-61d2-472d-82bb-bde9cb7de5a2", "slot_ms": 4752}, "message": "CREATE TABLE (6.0 rows, 217.8 MiB processed)", "failures": null, "unique_id": "model.uber_transformations.total_pickups_in_may_by_base", "compiled": true, "compiled_code": "-- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.\n\nSELECT base.base_name AS `Dispatching Base Name`,\n       COUNT(*) AS `Number of Pick Ups for Base`\nFROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw\nJOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.dispatching_base_num\nWHERE EXTRACT(MONTH FROM raw.pickup_date) = 5\nGROUP BY base.base_name\nORDER BY COUNT(*) DESC", "relation_name": "`uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-28T23:56:11.144423Z", "completed_at": "2024-03-28T23:56:11.151529Z"}, {"name": "execute", "started_at": "2024-03-28T23:56:11.154892Z", "completed_at": "2024-03-28T23:56:13.450078Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.3113224506378174, "adapter_response": {"_message": "CREATE TABLE (19.6k rows, 325.4 MiB processed)", "code": "CREATE TABLE", "rows_affected": 19556, "bytes_processed": 341203498, "bytes_billed": 341835776, "location": "europe-west2", "project_id": "uber-data-pipeline-417021", "job_id": "8dfe930a-d774-4d09-9e86-4cd406d5c163", "slot_ms": 6094}, "message": "CREATE TABLE (19.6k rows, 325.4 MiB processed)", "failures": null, "unique_id": "model.uber_transformations.unter_grun_pickups_in_bronx", "compiled": true, "compiled_code": "-- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.\n\nSELECT raw.pickup_date AS `Pickup Date`,\n       base.base_name AS `Base Name`,\n       t_zone.borough AS `Borough`,\n       t_zone.zone AS `Zone`\nFROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw\nJOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.affiliated_base_num\nJOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`taxi_zone_lookup` AS t_zone ON t_zone.locationid = raw.locationid\nWHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'", "relation_name": "`uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`"}], "elapsed_time": 20.664756298065186, "args": {"log_format": "json", "use_colors": true, "send_anonymous_usage_stats": false, "cache_selected_only": false, "partial_parse_file_diff": true, "exclude": [], "log_format_file": "json", "printer_width": 80, "log_level": "info", "which": "build", "strict_mode": false, "project_dir": "/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations", "vars": {}, "target_path": "target/uber_transformations_dbt_assets-e80dc51-4171a9b", "populate_cache": true, "log_path": "/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/target/uber_transformations_dbt_assets-e80dc51-4171a9b", "select": ["fqn:*"], "write_json": true, "invocation_command": "dbt build --select fqn:*", "static_parser": true, "indirect_selection": "eager", "quiet": false, "macro_debugging": false, "defer": false, "enable_legacy_logger": false, "favor_state": false, "print": true, "use_colors_file": true, "partial_parse": true, "show": false, "log_level_file": "debug", "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "introspect": true, "debug": true, "profiles_dir": "/home/kimiko/.dbt", "include_saved_query": false, "resource_types": [], "show_resource_report": false}}