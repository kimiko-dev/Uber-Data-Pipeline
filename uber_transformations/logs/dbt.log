[0m11:33:25.455104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9b9b7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9f6bca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9b9b4530>]}


============================== 11:33:25.460185 | b7a6ab68-8366-4494-84bb-365b9a770df2 ==============================
[0m11:33:25.460185 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:33:25.461570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:33:25.462686 [info ] [MainThread]: dbt version: 1.7.10
[0m11:33:25.463723 [info ] [MainThread]: python version: 3.12.1
[0m11:33:25.464674 [info ] [MainThread]: python path: /home/kimiko/miniconda3/envs/uber_data_pipeline_env/bin/python
[0m11:33:25.465710 [info ] [MainThread]: os info: Linux-6.6.19-1-MANJARO-x86_64-with-glibc2.39
[0m11:33:26.166333 [info ] [MainThread]: Using profiles dir at /home/kimiko/.dbt
[0m11:33:26.167693 [info ] [MainThread]: Using profiles.yml file at /home/kimiko/.dbt/profiles.yml
[0m11:33:26.168961 [info ] [MainThread]: Using dbt_project.yml file at /home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/dbt_project.yml
[0m11:33:26.170544 [info ] [MainThread]: adapter type: bigquery
[0m11:33:26.171766 [info ] [MainThread]: adapter version: 1.7.6
[0m11:33:26.416057 [info ] [MainThread]: Configuration:
[0m11:33:26.417151 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:33:26.418228 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:33:26.419326 [info ] [MainThread]: Required dependencies:
[0m11:33:26.420403 [debug] [MainThread]: Executing "git --help"
[0m11:33:26.425593 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:33:26.427839 [debug] [MainThread]: STDERR: "b''"
[0m11:33:26.429409 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:33:26.431047 [info ] [MainThread]: Connection:
[0m11:33:26.432993 [info ] [MainThread]:   method: service-account
[0m11:33:26.434740 [info ] [MainThread]:   database: uber-data-pipeline-417021
[0m11:33:26.436560 [info ] [MainThread]:   execution_project: uber-data-pipeline-417021
[0m11:33:26.438248 [info ] [MainThread]:   schema: airbyte_uber_data
[0m11:33:26.439967 [info ] [MainThread]:   location: EU
[0m11:33:26.442674 [info ] [MainThread]:   priority: interactive
[0m11:33:26.444677 [info ] [MainThread]:   maximum_bytes_billed: None
[0m11:33:26.446646 [info ] [MainThread]:   impersonate_service_account: None
[0m11:33:26.452491 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m11:33:26.456542 [info ] [MainThread]:   job_retries: 1
[0m11:33:26.458824 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m11:33:26.461200 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m11:33:26.463150 [info ] [MainThread]:   keyfile: /home/kimiko/Desktop/Uber_Data_Pipeline/dbt-BQ-key.json
[0m11:33:26.468169 [info ] [MainThread]:   timeout_seconds: 300
[0m11:33:26.473170 [info ] [MainThread]:   client_id: None
[0m11:33:26.477684 [info ] [MainThread]:   token_uri: None
[0m11:33:26.482841 [info ] [MainThread]:   dataproc_region: None
[0m11:33:26.485655 [info ] [MainThread]:   dataproc_cluster_name: None
[0m11:33:26.489407 [info ] [MainThread]:   gcs_bucket: None
[0m11:33:26.494989 [info ] [MainThread]:   dataproc_batch: None
[0m11:33:26.497625 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m11:33:26.500090 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m11:33:26.502697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:26.512786 [debug] [MainThread]: On debug: select 1 as id
[0m11:33:27.375602 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:EU:34f047ff-5b20-4f13-8eeb-13dd32c25f72&page=queryresults
[0m11:33:27.754943 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:33:27.756812 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:33:27.760627 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.383796, "process_user_time": 4.590627, "process_kernel_time": 0.21132, "process_mem_max_rss": "120032", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m11:33:27.763450 [debug] [MainThread]: Command `dbt debug` succeeded at 11:33:27.762917 after 2.39 seconds
[0m11:33:27.764614 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:33:27.765841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9baab740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9c9a00e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9a158470>]}
[0m11:33:27.767049 [debug] [MainThread]: Flushing usage events
[0m11:35:31.260516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e0ec46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e0ec6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e0ec45f0>]}


============================== 11:35:31.265670 | 70992812-c270-4166-84ab-030e75d95c82 ==============================
[0m11:35:31.265670 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:35:31.267293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:35:32.141343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70992812-c270-4166-84ab-030e75d95c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80dfbd7290>]}
[0m11:35:32.316530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70992812-c270-4166-84ab-030e75d95c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80df13acc0>]}
[0m11:35:32.317993 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m11:35:32.383424 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:35:32.388381 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:35:32.393586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '70992812-c270-4166-84ab-030e75d95c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80df1391f0>]}
[0m11:35:34.880271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70992812-c270-4166-84ab-030e75d95c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80df106330>]}
[0m11:35:34.894585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70992812-c270-4166-84ab-030e75d95c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80df071a60>]}
[0m11:35:34.895715 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m11:35:34.896879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70992812-c270-4166-84ab-030e75d95c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80df0a0380>]}
[0m11:35:34.899838 [info ] [MainThread]: 
[0m11:35:34.901738 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:35:34.905333 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m11:35:34.906678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:35.473115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m11:35:35.475069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:36.005953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70992812-c270-4166-84ab-030e75d95c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80df0d0fb0>]}
[0m11:35:36.007655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:35:36.008776 [info ] [MainThread]: 
[0m11:35:36.039348 [debug] [Thread-1 (]: Began running node model.uber_transformations.my_first_dbt_model
[0m11:35:36.043466 [info ] [Thread-1 (]: 1 of 2 START sql table model airbyte_uber_data.my_first_dbt_model .............. [RUN]
[0m11:35:36.058484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.my_first_dbt_model)
[0m11:35:36.066649 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.my_first_dbt_model
[0m11:35:36.100387 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.my_first_dbt_model"
[0m11:35:36.110547 [debug] [Thread-1 (]: Timing info for model.uber_transformations.my_first_dbt_model (compile): 11:35:36.072684 => 11:35:36.107669
[0m11:35:36.116206 [debug] [Thread-1 (]: Began executing node model.uber_transformations.my_first_dbt_model
[0m11:35:36.231178 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.my_first_dbt_model"
[0m11:35:36.232868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:36.235829 [debug] [Thread-1 (]: On model.uber_transformations.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.my_first_dbt_model"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m11:35:36.746444 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:EU:9e65cf48-612f-4e51-98a9-37f753489fab&page=queryresults
[0m11:35:36.749041 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.my_first_dbt_model"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m11:35:36.753367 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset uber-data-pipeline-417021:airbyte_uber_data was not found in location EU; reason: notFound, message: Not found: Dataset uber-data-pipeline-417021:airbyte_uber_data was not found in location EU

Location: EU
Job ID: 9e65cf48-612f-4e51-98a9-37f753489fab

[0m11:35:36.760409 [debug] [Thread-1 (]: Timing info for model.uber_transformations.my_first_dbt_model (execute): 11:35:36.120049 => 11:35:36.756572
[0m11:35:36.894257 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  404 Not found: Dataset uber-data-pipeline-417021:airbyte_uber_data was not found in location EU; reason: notFound, message: Not found: Dataset uber-data-pipeline-417021:airbyte_uber_data was not found in location EU
  
  Location: EU
  Job ID: 9e65cf48-612f-4e51-98a9-37f753489fab
  
[0m11:35:36.895556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70992812-c270-4166-84ab-030e75d95c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80de7b2d80>]}
[0m11:35:36.897042 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model airbyte_uber_data.my_first_dbt_model ..... [[31mERROR[0m in 0.84s]
[0m11:35:36.898751 [debug] [Thread-1 (]: Finished running node model.uber_transformations.my_first_dbt_model
[0m11:35:36.900588 [debug] [Thread-1 (]: Began running node model.uber_transformations.my_second_dbt_model
[0m11:35:36.901774 [info ] [Thread-1 (]: 2 of 2 SKIP relation airbyte_uber_data.my_second_dbt_model ..................... [[33mSKIP[0m]
[0m11:35:36.903878 [debug] [Thread-1 (]: Finished running node model.uber_transformations.my_second_dbt_model
[0m11:35:36.908517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:36.909714 [debug] [MainThread]: Connection 'model.uber_transformations.my_first_dbt_model' was properly closed.
[0m11:35:36.911003 [info ] [MainThread]: 
[0m11:35:36.912498 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m11:35:36.914351 [debug] [MainThread]: Command end result
[0m11:35:36.971887 [info ] [MainThread]: 
[0m11:35:36.977313 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:35:36.982494 [info ] [MainThread]: 
[0m11:35:36.987066 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  404 Not found: Dataset uber-data-pipeline-417021:airbyte_uber_data was not found in location EU; reason: notFound, message: Not found: Dataset uber-data-pipeline-417021:airbyte_uber_data was not found in location EU
  
  Location: EU
  Job ID: 9e65cf48-612f-4e51-98a9-37f753489fab
  
[0m11:35:36.991560 [info ] [MainThread]: 
[0m11:35:36.995179 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m11:35:36.999816 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.8150783, "process_user_time": 7.493623, "process_kernel_time": 0.31302, "process_mem_max_rss": "136296", "process_in_blocks": "2872", "process_out_blocks": "2792", "command_success": false}
[0m11:35:37.004133 [debug] [MainThread]: Command `dbt run` failed at 11:35:37.002339 after 5.82 seconds
[0m11:35:37.010232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e506b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80df1fb9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80def69a90>]}
[0m11:35:37.013471 [debug] [MainThread]: Flushing usage events
[0m11:42:22.586658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4844ae48c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f484539a720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f484586af30>]}


============================== 11:42:22.591872 | ea6f6c98-37fe-413f-9816-8294cbe0118c ==============================
[0m11:42:22.591872 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:42:22.593338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:42:23.435574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea6f6c98-37fe-413f-9816-8294cbe0118c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4844ae6e70>]}
[0m11:42:23.609151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea6f6c98-37fe-413f-9816-8294cbe0118c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4842e65400>]}
[0m11:42:23.610617 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m11:42:23.626429 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:42:23.696315 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:42:23.698528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ea6f6c98-37fe-413f-9816-8294cbe0118c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4842c98aa0>]}
[0m11:42:25.797287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea6f6c98-37fe-413f-9816-8294cbe0118c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4842cf3050>]}
[0m11:42:25.811649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea6f6c98-37fe-413f-9816-8294cbe0118c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48424a9ac0>]}
[0m11:42:25.812752 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m11:42:25.813823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea6f6c98-37fe-413f-9816-8294cbe0118c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4842ecf050>]}
[0m11:42:25.816893 [info ] [MainThread]: 
[0m11:42:25.818748 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:42:25.822293 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m11:42:25.823539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:26.376312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m11:42:26.377443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:26.864875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea6f6c98-37fe-413f-9816-8294cbe0118c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4842d580b0>]}
[0m11:42:26.866660 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:42:26.867673 [info ] [MainThread]: 
[0m11:42:26.871499 [debug] [Thread-1 (]: Began running node model.uber_transformations.my_first_dbt_model
[0m11:42:26.872774 [info ] [Thread-1 (]: 1 of 2 START sql table model airbyte_uber_data.my_first_dbt_model .............. [RUN]
[0m11:42:26.875701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.my_first_dbt_model)
[0m11:42:26.877645 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.my_first_dbt_model
[0m11:42:26.913326 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.my_first_dbt_model"
[0m11:42:26.921148 [debug] [Thread-1 (]: Timing info for model.uber_transformations.my_first_dbt_model (compile): 11:42:26.878831 => 11:42:26.918154
[0m11:42:26.922773 [debug] [Thread-1 (]: Began executing node model.uber_transformations.my_first_dbt_model
[0m11:42:27.057627 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.my_first_dbt_model"
[0m11:42:27.059048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:27.061969 [debug] [Thread-1 (]: On model.uber_transformations.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.my_first_dbt_model"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m11:42:27.411591 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('POST https://bigquery.googleapis.com/bigquery/v2/projects/uber-data-pipeline-417021/jobs?prettyPrint=false: Location EU-WEST2 does not support this operation.')
[0m11:42:28.192494 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:EU-WEST2:7cbdcb0e-7eb8-4ccd-83c8-a73a2c277291&page=queryresults
[0m11:42:28.194276 [debug] [Thread-1 (]: Timing info for model.uber_transformations.my_first_dbt_model (execute): 11:42:26.924544 => 11:42:28.193566
[0m11:42:28.253053 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Location EU-WEST2 does not support this operation.
  compiled Code at target/run/uber_transformations/models/example/my_first_dbt_model.sql
[0m11:42:28.254451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea6f6c98-37fe-413f-9816-8294cbe0118c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4842352f30>]}
[0m11:42:28.256075 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model airbyte_uber_data.my_first_dbt_model ..... [[31mERROR[0m in 1.38s]
[0m11:42:28.257818 [debug] [Thread-1 (]: Finished running node model.uber_transformations.my_first_dbt_model
[0m11:42:28.259762 [debug] [Thread-1 (]: Began running node model.uber_transformations.my_second_dbt_model
[0m11:42:28.260872 [info ] [Thread-1 (]: 2 of 2 SKIP relation airbyte_uber_data.my_second_dbt_model ..................... [[33mSKIP[0m]
[0m11:42:28.262715 [debug] [Thread-1 (]: Finished running node model.uber_transformations.my_second_dbt_model
[0m11:42:28.266437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:28.267788 [debug] [MainThread]: Connection 'model.uber_transformations.my_first_dbt_model' was properly closed.
[0m11:42:28.268881 [info ] [MainThread]: 
[0m11:42:28.270256 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m11:42:28.272911 [debug] [MainThread]: Command end result
[0m11:42:28.301252 [info ] [MainThread]: 
[0m11:42:28.303063 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:42:28.305169 [info ] [MainThread]: 
[0m11:42:28.307643 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Location EU-WEST2 does not support this operation.
  compiled Code at target/run/uber_transformations/models/example/my_first_dbt_model.sql
[0m11:42:28.311954 [info ] [MainThread]: 
[0m11:42:28.315000 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m11:42:28.317886 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.8085856, "process_user_time": 7.274992, "process_kernel_time": 0.230623, "process_mem_max_rss": "134800", "process_in_blocks": "528", "process_out_blocks": "2784", "command_success": false}
[0m11:42:28.320867 [debug] [MainThread]: Command `dbt run` failed at 11:42:28.319583 after 5.81 seconds
[0m11:42:28.326092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4844b13f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4842bc8e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4842d0dfa0>]}
[0m11:42:28.330712 [debug] [MainThread]: Flushing usage events
[0m11:43:56.560055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b695c9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6d100230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b695cb3b0>]}


============================== 11:43:56.565441 | c4b928e3-1d83-4f16-914e-37307f405aa0 ==============================
[0m11:43:56.565441 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:43:56.566882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:43:57.369629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4b928e3-1d83-4f16-914e-37307f405aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b67ab7470>]}
[0m11:43:57.544196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4b928e3-1d83-4f16-914e-37307f405aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b67b22c30>]}
[0m11:43:57.545758 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m11:43:57.564331 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:43:57.600547 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:43:57.603115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4b928e3-1d83-4f16-914e-37307f405aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6779fe60>]}
[0m11:43:59.724127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4b928e3-1d83-4f16-914e-37307f405aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b67913b30>]}
[0m11:43:59.739497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4b928e3-1d83-4f16-914e-37307f405aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b678fa390>]}
[0m11:43:59.740564 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m11:43:59.741671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b928e3-1d83-4f16-914e-37307f405aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6793e3f0>]}
[0m11:43:59.744684 [info ] [MainThread]: 
[0m11:43:59.746527 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:43:59.749760 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m11:43:59.751117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:00.256847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m11:44:00.258382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:00.738146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b928e3-1d83-4f16-914e-37307f405aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6770a630>]}
[0m11:44:00.740070 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:44:00.741084 [info ] [MainThread]: 
[0m11:44:00.745090 [debug] [Thread-1 (]: Began running node model.uber_transformations.my_first_dbt_model
[0m11:44:00.746665 [info ] [Thread-1 (]: 1 of 2 START sql table model airbyte_uber_data.my_first_dbt_model .............. [RUN]
[0m11:44:00.748938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.my_first_dbt_model)
[0m11:44:00.750027 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.my_first_dbt_model
[0m11:44:00.769891 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.my_first_dbt_model"
[0m11:44:00.778763 [debug] [Thread-1 (]: Timing info for model.uber_transformations.my_first_dbt_model (compile): 11:44:00.750678 => 11:44:00.776042
[0m11:44:00.781800 [debug] [Thread-1 (]: Began executing node model.uber_transformations.my_first_dbt_model
[0m11:44:00.891828 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.my_first_dbt_model"
[0m11:44:00.893290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:00.896254 [debug] [Thread-1 (]: On model.uber_transformations.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.my_first_dbt_model"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m11:44:01.406590 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:EU:b3b87f11-7320-4fb5-94bc-05cbc5aad112&page=queryresults
[0m11:44:01.408230 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.my_first_dbt_model"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m11:44:01.409613 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset uber-data-pipeline-417021:airbyte_uber_data was not found in location EU; reason: notFound, message: Not found: Dataset uber-data-pipeline-417021:airbyte_uber_data was not found in location EU

Location: EU
Job ID: b3b87f11-7320-4fb5-94bc-05cbc5aad112

[0m11:44:01.411356 [debug] [Thread-1 (]: Timing info for model.uber_transformations.my_first_dbt_model (execute): 11:44:00.784708 => 11:44:01.410706
[0m11:44:01.421304 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  404 Not found: Dataset uber-data-pipeline-417021:airbyte_uber_data was not found in location EU; reason: notFound, message: Not found: Dataset uber-data-pipeline-417021:airbyte_uber_data was not found in location EU
  
  Location: EU
  Job ID: b3b87f11-7320-4fb5-94bc-05cbc5aad112
  
[0m11:44:01.422652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b928e3-1d83-4f16-914e-37307f405aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b677bd9d0>]}
[0m11:44:01.424010 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model airbyte_uber_data.my_first_dbt_model ..... [[31mERROR[0m in 0.67s]
[0m11:44:01.425620 [debug] [Thread-1 (]: Finished running node model.uber_transformations.my_first_dbt_model
[0m11:44:01.427400 [debug] [Thread-1 (]: Began running node model.uber_transformations.my_second_dbt_model
[0m11:44:01.429038 [info ] [Thread-1 (]: 2 of 2 SKIP relation airbyte_uber_data.my_second_dbt_model ..................... [[33mSKIP[0m]
[0m11:44:01.430686 [debug] [Thread-1 (]: Finished running node model.uber_transformations.my_second_dbt_model
[0m11:44:01.435491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:01.437230 [debug] [MainThread]: Connection 'model.uber_transformations.my_first_dbt_model' was properly closed.
[0m11:44:01.438923 [info ] [MainThread]: 
[0m11:44:01.440925 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m11:44:01.444604 [debug] [MainThread]: Command end result
[0m11:44:01.488548 [info ] [MainThread]: 
[0m11:44:01.491013 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:44:01.492282 [info ] [MainThread]: 
[0m11:44:01.493427 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  404 Not found: Dataset uber-data-pipeline-417021:airbyte_uber_data was not found in location EU; reason: notFound, message: Not found: Dataset uber-data-pipeline-417021:airbyte_uber_data was not found in location EU
  
  Location: EU
  Job ID: b3b87f11-7320-4fb5-94bc-05cbc5aad112
  
[0m11:44:01.494509 [info ] [MainThread]: 
[0m11:44:01.495898 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m11:44:01.499046 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.014316, "process_user_time": 7.087232, "process_kernel_time": 0.320343, "process_mem_max_rss": "134328", "process_out_blocks": "2784", "command_success": false, "process_in_blocks": "0"}
[0m11:44:01.501368 [debug] [MainThread]: Command `dbt run` failed at 11:44:01.500779 after 5.02 seconds
[0m11:44:01.504677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b696b5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b67981b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b67901310>]}
[0m11:44:01.509652 [debug] [MainThread]: Flushing usage events
[0m11:45:27.487235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907b9d4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907bd596a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907b9d4260>]}


============================== 11:45:27.492254 | f545fdf2-ba13-4852-868b-0d60ed2e8ac7 ==============================
[0m11:45:27.492254 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:45:27.493604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:45:28.309574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f545fdf2-ba13-4852-868b-0d60ed2e8ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079d8aa50>]}
[0m11:45:28.495650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f545fdf2-ba13-4852-868b-0d60ed2e8ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079db3680>]}
[0m11:45:28.497136 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m11:45:28.514529 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:45:28.547185 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:45:28.548423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f545fdf2-ba13-4852-868b-0d60ed2e8ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079bbcbc0>]}
[0m11:45:30.693148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f545fdf2-ba13-4852-868b-0d60ed2e8ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079199490>]}
[0m11:45:30.709400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f545fdf2-ba13-4852-868b-0d60ed2e8ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079a99a90>]}
[0m11:45:30.710456 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m11:45:30.711529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f545fdf2-ba13-4852-868b-0d60ed2e8ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079aff2c0>]}
[0m11:45:30.714553 [info ] [MainThread]: 
[0m11:45:30.716372 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:45:30.720553 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m11:45:30.722499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:31.260145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m11:45:31.261351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:31.749809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f545fdf2-ba13-4852-868b-0d60ed2e8ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079ac3200>]}
[0m11:45:31.751514 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:45:31.752578 [info ] [MainThread]: 
[0m11:45:31.757142 [debug] [Thread-1 (]: Began running node model.uber_transformations.my_first_dbt_model
[0m11:45:31.759202 [info ] [Thread-1 (]: 1 of 2 START sql table model airbyte_uber_data.my_first_dbt_model .............. [RUN]
[0m11:45:31.762333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.my_first_dbt_model)
[0m11:45:31.764405 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.my_first_dbt_model
[0m11:45:31.790200 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.my_first_dbt_model"
[0m11:45:31.795321 [debug] [Thread-1 (]: Timing info for model.uber_transformations.my_first_dbt_model (compile): 11:45:31.765783 => 11:45:31.794131
[0m11:45:31.797252 [debug] [Thread-1 (]: Began executing node model.uber_transformations.my_first_dbt_model
[0m11:45:31.898358 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.my_first_dbt_model"
[0m11:45:31.899860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:31.902833 [debug] [Thread-1 (]: On model.uber_transformations.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.my_first_dbt_model"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m11:45:32.237171 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('POST https://bigquery.googleapis.com/bigquery/v2/projects/uber-data-pipeline-417021/jobs?prettyPrint=false: Location EU-WEST2 does not support this operation.')
[0m11:45:33.194744 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:EU-WEST2:74813ec7-f7bb-459a-a7d4-8886096b9fe0&page=queryresults
[0m11:45:33.197017 [debug] [Thread-1 (]: Timing info for model.uber_transformations.my_first_dbt_model (execute): 11:45:31.798419 => 11:45:33.195874
[0m11:45:33.215690 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Location EU-WEST2 does not support this operation.
  compiled Code at target/run/uber_transformations/models/example/my_first_dbt_model.sql
[0m11:45:33.217673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f545fdf2-ba13-4852-868b-0d60ed2e8ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079d8b6b0>]}
[0m11:45:33.220637 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model airbyte_uber_data.my_first_dbt_model ..... [[31mERROR[0m in 1.46s]
[0m11:45:33.228167 [debug] [Thread-1 (]: Finished running node model.uber_transformations.my_first_dbt_model
[0m11:45:33.234858 [debug] [Thread-1 (]: Began running node model.uber_transformations.my_second_dbt_model
[0m11:45:33.239304 [info ] [Thread-1 (]: 2 of 2 SKIP relation airbyte_uber_data.my_second_dbt_model ..................... [[33mSKIP[0m]
[0m11:45:33.243913 [debug] [Thread-1 (]: Finished running node model.uber_transformations.my_second_dbt_model
[0m11:45:33.255637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:33.258093 [debug] [MainThread]: Connection 'model.uber_transformations.my_first_dbt_model' was properly closed.
[0m11:45:33.260441 [info ] [MainThread]: 
[0m11:45:33.261812 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m11:45:33.263866 [debug] [MainThread]: Command end result
[0m11:45:33.297562 [info ] [MainThread]: 
[0m11:45:33.302341 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:45:33.306911 [info ] [MainThread]: 
[0m11:45:33.309338 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Location EU-WEST2 does not support this operation.
  compiled Code at target/run/uber_transformations/models/example/my_first_dbt_model.sql
[0m11:45:33.312774 [info ] [MainThread]: 
[0m11:45:33.316430 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m11:45:33.324812 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.91411, "process_user_time": 7.200793, "process_kernel_time": 0.299948, "process_mem_max_rss": "134460", "process_out_blocks": "2792", "command_success": false, "process_in_blocks": "0"}
[0m11:45:33.330081 [debug] [MainThread]: Command `dbt run` failed at 11:45:33.329177 after 5.92 seconds
[0m11:45:33.331217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907fbaf680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079ac69c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079d8aed0>]}
[0m11:45:33.332578 [debug] [MainThread]: Flushing usage events
[0m11:50:19.416454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd561bfec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd561be000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd561bd850>]}


============================== 11:50:19.421504 | ae92f530-6eda-4d24-9d83-a59e83162e44 ==============================
[0m11:50:19.421504 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:50:19.422955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:50:20.230711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae92f530-6eda-4d24-9d83-a59e83162e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd560cf380>]}
[0m11:50:20.401525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae92f530-6eda-4d24-9d83-a59e83162e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd54ab5370>]}
[0m11:50:20.403038 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m11:50:20.422895 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:50:20.460464 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:50:20.461631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ae92f530-6eda-4d24-9d83-a59e83162e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd543c03e0>]}
[0m11:50:22.570923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae92f530-6eda-4d24-9d83-a59e83162e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5423e420>]}
[0m11:50:22.585392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae92f530-6eda-4d24-9d83-a59e83162e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd53c208f0>]}
[0m11:50:22.586505 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m11:50:22.587572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae92f530-6eda-4d24-9d83-a59e83162e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd545f88f0>]}
[0m11:50:22.590582 [info ] [MainThread]: 
[0m11:50:22.592449 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:50:22.596497 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m11:50:22.598495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:23.132898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m11:50:23.133989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:50:23.610872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae92f530-6eda-4d24-9d83-a59e83162e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd542dd400>]}
[0m11:50:23.612648 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:50:23.613708 [info ] [MainThread]: 
[0m11:50:23.617482 [debug] [Thread-1 (]: Began running node model.uber_transformations.my_first_dbt_model
[0m11:50:23.618754 [info ] [Thread-1 (]: 1 of 2 START sql table model airbyte_uber_data.my_first_dbt_model .............. [RUN]
[0m11:50:23.621226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.my_first_dbt_model)
[0m11:50:23.622355 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.my_first_dbt_model
[0m11:50:23.650265 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.my_first_dbt_model"
[0m11:50:23.653723 [debug] [Thread-1 (]: Timing info for model.uber_transformations.my_first_dbt_model (compile): 11:50:23.623010 => 11:50:23.652551
[0m11:50:23.656018 [debug] [Thread-1 (]: Began executing node model.uber_transformations.my_first_dbt_model
[0m11:50:23.764467 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.my_first_dbt_model"
[0m11:50:23.766054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:23.769217 [debug] [Thread-1 (]: On model.uber_transformations.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.my_first_dbt_model"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m11:50:24.582644 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d5172ba9-4bc9-4127-958d-b53274a751cb&page=queryresults
[0m11:50:26.604209 [debug] [Thread-1 (]: Timing info for model.uber_transformations.my_first_dbt_model (execute): 11:50:23.657791 => 11:50:26.603694
[0m11:50:26.606251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae92f530-6eda-4d24-9d83-a59e83162e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd53ba0890>]}
[0m11:50:26.607649 [info ] [Thread-1 (]: 1 of 2 OK created sql table model airbyte_uber_data.my_first_dbt_model ......... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.99s]
[0m11:50:26.609390 [debug] [Thread-1 (]: Finished running node model.uber_transformations.my_first_dbt_model
[0m11:50:26.611219 [debug] [Thread-1 (]: Began running node model.uber_transformations.my_second_dbt_model
[0m11:50:26.612404 [info ] [Thread-1 (]: 2 of 2 START sql view model airbyte_uber_data.my_second_dbt_model .............. [RUN]
[0m11:50:26.614591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.my_first_dbt_model, now model.uber_transformations.my_second_dbt_model)
[0m11:50:26.616465 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.my_second_dbt_model
[0m11:50:26.625238 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.my_second_dbt_model"
[0m11:50:26.627116 [debug] [Thread-1 (]: Timing info for model.uber_transformations.my_second_dbt_model (compile): 11:50:26.617225 => 11:50:26.626375
[0m11:50:26.629159 [debug] [Thread-1 (]: Began executing node model.uber_transformations.my_second_dbt_model
[0m11:50:26.687203 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.my_second_dbt_model"
[0m11:50:26.688524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:26.693512 [debug] [Thread-1 (]: On model.uber_transformations.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.my_second_dbt_model"} */


  create or replace view `uber-data-pipeline-417021`.`airbyte_uber_data`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `uber-data-pipeline-417021`.`airbyte_uber_data`.`my_first_dbt_model`
where id = 1;


[0m11:50:27.442469 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:99070a93-e575-489d-8f2d-326015f3fd6c&page=queryresults
[0m11:50:27.886599 [debug] [Thread-1 (]: Timing info for model.uber_transformations.my_second_dbt_model (execute): 11:50:26.630518 => 11:50:27.886105
[0m11:50:27.888393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae92f530-6eda-4d24-9d83-a59e83162e44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd542eb3e0>]}
[0m11:50:27.889753 [info ] [Thread-1 (]: 2 of 2 OK created sql view model airbyte_uber_data.my_second_dbt_model ......... [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m11:50:27.891391 [debug] [Thread-1 (]: Finished running node model.uber_transformations.my_second_dbt_model
[0m11:50:27.894811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:27.895832 [debug] [MainThread]: Connection 'model.uber_transformations.my_second_dbt_model' was properly closed.
[0m11:50:27.897508 [info ] [MainThread]: 
[0m11:50:27.899032 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m11:50:27.901493 [debug] [MainThread]: Command end result
[0m11:50:27.937726 [info ] [MainThread]: 
[0m11:50:27.941171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:50:27.947131 [info ] [MainThread]: 
[0m11:50:27.952314 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:50:27.959687 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.619871, "process_user_time": 7.480475, "process_kernel_time": 0.254503, "process_mem_max_rss": "134312", "process_out_blocks": "2800", "process_in_blocks": "0"}
[0m11:50:27.964303 [debug] [MainThread]: Command `dbt run` succeeded at 11:50:27.962524 after 8.62 seconds
[0m11:50:27.967309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd562abb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd54425670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd546caa50>]}
[0m11:50:27.970325 [debug] [MainThread]: Flushing usage events
[0m13:51:35.679343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acf6cfb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acf6cd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acf6cdc10>]}


============================== 13:51:35.734482 | 75f14031-ed3a-4103-aed5-f4bba138452a ==============================
[0m13:51:35.734482 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:51:35.736350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:51:37.916006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75f14031-ed3a-4103-aed5-f4bba138452a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acddc35f0>]}
[0m13:51:38.089201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75f14031-ed3a-4103-aed5-f4bba138452a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acdaaf410>]}
[0m13:51:38.099652 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m13:51:38.144679 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:51:38.279441 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 0 files changed.
[0m13:51:38.280568 [debug] [MainThread]: Partial parsing: added file: uber_transformations://models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m13:51:38.281593 [debug] [MainThread]: Partial parsing: deleted file: uber_transformations://models/example/my_second_dbt_model.sql
[0m13:51:38.282526 [debug] [MainThread]: Partial parsing: deleted file: uber_transformations://models/example/my_first_dbt_model.sql
[0m13:51:38.628943 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.uber_transformations.example
[0m13:51:38.640036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75f14031-ed3a-4103-aed5-f4bba138452a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acd826300>]}
[0m13:51:38.707188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75f14031-ed3a-4103-aed5-f4bba138452a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acd9b8320>]}
[0m13:51:38.708255 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m13:51:38.709395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75f14031-ed3a-4103-aed5-f4bba138452a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acdc279b0>]}
[0m13:51:38.712095 [info ] [MainThread]: 
[0m13:51:38.713961 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:51:38.716937 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m13:51:38.718061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:39.316961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m13:51:39.318201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:39.765705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75f14031-ed3a-4103-aed5-f4bba138452a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acdc279b0>]}
[0m13:51:39.767781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:51:39.769076 [info ] [MainThread]: 
[0m13:51:39.816521 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:51:39.819521 [info ] [Thread-1 (]: 1 of 1 START sql view model airbyte_uber_data.unter_grun_pickups_in_bronx ...... [RUN]
[0m13:51:39.825508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m13:51:39.828097 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:51:39.848215 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m13:51:39.850709 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 13:51:39.830588 => 13:51:39.849708
[0m13:51:39.852526 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:51:39.930285 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m13:51:39.932033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:39.935296 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */


  create or replace view `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
  OPTIONS()
  as -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.Pickup_date AS 'Pickup Date',
       base.base_name AS 'Base Name',
       t_zone.Borough AS 'Borough',
       t_zone.Zone AS 'Zone'
FROM raw_data_janjune_15 AS raw
JOIN base_num_and_name AS base USING base.base_num = raw.Affiliated_base_num
JOIN taxi_zone_lookup AS t_zone USING t_zone.LocationID = raw.LocationID
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough == 'Bronx';


[0m13:51:40.554474 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:52b75fda-e8c4-4efa-8472-f4be3d4b0fc9&page=queryresults
[0m13:51:40.556340 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'Pickup Date' at [8:27]; reason: invalidQuery, location: query, message: Syntax error: Unexpected string literal 'Pickup Date' at [8:27]")
[0m13:51:41.228533 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:22b5770f-3de1-46ac-b1bb-ec67d7840e3a&page=queryresults
[0m13:51:41.231036 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:22b5770f-3de1-46ac-b1bb-ec67d7840e3a&page=queryresults
[0m13:51:41.234133 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 13:51:39.853653 => 13:51:41.233091
[0m13:51:41.364376 [debug] [Thread-1 (]: Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Syntax error: Unexpected string literal 'Pickup Date' at [8:27]
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m13:51:41.365553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f14031-ed3a-4103-aed5-f4bba138452a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acd86f140>]}
[0m13:51:41.366927 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model airbyte_uber_data.unter_grun_pickups_in_bronx  [[31mERROR[0m in 1.54s]
[0m13:51:41.368564 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:51:41.371911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:41.372766 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m13:51:41.374089 [info ] [MainThread]: 
[0m13:51:41.376148 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m13:51:41.379137 [debug] [MainThread]: Command end result
[0m13:51:41.410192 [info ] [MainThread]: 
[0m13:51:41.414769 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:51:41.420604 [info ] [MainThread]: 
[0m13:51:41.424363 [error] [MainThread]:   Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Syntax error: Unexpected string literal 'Pickup Date' at [8:27]
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m13:51:41.427651 [info ] [MainThread]: 
[0m13:51:41.430419 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:51:41.464603 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.892415, "process_user_time": 5.620219, "process_kernel_time": 0.407308, "process_mem_max_rss": "133392", "process_in_blocks": "101008", "process_out_blocks": "2712", "command_success": false}
[0m13:51:41.468266 [debug] [MainThread]: Command `dbt run` failed at 13:51:41.467473 after 5.90 seconds
[0m13:51:41.471717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acf6ffbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acd9008c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acdcf9a90>]}
[0m13:51:41.475812 [debug] [MainThread]: Flushing usage events
[0m13:52:45.260872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f592f8ef2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f592fd5d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f592ff23470>]}


============================== 13:52:45.265968 | d716c50a-cf1f-434a-8b45-e3e13153c78c ==============================
[0m13:52:45.265968 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:52:45.267374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:46.099401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd716c50a-cf1f-434a-8b45-e3e13153c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f592dc6f770>]}
[0m13:52:46.271230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd716c50a-cf1f-434a-8b45-e3e13153c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f592e1bd9a0>]}
[0m13:52:46.272756 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m13:52:46.288690 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:52:46.377392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:52:46.378752 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m13:52:46.719124 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.uber_transformations.example
[0m13:52:46.730401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd716c50a-cf1f-434a-8b45-e3e13153c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f592da25df0>]}
[0m13:52:46.754618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd716c50a-cf1f-434a-8b45-e3e13153c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f592dbbf020>]}
[0m13:52:46.760472 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m13:52:46.765676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd716c50a-cf1f-434a-8b45-e3e13153c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f592d9748f0>]}
[0m13:52:46.771544 [info ] [MainThread]: 
[0m13:52:46.776998 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:52:46.785983 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m13:52:46.790342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:47.427670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m13:52:47.428972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:47.887746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd716c50a-cf1f-434a-8b45-e3e13153c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f592d9776e0>]}
[0m13:52:47.889987 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:47.891393 [info ] [MainThread]: 
[0m13:52:47.897833 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:52:47.899439 [info ] [Thread-1 (]: 1 of 1 START sql view model airbyte_uber_data.unter_grun_pickups_in_bronx ...... [RUN]
[0m13:52:47.901494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m13:52:47.902801 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:52:47.924881 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m13:52:47.934307 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 13:52:47.903581 => 13:52:47.930477
[0m13:52:47.938776 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:52:48.068530 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m13:52:48.070289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:48.074019 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */


  create or replace view `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
  OPTIONS()
  as -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS 'Pickup Date',
       base.base_name AS 'Base Name',
       t_zone.borough AS 'Borough',
       t_zone.zone AS 'Zone'
FROM raw_data_janjune_15 AS raw
JOIN base_num_and_name AS base USING base.base_num = raw.affiliated_base_num
JOIN taxi_zone_lookup AS t_zone USING t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough == 'Bronx';


[0m13:52:48.773351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:34f86ba1-ed0a-4ebe-b764-f1ab4b9671a0&page=queryresults
[0m13:52:48.774826 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'Pickup Date' at [8:27]; reason: invalidQuery, location: query, message: Syntax error: Unexpected string literal 'Pickup Date' at [8:27]")
[0m13:52:49.942339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:018689de-a824-457b-a72f-2a4bc77e7e05&page=queryresults
[0m13:52:49.943684 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:018689de-a824-457b-a72f-2a4bc77e7e05&page=queryresults
[0m13:52:49.945385 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 13:52:47.941993 => 13:52:49.944755
[0m13:52:49.960714 [debug] [Thread-1 (]: Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Syntax error: Unexpected string literal 'Pickup Date' at [8:27]
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m13:52:49.962908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd716c50a-cf1f-434a-8b45-e3e13153c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f592da8a150>]}
[0m13:52:49.965394 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model airbyte_uber_data.unter_grun_pickups_in_bronx  [[31mERROR[0m in 2.06s]
[0m13:52:49.969113 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:52:49.978551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:49.979673 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m13:52:49.980850 [info ] [MainThread]: 
[0m13:52:49.982454 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m13:52:49.984861 [debug] [MainThread]: Command end result
[0m13:52:50.043637 [info ] [MainThread]: 
[0m13:52:50.046420 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:52:50.051912 [info ] [MainThread]: 
[0m13:52:50.057746 [error] [MainThread]:   Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Syntax error: Unexpected string literal 'Pickup Date' at [8:27]
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m13:52:50.062744 [info ] [MainThread]: 
[0m13:52:50.068852 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:52:50.073187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.8896456, "process_user_time": 5.627803, "process_kernel_time": 0.266392, "process_mem_max_rss": "131720", "process_out_blocks": "2712", "command_success": false, "process_in_blocks": "0"}
[0m13:52:50.075746 [debug] [MainThread]: Command `dbt run` failed at 13:52:50.075047 after 4.89 seconds
[0m13:52:50.077725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f592fb1b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f592de0f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5932944860>]}
[0m13:52:50.079562 [debug] [MainThread]: Flushing usage events
[0m13:55:48.698281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe273dc9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe273dc9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe273dc9af0>]}


============================== 13:55:48.703537 | 3c993621-5606-4782-aba9-9f66143a7b51 ==============================
[0m13:55:48.703537 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:55:48.704969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:55:49.555613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c993621-5606-4782-aba9-9f66143a7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe272392ae0>]}
[0m13:55:49.744189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c993621-5606-4782-aba9-9f66143a7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe27220a8a0>]}
[0m13:55:49.745685 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m13:55:49.767302 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:55:49.856490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:55:49.857693 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m13:55:50.195739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.uber_transformations.example
[0m13:55:50.209522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c993621-5606-4782-aba9-9f66143a7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe271e82cc0>]}
[0m13:55:50.253853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c993621-5606-4782-aba9-9f66143a7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2720bb860>]}
[0m13:55:50.256224 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m13:55:50.259825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c993621-5606-4782-aba9-9f66143a7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2720bbe00>]}
[0m13:55:50.278238 [info ] [MainThread]: 
[0m13:55:50.287323 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:55:50.293395 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m13:55:50.295305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:50.895452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m13:55:50.896623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:51.401218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c993621-5606-4782-aba9-9f66143a7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2720b9640>]}
[0m13:55:51.403129 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:51.404407 [info ] [MainThread]: 
[0m13:55:51.410842 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:55:51.412310 [info ] [Thread-1 (]: 1 of 1 START sql view model airbyte_uber_data.unter_grun_pickups_in_bronx ...... [RUN]
[0m13:55:51.414348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m13:55:51.415568 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:55:51.443663 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m13:55:51.452153 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 13:55:51.416329 => 13:55:51.449687
[0m13:55:51.454725 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:55:51.573585 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m13:55:51.575241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:51.578172 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */


  create or replace view `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
  OPTIONS()
  as -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS 'Pickup Date',
       base.base_name AS 'Base Name',
       t_zone.borough AS 'Borough',
       t_zone.zone AS 'Zone'
FROM raw_data_janjune_15 AS raw
JOIN base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx';


[0m13:55:52.281706 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:d8f91bde-d9f5-4a25-aba2-70d179b0882b&page=queryresults
[0m13:55:52.283099 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'Pickup Date' at [8:27]; reason: invalidQuery, location: query, message: Syntax error: Unexpected string literal 'Pickup Date' at [8:27]")
[0m13:55:53.277150 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:07852c56-8f10-4507-98e8-2ef7a090d34b&page=queryresults
[0m13:55:53.278898 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:07852c56-8f10-4507-98e8-2ef7a090d34b&page=queryresults
[0m13:55:53.281710 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 13:55:51.457186 => 13:55:53.280687
[0m13:55:53.297103 [debug] [Thread-1 (]: Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Syntax error: Unexpected string literal 'Pickup Date' at [8:27]
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m13:55:53.298856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c993621-5606-4782-aba9-9f66143a7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2720279e0>]}
[0m13:55:53.301524 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model airbyte_uber_data.unter_grun_pickups_in_bronx  [[31mERROR[0m in 1.88s]
[0m13:55:53.305505 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:55:53.326943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:53.330641 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m13:55:53.332597 [info ] [MainThread]: 
[0m13:55:53.337482 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m13:55:53.343938 [debug] [MainThread]: Command end result
[0m13:55:53.392582 [info ] [MainThread]: 
[0m13:55:53.395002 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:55:53.396903 [info ] [MainThread]: 
[0m13:55:53.398752 [error] [MainThread]:   Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Syntax error: Unexpected string literal 'Pickup Date' at [8:27]
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m13:55:53.400681 [info ] [MainThread]: 
[0m13:55:53.407282 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:55:53.414504 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.813421, "process_user_time": 5.693102, "process_kernel_time": 0.305054, "process_mem_max_rss": "131716", "process_in_blocks": "24", "process_out_blocks": "2712", "command_success": false}
[0m13:55:53.417782 [debug] [MainThread]: Command `dbt run` failed at 13:55:53.417021 after 4.82 seconds
[0m13:55:53.423236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2741fc170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe273fccf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe27203b080>]}
[0m13:55:53.427121 [debug] [MainThread]: Flushing usage events
[0m13:56:55.291052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa941f48440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa941f4bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa941f483b0>]}


============================== 13:56:55.296368 | 74f1b48c-b832-46b4-af9c-d55df7b6844a ==============================
[0m13:56:55.296368 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:56:55.297757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'True', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:56:56.134845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74f1b48c-b832-46b4-af9c-d55df7b6844a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94042cd40>]}
[0m13:56:56.367531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74f1b48c-b832-46b4-af9c-d55df7b6844a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9403c2cf0>]}
[0m13:56:56.369293 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m13:56:56.386920 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:56:56.503888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:56.505016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:56.506486 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.uber_transformations.example
[0m13:56:56.518186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74f1b48c-b832-46b4-af9c-d55df7b6844a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa940209c40>]}
[0m13:56:56.554978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74f1b48c-b832-46b4-af9c-d55df7b6844a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa940093da0>]}
[0m13:56:56.563859 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m13:56:56.567588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74f1b48c-b832-46b4-af9c-d55df7b6844a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9400933b0>]}
[0m13:56:56.577158 [info ] [MainThread]: 
[0m13:56:56.581451 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:56:56.592580 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m13:56:56.595336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:57.254162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m13:56:57.255921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:57.742985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74f1b48c-b832-46b4-af9c-d55df7b6844a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa940091220>]}
[0m13:56:57.745832 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:56:57.746830 [info ] [MainThread]: 
[0m13:56:57.752082 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:56:57.753794 [info ] [Thread-1 (]: 1 of 1 START sql view model airbyte_uber_data.unter_grun_pickups_in_bronx ...... [RUN]
[0m13:56:57.755935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m13:56:57.757244 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:56:57.779529 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m13:56:57.782165 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 13:56:57.758169 => 13:56:57.781132
[0m13:56:57.783679 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:56:57.923865 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m13:56:57.926489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:57.929612 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */


  create or replace view `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
  OPTIONS()
  as -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS 'Pickup Date',
       base.base_name AS 'Base Name',
       t_zone.borough AS 'Borough',
       t_zone.zone AS 'Zone'
FROM raw_data_janjune_15 AS raw
JOIN base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx';


[0m13:56:58.529575 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:4626ae64-22e5-45da-9ad6-d2be7192ab79&page=queryresults
[0m13:56:58.531425 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'Pickup Date' at [8:27]; reason: invalidQuery, location: query, message: Syntax error: Unexpected string literal 'Pickup Date' at [8:27]")
[0m13:56:59.314299 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:e7efbd72-1e2f-4781-baac-3f386d220395&page=queryresults
[0m13:56:59.316924 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:e7efbd72-1e2f-4781-baac-3f386d220395&page=queryresults
[0m13:56:59.319881 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 13:56:57.785616 => 13:56:59.318810
[0m13:56:59.343971 [debug] [Thread-1 (]: Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Syntax error: Unexpected string literal 'Pickup Date' at [8:27]
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m13:56:59.348164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74f1b48c-b832-46b4-af9c-d55df7b6844a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93ff58ad0>]}
[0m13:56:59.356099 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model airbyte_uber_data.unter_grun_pickups_in_bronx  [[31mERROR[0m in 1.59s]
[0m13:56:59.363575 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:56:59.381386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:59.383515 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m13:56:59.387747 [info ] [MainThread]: 
[0m13:56:59.391464 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m13:56:59.402088 [debug] [MainThread]: Command end result
[0m13:56:59.659259 [info ] [MainThread]: 
[0m13:56:59.661494 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:56:59.663535 [info ] [MainThread]: 
[0m13:56:59.665598 [error] [MainThread]:   Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Syntax error: Unexpected string literal 'Pickup Date' at [8:27]
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m13:56:59.667704 [info ] [MainThread]: 
[0m13:56:59.669560 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:56:59.673083 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.4578867, "process_user_time": 5.684241, "process_kernel_time": 0.26769, "process_mem_max_rss": "129472", "process_out_blocks": "1816", "command_success": false, "process_in_blocks": "0"}
[0m13:56:59.676503 [debug] [MainThread]: Command `dbt run` failed at 13:56:59.675815 after 4.46 seconds
[0m13:56:59.679337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa945bbb6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa940c40bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9402efef0>]}
[0m13:56:59.682167 [debug] [MainThread]: Flushing usage events
[0m13:57:53.824624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54068ea930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5404894ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5404436c90>]}


============================== 13:57:53.829613 | 4730504e-7503-4caf-b940-d6c2e50fbbe5 ==============================
[0m13:57:53.829613 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:57:53.830932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:57:54.676069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4730504e-7503-4caf-b940-d6c2e50fbbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54029e0fb0>]}
[0m13:57:54.850131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4730504e-7503-4caf-b940-d6c2e50fbbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5402ce7e90>]}
[0m13:57:54.851560 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m13:57:54.867009 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:57:54.949684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:57:54.950965 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m13:57:55.290808 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.uber_transformations.example
[0m13:57:55.302509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4730504e-7503-4caf-b940-d6c2e50fbbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5402527e90>]}
[0m13:57:55.350923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4730504e-7503-4caf-b940-d6c2e50fbbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54026dbb90>]}
[0m13:57:55.353649 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m13:57:55.359332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4730504e-7503-4caf-b940-d6c2e50fbbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5404347fb0>]}
[0m13:57:55.368268 [info ] [MainThread]: 
[0m13:57:55.377034 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:57:55.383604 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m13:57:55.384904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:55.911645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m13:57:55.912788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:56.370805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4730504e-7503-4caf-b940-d6c2e50fbbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54026d9520>]}
[0m13:57:56.372582 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:57:56.373657 [info ] [MainThread]: 
[0m13:57:56.378369 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:57:56.380194 [info ] [Thread-1 (]: 1 of 1 START sql view model airbyte_uber_data.unter_grun_pickups_in_bronx ...... [RUN]
[0m13:57:56.382644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m13:57:56.384060 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:57:56.408914 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m13:57:56.416917 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 13:57:56.384856 => 13:57:56.413256
[0m13:57:56.424575 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:57:56.550255 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m13:57:56.551691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:56.554624 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */


  create or replace view `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
  OPTIONS()
  as -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM raw_data_janjune_15 AS raw
JOIN base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx';


[0m13:57:57.044502 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:cbc7ba6f-e895-4c5e-b411-0196ba243945&page=queryresults
[0m13:57:57.046075 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: base_num_and_name, message: Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).')
[0m13:57:57.454792 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:de8416c0-687c-4bfe-8cd7-c21d1f6799ce&page=queryresults
[0m13:57:57.456036 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:de8416c0-687c-4bfe-8cd7-c21d1f6799ce&page=queryresults
[0m13:57:57.457631 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 13:57:56.427729 => 13:57:57.457049
[0m13:57:57.472949 [debug] [Thread-1 (]: Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m13:57:57.475044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4730504e-7503-4caf-b940-d6c2e50fbbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54025a9d90>]}
[0m13:57:57.477540 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model airbyte_uber_data.unter_grun_pickups_in_bronx  [[31mERROR[0m in 1.09s]
[0m13:57:57.480352 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:57:57.493602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:57.496408 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m13:57:57.498777 [info ] [MainThread]: 
[0m13:57:57.503881 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m13:57:57.514779 [debug] [MainThread]: Command end result
[0m13:57:57.557376 [info ] [MainThread]: 
[0m13:57:57.562600 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:57:57.567909 [info ] [MainThread]: 
[0m13:57:57.573488 [error] [MainThread]:   Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m13:57:57.578249 [info ] [MainThread]: 
[0m13:57:57.582720 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:57:57.597669 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.8488178, "process_user_time": 5.665582, "process_kernel_time": 0.273847, "process_mem_max_rss": "131644", "process_out_blocks": "2712", "command_success": false, "process_in_blocks": "0"}
[0m13:57:57.601563 [debug] [MainThread]: Command `dbt run` failed at 13:57:57.600851 after 3.85 seconds
[0m13:57:57.604182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54085f7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54029a6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5402824050>]}
[0m13:57:57.609704 [debug] [MainThread]: Flushing usage events
[0m13:59:10.494287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac0f64740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac11eb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac15cac00>]}


============================== 13:59:10.499260 | bc5d733d-0a1e-4fdf-b0d0-798ada03a6b7 ==============================
[0m13:59:10.499260 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:59:10.500612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:59:11.347911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc5d733d-0a1e-4fdf-b0d0-798ada03a6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabf8b9490>]}
[0m13:59:11.523686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc5d733d-0a1e-4fdf-b0d0-798ada03a6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabf5a7e30>]}
[0m13:59:11.525262 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m13:59:11.552402 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:59:11.631640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:59:11.632883 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m13:59:11.968524 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.uber_transformations.example
[0m13:59:11.980323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc5d733d-0a1e-4fdf-b0d0-798ada03a6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabf096a80>]}
[0m13:59:12.022196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc5d733d-0a1e-4fdf-b0d0-798ada03a6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabf324b90>]}
[0m13:59:12.024420 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m13:59:12.026340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc5d733d-0a1e-4fdf-b0d0-798ada03a6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabf4a8da0>]}
[0m13:59:12.034216 [info ] [MainThread]: 
[0m13:59:12.036287 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:59:12.048151 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m13:59:12.051877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:12.589954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m13:59:12.591001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:12.982504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc5d733d-0a1e-4fdf-b0d0-798ada03a6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabf4ca180>]}
[0m13:59:12.984913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:12.986159 [info ] [MainThread]: 
[0m13:59:12.989855 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:59:12.991424 [info ] [Thread-1 (]: 1 of 1 START sql view model airbyte_uber_data.unter_grun_pickups_in_bronx ...... [RUN]
[0m13:59:12.994942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m13:59:12.997049 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:59:13.036730 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m13:59:13.043344 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 13:59:12.998343 => 13:59:13.040966
[0m13:59:13.045351 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:59:13.169131 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m13:59:13.170809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:13.174596 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */


  create or replace view `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
  OPTIONS()
  as -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx';


[0m13:59:14.313164 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:5f3f12a6-8b31-4e79-800e-6bc3a87ab54e&page=queryresults
[0m13:59:14.786957 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 13:59:13.046276 => 13:59:14.786406
[0m13:59:14.789018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc5d733d-0a1e-4fdf-b0d0-798ada03a6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabf2da300>]}
[0m13:59:14.790501 [info ] [Thread-1 (]: 1 of 1 OK created sql view model airbyte_uber_data.unter_grun_pickups_in_bronx . [[32mCREATE VIEW (0 processed)[0m in 1.80s]
[0m13:59:14.792245 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m13:59:14.795589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:14.797159 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m13:59:14.798281 [info ] [MainThread]: 
[0m13:59:14.799557 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m13:59:14.801587 [debug] [MainThread]: Command end result
[0m13:59:14.818374 [info ] [MainThread]: 
[0m13:59:14.819747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:14.820769 [info ] [MainThread]: 
[0m13:59:14.821963 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:59:14.823889 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4063087, "process_user_time": 5.529316, "process_kernel_time": 0.303066, "process_mem_max_rss": "129264", "process_out_blocks": "2712", "process_in_blocks": "0"}
[0m13:59:14.825510 [debug] [MainThread]: Command `dbt run` succeeded at 13:59:14.824928 after 4.41 seconds
[0m13:59:14.826738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac11eb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabf4c9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabf708170>]}
[0m13:59:14.827747 [debug] [MainThread]: Flushing usage events
[0m14:01:41.865619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdb6b13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd9bfb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd9569460>]}


============================== 14:01:41.912517 | 4b04deed-6cae-4bc9-93b2-230ed49cf787 ==============================
[0m14:01:41.912517 [info ] [MainThread]: Running with dbt=1.7.10
[0m14:01:41.913980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:01:43.885363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b04deed-6cae-4bc9-93b2-230ed49cf787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd7dd29c0>]}
[0m14:01:44.068626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b04deed-6cae-4bc9-93b2-230ed49cf787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd79bfe00>]}
[0m14:01:44.197782 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m14:01:44.274394 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m14:01:44.321199 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:01:44.322424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b04deed-6cae-4bc9-93b2-230ed49cf787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd77c01a0>]}
[0m14:01:46.701825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b04deed-6cae-4bc9-93b2-230ed49cf787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd76fa330>]}
[0m14:01:46.746757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b04deed-6cae-4bc9-93b2-230ed49cf787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd76fb350>]}
[0m14:01:46.747788 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m14:01:46.748932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b04deed-6cae-4bc9-93b2-230ed49cf787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd76f0ce0>]}
[0m14:01:46.752559 [info ] [MainThread]: 
[0m14:01:46.755471 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:01:46.758407 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m14:01:46.760126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:47.338935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m14:01:47.340018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:47.901839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b04deed-6cae-4bc9-93b2-230ed49cf787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd7ccf770>]}
[0m14:01:47.904676 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:01:47.906445 [info ] [MainThread]: 
[0m14:01:47.921514 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m14:01:47.923180 [info ] [Thread-1 (]: 1 of 1 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m14:01:47.925495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m14:01:47.927043 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m14:01:47.959938 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m14:01:47.986007 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 14:01:47.928422 => 14:01:47.983961
[0m14:01:47.996243 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m14:01:48.096848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:48.712453 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m14:01:48.714692 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m14:01:49.570080 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c982447f-cbd8-42a9-8def-0775e4816e14&page=queryresults
[0m14:01:51.798605 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 14:01:48.000000 => 14:01:51.798023
[0m14:01:51.800632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b04deed-6cae-4bc9-93b2-230ed49cf787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd78ba030>]}
[0m14:01:51.802078 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.88s]
[0m14:01:51.803848 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m14:01:51.807159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:51.808113 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m14:01:51.810133 [info ] [MainThread]: 
[0m14:01:51.811661 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m14:01:51.813803 [debug] [MainThread]: Command end result
[0m14:01:51.886029 [info ] [MainThread]: 
[0m14:01:51.889220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:01:51.899655 [info ] [MainThread]: 
[0m14:01:51.904650 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:01:51.934151 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.176489, "process_user_time": 9.507163, "process_kernel_time": 0.629944, "process_mem_max_rss": "131368", "process_in_blocks": "67528", "process_out_blocks": "2712"}
[0m14:01:51.938921 [debug] [MainThread]: Command `dbt run` succeeded at 14:01:51.937413 after 10.18 seconds
[0m14:01:51.943420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd9597d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd7aa7d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd8621760>]}
[0m14:01:51.946486 [debug] [MainThread]: Flushing usage events
[0m16:27:39.278274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b61f35a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b620236e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b61f35850>]}


============================== 16:27:39.326848 | fac3a58f-f553-48fe-a35a-2cf5e24f8b95 ==============================
[0m16:27:39.326848 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:27:39.329798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:27:44.685166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fac3a58f-f553-48fe-a35a-2cf5e24f8b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b6045bec0>]}
[0m16:27:44.973600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fac3a58f-f553-48fe-a35a-2cf5e24f8b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b61e596a0>]}
[0m16:27:44.976233 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m16:27:45.009226 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:27:45.228737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:27:45.232960 [debug] [MainThread]: Partial parsing: added file: uber_transformations://models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m16:27:45.234720 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m16:27:45.756779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fac3a58f-f553-48fe-a35a-2cf5e24f8b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b6002cd40>]}
[0m16:27:45.818071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fac3a58f-f553-48fe-a35a-2cf5e24f8b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b6026c110>]}
[0m16:27:45.819649 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m16:27:45.820912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fac3a58f-f553-48fe-a35a-2cf5e24f8b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b60057170>]}
[0m16:27:45.824054 [info ] [MainThread]: 
[0m16:27:45.830038 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:27:45.834743 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m16:27:45.836511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:46.709921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m16:27:46.711454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:47.293013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fac3a58f-f553-48fe-a35a-2cf5e24f8b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b603330e0>]}
[0m16:27:47.295737 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:27:47.297130 [info ] [MainThread]: 
[0m16:27:47.341880 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:27:47.348168 [info ] [Thread-1 (]: 1 of 2 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m16:27:47.356389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m16:27:47.361222 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:27:47.438437 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m16:27:47.468297 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 16:27:47.364596 => 16:27:47.466462
[0m16:27:47.475740 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:27:47.659700 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m16:27:47.665088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:47.673512 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
GROUP BY base.base_num
HAVING EXTRACT(MONTH FROM raw.pickup_date) = 5
ORDER BY COUNT(*) DESC;
    );
  
[0m16:27:48.273715 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:227d923d-1530-4af8-a2cd-752617082a19&page=queryresults
[0m16:27:48.276161 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [21:23]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [21:23]')
[0m16:27:48.701174 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a4017603-299d-489a-8131-0224d9a2b675&page=queryresults
[0m16:27:48.702475 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a4017603-299d-489a-8131-0224d9a2b675&page=queryresults
[0m16:27:48.704122 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 16:27:47.480308 => 16:27:48.703538
[0m16:27:48.886543 [debug] [Thread-1 (]: Database Error in model total_number_of_pickups_in_may_by_base_name (models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql)
  Syntax error: Expected ")" but got ";" at [21:23]
  compiled Code at target/run/uber_transformations/models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m16:27:48.887954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac3a58f-f553-48fe-a35a-2cf5e24f8b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b602c76e0>]}
[0m16:27:48.889447 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[31mERROR[0m in 1.54s]
[0m16:27:48.891548 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:27:48.893461 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:27:48.899684 [info ] [Thread-1 (]: 2 of 2 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m16:27:48.903280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m16:27:48.905657 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:27:48.921755 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m16:27:48.930402 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 16:27:48.907384 => 16:27:48.923923
[0m16:27:48.937145 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:27:48.957413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:49.518185 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m16:27:49.520892 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx';
    );
  
[0m16:27:49.658474 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c5e2e902-c408-4130-8dec-8526d7125ba4&page=queryresults
[0m16:27:49.659707 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [22:71]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [22:71]')
[0m16:27:50.476192 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:47ece7a8-6f59-4e2c-9da8-5de80571e0a4&page=queryresults
[0m16:27:50.477954 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:47ece7a8-6f59-4e2c-9da8-5de80571e0a4&page=queryresults
[0m16:27:50.483680 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 16:27:48.939672 => 16:27:50.481327
[0m16:27:50.507535 [debug] [Thread-1 (]: Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Syntax error: Expected ")" but got ";" at [22:71]
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m16:27:50.513261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac3a58f-f553-48fe-a35a-2cf5e24f8b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b602c5ee0>]}
[0m16:27:50.518485 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[31mERROR[0m in 1.61s]
[0m16:27:50.526133 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:27:50.544906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:50.552323 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m16:27:50.554740 [info ] [MainThread]: 
[0m16:27:50.562665 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m16:27:50.599506 [debug] [MainThread]: Command end result
[0m16:27:50.679203 [info ] [MainThread]: 
[0m16:27:50.687268 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:27:50.696440 [info ] [MainThread]: 
[0m16:27:50.701024 [error] [MainThread]:   Database Error in model total_number_of_pickups_in_may_by_base_name (models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql)
  Syntax error: Expected ")" but got ";" at [21:23]
  compiled Code at target/run/uber_transformations/models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m16:27:50.704640 [info ] [MainThread]: 
[0m16:27:50.707851 [error] [MainThread]:   Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Syntax error: Expected ")" but got ";" at [22:71]
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m16:27:50.715883 [info ] [MainThread]: 
[0m16:27:50.721297 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:27:50.761770 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.674439, "process_user_time": 12.116168, "process_kernel_time": 1.255964, "process_mem_max_rss": "132052", "process_in_blocks": "131040", "process_out_blocks": "2760", "command_success": false}
[0m16:27:50.775627 [debug] [MainThread]: Command `dbt run` failed at 16:27:50.769375 after 11.69 seconds
[0m16:27:50.783207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b621ee8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b601c08c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b60011640>]}
[0m16:27:50.788314 [debug] [MainThread]: Flushing usage events
[0m16:28:19.134980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db2ff4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db3345580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db314c350>]}


============================== 16:28:19.141247 | 2c7d9943-aa08-4559-8255-bc0b433db8a4 ==============================
[0m16:28:19.141247 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:28:19.144920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:28:20.377520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c7d9943-aa08-4559-8255-bc0b433db8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db114be90>]}
[0m16:28:20.659341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c7d9943-aa08-4559-8255-bc0b433db8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db125f0e0>]}
[0m16:28:20.661501 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m16:28:20.694551 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:28:20.927607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:28:20.932523 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m16:28:20.938232 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m16:28:22.441839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c7d9943-aa08-4559-8255-bc0b433db8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db125fbc0>]}
[0m16:28:22.486982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c7d9943-aa08-4559-8255-bc0b433db8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db1093bf0>]}
[0m16:28:22.490498 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m16:28:22.493793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c7d9943-aa08-4559-8255-bc0b433db8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db16717f0>]}
[0m16:28:22.512824 [info ] [MainThread]: 
[0m16:28:22.528771 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:28:22.561350 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m16:28:22.563722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:23.817829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m16:28:23.827127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:24.772731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c7d9943-aa08-4559-8255-bc0b433db8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db30364e0>]}
[0m16:28:24.785510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:28:24.789480 [info ] [MainThread]: 
[0m16:28:24.828332 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:28:24.839796 [info ] [Thread-1 (]: 1 of 2 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m16:28:24.857579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m16:28:24.870419 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:28:24.982342 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m16:28:25.002859 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 16:28:24.874780 => 16:28:24.997995
[0m16:28:25.020152 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:28:25.509774 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m16:28:25.520805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:25.530975 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
GROUP BY base.base_num
HAVING EXTRACT(MONTH FROM raw.pickup_date) = 5
ORDER BY COUNT(*) DESC
    );
  
[0m16:28:26.889938 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b82ace6c-c44f-491b-9163-e92758907ad6&page=queryresults
[0m16:28:27.092972 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references base.base_name which is neither grouped nor aggregated at [15:8]; reason: invalidQuery, location: query, message: SELECT list expression references base.base_name which is neither grouped nor aggregated at [15:8]')
[0m16:28:27.428769 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ffe4f522-00d7-493c-8588-e91d5ec029cf&page=queryresults
[0m16:28:27.578041 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ffe4f522-00d7-493c-8588-e91d5ec029cf&page=queryresults
[0m16:28:27.580508 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 16:28:25.035706 => 16:28:27.579819
[0m16:28:27.607801 [debug] [Thread-1 (]: Database Error in model total_number_of_pickups_in_may_by_base_name (models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql)
  SELECT list expression references base.base_name which is neither grouped nor aggregated at [15:8]
  compiled Code at target/run/uber_transformations/models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m16:28:27.609951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c7d9943-aa08-4559-8255-bc0b433db8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db10dc830>]}
[0m16:28:27.614548 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[31mERROR[0m in 2.76s]
[0m16:28:27.618942 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:28:27.628150 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:28:27.633323 [info ] [Thread-1 (]: 2 of 2 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m16:28:27.644955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m16:28:27.647164 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:28:27.690991 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m16:28:27.698903 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 16:28:27.648742 => 16:28:27.694794
[0m16:28:27.708970 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:28:27.744398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:28.281374 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m16:28:28.283836 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m16:28:29.102330 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:db9a9a5a-5195-4434-b8b5-3329c11b13b2&page=queryresults
[0m16:28:31.494139 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 16:28:27.711902 => 16:28:31.492664
[0m16:28:31.513041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c7d9943-aa08-4559-8255-bc0b433db8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db0f620c0>]}
[0m16:28:31.517599 [info ] [Thread-1 (]: 2 of 2 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.87s]
[0m16:28:31.524831 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:28:31.549972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:31.552564 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m16:28:31.557907 [info ] [MainThread]: 
[0m16:28:31.560718 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 9.04 seconds (9.04s).
[0m16:28:31.574026 [debug] [MainThread]: Command end result
[0m16:28:31.712013 [info ] [MainThread]: 
[0m16:28:31.720668 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:28:31.728337 [info ] [MainThread]: 
[0m16:28:31.735493 [error] [MainThread]:   Database Error in model total_number_of_pickups_in_may_by_base_name (models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql)
  SELECT list expression references base.base_name which is neither grouped nor aggregated at [15:8]
  compiled Code at target/run/uber_transformations/models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m16:28:31.743718 [info ] [MainThread]: 
[0m16:28:31.747257 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:28:31.755742 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.747055, "process_user_time": 12.413341, "process_kernel_time": 0.868905, "process_mem_max_rss": "130416", "process_out_blocks": "2768", "command_success": false, "process_in_blocks": "0"}
[0m16:28:31.765216 [debug] [MainThread]: Command `dbt run` failed at 16:28:31.764038 after 12.76 seconds
[0m16:28:31.770002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db3137740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db0f38e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db0e4fe90>]}
[0m16:28:31.773732 [debug] [MainThread]: Flushing usage events
[0m16:29:37.180035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca85a4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca76f9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca7898bc0>]}


============================== 16:29:37.185420 | cd4b2081-8ec9-46c0-9662-bcfa495af6c5 ==============================
[0m16:29:37.185420 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:29:37.187009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:29:38.220268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd4b2081-8ec9-46c0-9662-bcfa495af6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca5a1fb30>]}
[0m16:29:38.425360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd4b2081-8ec9-46c0-9662-bcfa495af6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca580cbf0>]}
[0m16:29:38.427025 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m16:29:38.446864 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:29:38.538315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:29:38.539911 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m16:29:38.956798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd4b2081-8ec9-46c0-9662-bcfa495af6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca57720f0>]}
[0m16:29:38.978916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd4b2081-8ec9-46c0-9662-bcfa495af6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca56c6b40>]}
[0m16:29:38.980886 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m16:29:38.983017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd4b2081-8ec9-46c0-9662-bcfa495af6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca54878c0>]}
[0m16:29:38.987793 [info ] [MainThread]: 
[0m16:29:38.991235 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:29:38.995671 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m16:29:38.997769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:39.540219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m16:29:39.541419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:40.032603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd4b2081-8ec9-46c0-9662-bcfa495af6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca5484560>]}
[0m16:29:40.034454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:29:40.035532 [info ] [MainThread]: 
[0m16:29:40.041015 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:29:40.043185 [info ] [Thread-1 (]: 1 of 2 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m16:29:40.045389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m16:29:40.046738 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:29:40.070048 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m16:29:40.080606 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 16:29:40.047524 => 16:29:40.077359
[0m16:29:40.084552 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:29:40.245055 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m16:29:40.246460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:40.249428 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
GROUP BY base.base_name
HAVING EXTRACT(MONTH FROM raw.pickup_date) = 5
ORDER BY COUNT(*) DESC
    );
  
[0m16:29:41.372790 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:9ce24f0d-1ebb-44eb-9602-df8cc8b2ebd8&page=queryresults
[0m16:29:41.510940 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('HAVING clause expression references raw.pickup_date which is neither grouped nor aggregated at [20:27]; reason: invalidQuery, location: query, message: HAVING clause expression references raw.pickup_date which is neither grouped nor aggregated at [20:27]')
[0m16:29:42.282280 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ff94bbef-b9a1-45dc-8a56-19a38dc9da99&page=queryresults
[0m16:29:42.430039 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ff94bbef-b9a1-45dc-8a56-19a38dc9da99&page=queryresults
[0m16:29:42.431979 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 16:29:40.086630 => 16:29:42.431332
[0m16:29:42.445224 [debug] [Thread-1 (]: Database Error in model total_number_of_pickups_in_may_by_base_name (models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql)
  HAVING clause expression references raw.pickup_date which is neither grouped nor aggregated at [20:27]
  compiled Code at target/run/uber_transformations/models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m16:29:42.447892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4b2081-8ec9-46c0-9662-bcfa495af6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca5485fd0>]}
[0m16:29:42.449646 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[31mERROR[0m in 2.40s]
[0m16:29:42.451573 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:29:42.452881 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:29:42.454638 [info ] [Thread-1 (]: 2 of 2 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m16:29:42.459644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m16:29:42.462920 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:29:42.482201 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m16:29:42.492213 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 16:29:42.464822 => 16:29:42.485972
[0m16:29:42.494833 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:29:42.518583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:43.020703 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m16:29:43.042372 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m16:29:43.277043 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:98826203-d5d8-4b3a-88a0-3d5b4105829a&page=queryresults
[0m16:29:45.202233 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 16:29:42.496606 => 16:29:45.201457
[0m16:29:45.204120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4b2081-8ec9-46c0-9662-bcfa495af6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca4c14710>]}
[0m16:29:45.205531 [info ] [Thread-1 (]: 2 of 2 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.75s]
[0m16:29:45.207100 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:29:45.211602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:45.214421 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m16:29:45.216222 [info ] [MainThread]: 
[0m16:29:45.218081 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.23 seconds (6.23s).
[0m16:29:45.221502 [debug] [MainThread]: Command end result
[0m16:29:45.272596 [info ] [MainThread]: 
[0m16:29:45.286040 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:29:45.288345 [info ] [MainThread]: 
[0m16:29:45.290527 [error] [MainThread]:   Database Error in model total_number_of_pickups_in_may_by_base_name (models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql)
  HAVING clause expression references raw.pickup_date which is neither grouped nor aggregated at [20:27]
  compiled Code at target/run/uber_transformations/models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m16:29:45.293614 [info ] [MainThread]: 
[0m16:29:45.295931 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:29:45.301138 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.2098875, "process_user_time": 6.499508, "process_kernel_time": 0.338419, "process_mem_max_rss": "131968", "process_in_blocks": "40", "process_out_blocks": "2760", "command_success": false}
[0m16:29:45.306647 [debug] [MainThread]: Command `dbt run` failed at 16:29:45.303348 after 8.21 seconds
[0m16:29:45.312101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca74e1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca5772c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca7bf9250>]}
[0m16:29:45.315279 [debug] [MainThread]: Flushing usage events
[0m16:30:33.562468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f875794aea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8757de38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8757b83110>]}


============================== 16:30:33.567646 | c3b5cc37-f80a-45dd-ba0d-7083857baa6e ==============================
[0m16:30:33.567646 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:30:33.569086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:30:35.293906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3b5cc37-f80a-45dd-ba0d-7083857baa6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8755b47ec0>]}
[0m16:30:35.495038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3b5cc37-f80a-45dd-ba0d-7083857baa6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8755c067b0>]}
[0m16:30:35.497635 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m16:30:35.519852 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:30:35.652336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:30:35.653537 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m16:30:36.028279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3b5cc37-f80a-45dd-ba0d-7083857baa6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87558fa720>]}
[0m16:30:36.042426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3b5cc37-f80a-45dd-ba0d-7083857baa6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8755a875f0>]}
[0m16:30:36.043548 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m16:30:36.044739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3b5cc37-f80a-45dd-ba0d-7083857baa6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87558521b0>]}
[0m16:30:36.047722 [info ] [MainThread]: 
[0m16:30:36.049722 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:30:36.054301 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m16:30:36.056442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:36.768586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m16:30:36.769831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:37.227431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3b5cc37-f80a-45dd-ba0d-7083857baa6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8755852150>]}
[0m16:30:37.231036 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:30:37.232745 [info ] [MainThread]: 
[0m16:30:37.239732 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:30:37.242221 [info ] [Thread-1 (]: 1 of 2 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m16:30:37.245637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m16:30:37.247800 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:30:37.284673 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m16:30:37.305051 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 16:30:37.249110 => 16:30:37.299958
[0m16:30:37.309200 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:30:37.466471 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m16:30:37.468925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:37.474574 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
GROUP BY base.base_name
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
ORDER BY COUNT(*) DESC
    );
  
[0m16:30:37.931503 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ab1cf773-2dea-4cb9-87ec-3ee2f64aa95d&page=queryresults
[0m16:30:37.933525 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WHERE at [20:1]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword WHERE at [20:1]')
[0m16:30:38.440211 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:61146147-e3a9-47dd-a77b-7f96e65eddf0&page=queryresults
[0m16:30:38.442729 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:61146147-e3a9-47dd-a77b-7f96e65eddf0&page=queryresults
[0m16:30:38.445472 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 16:30:37.311559 => 16:30:38.444427
[0m16:30:38.553206 [debug] [Thread-1 (]: Database Error in model total_number_of_pickups_in_may_by_base_name (models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql)
  Syntax error: Expected ")" but got keyword WHERE at [20:1]
  compiled Code at target/run/uber_transformations/models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m16:30:38.554428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b5cc37-f80a-45dd-ba0d-7083857baa6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8755962060>]}
[0m16:30:38.555815 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[31mERROR[0m in 1.31s]
[0m16:30:38.557593 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:30:38.559352 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:30:38.561641 [info ] [Thread-1 (]: 2 of 2 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m16:30:38.565583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m16:30:38.568527 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:30:38.587367 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m16:30:38.596675 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 16:30:38.570470 => 16:30:38.594123
[0m16:30:38.599301 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:30:38.612447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:39.086047 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m16:30:39.087849 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m16:30:39.836343 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:54c87901-4a52-43f7-8036-439a8dd7bb0f&page=queryresults
[0m16:30:41.727839 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 16:30:38.603114 => 16:30:41.727254
[0m16:30:41.730477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b5cc37-f80a-45dd-ba0d-7083857baa6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87558e6cf0>]}
[0m16:30:41.731944 [info ] [Thread-1 (]: 2 of 2 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.17s]
[0m16:30:41.733820 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:30:41.737324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:41.738407 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m16:30:41.740271 [info ] [MainThread]: 
[0m16:30:41.742231 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.69 seconds (5.69s).
[0m16:30:41.745810 [debug] [MainThread]: Command end result
[0m16:30:41.792534 [info ] [MainThread]: 
[0m16:30:41.796578 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:30:41.811054 [info ] [MainThread]: 
[0m16:30:41.816664 [error] [MainThread]:   Database Error in model total_number_of_pickups_in_may_by_base_name (models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql)
  Syntax error: Expected ")" but got keyword WHERE at [20:1]
  compiled Code at target/run/uber_transformations/models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m16:30:41.820724 [info ] [MainThread]: 
[0m16:30:41.823520 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:30:41.829373 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.371433, "process_user_time": 6.606895, "process_kernel_time": 0.455463, "process_mem_max_rss": "131800", "process_in_blocks": "36360", "process_out_blocks": "2760", "command_success": false}
[0m16:30:41.839624 [debug] [MainThread]: Command `dbt run` failed at 16:30:41.836222 after 8.38 seconds
[0m16:30:41.843286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8757948650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87560710a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8757e833e0>]}
[0m16:30:41.851502 [debug] [MainThread]: Flushing usage events
[0m16:31:23.415567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe95254b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe952549160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe95254ae70>]}


============================== 16:31:23.435746 | eb3a1c27-4fab-4492-b1c1-1bf1ec5da529 ==============================
[0m16:31:23.435746 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:31:23.437181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:25.125063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb3a1c27-4fab-4492-b1c1-1bf1ec5da529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe950d61a00>]}
[0m16:31:25.337831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb3a1c27-4fab-4492-b1c1-1bf1ec5da529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9512801a0>]}
[0m16:31:25.339610 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m16:31:25.423576 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:31:25.575603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:31:25.578360 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m16:31:26.208465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb3a1c27-4fab-4492-b1c1-1bf1ec5da529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9505eb200>]}
[0m16:31:26.223495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb3a1c27-4fab-4492-b1c1-1bf1ec5da529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe95068f200>]}
[0m16:31:26.224884 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m16:31:26.226079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb3a1c27-4fab-4492-b1c1-1bf1ec5da529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe95044a0f0>]}
[0m16:31:26.229551 [info ] [MainThread]: 
[0m16:31:26.231982 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:31:26.234960 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m16:31:26.236461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:27.104215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m16:31:27.113927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:27.676642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb3a1c27-4fab-4492-b1c1-1bf1ec5da529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe950776360>]}
[0m16:31:27.680062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:31:27.681659 [info ] [MainThread]: 
[0m16:31:27.730645 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:31:27.736340 [info ] [Thread-1 (]: 1 of 2 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m16:31:27.740999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m16:31:27.747333 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:31:27.790321 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m16:31:27.819671 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 16:31:27.756382 => 16:31:27.818402
[0m16:31:27.821128 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:31:27.924037 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m16:31:27.928459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:27.931590 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m16:31:28.636325 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0ba00ffb-ebe6-49da-be33-02794031467a&page=queryresults
[0m16:31:30.310666 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 16:31:27.821881 => 16:31:30.310129
[0m16:31:30.312799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb3a1c27-4fab-4492-b1c1-1bf1ec5da529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe95055f260>]}
[0m16:31:30.314272 [info ] [Thread-1 (]: 1 of 2 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (9.0 rows, 216.5 MiB processed)[0m in 2.57s]
[0m16:31:30.315919 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m16:31:30.317113 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:31:30.318572 [info ] [Thread-1 (]: 2 of 2 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m16:31:30.321083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m16:31:30.322708 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:31:30.327790 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m16:31:30.330036 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 16:31:30.323506 => 16:31:30.329144
[0m16:31:30.331436 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:31:30.340414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:30.835221 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m16:31:30.837262 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m16:31:31.057090 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f200bdaf-b4fa-45d9-96ea-bcb2e7ee5a27&page=queryresults
[0m16:31:32.929048 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 16:31:30.333281 => 16:31:32.928524
[0m16:31:32.931123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb3a1c27-4fab-4492-b1c1-1bf1ec5da529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe95055ef60>]}
[0m16:31:32.932552 [info ] [Thread-1 (]: 2 of 2 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.61s]
[0m16:31:32.934270 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m16:31:32.937864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:32.938881 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m16:31:32.940668 [info ] [MainThread]: 
[0m16:31:32.942254 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.71 seconds (6.71s).
[0m16:31:32.945168 [debug] [MainThread]: Command end result
[0m16:31:33.023768 [info ] [MainThread]: 
[0m16:31:33.027999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:33.043252 [info ] [MainThread]: 
[0m16:31:33.052236 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:31:33.088406 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.807269, "process_user_time": 6.877535, "process_kernel_time": 0.377112, "process_mem_max_rss": "129672", "process_in_blocks": "24168", "process_out_blocks": "2752"}
[0m16:31:33.108144 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:33.106557 after 9.83 seconds
[0m16:31:33.113745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe952377c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe94db2dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9506def30>]}
[0m16:31:33.117287 [debug] [MainThread]: Flushing usage events
[0m17:02:54.096870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fee148170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fee381820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fee7d5580>]}


============================== 17:02:54.130852 | 739558c4-4e35-4e7f-a1eb-0bf74f2d8451 ==============================
[0m17:02:54.130852 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:02:54.132416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:02:56.410595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '739558c4-4e35-4e7f-a1eb-0bf74f2d8451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fec482240>]}
[0m17:02:56.582452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '739558c4-4e35-4e7f-a1eb-0bf74f2d8451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fec3dd370>]}
[0m17:02:56.616240 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:02:56.668763 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:02:56.836867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:02:56.838025 [debug] [MainThread]: Partial parsing: added file: uber_transformations://models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql
[0m17:02:57.197061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '739558c4-4e35-4e7f-a1eb-0bf74f2d8451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fec102bd0>]}
[0m17:02:57.223300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '739558c4-4e35-4e7f-a1eb-0bf74f2d8451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fec283920>]}
[0m17:02:57.224378 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:02:57.225582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '739558c4-4e35-4e7f-a1eb-0bf74f2d8451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fecc7f7d0>]}
[0m17:02:57.228514 [info ] [MainThread]: 
[0m17:02:57.231355 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:02:57.234100 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:02:57.235251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:57.771234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:02:57.772327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:58.228174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '739558c4-4e35-4e7f-a1eb-0bf74f2d8451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fec687650>]}
[0m17:02:58.230261 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:02:58.231523 [info ] [MainThread]: 
[0m17:02:58.258762 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:02:58.267311 [info ] [Thread-1 (]: 1 of 3 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:02:58.280816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:02:58.288561 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:02:58.320235 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:02:58.326588 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:02:58.292005 => 17:02:58.322356
[0m17:02:58.335869 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:02:58.490030 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:02:58.492377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:58.497744 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:02:59.010381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:782a2432-4fd5-4c50-8f8e-b7fc43219f13&page=queryresults
[0m17:02:59.012000 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "base" at [16:8]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "base" at [16:8]')
[0m17:02:59.988112 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:53ffd396-849d-4e1f-be62-9e90fb50bcbd&page=queryresults
[0m17:02:59.989449 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:53ffd396-849d-4e1f-be62-9e90fb50bcbd&page=queryresults
[0m17:02:59.991201 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:02:58.338233 => 17:02:59.990574
[0m17:03:00.135487 [debug] [Thread-1 (]: Database Error in model top_3_base_names_based_on_total_number_of_pick_ups (models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql)
  Syntax error: Expected ")" but got identifier "base" at [16:8]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql
[0m17:03:00.136624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '739558c4-4e35-4e7f-a1eb-0bf74f2d8451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fec15f9b0>]}
[0m17:03:00.138004 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[31mERROR[0m in 1.87s]
[0m17:03:00.139660 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:03:00.140800 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:03:00.142252 [info ] [Thread-1 (]: 2 of 3 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:03:00.144022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:03:00.145711 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:03:00.154551 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:03:00.156654 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:03:00.146890 => 17:03:00.155753
[0m17:03:00.157846 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:03:00.166308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:00.638114 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:03:00.639889 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:03:00.944796 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1285b075-6601-49e7-b190-1253e98b7154&page=queryresults
[0m17:03:02.849666 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:03:00.158510 => 17:03:02.849139
[0m17:03:02.851530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '739558c4-4e35-4e7f-a1eb-0bf74f2d8451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fec15d790>]}
[0m17:03:02.852900 [info ] [Thread-1 (]: 2 of 3 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (9.0 rows, 216.5 MiB processed)[0m in 2.71s]
[0m17:03:02.854556 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:03:02.855915 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:03:02.857262 [info ] [Thread-1 (]: 3 of 3 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:03:02.859032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:03:02.860649 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:03:02.865082 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:03:02.867235 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:03:02.861587 => 17:03:02.866322
[0m17:03:02.868603 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:03:02.874008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:03.320929 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:03:03.322939 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:03:03.777083 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c1b15f76-d7cf-431f-817c-e8c54c653198&page=queryresults
[0m17:03:05.685285 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:03:02.869413 => 17:03:05.684033
[0m17:03:05.689456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '739558c4-4e35-4e7f-a1eb-0bf74f2d8451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe99f4ec0>]}
[0m17:03:05.692419 [info ] [Thread-1 (]: 3 of 3 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.83s]
[0m17:03:05.696160 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:03:05.702922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:05.703943 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:03:05.704975 [info ] [MainThread]: 
[0m17:03:05.706159 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 8.47 seconds (8.47s).
[0m17:03:05.708782 [debug] [MainThread]: Command end result
[0m17:03:05.729152 [info ] [MainThread]: 
[0m17:03:05.730830 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:03:05.732319 [info ] [MainThread]: 
[0m17:03:05.733707 [error] [MainThread]:   Database Error in model top_3_base_names_based_on_total_number_of_pick_ups (models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql)
  Syntax error: Expected ")" but got identifier "base" at [16:8]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql
[0m17:03:05.735378 [info ] [MainThread]: 
[0m17:03:05.737259 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:03:05.740466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.719037, "process_user_time": 6.123463, "process_kernel_time": 0.303802, "process_mem_max_rss": "132924", "process_in_blocks": "30568", "process_out_blocks": "2808", "command_success": false}
[0m17:03:05.747580 [debug] [MainThread]: Command `dbt run` failed at 17:03:05.745607 after 11.73 seconds
[0m17:03:05.754213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2feec0adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fec0ebfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fec12ea50>]}
[0m17:03:05.758303 [debug] [MainThread]: Flushing usage events
[0m17:06:23.297710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9395ea0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939615c3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9395ec2f30>]}


============================== 17:06:23.302910 | 285312d2-a628-4e19-9aae-91137cf448b8 ==============================
[0m17:06:23.302910 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:06:23.304284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:24.172891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '285312d2-a628-4e19-9aae-91137cf448b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93941b9be0>]}
[0m17:06:24.352993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '285312d2-a628-4e19-9aae-91137cf448b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9395a4fe90>]}
[0m17:06:24.354455 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:06:24.370108 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:06:24.460623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:06:24.461934 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql
[0m17:06:24.462999 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m17:06:24.815327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '285312d2-a628-4e19-9aae-91137cf448b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9393c5a750>]}
[0m17:06:24.829354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '285312d2-a628-4e19-9aae-91137cf448b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9393e777a0>]}
[0m17:06:24.830463 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:06:24.831621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '285312d2-a628-4e19-9aae-91137cf448b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9393c1fef0>]}
[0m17:06:24.834633 [info ] [MainThread]: 
[0m17:06:24.836462 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:06:24.840766 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:06:24.842096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:25.400303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:06:25.401417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:25.858617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '285312d2-a628-4e19-9aae-91137cf448b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9393c06870>]}
[0m17:06:25.860713 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:06:25.861862 [info ] [MainThread]: 
[0m17:06:25.865919 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:06:25.868268 [info ] [Thread-1 (]: 1 of 3 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:06:25.870981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:06:25.872197 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:06:25.905239 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:06:25.916901 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:06:25.873000 => 17:06:25.912507
[0m17:06:25.922613 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:06:26.065195 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:06:26.066720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:26.070165 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispathcing_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3;
    );
  
[0m17:06:26.535221 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:13552aff-db30-4c8a-829f-aea42bc53a7a&page=queryresults
[0m17:06:26.536732 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [22:8]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [22:8]')
[0m17:06:27.534757 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:060e6d5e-c8f1-4836-9291-7320cdd572d9&page=queryresults
[0m17:06:27.537338 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:060e6d5e-c8f1-4836-9291-7320cdd572d9&page=queryresults
[0m17:06:27.540778 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:06:25.924584 => 17:06:27.539634
[0m17:06:27.564023 [debug] [Thread-1 (]: Database Error in model top_3_base_names_based_on_total_number_of_pick_ups (models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql)
  Syntax error: Expected ")" but got ";" at [22:8]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql
[0m17:06:27.566234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '285312d2-a628-4e19-9aae-91137cf448b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9393fa6b10>]}
[0m17:06:27.568398 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[31mERROR[0m in 1.70s]
[0m17:06:27.570272 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:06:27.572553 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:06:27.575967 [info ] [Thread-1 (]: 2 of 3 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:06:27.579923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:06:27.582029 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:06:27.611611 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:06:27.618024 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:06:27.582977 => 17:06:27.615928
[0m17:06:27.620491 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:06:27.635479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:28.107220 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:06:28.109037 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.disptaching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:06:28.331815 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:867f8bf0-9c82-434e-962a-948efea6e440&page=queryresults
[0m17:06:28.493960 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name disptaching_base_num not found inside raw at [18:73]; reason: invalidQuery, location: query, message: Name disptaching_base_num not found inside raw at [18:73]')
[0m17:06:29.686563 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a94bce92-b1a2-4fdc-8eb6-83bc5efd678c&page=queryresults
[0m17:06:29.829606 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a94bce92-b1a2-4fdc-8eb6-83bc5efd678c&page=queryresults
[0m17:06:29.831528 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:06:27.621905 => 17:06:29.830682
[0m17:06:29.839833 [debug] [Thread-1 (]: Database Error in model total_number_of_pickups_in_may_by_base_name (models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql)
  Name disptaching_base_num not found inside raw at [18:73]
  compiled Code at target/run/uber_transformations/models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m17:06:29.840992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '285312d2-a628-4e19-9aae-91137cf448b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93935e3f20>]}
[0m17:06:29.842383 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[31mERROR[0m in 2.26s]
[0m17:06:29.844243 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:06:29.846046 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:06:29.847822 [info ] [Thread-1 (]: 3 of 3 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:06:29.850107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:06:29.851255 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:06:29.856483 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:06:29.858085 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:06:29.852397 => 17:06:29.857439
[0m17:06:29.860167 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:06:29.869037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:30.434493 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:06:30.436078 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:06:30.694476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:cb5c070c-5816-421f-b1ea-a1c2b02b9cc6&page=queryresults
[0m17:06:32.631576 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:06:29.861456 => 17:06:32.631007
[0m17:06:32.633419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '285312d2-a628-4e19-9aae-91137cf448b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9393cf8f20>]}
[0m17:06:32.634776 [info ] [Thread-1 (]: 3 of 3 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.78s]
[0m17:06:32.636365 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:06:32.639631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:32.640981 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:06:32.642502 [info ] [MainThread]: 
[0m17:06:32.644007 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.81 seconds (7.81s).
[0m17:06:32.646730 [debug] [MainThread]: Command end result
[0m17:06:32.664990 [info ] [MainThread]: 
[0m17:06:32.670063 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:06:32.677934 [info ] [MainThread]: 
[0m17:06:32.681285 [error] [MainThread]:   Database Error in model top_3_base_names_based_on_total_number_of_pick_ups (models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql)
  Syntax error: Expected ")" but got ";" at [22:8]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql
[0m17:06:32.692182 [info ] [MainThread]: 
[0m17:06:32.697842 [error] [MainThread]:   Database Error in model total_number_of_pickups_in_may_by_base_name (models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql)
  Name disptaching_base_num not found inside raw at [18:73]
  compiled Code at target/run/uber_transformations/models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m17:06:32.704268 [info ] [MainThread]: 
[0m17:06:32.707691 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m17:06:32.719759 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.503963, "process_user_time": 6.369667, "process_kernel_time": 0.260006, "process_mem_max_rss": "133160", "process_in_blocks": "56", "process_out_blocks": "2808", "command_success": false}
[0m17:06:32.722589 [debug] [MainThread]: Command `dbt run` failed at 17:06:32.722194 after 9.51 seconds
[0m17:06:32.723725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9395b39b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9393fce330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9393c1fef0>]}
[0m17:06:32.724788 [debug] [MainThread]: Flushing usage events
[0m17:07:31.114476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1687ccfa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1687f85880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1687fc67e0>]}


============================== 17:07:31.119526 | b316d5fc-22c6-4688-a7db-203149524459 ==============================
[0m17:07:31.119526 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:07:31.121034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:07:31.995109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b316d5fc-22c6-4688-a7db-203149524459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1687ccf0b0>]}
[0m17:07:32.177494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b316d5fc-22c6-4688-a7db-203149524459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1686257920>]}
[0m17:07:32.178942 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:07:32.197712 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:07:32.297479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:07:32.298770 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql
[0m17:07:32.299861 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/total_number_of_pickups_in_may_by_base_name.sql
[0m17:07:32.686314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b316d5fc-22c6-4688-a7db-203149524459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1686045700>]}
[0m17:07:32.699807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b316d5fc-22c6-4688-a7db-203149524459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1685fd36e0>]}
[0m17:07:32.700881 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:07:32.702047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b316d5fc-22c6-4688-a7db-203149524459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1685d6f8c0>]}
[0m17:07:32.704963 [info ] [MainThread]: 
[0m17:07:32.707071 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:07:32.710956 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:07:32.712245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:33.268802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:07:33.269932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:33.725119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b316d5fc-22c6-4688-a7db-203149524459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1686256d20>]}
[0m17:07:33.728370 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:33.730249 [info ] [MainThread]: 
[0m17:07:33.735872 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:07:33.737653 [info ] [Thread-1 (]: 1 of 3 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:07:33.739918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:07:33.741059 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:07:33.770938 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:07:33.783039 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:07:33.741989 => 17:07:33.780211
[0m17:07:33.789106 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:07:33.945139 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:07:33.947247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:33.950310 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3;
    );
  
[0m17:07:34.372586 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:fef4e06d-6693-4aef-8c42-445173f601dd&page=queryresults
[0m17:07:34.375518 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [22:8]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [22:8]')
[0m17:07:35.334875 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8020f93b-87d8-40ef-b17e-4a16206eb071&page=queryresults
[0m17:07:35.337049 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8020f93b-87d8-40ef-b17e-4a16206eb071&page=queryresults
[0m17:07:35.340133 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:07:33.790532 => 17:07:35.339036
[0m17:07:35.357556 [debug] [Thread-1 (]: Database Error in model top_3_base_names_based_on_total_number_of_pick_ups (models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql)
  Syntax error: Expected ")" but got ";" at [22:8]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql
[0m17:07:35.359856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b316d5fc-22c6-4688-a7db-203149524459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1685f47980>]}
[0m17:07:35.362822 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[31mERROR[0m in 1.62s]
[0m17:07:35.365835 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:07:35.368756 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:07:35.371549 [info ] [Thread-1 (]: 2 of 3 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:07:35.376819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:07:35.379312 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:07:35.404594 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:07:35.416524 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:07:35.380719 => 17:07:35.409098
[0m17:07:35.423774 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:07:35.443276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:35.920288 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:07:35.921757 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:07:36.135510 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c05a4654-a32a-458e-a542-cc681761d8bb&page=queryresults
[0m17:07:38.055237 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:07:35.427168 => 17:07:38.054651
[0m17:07:38.057400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b316d5fc-22c6-4688-a7db-203149524459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16854377a0>]}
[0m17:07:38.059146 [info ] [Thread-1 (]: 2 of 3 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.68s]
[0m17:07:38.061009 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:07:38.062194 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:07:38.063444 [info ] [Thread-1 (]: 3 of 3 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:07:38.065302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:07:38.067223 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:07:38.072102 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:07:38.074338 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:07:38.068240 => 17:07:38.073325
[0m17:07:38.076055 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:07:38.082279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:38.570524 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:07:38.573986 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:07:38.796792 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:cddcf569-914e-4347-9939-a0264e098f2e&page=queryresults
[0m17:07:40.660326 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:07:38.076873 => 17:07:40.659381
[0m17:07:40.663347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b316d5fc-22c6-4688-a7db-203149524459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1686198fe0>]}
[0m17:07:40.665703 [info ] [Thread-1 (]: 3 of 3 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.60s]
[0m17:07:40.667974 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:07:40.671655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:40.672721 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:07:40.674540 [info ] [MainThread]: 
[0m17:07:40.676528 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.97 seconds (7.97s).
[0m17:07:40.680490 [debug] [MainThread]: Command end result
[0m17:07:40.707019 [info ] [MainThread]: 
[0m17:07:40.709343 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:07:40.711848 [info ] [MainThread]: 
[0m17:07:40.716691 [error] [MainThread]:   Database Error in model top_3_base_names_based_on_total_number_of_pick_ups (models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql)
  Syntax error: Expected ")" but got ";" at [22:8]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql
[0m17:07:40.723094 [info ] [MainThread]: 
[0m17:07:40.727136 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:07:40.742650 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.705357, "process_user_time": 6.412391, "process_kernel_time": 0.296093, "process_mem_max_rss": "132504", "process_in_blocks": "8", "process_out_blocks": "2816", "command_success": false}
[0m17:07:40.751420 [debug] [MainThread]: Command `dbt run` failed at 17:07:40.749421 after 9.71 seconds
[0m17:07:40.756196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1687cce2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1684333ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16860ad700>]}
[0m17:07:40.759096 [debug] [MainThread]: Flushing usage events
[0m17:08:02.721047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9543477d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff954345e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff954346cf0>]}


============================== 17:08:02.733203 | e7a6a129-ed36-467d-8d65-339310bafd60 ==============================
[0m17:08:02.733203 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:08:02.737975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:08:05.149331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7a6a129-ed36-467d-8d65-339310bafd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95265b3e0>]}
[0m17:08:05.488732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7a6a129-ed36-467d-8d65-339310bafd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9525fea20>]}
[0m17:08:05.490330 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:08:05.538371 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:08:05.715440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:08:05.716759 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_base_names_based_on_total_number_of_pick_ups.sql
[0m17:08:06.634831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7a6a129-ed36-467d-8d65-339310bafd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9522feea0>]}
[0m17:08:06.664071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7a6a129-ed36-467d-8d65-339310bafd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95248f0b0>]}
[0m17:08:06.666140 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:08:06.668104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7a6a129-ed36-467d-8d65-339310bafd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff952ca09b0>]}
[0m17:08:06.673864 [info ] [MainThread]: 
[0m17:08:06.677495 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:08:06.682954 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:08:06.685423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:07.586703 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021_airbyte_uber_data'
[0m17:08:07.588749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:08.394923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7a6a129-ed36-467d-8d65-339310bafd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9524da150>]}
[0m17:08:08.405433 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:08:08.409014 [info ] [MainThread]: 
[0m17:08:08.425340 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:08:08.433077 [info ] [Thread-1 (]: 1 of 3 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:08:08.439267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:08:08.442345 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:08:08.483034 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:08:08.487013 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:08:08.443800 => 17:08:08.485768
[0m17:08:08.503120 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:08:08.801847 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:08:08.804508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:08.815428 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:08:09.933973 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1fc89eba-1118-4413-8ac1-a323e40964b2&page=queryresults
[0m17:08:11.917448 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:08:08.505021 => 17:08:11.915225
[0m17:08:11.921629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7a6a129-ed36-467d-8d65-339310bafd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95248e330>]}
[0m17:08:11.927562 [info ] [Thread-1 (]: 1 of 3 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 3.49s]
[0m17:08:11.939157 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:08:11.943963 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:08:11.948788 [info ] [Thread-1 (]: 2 of 3 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:08:11.954571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:08:11.956755 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:08:11.973067 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:08:11.979880 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:08:11.958107 => 17:08:11.975262
[0m17:08:11.987812 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:08:12.013498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:13.003094 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:08:13.014324 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:08:13.248936 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:2c62ad9b-036c-4980-b762-09c1c9c3e0f6&page=queryresults
[0m17:08:15.211733 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:08:12.001699 => 17:08:15.210384
[0m17:08:15.227910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7a6a129-ed36-467d-8d65-339310bafd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9522eac00>]}
[0m17:08:15.235313 [info ] [Thread-1 (]: 2 of 3 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 3.27s]
[0m17:08:15.260307 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:08:15.263652 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:08:15.266619 [info ] [Thread-1 (]: 3 of 3 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:08:15.270784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:08:15.275370 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:08:15.295514 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:08:15.300233 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:08:15.278469 => 17:08:15.298924
[0m17:08:15.303925 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:08:15.319210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:16.381296 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:08:16.397405 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:08:16.604855 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:311abffc-6d10-446d-b5f9-7fb1dd7ffcec&page=queryresults
[0m17:08:18.201139 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:08:15.305571 => 17:08:18.199830
[0m17:08:18.204929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7a6a129-ed36-467d-8d65-339310bafd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95235df40>]}
[0m17:08:18.208837 [info ] [Thread-1 (]: 3 of 3 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.94s]
[0m17:08:18.212806 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:08:18.219767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:18.222533 [debug] [MainThread]: Connection 'list_uber-data-pipeline-417021' was properly closed.
[0m17:08:18.225982 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:08:18.227843 [info ] [MainThread]: 
[0m17:08:18.229545 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.55 seconds (11.55s).
[0m17:08:18.246709 [debug] [MainThread]: Command end result
[0m17:08:18.295315 [info ] [MainThread]: 
[0m17:08:18.297578 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:08:18.304490 [info ] [MainThread]: 
[0m17:08:18.308762 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:08:18.320340 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.854021, "process_user_time": 10.848831, "process_kernel_time": 0.625957, "process_mem_max_rss": "133116", "process_out_blocks": "2800", "process_in_blocks": "0"}
[0m17:08:18.327603 [debug] [MainThread]: Command `dbt run` succeeded at 17:08:18.326911 after 15.86 seconds
[0m17:08:18.329831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9547afb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff952ec58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9524d8d70>]}
[0m17:08:18.332072 [debug] [MainThread]: Flushing usage events
[0m17:34:23.795580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9faa9415b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9faaac21b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9faa73d910>]}


============================== 17:34:23.838889 | 55bf3505-6915-4201-8804-c6d3ecd090dc ==============================
[0m17:34:23.838889 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:34:23.840258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:34:26.206730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55bf3505-6915-4201-8804-c6d3ecd090dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa8e372c0>]}
[0m17:34:26.397356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55bf3505-6915-4201-8804-c6d3ecd090dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa963a2a0>]}
[0m17:34:26.399668 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:34:26.416966 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:34:26.626915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:34:26.628046 [debug] [MainThread]: Partial parsing: added file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:34:26.985493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55bf3505-6915-4201-8804-c6d3ecd090dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa8e00140>]}
[0m17:34:26.999525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55bf3505-6915-4201-8804-c6d3ecd090dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa8a88530>]}
[0m17:34:27.000575 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:34:27.001649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55bf3505-6915-4201-8804-c6d3ecd090dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa8ef4200>]}
[0m17:34:27.004706 [info ] [MainThread]: 
[0m17:34:27.006495 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:34:27.010012 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:34:27.011418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:27.615646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:34:27.616752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:28.060238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55bf3505-6915-4201-8804-c6d3ecd090dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa8b72240>]}
[0m17:34:28.061974 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:34:28.063050 [info ] [MainThread]: 
[0m17:34:28.094446 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:34:28.099732 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:34:28.105212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:34:28.112938 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:34:28.145649 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:34:28.150170 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:34:28.116213 => 17:34:28.148728
[0m17:34:28.157989 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:34:28.238935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:28.734151 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:34:28.736029 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:34:29.018228 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e330757d-863a-416a-8be7-fce4632eb566&page=queryresults
[0m17:34:31.029390 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:34:28.160743 => 17:34:31.028684
[0m17:34:31.034037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55bf3505-6915-4201-8804-c6d3ecd090dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9faa73c920>]}
[0m17:34:31.037189 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.93s]
[0m17:34:31.039578 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:34:31.041139 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:34:31.042532 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:34:31.045440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:34:31.049195 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:34:31.058891 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:34:31.061576 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:34:31.051284 => 17:34:31.060519
[0m17:34:31.064799 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:34:31.084089 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:34:31.110269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:31.131648 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

SELECT base.base_name AS `Base Name`,
       raw.dispatching_base_num AS `Dispatching Base Number`,
       RANK() OVER(PARTITION BY raw.pickup_date ORDER BY COUNT(raw.pickup_date) DESC) AS `Rank`
       COUNT(raw.pickup_date)
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE Rank IN (1,2,3)
    );
  
[0m17:34:31.772909 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a473709b-f70d-4ba7-b9ec-2c2a538839a4&page=queryresults
[0m17:34:31.774550 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "COUNT" at [18:8]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "COUNT" at [18:8]')
[0m17:34:32.660246 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:5a91f2ac-a4e7-4208-a77e-72e123493acb&page=queryresults
[0m17:34:32.661700 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:5a91f2ac-a4e7-4208-a77e-72e123493acb&page=queryresults
[0m17:34:32.663370 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:34:31.067430 => 17:34:32.662799
[0m17:34:32.778689 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Syntax error: Expected ")" but got identifier "COUNT" at [18:8]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:34:32.779852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55bf3505-6915-4201-8804-c6d3ecd090dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa8925430>]}
[0m17:34:32.781201 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.74s]
[0m17:34:32.782844 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:34:32.784075 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:34:32.785635 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:34:32.787423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:34:32.789058 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:34:32.798234 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:34:32.799981 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:34:32.790047 => 17:34:32.799300
[0m17:34:32.801186 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:34:32.812649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:33.250797 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:34:33.252565 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:34:33.453026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:2558fc22-43e9-496a-b28e-b37516337665&page=queryresults
[0m17:34:35.615626 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:34:32.802190 => 17:34:35.615112
[0m17:34:35.617858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55bf3505-6915-4201-8804-c6d3ecd090dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa8136f90>]}
[0m17:34:35.619230 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.83s]
[0m17:34:35.620842 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:34:35.621952 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:34:35.623132 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:34:35.625004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:34:35.626628 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:34:35.631718 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:34:35.633696 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:34:35.627776 => 17:34:35.632946
[0m17:34:35.634987 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:34:35.640342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:36.110338 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:34:36.112037 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:34:36.325340 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b147da30-806a-4f57-9306-eb529ad81314&page=queryresults
[0m17:34:38.064005 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:34:35.635730 => 17:34:38.063497
[0m17:34:38.065796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55bf3505-6915-4201-8804-c6d3ecd090dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa8925430>]}
[0m17:34:38.067161 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.44s]
[0m17:34:38.069749 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:34:38.073378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:38.074222 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:34:38.075598 [info ] [MainThread]: 
[0m17:34:38.076806 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.07 seconds (11.07s).
[0m17:34:38.079312 [debug] [MainThread]: Command end result
[0m17:34:38.121083 [info ] [MainThread]: 
[0m17:34:38.126645 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:34:38.132782 [info ] [MainThread]: 
[0m17:34:38.135163 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Syntax error: Expected ")" but got identifier "COUNT" at [18:8]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:34:38.137240 [info ] [MainThread]: 
[0m17:34:38.140019 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:34:38.147985 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.502959, "process_user_time": 7.122886, "process_kernel_time": 0.518853, "process_mem_max_rss": "136596", "process_in_blocks": "66920", "process_out_blocks": "2856", "command_success": false}
[0m17:34:38.153160 [debug] [MainThread]: Command `dbt run` failed at 17:34:38.151061 after 14.51 seconds
[0m17:34:38.158523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fae4dbf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa8808500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa8130080>]}
[0m17:34:38.162517 [debug] [MainThread]: Flushing usage events
[0m17:36:16.272082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cb0963cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cb0961a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cb0960200>]}


============================== 17:36:16.277173 | f27d9308-e2ad-46ac-84df-1732df69c9c2 ==============================
[0m17:36:16.277173 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:36:16.278582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:36:17.167641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f27d9308-e2ad-46ac-84df-1732df69c9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cb0c1a9c0>]}
[0m17:36:17.341253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f27d9308-e2ad-46ac-84df-1732df69c9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cb0b4fce0>]}
[0m17:36:17.342766 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:36:17.359214 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:36:17.454324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:36:17.455582 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:36:17.803169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f27d9308-e2ad-46ac-84df-1732df69c9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7caed87740>]}
[0m17:36:17.817217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f27d9308-e2ad-46ac-84df-1732df69c9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7caecc36b0>]}
[0m17:36:17.818341 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:36:17.819362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f27d9308-e2ad-46ac-84df-1732df69c9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7caf27caa0>]}
[0m17:36:17.822357 [info ] [MainThread]: 
[0m17:36:17.824168 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:36:17.827966 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:36:17.829237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:18.336614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:36:18.337744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:18.761043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f27d9308-e2ad-46ac-84df-1732df69c9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7caecc1f70>]}
[0m17:36:18.762762 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:36:18.763910 [info ] [MainThread]: 
[0m17:36:18.768133 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:36:18.769671 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:36:18.772143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:36:18.773286 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:36:18.797342 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:36:18.800626 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:36:18.773959 => 17:36:18.799257
[0m17:36:18.802545 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:36:18.890690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:19.378784 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:36:19.380325 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:36:19.596227 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0b458209-7b64-4ffb-a803-070b967df059&page=queryresults
[0m17:36:21.526050 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:36:18.804130 => 17:36:21.525180
[0m17:36:21.528883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f27d9308-e2ad-46ac-84df-1732df69c9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7caeb71f40>]}
[0m17:36:21.531392 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.76s]
[0m17:36:21.533881 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:36:21.535620 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:36:21.537657 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:36:21.540813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:36:21.542487 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:36:21.548067 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:36:21.550865 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:36:21.543416 => 17:36:21.549671
[0m17:36:21.552053 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:36:21.572652 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:36:21.582167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:21.588340 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

SELECT base.base_name AS `Base Name`,
       raw.dispatching_base_num AS `Dispatching Base Number`,
       RANK() OVER(PARTITION BY raw.pickup_date ORDER BY COUNT(raw.pickup_date) DESC) AS `Rank`,
       COUNT(raw.pickup_date)
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE Rank IN (1,2,3)
    );
  
[0m17:36:22.156908 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1ea27fce-6620-4eb8-845c-1067a74b93f9&page=queryresults
[0m17:36:22.323199 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: Rank at [21:7]; reason: invalidQuery, location: query, message: Unrecognized name: Rank at [21:7]')
[0m17:36:23.262375 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a6f70851-ed58-443a-bd98-7435e9e66dbf&page=queryresults
[0m17:36:23.395472 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a6f70851-ed58-443a-bd98-7435e9e66dbf&page=queryresults
[0m17:36:23.397208 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:36:21.552714 => 17:36:23.396631
[0m17:36:23.407718 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Unrecognized name: Rank at [21:7]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:36:23.409095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f27d9308-e2ad-46ac-84df-1732df69c9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cae380710>]}
[0m17:36:23.410879 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.87s]
[0m17:36:23.412812 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:36:23.413931 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:36:23.415929 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:36:23.419549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:36:23.422145 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:36:23.451924 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:36:23.462569 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:36:23.423480 => 17:36:23.456060
[0m17:36:23.465209 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:36:23.482518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:23.965986 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:36:23.967441 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:36:24.182072 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a307f31f-a696-4a1e-abd7-7f3dd04b3790&page=queryresults
[0m17:36:26.155938 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:36:23.469045 => 17:36:26.155412
[0m17:36:26.157731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f27d9308-e2ad-46ac-84df-1732df69c9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7caeb715b0>]}
[0m17:36:26.159140 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.74s]
[0m17:36:26.160755 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:36:26.161942 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:36:26.163144 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:36:26.164992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:36:26.166580 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:36:26.174525 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:36:26.177383 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:36:26.168192 => 17:36:26.176266
[0m17:36:26.179644 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:36:26.187218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:26.630639 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:36:26.632317 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:36:26.841502 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0b6bd013-a6a1-4e78-a010-e2cdb8263257&page=queryresults
[0m17:36:28.731566 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:36:26.181765 => 17:36:28.730369
[0m17:36:28.735430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f27d9308-e2ad-46ac-84df-1732df69c9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cac233890>]}
[0m17:36:28.738375 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.57s]
[0m17:36:28.742177 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:36:28.751543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:28.753415 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:36:28.756069 [info ] [MainThread]: 
[0m17:36:28.758093 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.93 seconds (10.93s).
[0m17:36:28.761438 [debug] [MainThread]: Command end result
[0m17:36:28.825083 [info ] [MainThread]: 
[0m17:36:28.831418 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:36:28.833630 [info ] [MainThread]: 
[0m17:36:28.839158 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Unrecognized name: Rank at [21:7]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:36:28.844831 [info ] [MainThread]: 
[0m17:36:28.849575 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:36:28.855914 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.658874, "process_user_time": 6.57417, "process_kernel_time": 0.308084, "process_mem_max_rss": "134992", "process_out_blocks": "2848", "command_success": false, "process_in_blocks": "0"}
[0m17:36:28.863131 [debug] [MainThread]: Command `dbt run` failed at 17:36:28.861736 after 12.67 seconds
[0m17:36:28.866769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cb0d96f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7caf11dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cac22b860>]}
[0m17:36:28.873150 [debug] [MainThread]: Flushing usage events
[0m17:36:57.554614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48de1242c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48de9a1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48de1243b0>]}


============================== 17:36:57.559610 | 4d2f00ca-44b4-4630-82c0-880deb947697 ==============================
[0m17:36:57.559610 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:36:57.561046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:36:58.414390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d2f00ca-44b4-4630-82c0-880deb947697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc83a360>]}
[0m17:36:58.587628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d2f00ca-44b4-4630-82c0-880deb947697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc8fe1b0>]}
[0m17:36:58.589139 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:36:58.605783 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:36:58.695329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:36:58.696539 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:36:59.041986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d2f00ca-44b4-4630-82c0-880deb947697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc523380>]}
[0m17:36:59.055594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d2f00ca-44b4-4630-82c0-880deb947697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc44fef0>]}
[0m17:36:59.056627 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:36:59.057719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d2f00ca-44b4-4630-82c0-880deb947697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc226c00>]}
[0m17:36:59.060703 [info ] [MainThread]: 
[0m17:36:59.062557 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:36:59.066065 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:36:59.067227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:59.554575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:36:59.555651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:59.976624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d2f00ca-44b4-4630-82c0-880deb947697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc86f770>]}
[0m17:36:59.979105 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:36:59.980558 [info ] [MainThread]: 
[0m17:36:59.985869 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:36:59.987702 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:36:59.989763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:36:59.990858 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:37:00.011242 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:37:00.018397 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:36:59.991623 => 17:37:00.015490
[0m17:37:00.022990 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:37:00.120856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:00.628085 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:37:00.629895 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:37:00.830974 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ae5e50fb-efa2-41e2-883c-e9305c7fc5d4&page=queryresults
[0m17:37:02.740997 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:37:00.024297 => 17:37:02.740147
[0m17:37:02.743600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d2f00ca-44b4-4630-82c0-880deb947697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc77c3e0>]}
[0m17:37:02.745611 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.75s]
[0m17:37:02.747887 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:37:02.749501 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:37:02.751331 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:37:02.754671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:37:02.756383 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:37:02.762353 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:37:02.765230 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:37:02.757290 => 17:37:02.763981
[0m17:37:02.766709 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:37:02.792854 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:37:02.800244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:02.810679 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

SELECT base.base_name AS `Base Name`,
       raw.dispatching_base_num AS `Dispatching Base Number`,
       RANK() OVER(PARTITION BY raw.pickup_date ORDER BY COUNT(raw.pickup_date) DESC) AS `Rank`,
       COUNT(raw.pickup_date)
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE RANK() OVER(PARTITION BY raw.pickup_date ORDER BY COUNT(raw.pickup_date) DESC) IN (1,2,3)
    );
  
[0m17:37:03.339996 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1950711e-c8d6-496d-b25d-ed33e0752ec6&page=queryresults
[0m17:37:03.485025 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Analytic function not allowed in WHERE clause at [21:7]; reason: invalidQuery, location: query, message: Analytic function not allowed in WHERE clause at [21:7]')
[0m17:37:03.848870 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f055ddb2-d630-40d5-aef9-790b55c64740&page=queryresults
[0m17:37:04.220366 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f055ddb2-d630-40d5-aef9-790b55c64740&page=queryresults
[0m17:37:04.223952 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:37:02.768089 => 17:37:04.222714
[0m17:37:04.241130 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Analytic function not allowed in WHERE clause at [21:7]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:37:04.242975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d2f00ca-44b4-4630-82c0-880deb947697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc662f30>]}
[0m17:37:04.245911 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.49s]
[0m17:37:04.249314 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:37:04.251403 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:37:04.253704 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:37:04.261886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:37:04.266851 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:37:04.301300 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:37:04.310136 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:37:04.269433 => 17:37:04.307054
[0m17:37:04.317281 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:37:04.334209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:04.794812 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:37:04.796823 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:37:04.995314 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1a09dc88-bf8c-4a76-84a9-705751325954&page=queryresults
[0m17:37:06.862578 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:37:04.319866 => 17:37:06.861306
[0m17:37:06.866989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d2f00ca-44b4-4630-82c0-880deb947697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc300c80>]}
[0m17:37:06.870286 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.61s]
[0m17:37:06.873838 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:37:06.875250 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:37:06.876460 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:37:06.879166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:37:06.881430 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:37:06.889363 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:37:06.892315 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:37:06.882677 => 17:37:06.891131
[0m17:37:06.894176 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:37:06.905793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:07.383239 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:37:07.384906 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:37:07.594110 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8439851d-8f65-4a53-af85-06da2232e01d&page=queryresults
[0m17:37:09.480163 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:37:06.895369 => 17:37:09.478855
[0m17:37:09.484808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d2f00ca-44b4-4630-82c0-880deb947697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d99ebda0>]}
[0m17:37:09.488425 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.61s]
[0m17:37:09.492028 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:37:09.499953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:09.500949 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:37:09.501964 [info ] [MainThread]: 
[0m17:37:09.503049 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.44 seconds (10.44s).
[0m17:37:09.505844 [debug] [MainThread]: Command end result
[0m17:37:09.565359 [info ] [MainThread]: 
[0m17:37:09.570221 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:37:09.573159 [info ] [MainThread]: 
[0m17:37:09.575667 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Analytic function not allowed in WHERE clause at [21:7]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:37:09.581896 [info ] [MainThread]: 
[0m17:37:09.585354 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:37:09.596306 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.117736, "process_user_time": 6.504434, "process_kernel_time": 0.269898, "process_mem_max_rss": "134588", "process_out_blocks": "2848", "command_success": false, "process_in_blocks": "0"}
[0m17:37:09.602764 [debug] [MainThread]: Command `dbt run` failed at 17:37:09.601327 after 12.12 seconds
[0m17:37:09.604666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e1fbb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc5b3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d99deab0>]}
[0m17:37:09.605904 [debug] [MainThread]: Flushing usage events
[0m17:37:49.455948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff67101ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff67101be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff671019a60>]}


============================== 17:37:49.461057 | 09bf909d-2aee-4b70-ba8c-dd9a4f9711b6 ==============================
[0m17:37:49.461057 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:37:49.462545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:37:50.311210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09bf909d-2aee-4b70-ba8c-dd9a4f9711b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66fa5f9b0>]}
[0m17:37:50.483499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09bf909d-2aee-4b70-ba8c-dd9a4f9711b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66f58f260>]}
[0m17:37:50.485020 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:37:50.502808 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:37:50.591254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:37:50.592521 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:37:50.938795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09bf909d-2aee-4b70-ba8c-dd9a4f9711b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66f002e40>]}
[0m17:37:50.953075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09bf909d-2aee-4b70-ba8c-dd9a4f9711b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66f193290>]}
[0m17:37:50.954151 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:37:50.955247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09bf909d-2aee-4b70-ba8c-dd9a4f9711b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66f190890>]}
[0m17:37:50.958280 [info ] [MainThread]: 
[0m17:37:50.960160 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:37:50.964867 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:37:50.966675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:51.488050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:37:51.489119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:51.915722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09bf909d-2aee-4b70-ba8c-dd9a4f9711b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66ef3ce30>]}
[0m17:37:51.917703 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:37:51.918762 [info ] [MainThread]: 
[0m17:37:51.923023 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:37:51.924625 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:37:51.926807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:37:51.927943 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:37:51.940150 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:37:51.942222 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:37:51.928602 => 17:37:51.941392
[0m17:37:51.943794 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:37:52.020760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:52.504796 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:37:52.506343 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:37:52.720061 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:22f47421-aa6a-409a-865a-1a42311ba764&page=queryresults
[0m17:37:54.620240 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:37:51.944627 => 17:37:54.619711
[0m17:37:54.622132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09bf909d-2aee-4b70-ba8c-dd9a4f9711b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66f192870>]}
[0m17:37:54.623515 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.70s]
[0m17:37:54.625194 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:37:54.626300 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:37:54.627535 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:37:54.629316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:37:54.630792 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:37:54.635024 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:37:54.636980 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:37:54.632041 => 17:37:54.636179
[0m17:37:54.638256 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:37:54.648571 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:37:54.657498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:54.674215 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

SELECT base.base_name AS `Base Name`,
       raw.dispatching_base_num AS `Dispatching Base Number`,
       RANK() OVER(PARTITION BY raw.pickup_date ORDER BY COUNT(raw.pickup_date) DESC) AS `Rank`,
       COUNT(raw.pickup_date)
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_name, raw.dispatching_base_num
HAVING (RANK() OVER(PARTITION BY raw.pickup_date ORDER BY COUNT(raw.pickup_date) DESC) IN (1,2,3))
    );
  
[0m17:37:55.266576 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a5db849d-9cf8-4be6-b4f6-c5bb2dda8fb2&page=queryresults
[0m17:37:55.404351 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('PARTITION BY expression references raw.pickup_date which is neither grouped nor aggregated at [17:33]; reason: invalidQuery, location: query, message: PARTITION BY expression references raw.pickup_date which is neither grouped nor aggregated at [17:33]')
[0m17:37:56.450727 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:935e242b-36b7-4c8b-916a-f3b429a73659&page=queryresults
[0m17:37:56.586532 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:935e242b-36b7-4c8b-916a-f3b429a73659&page=queryresults
[0m17:37:56.589487 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:37:54.639213 => 17:37:56.588198
[0m17:37:56.604569 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  PARTITION BY expression references raw.pickup_date which is neither grouped nor aggregated at [17:33]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:37:56.605859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09bf909d-2aee-4b70-ba8c-dd9a4f9711b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66c810b90>]}
[0m17:37:56.607619 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.98s]
[0m17:37:56.611196 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:37:56.613581 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:37:56.617098 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:37:56.630164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:37:56.633663 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:37:56.668488 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:37:56.672807 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:37:56.636737 => 17:37:56.670493
[0m17:37:56.675863 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:37:56.693701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:57.160413 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:37:57.161849 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:37:57.362245 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d29994af-b80a-4d50-b05a-dd8a59080ee6&page=queryresults
[0m17:37:59.269635 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:37:56.677259 => 17:37:59.269126
[0m17:37:59.271578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09bf909d-2aee-4b70-ba8c-dd9a4f9711b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66c817ad0>]}
[0m17:37:59.272895 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.65s]
[0m17:37:59.274477 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:37:59.275586 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:37:59.276858 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:37:59.279394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:37:59.281290 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:37:59.285451 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:37:59.288107 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:37:59.282218 => 17:37:59.286886
[0m17:37:59.289795 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:37:59.295835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:59.732344 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:37:59.733996 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:37:59.948721 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:64f09427-eb26-4417-a0bf-b82f03433027&page=queryresults
[0m17:38:02.386946 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:37:59.290489 => 17:38:02.386433
[0m17:38:02.388860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09bf909d-2aee-4b70-ba8c-dd9a4f9711b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66f0394f0>]}
[0m17:38:02.390196 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.11s]
[0m17:38:02.391825 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:38:02.395118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:02.395976 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:38:02.397233 [info ] [MainThread]: 
[0m17:38:02.399212 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.44 seconds (11.44s).
[0m17:38:02.403795 [debug] [MainThread]: Command end result
[0m17:38:02.460407 [info ] [MainThread]: 
[0m17:38:02.462966 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:38:02.465206 [info ] [MainThread]: 
[0m17:38:02.466840 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  PARTITION BY expression references raw.pickup_date which is neither grouped nor aggregated at [17:33]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:38:02.468595 [info ] [MainThread]: 
[0m17:38:02.470684 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:38:02.474628 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.095554, "process_user_time": 6.299886, "process_kernel_time": 0.361887, "process_mem_max_rss": "134632", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m17:38:02.477051 [debug] [MainThread]: Command `dbt run` failed at 17:38:02.476423 after 13.10 seconds
[0m17:38:02.481074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff670e4bc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66f30b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66c816330>]}
[0m17:38:02.485625 [debug] [MainThread]: Flushing usage events
[0m17:38:40.385386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a49ac8320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a49bb4bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a49ac81d0>]}


============================== 17:38:40.390427 | 412134cf-4040-4693-b8b6-fca86f1133fb ==============================
[0m17:38:40.390427 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:38:40.391830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:38:41.266606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '412134cf-4040-4693-b8b6-fca86f1133fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a47fb5ca0>]}
[0m17:38:41.440388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '412134cf-4040-4693-b8b6-fca86f1133fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a4ac4fe90>]}
[0m17:38:41.441888 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:38:41.457206 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:38:41.551511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:38:41.552763 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:38:41.899156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '412134cf-4040-4693-b8b6-fca86f1133fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a47d3e5d0>]}
[0m17:38:41.913469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '412134cf-4040-4693-b8b6-fca86f1133fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a47db3d70>]}
[0m17:38:41.914635 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:38:41.915713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '412134cf-4040-4693-b8b6-fca86f1133fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a47bac1a0>]}
[0m17:38:41.918776 [info ] [MainThread]: 
[0m17:38:41.921148 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:38:41.925011 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:38:41.926139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:42.400161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:38:42.401280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:42.824669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '412134cf-4040-4693-b8b6-fca86f1133fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a47e7f1a0>]}
[0m17:38:42.826420 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:42.827434 [info ] [MainThread]: 
[0m17:38:42.831331 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:38:42.832591 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:38:42.835207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:38:42.836523 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:38:42.855466 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:38:42.862068 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:38:42.837222 => 17:38:42.860563
[0m17:38:42.864067 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:38:42.955971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:43.440452 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:38:43.442635 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:38:43.689185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:cfadbf24-ca57-432b-bc35-43e28f4d1061&page=queryresults
[0m17:38:45.613142 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:38:42.865833 => 17:38:45.612267
[0m17:38:45.615982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '412134cf-4040-4693-b8b6-fca86f1133fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a47d1b020>]}
[0m17:38:45.618122 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.78s]
[0m17:38:45.620637 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:38:45.622321 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:38:45.624055 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:38:45.627601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:38:45.629255 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:38:45.634791 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:38:45.637463 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:38:45.630187 => 17:38:45.636164
[0m17:38:45.639224 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:38:45.650716 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:38:45.655993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:45.665645 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

SELECT base.base_name AS `Base Name`,
       raw.dispatching_base_num AS `Dispatching Base Number`,
       RANK() OVER(PARTITION BY raw.pickup_date ORDER BY COUNT(raw.pickup_date) DESC) AS `Rank`,
       COUNT(raw.pickup_date)
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_name, raw.dispatching_base_num, raw.pickup_date
HAVING (RANK() OVER(PARTITION BY raw.pickup_date ORDER BY COUNT(raw.pickup_date) DESC) IN (1,2,3))
    );
  
[0m17:38:46.190178 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:9aa55841-b282-44d3-b8b3-4606fa44d0ed&page=queryresults
[0m17:38:46.320164 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Analytic function not allowed in HAVING clause at [22:9]; reason: invalidQuery, location: query, message: Analytic function not allowed in HAVING clause at [22:9]')
[0m17:38:47.310638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:80feb7fe-d744-43e9-aa39-e9079d9894af&page=queryresults
[0m17:38:47.445791 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:80feb7fe-d744-43e9-aa39-e9079d9894af&page=queryresults
[0m17:38:47.447655 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:38:45.640135 => 17:38:47.447022
[0m17:38:47.462918 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Analytic function not allowed in HAVING clause at [22:9]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:38:47.465119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '412134cf-4040-4693-b8b6-fca86f1133fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a47c60f20>]}
[0m17:38:47.467746 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.84s]
[0m17:38:47.470524 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:38:47.472758 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:38:47.476001 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:38:47.481063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:38:47.489380 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:38:47.527212 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:38:47.534703 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:38:47.492809 => 17:38:47.531203
[0m17:38:47.538871 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:38:47.555491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:48.015869 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:38:48.017437 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:38:48.195758 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:3c3c548f-7c44-46b4-bf59-5f03de0cd079&page=queryresults
[0m17:38:50.054653 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:38:47.541556 => 17:38:50.053695
[0m17:38:50.058080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '412134cf-4040-4693-b8b6-fca86f1133fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a47c60e90>]}
[0m17:38:50.059400 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.58s]
[0m17:38:50.060978 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:38:50.062127 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:38:50.063336 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:38:50.065118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:38:50.066657 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:38:50.070752 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:38:50.072541 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:38:50.067498 => 17:38:50.071767
[0m17:38:50.073854 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:38:50.078834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:50.530701 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:38:50.532387 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:38:50.770065 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4a36dd17-2b28-41ec-a1ee-60716b65a208&page=queryresults
[0m17:38:52.630440 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:38:50.074695 => 17:38:52.629030
[0m17:38:52.632764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '412134cf-4040-4693-b8b6-fca86f1133fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a47c60e90>]}
[0m17:38:52.634076 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.57s]
[0m17:38:52.635642 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:38:52.638860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:52.639700 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:38:52.640649 [info ] [MainThread]: 
[0m17:38:52.642321 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.72 seconds (10.72s).
[0m17:38:52.645352 [debug] [MainThread]: Command end result
[0m17:38:52.716662 [info ] [MainThread]: 
[0m17:38:52.718534 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:38:52.719945 [info ] [MainThread]: 
[0m17:38:52.728500 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Analytic function not allowed in HAVING clause at [22:9]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:38:52.731870 [info ] [MainThread]: 
[0m17:38:52.735258 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:38:52.748589 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.438314, "process_user_time": 6.498389, "process_kernel_time": 0.273543, "process_mem_max_rss": "132696", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m17:38:52.755223 [debug] [MainThread]: Command `dbt run` failed at 17:38:52.753545 after 12.45 seconds
[0m17:38:52.759345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a49ccd040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a45354380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a453577d0>]}
[0m17:38:52.769835 [debug] [MainThread]: Flushing usage events
[0m17:40:08.644734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0939664530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093994d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0939667ec0>]}


============================== 17:40:08.649725 | c9032200-db77-49e3-adc5-df4db77a45bc ==============================
[0m17:40:08.649725 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:40:08.651116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:40:09.503152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9032200-db77-49e3-adc5-df4db77a45bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0937d072c0>]}
[0m17:40:09.678761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9032200-db77-49e3-adc5-df4db77a45bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0937c76600>]}
[0m17:40:09.680254 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:40:09.702301 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:40:09.798495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:40:09.799706 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:40:10.146125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9032200-db77-49e3-adc5-df4db77a45bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093776ef60>]}
[0m17:40:10.160720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9032200-db77-49e3-adc5-df4db77a45bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093799b5c0>]}
[0m17:40:10.161872 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:40:10.162919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9032200-db77-49e3-adc5-df4db77a45bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0937c22db0>]}
[0m17:40:10.166134 [info ] [MainThread]: 
[0m17:40:10.169287 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:40:10.172449 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:40:10.173737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:10.720640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:40:10.721759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:11.162543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9032200-db77-49e3-adc5-df4db77a45bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0937a5c650>]}
[0m17:40:11.164544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:11.165570 [info ] [MainThread]: 
[0m17:40:11.169568 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:40:11.170800 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:40:11.173583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:40:11.174735 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:40:11.194371 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:40:11.202958 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:40:11.175393 => 17:40:11.200965
[0m17:40:11.206158 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:40:11.304532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:11.799961 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:40:11.801561 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:40:11.998243 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:504336e9-50ef-4a5f-b5ed-d280cd6b151c&page=queryresults
[0m17:40:13.899462 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:40:11.209903 => 17:40:13.898781
[0m17:40:13.901730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9032200-db77-49e3-adc5-df4db77a45bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093799a060>]}
[0m17:40:13.903422 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.73s]
[0m17:40:13.905323 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:40:13.906517 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:40:13.907949 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:40:13.911026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:40:13.912513 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:40:13.916864 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:40:13.919106 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:40:13.913746 => 17:40:13.918139
[0m17:40:13.920576 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:40:13.938003 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:40:13.942577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:13.955061 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

SELECT base.base_name AS `Base Name`,
       raw.dispatching_base_num AS `Dispatching Base Number`,
       RANK() OVER(PARTITION BY raw.pickup_date) AS `Rank`,
       COUNT(raw.pickup_date)
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_name, raw.dispatching_base_num, raw.pickup_date
HAVING (RANK() OVER(PARTITION BY raw.pickup_date) IN (1,2,3))
    );
  
[0m17:40:14.501494 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e937b5cf-9ad1-40c5-8a16-27ac56043051&page=queryresults
[0m17:40:14.637184 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Window ORDER BY is required for analytic function rank at [17:19]; reason: invalidQuery, location: query, message: Window ORDER BY is required for analytic function rank at [17:19]')
[0m17:40:15.395184 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c668b7c2-d5e1-4f07-ad5e-468b37cabf03&page=queryresults
[0m17:40:15.539377 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c668b7c2-d5e1-4f07-ad5e-468b37cabf03&page=queryresults
[0m17:40:15.542865 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:40:13.921469 => 17:40:15.541616
[0m17:40:15.564011 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY is required for analytic function rank at [17:19]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:40:15.566057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9032200-db77-49e3-adc5-df4db77a45bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09379f4ad0>]}
[0m17:40:15.568196 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.66s]
[0m17:40:15.570962 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:40:15.573076 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:40:15.575230 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:40:15.579773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:40:15.582114 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:40:15.616124 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:40:15.625033 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:40:15.583720 => 17:40:15.623177
[0m17:40:15.629145 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:40:15.652520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:16.117592 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:40:16.119032 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:40:16.322489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:fdaef62e-e695-4cd4-811b-796cc0866345&page=queryresults
[0m17:40:18.770854 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:40:15.636712 => 17:40:18.769696
[0m17:40:18.775128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9032200-db77-49e3-adc5-df4db77a45bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0937849160>]}
[0m17:40:18.778082 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 3.20s]
[0m17:40:18.781598 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:40:18.784164 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:40:18.788486 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:40:18.792968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:40:18.795420 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:40:18.810386 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:40:18.814472 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:40:18.797245 => 17:40:18.813182
[0m17:40:18.818208 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:40:18.832402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:19.282427 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:40:19.283849 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:40:19.512867 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f9198185-7685-4f95-8d7c-e048c57bea30&page=queryresults
[0m17:40:22.253573 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:40:18.823822 => 17:40:22.253092
[0m17:40:22.255420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9032200-db77-49e3-adc5-df4db77a45bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0934f37950>]}
[0m17:40:22.256766 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.46s]
[0m17:40:22.258295 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:40:22.261504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:22.262799 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:40:22.264312 [info ] [MainThread]: 
[0m17:40:22.265805 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.10 seconds (12.10s).
[0m17:40:22.269049 [debug] [MainThread]: Command end result
[0m17:40:22.314615 [info ] [MainThread]: 
[0m17:40:22.316386 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:40:22.321328 [info ] [MainThread]: 
[0m17:40:22.327253 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY is required for analytic function rank at [17:19]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:40:22.331481 [info ] [MainThread]: 
[0m17:40:22.333722 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:40:22.341625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.774087, "process_user_time": 6.518652, "process_kernel_time": 0.279403, "process_mem_max_rss": "132616", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m17:40:22.346757 [debug] [MainThread]: Command `dbt run` failed at 17:40:22.346025 after 13.78 seconds
[0m17:40:22.347834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0939665940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09396d0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0934f32960>]}
[0m17:40:22.348807 [debug] [MainThread]: Flushing usage events
[0m17:41:17.518478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71509642c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7150bc9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7150bca1e0>]}


============================== 17:41:17.523503 | 67f49478-7d08-4432-8e0d-484d2c7e63b6 ==============================
[0m17:41:17.523503 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:41:17.524916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:41:18.366522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67f49478-7d08-4432-8e0d-484d2c7e63b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714ed53650>]}
[0m17:41:18.538123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67f49478-7d08-4432-8e0d-484d2c7e63b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714f2b6630>]}
[0m17:41:18.539864 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:41:18.555824 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:41:18.651942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:41:18.653223 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:41:18.998418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67f49478-7d08-4432-8e0d-484d2c7e63b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714eb1f560>]}
[0m17:41:19.012671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67f49478-7d08-4432-8e0d-484d2c7e63b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714eccbc80>]}
[0m17:41:19.013789 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:41:19.014875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67f49478-7d08-4432-8e0d-484d2c7e63b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714eccb590>]}
[0m17:41:19.017885 [info ] [MainThread]: 
[0m17:41:19.020360 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:41:19.023633 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:41:19.024922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:19.493170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:41:19.494323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:19.927856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67f49478-7d08-4432-8e0d-484d2c7e63b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714ea76480>]}
[0m17:41:19.929608 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:19.930631 [info ] [MainThread]: 
[0m17:41:19.934610 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:41:19.935974 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:41:19.938775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:41:19.940156 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:41:19.954057 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:41:19.956345 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:41:19.940962 => 17:41:19.955452
[0m17:41:19.958358 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:41:20.064105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:20.564104 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:41:20.566072 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:41:20.791751 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7a3efca0-298f-42e4-8030-75313957d301&page=queryresults
[0m17:41:22.765021 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:41:19.960104 => 17:41:22.764088
[0m17:41:22.768060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f49478-7d08-4432-8e0d-484d2c7e63b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714ecca300>]}
[0m17:41:22.770490 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.83s]
[0m17:41:22.773472 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:41:22.776196 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:41:22.778511 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:41:22.781316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:41:22.782751 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:41:22.791691 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:41:22.795049 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:41:22.784021 => 17:41:22.793855
[0m17:41:22.796942 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:41:22.810964 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:41:22.813613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:22.819846 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

SELECT base.base_name AS `Base Name`,
       raw.dispatching_base_num AS `Dispatching Base Number`,
       RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY raw.pickup_date) AS `Rank`,
       COUNT(raw.pickup_date)
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_name, raw.dispatching_base_num, raw.pickup_date
HAVING (RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY raw.pickup_date) IN (1,2,3))
    );
  
[0m17:41:23.371658 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0280e6fe-6640-44f0-bdc5-543673e59749&page=queryresults
[0m17:41:23.521303 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Analytic function not allowed in HAVING clause at [22:9]; reason: invalidQuery, location: query, message: Analytic function not allowed in HAVING clause at [22:9]')
[0m17:41:24.491609 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:efd75947-3dfb-41ed-ad02-df5af360971e&page=queryresults
[0m17:41:24.601077 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:efd75947-3dfb-41ed-ad02-df5af360971e&page=queryresults
[0m17:41:24.605194 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:41:22.798245 => 17:41:24.603839
[0m17:41:24.621336 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Analytic function not allowed in HAVING clause at [22:9]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:41:24.622574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f49478-7d08-4432-8e0d-484d2c7e63b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714eb79a90>]}
[0m17:41:24.623984 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.84s]
[0m17:41:24.627784 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:41:24.629953 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:41:24.633624 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:41:24.646304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:41:24.649431 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:41:24.690831 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:41:24.694622 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:41:24.651897 => 17:41:24.693392
[0m17:41:24.696843 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:41:24.713601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:25.197665 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:41:25.199447 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:41:25.975711 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:70eed15d-de83-4e57-8d39-350f1e74ca3c&page=queryresults
[0m17:41:27.822348 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:41:24.698787 => 17:41:27.821663
[0m17:41:27.824913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f49478-7d08-4432-8e0d-484d2c7e63b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714eb791c0>]}
[0m17:41:27.826230 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 3.18s]
[0m17:41:27.827892 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:41:27.828975 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:41:27.830205 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:41:27.832066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:41:27.833715 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:41:27.839487 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:41:27.843172 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:41:27.834707 => 17:41:27.841600
[0m17:41:27.845466 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:41:27.851304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:28.275274 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:41:28.276706 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:41:28.509752 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7109e94d-5268-4a81-97cf-09a3e78ae422&page=queryresults
[0m17:41:30.362934 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:41:27.846844 => 17:41:30.361798
[0m17:41:30.371843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f49478-7d08-4432-8e0d-484d2c7e63b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714e13d400>]}
[0m17:41:30.378325 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.54s]
[0m17:41:30.386208 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:41:30.391028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:30.392828 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:41:30.394454 [info ] [MainThread]: 
[0m17:41:30.396253 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.38 seconds (11.38s).
[0m17:41:30.401055 [debug] [MainThread]: Command end result
[0m17:41:30.463841 [info ] [MainThread]: 
[0m17:41:30.467053 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:41:30.469510 [info ] [MainThread]: 
[0m17:41:30.474283 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Analytic function not allowed in HAVING clause at [22:9]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:41:30.479893 [info ] [MainThread]: 
[0m17:41:30.485319 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:41:30.493972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.050354, "process_user_time": 6.444544, "process_kernel_time": 0.329558, "process_mem_max_rss": "132732", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m17:41:30.497783 [debug] [MainThread]: Command `dbt run` failed at 17:41:30.496640 after 13.05 seconds
[0m17:41:30.501587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71546dbf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714eea1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f712ff439e0>]}
[0m17:41:30.503837 [debug] [MainThread]: Flushing usage events
[0m17:42:41.380785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f5ec80e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f6a7a720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f652d880>]}


============================== 17:42:41.385882 | 78cb55b1-e7ef-4933-8356-51583a456933 ==============================
[0m17:42:41.385882 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:42:41.387378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:42:42.223657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78cb55b1-e7ef-4933-8356-51583a456933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f4562420>]}
[0m17:42:42.396467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78cb55b1-e7ef-4933-8356-51583a456933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f432ee40>]}
[0m17:42:42.397913 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:42:42.413591 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:42:42.506024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:42:42.507230 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:42:42.851072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78cb55b1-e7ef-4933-8356-51583a456933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f401eb10>]}
[0m17:42:42.865704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78cb55b1-e7ef-4933-8356-51583a456933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f41c6f30>]}
[0m17:42:42.866791 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:42:42.868023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78cb55b1-e7ef-4933-8356-51583a456933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f41c7170>]}
[0m17:42:42.871525 [info ] [MainThread]: 
[0m17:42:42.873523 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:42:42.878272 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:42:42.880539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:43.358418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:42:43.359496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:43.781019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78cb55b1-e7ef-4933-8356-51583a456933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f41c6090>]}
[0m17:42:43.782736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:42:43.783931 [info ] [MainThread]: 
[0m17:42:43.788193 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:42:43.790191 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:42:43.792339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:42:43.793424 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:42:43.810934 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:42:43.825098 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:42:43.794437 => 17:42:43.822048
[0m17:42:43.827738 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:42:43.958992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:44.432608 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:42:44.434110 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:42:44.644538 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7eebbe6a-684d-42b5-9bd6-b6ed3b1ff21a&page=queryresults
[0m17:42:46.576066 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:42:43.830779 => 17:42:46.575547
[0m17:42:46.577967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78cb55b1-e7ef-4933-8356-51583a456933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f3fd4a10>]}
[0m17:42:46.579396 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.79s]
[0m17:42:46.581312 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:42:46.582478 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:42:46.583796 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:42:46.586497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:42:46.588729 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:42:46.595506 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:42:46.598385 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:42:46.589911 => 17:42:46.597180
[0m17:42:46.600304 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:42:46.623700 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:42:46.632350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:46.641926 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

SELECT base.base_name AS `Base Name`,
       raw.dispatching_base_num AS `Dispatching Base Number`,
       RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY raw.pickup_date) AS `Rank`,
       COUNT(raw.pickup_date)
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_name, raw.dispatching_base_num, raw.pickup_date
HAVING (SELECT RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY raw.pickup_date) FROM airbyte_uber_data.raw_data_janjune_15 AS raw) IN (1,2,3)
    );
  
[0m17:42:47.133412 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4c19beab-178f-4ef0-865a-84e314dd80ba&page=queryresults
[0m17:42:47.269209 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE columns must be named, but column 4 has no name at [15:1]; reason: invalidQuery, location: query, message: CREATE TABLE columns must be named, but column 4 has no name at [15:1]')
[0m17:42:47.564143 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:80a8b1be-c3de-4b15-b0d0-3cb3208cc512&page=queryresults
[0m17:42:47.694687 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:80a8b1be-c3de-4b15-b0d0-3cb3208cc512&page=queryresults
[0m17:42:47.696590 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:42:46.601462 => 17:42:47.696013
[0m17:42:47.711634 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  CREATE TABLE columns must be named, but column 4 has no name at [15:1]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:42:47.713858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78cb55b1-e7ef-4933-8356-51583a456933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f41c6450>]}
[0m17:42:47.716375 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.13s]
[0m17:42:47.719091 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:42:47.721352 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:42:47.724558 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:42:47.731048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:42:47.736981 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:42:47.766808 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:42:47.774036 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:42:47.739418 => 17:42:47.770764
[0m17:42:47.777708 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:42:47.792303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:48.221198 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:42:48.223222 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:42:48.412018 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:72a250c2-3a46-433e-aa5e-458b3cda3e37&page=queryresults
[0m17:42:49.999002 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:42:47.780103 => 17:42:49.998513
[0m17:42:50.000788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78cb55b1-e7ef-4933-8356-51583a456933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f406d8e0>]}
[0m17:42:50.002166 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.27s]
[0m17:42:50.003815 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:42:50.004994 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:42:50.006266 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:42:50.008060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:42:50.009666 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:42:50.013904 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:42:50.015860 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:42:50.010666 => 17:42:50.015126
[0m17:42:50.017001 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:42:50.021456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:50.483553 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:42:50.485213 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:42:50.687833 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e8effdd7-929a-4b3c-a344-369f14677592&page=queryresults
[0m17:42:52.305868 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:42:50.017781 => 17:42:52.305390
[0m17:42:52.307610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78cb55b1-e7ef-4933-8356-51583a456933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f406d9a0>]}
[0m17:42:52.308943 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.30s]
[0m17:42:52.310489 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:42:52.313758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:52.314935 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:42:52.316493 [info ] [MainThread]: 
[0m17:42:52.318078 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.44 seconds (9.44s).
[0m17:42:52.320813 [debug] [MainThread]: Command end result
[0m17:42:52.372737 [info ] [MainThread]: 
[0m17:42:52.374860 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:42:52.380451 [info ] [MainThread]: 
[0m17:42:52.385601 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  CREATE TABLE columns must be named, but column 4 has no name at [15:1]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:42:52.389314 [info ] [MainThread]: 
[0m17:42:52.393909 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:42:52.403244 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.098553, "process_user_time": 6.695998, "process_kernel_time": 0.302063, "process_mem_max_rss": "132752", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m17:42:52.411615 [debug] [MainThread]: Command `dbt run` failed at 17:42:52.406056 after 11.10 seconds
[0m17:42:52.414471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f4a62d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f17533e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f17536e0>]}
[0m17:42:52.418673 [debug] [MainThread]: Flushing usage events
[0m17:43:14.743474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4babf40500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bac12fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4babf40f20>]}


============================== 17:43:14.748475 | 75a16b55-0265-4e41-b184-1c844ee37fda ==============================
[0m17:43:14.748475 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:43:14.749902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:43:15.604391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75a16b55-0265-4e41-b184-1c844ee37fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4baa4b8f80>]}
[0m17:43:15.778742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75a16b55-0265-4e41-b184-1c844ee37fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4babda1580>]}
[0m17:43:15.780218 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:43:15.795787 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:43:15.895726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:43:15.896950 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:43:16.240321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75a16b55-0265-4e41-b184-1c844ee37fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4baa0279e0>]}
[0m17:43:16.254444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75a16b55-0265-4e41-b184-1c844ee37fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4baa08bb60>]}
[0m17:43:16.255527 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:43:16.256617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a16b55-0265-4e41-b184-1c844ee37fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ba9e4eff0>]}
[0m17:43:16.259616 [info ] [MainThread]: 
[0m17:43:16.261499 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:43:16.264936 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:43:16.266045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:16.780408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:43:16.781536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:17.198857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a16b55-0265-4e41-b184-1c844ee37fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ba9e4f560>]}
[0m17:43:17.200837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:43:17.202246 [info ] [MainThread]: 
[0m17:43:17.206720 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:43:17.208574 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:43:17.211126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:43:17.212533 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:43:17.230550 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:43:17.236940 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:43:17.213244 => 17:43:17.233492
[0m17:43:17.239646 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:43:17.334518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:17.821357 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:43:17.823202 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:43:18.045344 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4cc1e4e3-20ee-46d6-b197-2d798b96fc88&page=queryresults
[0m17:43:19.958856 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:43:17.241996 => 17:43:19.958285
[0m17:43:19.960838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a16b55-0265-4e41-b184-1c844ee37fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ba9e73b00>]}
[0m17:43:19.962249 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.75s]
[0m17:43:19.963948 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:43:19.965148 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:43:19.966483 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:43:19.968283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:43:19.970329 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:43:19.977366 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:43:19.980140 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:43:19.971710 => 17:43:19.979009
[0m17:43:19.982250 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:43:20.002411 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:43:20.006612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:20.017498 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

SELECT base.base_name AS `Base Name`,
       raw.dispatching_base_num AS `Dispatching Base Number`,
       RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY raw.pickup_date) AS `Rank`,
       COUNT(raw.pickup_date) AS `Count`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_name, raw.dispatching_base_num, raw.pickup_date
HAVING (SELECT RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY raw.pickup_date) FROM airbyte_uber_data.raw_data_janjune_15 AS raw) IN (1,2,3)
    );
  
[0m17:43:20.551460 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:782c5765-c09c-48ab-af29-08a0a7359d36&page=queryresults
[0m17:43:23.486509 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Scalar subquery produced more than one element; reason: invalidQuery, location: query, message: Scalar subquery produced more than one element')
[0m17:43:24.337369 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:adc2fd53-b07e-42a7-95dc-2eea740cdb8b&page=queryresults
[0m17:43:26.661889 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:adc2fd53-b07e-42a7-95dc-2eea740cdb8b&page=queryresults
[0m17:43:26.665876 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:43:19.983487 => 17:43:26.664403
[0m17:43:26.693593 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Scalar subquery produced more than one element
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:43:26.695697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a16b55-0265-4e41-b184-1c844ee37fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ba9e4d8e0>]}
[0m17:43:26.698698 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 6.73s]
[0m17:43:26.702789 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:43:26.705409 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:43:26.708588 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:43:26.712247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:43:26.714548 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:43:26.721020 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:43:26.727895 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:43:26.715926 => 17:43:26.724388
[0m17:43:26.732986 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:43:26.756361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:27.209250 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:43:27.210663 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:43:27.414265 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1f1cc89c-b7e0-4a09-a281-a1180bb55263&page=queryresults
[0m17:43:29.259528 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:43:26.735438 => 17:43:29.259032
[0m17:43:29.262728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a16b55-0265-4e41-b184-1c844ee37fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ba3513e00>]}
[0m17:43:29.265674 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.55s]
[0m17:43:29.269089 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:43:29.271532 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:43:29.274840 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:43:29.281747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:43:29.285555 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:43:29.299111 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:43:29.303764 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:43:29.288045 => 17:43:29.301942
[0m17:43:29.305931 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:43:29.314734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:29.804721 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:43:29.806135 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:43:30.040152 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7e7a4ec6-d819-4b34-830c-344ad284d661&page=queryresults
[0m17:43:31.915706 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:43:29.307343 => 17:43:31.914551
[0m17:43:31.919920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a16b55-0265-4e41-b184-1c844ee37fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ba9f31910>]}
[0m17:43:31.922879 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.64s]
[0m17:43:31.926339 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:43:31.935086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:31.937039 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:43:31.939407 [info ] [MainThread]: 
[0m17:43:31.942718 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.68 seconds (15.68s).
[0m17:43:31.949701 [debug] [MainThread]: Command end result
[0m17:43:32.038155 [info ] [MainThread]: 
[0m17:43:32.042612 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:43:32.047005 [info ] [MainThread]: 
[0m17:43:32.050074 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Scalar subquery produced more than one element
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:43:32.052479 [info ] [MainThread]: 
[0m17:43:32.059880 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:43:32.069751 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 17.401525, "process_user_time": 6.478915, "process_kernel_time": 0.319355, "process_mem_max_rss": "136592", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m17:43:32.074681 [debug] [MainThread]: Command `dbt run` failed at 17:43:32.073632 after 17.41 seconds
[0m17:43:32.079876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4babd73c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4baa202c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ba341b110>]}
[0m17:43:32.085526 [debug] [MainThread]: Flushing usage events
[0m17:46:22.807193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d40718b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d4f7b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d4072570>]}


============================== 17:46:22.812301 | ced27485-6975-414f-8775-1b261d34ebe5 ==============================
[0m17:46:22.812301 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:46:22.813670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:46:23.663087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ced27485-6975-414f-8775-1b261d34ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d249ef00>]}
[0m17:46:23.851446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ced27485-6975-414f-8775-1b261d34ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d235e7e0>]}
[0m17:46:23.852870 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:46:23.874643 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:46:23.968862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:46:23.970090 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:46:24.322742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ced27485-6975-414f-8775-1b261d34ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d21a7080>]}
[0m17:46:24.336925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ced27485-6975-414f-8775-1b261d34ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d23e6ed0>]}
[0m17:46:24.338017 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:46:24.339058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ced27485-6975-414f-8775-1b261d34ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d291e1e0>]}
[0m17:46:24.342142 [info ] [MainThread]: 
[0m17:46:24.343977 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:46:24.348493 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:46:24.349854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:24.894260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:46:24.895245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:25.428261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ced27485-6975-414f-8775-1b261d34ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d2186d20>]}
[0m17:46:25.438665 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:46:25.440518 [info ] [MainThread]: 
[0m17:46:25.479188 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:46:25.495332 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:46:25.509637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:46:25.525899 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:46:25.570659 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:46:25.581934 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:46:25.527757 => 17:46:25.577045
[0m17:46:25.584503 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:46:25.699183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:26.273326 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:46:26.275324 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:46:26.572639 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:22670eca-da80-487e-af2a-205a8013cb6c&page=queryresults
[0m17:46:28.555379 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:46:25.585800 => 17:46:28.554856
[0m17:46:28.557228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ced27485-6975-414f-8775-1b261d34ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d2238fb0>]}
[0m17:46:28.558756 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 3.06s]
[0m17:46:28.560522 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:46:28.561773 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:46:28.563029 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:46:28.565656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:46:28.567760 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:46:28.574717 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:46:28.577842 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:46:28.568970 => 17:46:28.576615
[0m17:46:28.579864 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:46:28.601711 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:46:28.606448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:28.621153 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

with ranked_cte AS (
    SELECT base.base_name AS `Base Name`,
          raw.dispatching_base_num AS `Dispatching Base Number`,
          RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY raw.pickup_date) AS `Rank`,
          COUNT(raw.pickup_date) AS `Count`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
    GROUP BY base.base_name, raw.dispatching_base_num, raw.pickup_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m17:46:29.266717 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:807e732a-df85-4a16-af60-53cfd48c9e8e&page=queryresults
[0m17:46:35.696319 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:46:28.581137 => 17:46:35.695299
[0m17:46:35.700145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ced27485-6975-414f-8775-1b261d34ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d228a0c0>]}
[0m17:46:35.702885 [info ] [Thread-1 (]: 2 of 4 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (24.0 rows, 217.8 MiB processed)[0m in 7.14s]
[0m17:46:35.706199 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:46:35.708503 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:46:35.712233 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:46:35.718508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:46:35.722694 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:46:35.747822 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:46:35.753091 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:46:35.725112 => 17:46:35.751057
[0m17:46:35.757049 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:46:35.770413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:36.238146 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:46:36.239569 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:46:36.478645 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:786439fb-fb85-4033-aa2b-b0624cacb5e6&page=queryresults
[0m17:46:38.355941 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:46:35.759255 => 17:46:38.354769
[0m17:46:38.359829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ced27485-6975-414f-8775-1b261d34ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d2289670>]}
[0m17:46:38.362815 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.64s]
[0m17:46:38.366556 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:46:38.369299 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:46:38.374049 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:46:38.380907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:46:38.384772 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:46:38.392094 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:46:38.394801 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:46:38.385962 => 17:46:38.393716
[0m17:46:38.396546 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:46:38.407404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:38.833243 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:46:38.834764 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:46:39.061985 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:65291621-96bd-4ab8-bbe3-4fc3d930ea14&page=queryresults
[0m17:46:40.959484 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:46:38.398143 => 17:46:40.958298
[0m17:46:40.963291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ced27485-6975-414f-8775-1b261d34ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d1ab5f70>]}
[0m17:46:40.966216 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.59s]
[0m17:46:40.969640 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:46:40.978349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:40.980570 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:46:40.983035 [info ] [MainThread]: 
[0m17:46:40.985674 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 16.64 seconds (16.64s).
[0m17:46:40.991919 [debug] [MainThread]: Command end result
[0m17:46:41.065564 [info ] [MainThread]: 
[0m17:46:41.068370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:46:41.070555 [info ] [MainThread]: 
[0m17:46:41.080499 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:46:41.085374 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.354473, "process_user_time": 7.537158, "process_kernel_time": 0.346624, "process_mem_max_rss": "133560", "process_in_blocks": "56", "process_out_blocks": "2848"}
[0m17:46:41.088246 [debug] [MainThread]: Command `dbt run` succeeded at 17:46:41.087392 after 18.36 seconds
[0m17:46:41.091586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d254ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d1a8b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d1a8ad20>]}
[0m17:46:41.093888 [debug] [MainThread]: Flushing usage events
[0m17:48:23.582049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b2643c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b266bf7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b2643c200>]}


============================== 17:48:23.587014 | 4305704c-7200-424e-8309-019e269ef04e ==============================
[0m17:48:23.587014 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:48:23.588365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:48:24.473436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4305704c-7200-424e-8309-019e269ef04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b24bdee40>]}
[0m17:48:24.656293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4305704c-7200-424e-8309-019e269ef04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b250efe90>]}
[0m17:48:24.657774 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:48:24.673544 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:48:24.774658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:48:24.775939 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:48:25.126419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4305704c-7200-424e-8309-019e269ef04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b24523320>]}
[0m17:48:25.143371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4305704c-7200-424e-8309-019e269ef04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b246d0110>]}
[0m17:48:25.144981 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:48:25.146238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4305704c-7200-424e-8309-019e269ef04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b244a7710>]}
[0m17:48:25.149610 [info ] [MainThread]: 
[0m17:48:25.152443 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:48:25.157310 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:48:25.159730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:25.707976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:48:25.709082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:26.173584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4305704c-7200-424e-8309-019e269ef04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b244a6b40>]}
[0m17:48:26.175359 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:48:26.176551 [info ] [MainThread]: 
[0m17:48:26.180467 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:48:26.181886 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:48:26.184601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:48:26.185681 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:48:26.211178 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:48:26.218144 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:48:26.186328 => 17:48:26.216363
[0m17:48:26.225602 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:48:26.316376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:26.861512 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:48:26.863002 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:48:27.161382 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:5cd85f2f-c224-4b26-93bf-f45c2e665949&page=queryresults
[0m17:48:29.084665 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:48:26.228578 => 17:48:29.083935
[0m17:48:29.086624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4305704c-7200-424e-8309-019e269ef04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b2457e300>]}
[0m17:48:29.088009 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.90s]
[0m17:48:29.089850 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:48:29.091030 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:48:29.092368 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:48:29.094101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:48:29.095718 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:48:29.100278 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:48:29.102465 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:48:29.096909 => 17:48:29.101453
[0m17:48:29.103979 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:48:29.109727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:29.573498 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:48:29.575249 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

with ranked_cte AS (
    SELECT base.base_name AS `Base Name`,
          raw.dispatching_base_num AS `Dispatching Base Number`,
          RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY raw.pickup_date) AS `Rank`,
          COUNT(raw.pickup_date) AS `Count`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
    GROUP BY base.base_name, raw.dispatching_base_num
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m17:48:29.803267 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:6a6d1e93-9bb4-4ec3-a550-493d78260dd3&page=queryresults
[0m17:48:29.957192 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:70]; reason: invalidQuery, location: query, message: Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:70]')
[0m17:48:30.210025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:10e69b50-278d-4628-9f14-62824079385a&page=queryresults
[0m17:48:30.358863 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:10e69b50-278d-4628-9f14-62824079385a&page=queryresults
[0m17:48:30.365671 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:48:29.104940 => 17:48:30.363035
[0m17:48:30.401589 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:70]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:48:30.404746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4305704c-7200-424e-8309-019e269ef04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b2457cec0>]}
[0m17:48:30.409703 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.31s]
[0m17:48:30.414401 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:48:30.422165 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:48:30.426411 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:48:30.437155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:48:30.441577 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:48:30.449481 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:48:30.456460 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:48:30.443357 => 17:48:30.454955
[0m17:48:30.458907 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:48:30.472858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:30.958802 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:48:30.961133 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:48:31.211317 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:89232863-fbd5-4cac-9ee2-afab1ddff8f6&page=queryresults
[0m17:48:33.143162 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:48:30.461089 => 17:48:33.142031
[0m17:48:33.147459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4305704c-7200-424e-8309-019e269ef04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b2457d190>]}
[0m17:48:33.150389 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.72s]
[0m17:48:33.154038 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:48:33.156647 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:48:33.160432 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:48:33.167422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:48:33.170873 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:48:33.180014 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:48:33.184250 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:48:33.172705 => 17:48:33.182389
[0m17:48:33.187179 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:48:33.195631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:33.715160 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:48:33.716586 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:48:33.972276 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a344fe63-fbd8-4efc-a072-557e18805e42&page=queryresults
[0m17:48:35.918083 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:48:33.189287 => 17:48:35.917576
[0m17:48:35.919905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4305704c-7200-424e-8309-019e269ef04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b1da4bec0>]}
[0m17:48:35.921253 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.76s]
[0m17:48:35.922847 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:48:35.930393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:35.932713 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:48:35.935653 [info ] [MainThread]: 
[0m17:48:35.938056 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.78 seconds (10.78s).
[0m17:48:35.945072 [debug] [MainThread]: Command end result
[0m17:48:36.039093 [info ] [MainThread]: 
[0m17:48:36.043163 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:48:36.045880 [info ] [MainThread]: 
[0m17:48:36.051732 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:70]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:48:36.057633 [info ] [MainThread]: 
[0m17:48:36.062805 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:48:36.068819 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.566711, "process_user_time": 6.748267, "process_kernel_time": 0.34866, "process_mem_max_rss": "136408", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m17:48:36.077673 [debug] [MainThread]: Command `dbt run` failed at 17:48:36.074046 after 12.57 seconds
[0m17:48:36.082028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b2646fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b2465e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b1da6f740>]}
[0m17:48:36.084218 [debug] [MainThread]: Flushing usage events
[0m17:51:37.829334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec8222960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec828a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec8288bc0>]}


============================== 17:51:37.834378 | 3f02660a-d226-42f9-8288-3e1012026059 ==============================
[0m17:51:37.834378 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:51:37.835768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:51:38.683182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f02660a-d226-42f9-8288-3e1012026059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec66cae70>]}
[0m17:51:38.864245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f02660a-d226-42f9-8288-3e1012026059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec656b2f0>]}
[0m17:51:38.865768 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:51:38.881802 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:51:38.975348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:51:38.976272 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:51:38.986241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f02660a-d226-42f9-8288-3e1012026059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec64bbc50>]}
[0m17:51:39.023192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f02660a-d226-42f9-8288-3e1012026059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec638fa40>]}
[0m17:51:39.024307 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:51:39.025385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f02660a-d226-42f9-8288-3e1012026059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec66fa5d0>]}
[0m17:51:39.028443 [info ] [MainThread]: 
[0m17:51:39.030305 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:51:39.033761 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:51:39.035027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:39.572848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:51:39.573910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:40.027421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f02660a-d226-42f9-8288-3e1012026059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec6481ca0>]}
[0m17:51:40.029217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:40.030290 [info ] [MainThread]: 
[0m17:51:40.034384 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:51:40.035733 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:51:40.038827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:51:40.041070 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:51:40.067880 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:51:40.075359 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:51:40.042366 => 17:51:40.073345
[0m17:51:40.079170 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:51:40.183898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:45.747624 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:51:45.749232 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:51:46.031872 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8b827e35-1036-4455-be17-f3cd583893dd&page=queryresults
[0m17:51:47.971619 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:51:40.083773 => 17:51:47.971093
[0m17:51:47.973388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f02660a-d226-42f9-8288-3e1012026059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec4108200>]}
[0m17:51:47.974829 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 7.94s]
[0m17:51:47.976474 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:51:47.977607 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:51:47.979169 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:51:47.981613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:51:47.982998 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:51:47.987552 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:51:47.990296 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:51:47.983735 => 17:51:47.989187
[0m17:51:47.992266 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:51:48.187597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:48.640363 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:51:48.642202 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

with ranked_cte AS (
    SELECT base.base_name AS `Base Name`,
          raw.dispatching_base_num AS `Dispatching Base Number`,
          RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY raw.pickup_date) AS `Rank`,
          COUNT(raw.pickup_date) AS `Count`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
    GROUP BY base.base_name, raw.dispatching_base_num
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m17:51:48.913257 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4344996a-1ac2-4c43-ba43-7e76d4fd3723&page=queryresults
[0m17:51:49.062919 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:70]; reason: invalidQuery, location: query, message: Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:70]')
[0m17:51:50.127598 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c73bbe0a-b11d-43c9-b05d-b0ea7ced8405&page=queryresults
[0m17:51:50.524387 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c73bbe0a-b11d-43c9-b05d-b0ea7ced8405&page=queryresults
[0m17:51:50.526139 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:51:47.993458 => 17:51:50.525557
[0m17:51:50.541284 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:70]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:51:50.543370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f02660a-d226-42f9-8288-3e1012026059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec6616990>]}
[0m17:51:50.546026 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 2.56s]
[0m17:51:50.548825 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:51:50.550878 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:51:50.553508 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:51:50.558312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:51:50.560701 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:51:50.569571 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:51:50.575627 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:51:50.562311 => 17:51:50.571472
[0m17:51:50.582504 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:51:50.603672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:51.090650 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:51:51.092645 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:51:51.314003 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:00e7fa63-1f4b-48b6-a3a5-35c4e2500e5d&page=queryresults
[0m17:51:52.942597 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:51:50.585142 => 17:51:52.942101
[0m17:51:52.944446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f02660a-d226-42f9-8288-3e1012026059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec626ce60>]}
[0m17:51:52.946186 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.39s]
[0m17:51:52.947833 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:51:52.948941 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:51:52.950129 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:51:52.951839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:51:52.953177 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:51:52.957108 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:51:52.959108 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:51:52.954206 => 17:51:52.958201
[0m17:51:52.960260 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:51:52.965107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:53.444853 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:51:53.446624 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:51:53.721765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ed29bd8e-cdcd-4954-8524-934562f1c814&page=queryresults
[0m17:51:55.301769 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:51:52.961042 => 17:51:55.301270
[0m17:51:55.303585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f02660a-d226-42f9-8288-3e1012026059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec41eb050>]}
[0m17:51:55.304967 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.35s]
[0m17:51:55.306518 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:51:55.309729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:55.310563 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:51:55.312111 [info ] [MainThread]: 
[0m17:51:55.313816 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 16.28 seconds (16.28s).
[0m17:51:55.316944 [debug] [MainThread]: Command end result
[0m17:51:55.340077 [info ] [MainThread]: 
[0m17:51:55.342253 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:51:55.343778 [info ] [MainThread]: 
[0m17:51:55.345427 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:70]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:51:55.351182 [info ] [MainThread]: 
[0m17:51:55.356894 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:51:55.359694 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 17.6068, "process_user_time": 6.230052, "process_kernel_time": 0.283957, "process_mem_max_rss": "130380", "process_in_blocks": "8", "process_out_blocks": "1936", "command_success": false}
[0m17:51:55.361302 [debug] [MainThread]: Command `dbt run` failed at 17:51:55.360933 after 17.61 seconds
[0m17:51:55.362419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ecc203620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec41cab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec41081a0>]}
[0m17:51:55.364598 [debug] [MainThread]: Flushing usage events
[0m17:52:24.509305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e77bd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e83d2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e8842060>]}


============================== 17:52:24.514520 | bf5b647c-a419-4d41-94ba-65bca4d4e0af ==============================
[0m17:52:24.514520 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:52:24.515864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:52:25.350986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf5b647c-a419-4d41-94ba-65bca4d4e0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e5c43bf0>]}
[0m17:52:25.525807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf5b647c-a419-4d41-94ba-65bca4d4e0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e5a62de0>]}
[0m17:52:25.527229 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:52:25.542896 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:52:25.626764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:52:25.628174 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:52:25.972596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf5b647c-a419-4d41-94ba-65bca4d4e0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e591ecc0>]}
[0m17:52:25.986518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf5b647c-a419-4d41-94ba-65bca4d4e0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e5adf080>]}
[0m17:52:25.987645 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:52:25.988686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf5b647c-a419-4d41-94ba-65bca4d4e0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e589ecf0>]}
[0m17:52:25.991686 [info ] [MainThread]: 
[0m17:52:25.993509 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:52:25.997140 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:52:25.998306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:26.509853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:52:26.510953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:26.941919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf5b647c-a419-4d41-94ba-65bca4d4e0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e589f560>]}
[0m17:52:26.943716 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:26.944806 [info ] [MainThread]: 
[0m17:52:26.948723 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:52:26.950167 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:52:26.952907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:52:26.954204 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:52:26.971433 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:52:26.980543 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:52:26.954914 => 17:52:26.977328
[0m17:52:26.984377 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:52:27.075861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:27.569873 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:52:27.571733 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:52:27.840262 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0b973578-a299-4ace-a518-a3e39bb981b5&page=queryresults
[0m17:52:29.784443 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:52:26.986228 => 17:52:29.783545
[0m17:52:29.787305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b647c-a419-4d41-94ba-65bca4d4e0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e5ea1d90>]}
[0m17:52:29.789535 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.84s]
[0m17:52:29.791948 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:52:29.793653 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:52:29.795737 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:52:29.799005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:52:29.800581 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:52:29.806292 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:52:29.809176 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:52:29.801602 => 17:52:29.807849
[0m17:52:29.810895 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:52:29.818986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:30.268122 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:52:30.269661 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

with ranked_cte AS (
    SELECT base.base_name AS `Base Name`,
          raw.dispatching_base_num AS `Dispatching Base Number`,
          RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY COUNT(raw.pickup_date)) AS `Rank`,
          COUNT(raw.pickup_date) AS `Count`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
    GROUP BY base.base_name, raw.dispatching_base_num
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m17:52:30.505359 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:25a89499-7649-4112-8a80-6b766cbfeb4d&page=queryresults
[0m17:52:32.380115 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:52:29.811582 => 17:52:32.379615
[0m17:52:32.383506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b647c-a419-4d41-94ba-65bca4d4e0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e5150fb0>]}
[0m17:52:32.386570 [info ] [Thread-1 (]: 2 of 4 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (8.0 rows, 217.8 MiB processed)[0m in 2.59s]
[0m17:52:32.390093 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:52:32.392663 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:52:32.396085 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:52:32.400614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:52:32.403164 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:52:32.412479 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:52:32.417005 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:52:32.405276 => 17:52:32.414881
[0m17:52:32.419251 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:52:32.429635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:32.930039 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:52:32.931778 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:52:33.150892 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:73f3e5b4-bb6a-499f-8773-a0cc8f559f4a&page=queryresults
[0m17:52:35.193556 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:52:32.420489 => 17:52:35.190121
[0m17:52:35.202134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b647c-a419-4d41-94ba-65bca4d4e0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e5981670>]}
[0m17:52:35.224426 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.80s]
[0m17:52:35.231544 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:52:35.245902 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:52:35.256888 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:52:35.267448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:52:35.283060 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:52:35.313969 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:52:35.321638 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:52:35.286990 => 17:52:35.319530
[0m17:52:35.330712 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:52:35.344014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:36.140781 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:52:36.146559 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:52:36.392981 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:855346e6-f069-47cd-8ced-5d8259e1293e&page=queryresults
[0m17:52:38.322600 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:52:35.334511 => 17:52:38.321751
[0m17:52:38.325767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5b647c-a419-4d41-94ba-65bca4d4e0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e59818b0>]}
[0m17:52:38.332379 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.06s]
[0m17:52:38.341987 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:52:38.363023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:38.365112 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:52:38.367260 [info ] [MainThread]: 
[0m17:52:38.369756 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.37 seconds (12.37s).
[0m17:52:38.375811 [debug] [MainThread]: Command end result
[0m17:52:38.519049 [info ] [MainThread]: 
[0m17:52:38.521541 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:52:38.523910 [info ] [MainThread]: 
[0m17:52:38.526202 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:52:38.540452 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.106522, "process_user_time": 6.762833, "process_kernel_time": 0.315872, "process_mem_max_rss": "135380", "process_out_blocks": "2848", "process_in_blocks": "0"}
[0m17:52:38.544394 [debug] [MainThread]: Command `dbt run` succeeded at 17:52:38.543586 after 14.11 seconds
[0m17:52:38.546714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e77ebda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e584ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e5181010>]}
[0m17:52:38.548950 [debug] [MainThread]: Flushing usage events
[0m17:54:39.157431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f10896c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0e832f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0e46dd90>]}


============================== 17:54:39.162554 | da583377-b8bc-48bf-9f04-aa4c24cd51ba ==============================
[0m17:54:39.162554 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:54:39.163926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:54:40.079793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da583377-b8bc-48bf-9f04-aa4c24cd51ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0ccdee40>]}
[0m17:54:40.262074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da583377-b8bc-48bf-9f04-aa4c24cd51ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0f5f3d40>]}
[0m17:54:40.263593 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:54:40.284797 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:54:40.372541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:40.373782 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:54:40.731089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da583377-b8bc-48bf-9f04-aa4c24cd51ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0c9ad640>]}
[0m17:54:40.745233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da583377-b8bc-48bf-9f04-aa4c24cd51ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0c7b78c0>]}
[0m17:54:40.746352 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:54:40.747360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da583377-b8bc-48bf-9f04-aa4c24cd51ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0f6489b0>]}
[0m17:54:40.750498 [info ] [MainThread]: 
[0m17:54:40.752365 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:54:40.755881 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:54:40.757017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:41.252076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:54:41.253134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:41.680865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da583377-b8bc-48bf-9f04-aa4c24cd51ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0c5ca1e0>]}
[0m17:54:41.683132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:41.684206 [info ] [MainThread]: 
[0m17:54:41.688110 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:54:41.689801 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:54:41.693738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:54:41.697679 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:54:41.726020 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:54:41.733932 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:54:41.699369 => 17:54:41.732734
[0m17:54:41.741882 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:54:41.839423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:42.337150 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:54:42.339448 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:54:42.637359 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:fffc048e-3f01-486e-8b73-068a67ec46bf&page=queryresults
[0m17:54:44.566303 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:54:41.745720 => 17:54:44.565453
[0m17:54:44.569214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da583377-b8bc-48bf-9f04-aa4c24cd51ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0c9d3620>]}
[0m17:54:44.571233 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.88s]
[0m17:54:44.572820 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:54:44.573982 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:54:44.575269 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:54:44.576946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:54:44.578599 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:54:44.582633 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:54:44.584769 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:54:44.579533 => 17:54:44.583635
[0m17:54:44.587107 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:54:44.597490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:45.102250 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:54:45.103989 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

with ranked_cte AS (
    SELECT base.base_name AS `Base Name`,
          raw.dispatching_base_num AS `Dispatching Base Number`,
          RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY raw.pickup_date) AS `Rank`,
          COUNT(raw.pickup_date) AS `Count`
          raw.pickup_date AS `Pick Up Date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
    GROUP BY base.base_name, raw.dispatching_base_num, raw.pickup_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m17:54:45.226348 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:80778867-e329-452b-a148-bda8204a7252&page=queryresults
[0m17:54:45.228610 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "raw" at [20:11]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "raw" at [20:11]')
[0m17:54:45.367253 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:23a03b6d-3ec9-4ad4-88a0-2b4449340a17&page=queryresults
[0m17:54:45.368578 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:23a03b6d-3ec9-4ad4-88a0-2b4449340a17&page=queryresults
[0m17:54:45.370260 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:54:44.588789 => 17:54:45.369692
[0m17:54:45.385132 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Syntax error: Expected ")" but got identifier "raw" at [20:11]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:54:45.387800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da583377-b8bc-48bf-9f04-aa4c24cd51ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0c040c50>]}
[0m17:54:45.390921 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 0.81s]
[0m17:54:45.393976 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:54:45.396371 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:54:45.399824 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:54:45.408583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:54:45.412461 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:54:45.429119 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:54:45.432594 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:54:45.414625 => 17:54:45.431403
[0m17:54:45.435347 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:54:45.452355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:45.932580 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:54:45.934382 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:54:46.154072 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f5c84c5e-150c-4b48-9fe5-cfcaf23ca078&page=queryresults
[0m17:54:47.798391 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:54:45.436868 => 17:54:47.797056
[0m17:54:47.801988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da583377-b8bc-48bf-9f04-aa4c24cd51ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0c041490>]}
[0m17:54:47.803805 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.40s]
[0m17:54:47.806439 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:54:47.808282 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:54:47.810593 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:54:47.814479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:54:47.816687 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:54:47.837606 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:54:47.846440 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:54:47.820142 => 17:54:47.842754
[0m17:54:47.851214 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:54:47.868157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:48.367895 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:54:48.369869 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:54:48.601023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8a7f227c-d39e-49b9-be0f-f1a017bb6c57&page=queryresults
[0m17:54:50.491051 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:54:47.853570 => 17:54:50.489419
[0m17:54:50.495516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da583377-b8bc-48bf-9f04-aa4c24cd51ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f05b3fb90>]}
[0m17:54:50.498444 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.68s]
[0m17:54:50.501883 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:54:50.509270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:50.510298 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:54:50.511327 [info ] [MainThread]: 
[0m17:54:50.512382 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.76 seconds (9.76s).
[0m17:54:50.515633 [debug] [MainThread]: Command end result
[0m17:54:50.653261 [info ] [MainThread]: 
[0m17:54:50.654425 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:54:50.655442 [info ] [MainThread]: 
[0m17:54:50.656472 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Syntax error: Expected ")" but got identifier "raw" at [20:11]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:54:50.657518 [info ] [MainThread]: 
[0m17:54:50.658543 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:54:50.661002 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.579062, "process_user_time": 7.776346, "process_kernel_time": 0.381163, "process_mem_max_rss": "136480", "process_out_blocks": "2848", "command_success": false, "process_in_blocks": "0"}
[0m17:54:50.663083 [debug] [MainThread]: Command `dbt run` failed at 17:54:50.662732 after 11.58 seconds
[0m17:54:50.664085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f05b2cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f05b2c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f05b2e360>]}
[0m17:54:50.665767 [debug] [MainThread]: Flushing usage events
[0m17:55:15.279120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9e841880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9eac6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9e841790>]}


============================== 17:55:15.284199 | 832bdbcf-9009-415c-aba8-b110f93d0c09 ==============================
[0m17:55:15.284199 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:55:15.285613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:55:16.161810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '832bdbcf-9009-415c-aba8-b110f93d0c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9cd38e60>]}
[0m17:55:16.339574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '832bdbcf-9009-415c-aba8-b110f93d0c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9ca33b90>]}
[0m17:55:16.341082 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:55:16.362887 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:55:16.467110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:55:16.468564 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:55:16.822549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '832bdbcf-9009-415c-aba8-b110f93d0c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9d0ca6c0>]}
[0m17:55:16.837812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '832bdbcf-9009-415c-aba8-b110f93d0c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9caeb140>]}
[0m17:55:16.838856 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:55:16.839863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '832bdbcf-9009-415c-aba8-b110f93d0c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9e840980>]}
[0m17:55:16.842886 [info ] [MainThread]: 
[0m17:55:16.845741 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:55:16.849462 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:55:16.850902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:17.370283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:55:17.371439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:17.820705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '832bdbcf-9009-415c-aba8-b110f93d0c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9ceddc10>]}
[0m17:55:17.822514 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:17.823495 [info ] [MainThread]: 
[0m17:55:17.827478 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:55:17.828961 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:55:17.832562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:55:17.834244 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:55:17.850637 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:55:17.858771 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:55:17.834954 => 17:55:17.856260
[0m17:55:17.862669 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:55:17.954195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:18.446775 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:55:18.448267 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:55:18.691835 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a686077d-a0c0-4e96-8fc5-4a6c15e03cc5&page=queryresults
[0m17:55:20.599791 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:55:17.865133 => 17:55:20.599275
[0m17:55:20.602281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '832bdbcf-9009-415c-aba8-b110f93d0c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9ca33b90>]}
[0m17:55:20.604634 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.77s]
[0m17:55:20.607529 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:55:20.609314 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:55:20.611143 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:55:20.614892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:55:20.617740 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:55:20.626950 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:55:20.630900 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:55:20.619617 => 17:55:20.629218
[0m17:55:20.632874 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:55:20.643939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:21.102299 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:55:21.104056 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

with ranked_cte AS (
    SELECT base.base_name AS `Base Name`,
          raw.dispatching_base_num AS `Dispatching Base Number`,
          RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY raw.pickup_date) AS `Rank`,
          COUNT(raw.pickup_date) AS `Count`,
          raw.pickup_date AS `Pick Up Date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
    GROUP BY base.base_name, raw.dispatching_base_num, raw.pickup_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m17:55:21.320420 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:94647438-e04f-42f7-92c3-3ae8bb481152&page=queryresults
[0m17:55:27.763278 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:55:20.634026 => 17:55:27.762160
[0m17:55:27.767613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '832bdbcf-9009-415c-aba8-b110f93d0c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9c991eb0>]}
[0m17:55:27.770974 [info ] [Thread-1 (]: 2 of 4 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (24.0 rows, 217.8 MiB processed)[0m in 7.15s]
[0m17:55:27.774595 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:55:27.777161 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:55:27.781858 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:55:27.789004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:55:27.793895 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:55:27.811745 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:55:27.816715 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:55:27.797052 => 17:55:27.814786
[0m17:55:27.820431 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:55:27.835640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:28.327365 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:55:28.328852 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:55:28.572708 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:2126cfca-06db-4b92-8389-9194ede59f9c&page=queryresults
[0m17:55:30.655982 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:55:27.822956 => 17:55:30.654626
[0m17:55:30.691560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '832bdbcf-9009-415c-aba8-b110f93d0c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9c9918e0>]}
[0m17:55:30.701432 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.91s]
[0m17:55:30.719629 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:55:30.740740 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:55:30.760226 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:55:30.779553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:55:30.790938 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:55:30.813521 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:55:30.825951 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:55:30.794012 => 17:55:30.819071
[0m17:55:30.828523 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:55:30.840127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:31.495731 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:55:31.498838 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:55:31.754064 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:701f0715-122a-4abe-a405-12f9fe2d355f&page=queryresults
[0m17:55:33.613680 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:55:30.830233 => 17:55:33.613189
[0m17:55:33.616037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '832bdbcf-9009-415c-aba8-b110f93d0c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b8ff96ea0>]}
[0m17:55:33.617593 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.84s]
[0m17:55:33.619520 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:55:33.625026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:33.626868 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:55:33.628603 [info ] [MainThread]: 
[0m17:55:33.630483 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 16.78 seconds (16.78s).
[0m17:55:33.634567 [debug] [MainThread]: Command end result
[0m17:55:33.756763 [info ] [MainThread]: 
[0m17:55:33.767370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:33.770101 [info ] [MainThread]: 
[0m17:55:33.778423 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:55:33.801609 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.590075, "process_user_time": 6.843729, "process_kernel_time": 0.310979, "process_mem_max_rss": "133440", "process_out_blocks": "2848", "process_in_blocks": "0"}
[0m17:55:33.815386 [debug] [MainThread]: Command `dbt run` succeeded at 17:55:33.814472 after 18.61 seconds
[0m17:55:33.817415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9c8d39e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b8ff8b7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b8ff8bb00>]}
[0m17:55:33.832490 [debug] [MainThread]: Flushing usage events
[0m17:57:29.277187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969bbbc260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969be72720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969c01f200>]}


============================== 17:57:29.282314 | cec98c76-ca48-4f99-b5b0-1dd3244a003d ==============================
[0m17:57:29.282314 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:57:29.283708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:57:30.123093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cec98c76-ca48-4f99-b5b0-1dd3244a003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969a0bc5f0>]}
[0m17:57:30.298172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cec98c76-ca48-4f99-b5b0-1dd3244a003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969bbec5f0>]}
[0m17:57:30.299605 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:57:30.314860 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:57:30.409274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:57:30.411385 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:57:30.760559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cec98c76-ca48-4f99-b5b0-1dd3244a003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9699d1ed80>]}
[0m17:57:30.775346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cec98c76-ca48-4f99-b5b0-1dd3244a003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9699edb1a0>]}
[0m17:57:30.776416 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:57:30.777755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec98c76-ca48-4f99-b5b0-1dd3244a003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9699ed8710>]}
[0m17:57:30.781016 [info ] [MainThread]: 
[0m17:57:30.783331 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:57:30.785967 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:57:30.786919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:31.372983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:57:31.374201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:31.807230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec98c76-ca48-4f99-b5b0-1dd3244a003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9699fc1ee0>]}
[0m17:57:31.809191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:31.810329 [info ] [MainThread]: 
[0m17:57:31.815893 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:57:31.818163 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:57:31.821289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:57:31.823015 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:57:31.850093 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:57:31.859673 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:57:31.824300 => 17:57:31.855794
[0m17:57:31.864785 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:57:31.949466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:32.432482 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:57:32.434282 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:57:32.694605 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:5745afae-dfa6-40ab-9103-737def0767e3&page=queryresults
[0m17:57:34.606841 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:57:31.866189 => 17:57:34.606344
[0m17:57:34.608663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec98c76-ca48-4f99-b5b0-1dd3244a003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9699cbe9f0>]}
[0m17:57:34.610066 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.79s]
[0m17:57:34.611809 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:57:34.612934 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:57:34.614268 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:57:34.616055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:57:34.618011 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:57:34.624843 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:57:34.627551 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:57:34.619320 => 17:57:34.626414
[0m17:57:34.629597 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:57:34.639102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:35.112186 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:57:35.113610 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

with ranked_cte AS (
    SELECT base.base_name AS `Base Name`,
          raw.dispatching_base_num AS `Dispatching Base Number`,
          RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY DATE(raw.pickup_date)) AS `Rank`,
          COUNT(DATE(raw.pickup_date)) AS `Count`,
          DATE(raw.pickup_date) AS `Pick Up Date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
    GROUP BY base.base_name, raw.dispatching_base_num
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m17:57:35.378216 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:25a94ee4-258f-4f1e-b357-29b23df13044&page=queryresults
[0m17:57:35.535195 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]; reason: invalidQuery, location: query, message: Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]')
[0m17:57:36.708991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4fd75376-0553-4d7e-8c6d-098bfa0be47f&page=queryresults
[0m17:57:36.851398 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4fd75376-0553-4d7e-8c6d-098bfa0be47f&page=queryresults
[0m17:57:36.853088 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:57:34.630896 => 17:57:36.852514
[0m17:57:36.863537 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:57:36.865210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec98c76-ca48-4f99-b5b0-1dd3244a003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9699d7e090>]}
[0m17:57:36.866810 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 2.25s]
[0m17:57:36.868763 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:57:36.870089 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:57:36.872127 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:57:36.876185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:57:36.878262 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:57:36.894646 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:57:36.903854 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:57:36.879720 => 17:57:36.896673
[0m17:57:36.909162 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:57:36.920901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:37.394718 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:57:37.396130 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:57:37.648708 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:703cb9dc-685e-46f5-a650-7bc0195759a1&page=queryresults
[0m17:57:39.242718 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:57:36.911321 => 17:57:39.242205
[0m17:57:39.244652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec98c76-ca48-4f99-b5b0-1dd3244a003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969bcab7d0>]}
[0m17:57:39.246121 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.37s]
[0m17:57:39.247835 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:57:39.248990 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:57:39.250351 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:57:39.252382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:57:39.254298 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:57:39.261773 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:57:39.264484 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:57:39.255714 => 17:57:39.263348
[0m17:57:39.266566 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:57:39.275765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:39.756465 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:57:39.757990 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:57:39.967563 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4f011122-f7d9-40f2-95a7-8280827a037b&page=queryresults
[0m17:57:41.835636 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:57:39.267792 => 17:57:41.835152
[0m17:57:41.837463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec98c76-ca48-4f99-b5b0-1dd3244a003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969846f800>]}
[0m17:57:41.838743 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.59s]
[0m17:57:41.840391 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:57:41.843660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:41.845236 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:57:41.847298 [info ] [MainThread]: 
[0m17:57:41.849387 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.06 seconds (11.06s).
[0m17:57:41.854269 [debug] [MainThread]: Command end result
[0m17:57:41.932678 [info ] [MainThread]: 
[0m17:57:41.937523 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:57:41.943263 [info ] [MainThread]: 
[0m17:57:41.948226 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:57:41.951629 [info ] [MainThread]: 
[0m17:57:41.959997 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:57:41.966323 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.765888, "process_user_time": 6.375848, "process_kernel_time": 0.308886, "process_mem_max_rss": "136448", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m17:57:41.973448 [debug] [MainThread]: Command `dbt run` failed at 17:57:41.971884 after 12.77 seconds
[0m17:57:41.975409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969f9bb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969baced50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9698481370>]}
[0m17:57:41.976626 [debug] [MainThread]: Flushing usage events
[0m17:58:07.872017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293e738980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293e7388f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293e73b4d0>]}


============================== 17:58:07.877111 | db81a006-0f77-405d-9899-166f776f247c ==============================
[0m17:58:07.877111 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:58:07.878490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:58:08.719718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db81a006-0f77-405d-9899-166f776f247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293cc56210>]}
[0m17:58:08.893687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db81a006-0f77-405d-9899-166f776f247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293e73aa50>]}
[0m17:58:08.895137 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:58:08.910555 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:58:08.996001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:58:08.997530 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:58:09.342634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db81a006-0f77-405d-9899-166f776f247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293c8fae40>]}
[0m17:58:09.356776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db81a006-0f77-405d-9899-166f776f247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293ca87b60>]}
[0m17:58:09.357870 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:58:09.358953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db81a006-0f77-405d-9899-166f776f247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293ca87920>]}
[0m17:58:09.362012 [info ] [MainThread]: 
[0m17:58:09.364990 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:58:09.368761 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:58:09.370025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:09.868946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:58:09.870029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:10.287040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db81a006-0f77-405d-9899-166f776f247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293ca85e80>]}
[0m17:58:10.288846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:10.289875 [info ] [MainThread]: 
[0m17:58:10.293774 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:58:10.295333 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:58:10.297987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:58:10.299113 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:58:10.315840 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:58:10.324616 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:58:10.299782 => 17:58:10.322105
[0m17:58:10.328304 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:58:10.421957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:10.905293 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:58:10.907103 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:58:11.089736 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:76421c4f-9dee-4401-a36e-c6fb0ce6b0c2&page=queryresults
[0m17:58:13.291331 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:58:10.331081 => 17:58:13.290434
[0m17:58:13.294241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db81a006-0f77-405d-9899-166f776f247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293c950da0>]}
[0m17:58:13.296274 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 3.00s]
[0m17:58:13.298781 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:58:13.300822 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:58:13.302745 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:58:13.306092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:58:13.307831 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:58:13.313153 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:58:13.316359 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:58:13.308817 => 17:58:13.314881
[0m17:58:13.318697 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:58:13.329251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:13.771222 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:58:13.772960 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

with ranked_cte AS (
    SELECT base.base_name AS `Base Name`,
          raw.dispatching_base_num AS `Dispatching Base Number`,
          RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY DATE(raw.pickup_date)) AS `Rank`,
          COUNT(DATE(raw.pickup_date)) AS `Count`,
          DATE(raw.pickup_date) AS `Pick Up Date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
    GROUP BY base.base_name, raw.dispatching_base_num, DATE(raw.pickup_date)
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m17:58:13.978252 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:16adde1a-6f83-4e2f-bbe9-c3f0f266c8b5&page=queryresults
[0m17:58:14.131920 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]; reason: invalidQuery, location: query, message: Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]')
[0m17:58:14.798859 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ea1dcf5c-01a0-4916-8ec0-dedc271f174e&page=queryresults
[0m17:58:14.919121 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ea1dcf5c-01a0-4916-8ec0-dedc271f174e&page=queryresults
[0m17:58:14.922170 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:58:13.319670 => 17:58:14.920924
[0m17:58:14.946616 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:58:14.949336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db81a006-0f77-405d-9899-166f776f247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293c12b950>]}
[0m17:58:14.952837 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.64s]
[0m17:58:14.958881 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:58:14.963384 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:58:14.967408 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:58:14.982317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:58:14.986126 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:58:15.006780 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:58:15.011202 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:58:14.989797 => 17:58:15.009816
[0m17:58:15.015868 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:58:15.032218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:15.525515 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:58:15.526912 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:58:15.721487 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:dd0eb05e-d8ca-4cfc-a017-25adca8cf9b2&page=queryresults
[0m17:58:17.599297 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:58:15.018534 => 17:58:17.598722
[0m17:58:17.603779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db81a006-0f77-405d-9899-166f776f247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293c925be0>]}
[0m17:58:17.607885 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.63s]
[0m17:58:17.611943 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:58:17.613618 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:58:17.614880 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:58:17.617602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:58:17.619390 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:58:17.623811 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:58:17.626047 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:58:17.620099 => 17:58:17.625222
[0m17:58:17.627250 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:58:17.633447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:18.104252 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:58:18.105656 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:58:18.290209 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8bd40e5d-0aa8-4096-b7bb-da6ad0a58241&page=queryresults
[0m17:58:19.869616 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:58:17.628058 => 17:58:19.868465
[0m17:58:19.874056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db81a006-0f77-405d-9899-166f776f247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2935d0eba0>]}
[0m17:58:19.877173 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.26s]
[0m17:58:19.881075 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:58:19.886697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:19.887822 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:58:19.888804 [info ] [MainThread]: 
[0m17:58:19.890131 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.53 seconds (10.53s).
[0m17:58:19.892951 [debug] [MainThread]: Command end result
[0m17:58:19.975805 [info ] [MainThread]: 
[0m17:58:19.979118 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:58:19.982549 [info ] [MainThread]: 
[0m17:58:19.985190 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:58:19.990946 [info ] [MainThread]: 
[0m17:58:19.994363 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:58:19.996905 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.200811, "process_user_time": 6.513903, "process_kernel_time": 0.295632, "process_mem_max_rss": "138404", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m17:58:20.001539 [debug] [MainThread]: Command `dbt run` failed at 17:58:19.999249 after 12.20 seconds
[0m17:58:20.006458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293ed9ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2935d1da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2935d1f170>]}
[0m17:58:20.008752 [debug] [MainThread]: Flushing usage events
[0m17:59:39.934469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd2143fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd11e9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd0fbeff0>]}


============================== 17:59:39.939530 | 87961c90-1940-4b08-affb-f807ba62a870 ==============================
[0m17:59:39.939530 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:59:39.940980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:59:40.792795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87961c90-1940-4b08-affb-f807ba62a870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd0fe9550>]}
[0m17:59:40.965075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87961c90-1940-4b08-affb-f807ba62a870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdcf232930>]}
[0m17:59:40.966488 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m17:59:40.981974 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:59:41.075283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:41.076165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:41.086096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87961c90-1940-4b08-affb-f807ba62a870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdcfa15bb0>]}
[0m17:59:41.099737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87961c90-1940-4b08-affb-f807ba62a870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdcf28d640>]}
[0m17:59:41.100919 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m17:59:41.102051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87961c90-1940-4b08-affb-f807ba62a870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdcfb74560>]}
[0m17:59:41.105049 [info ] [MainThread]: 
[0m17:59:41.106929 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:59:41.110646 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m17:59:41.111969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:41.638484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m17:59:41.639509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:42.077631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87961c90-1940-4b08-affb-f807ba62a870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdcf28d430>]}
[0m17:59:42.079846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:42.081193 [info ] [MainThread]: 
[0m17:59:42.085374 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:59:42.086745 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m17:59:42.089339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m17:59:42.090615 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:59:42.106168 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:59:42.113081 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 17:59:42.091400 => 17:59:42.109793
[0m17:59:42.118085 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:59:42.205757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:42.730588 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m17:59:42.732156 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m17:59:42.931904 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:48d95871-c834-4990-b42e-8ec8ad59adf2&page=queryresults
[0m17:59:44.568881 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 17:59:42.120170 => 17:59:44.568326
[0m17:59:44.570721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87961c90-1940-4b08-affb-f807ba62a870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdcf069cd0>]}
[0m17:59:44.572102 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.48s]
[0m17:59:44.573682 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m17:59:44.575441 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:59:44.577506 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m17:59:44.580191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m17:59:44.582314 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:59:44.589184 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:59:44.592146 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 17:59:44.583476 => 17:59:44.591025
[0m17:59:44.594071 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:59:44.783881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:45.215977 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m17:59:45.217599 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

with ranked_cte AS (
    SELECT base.base_name AS `Base Name`,
          raw.dispatching_base_num AS `Dispatching Base Number`,
          RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY DATE(raw.pickup_date)) AS `Rank`,
          COUNT(DATE(raw.pickup_date)) AS `Count`,
          DATE(raw.pickup_date) AS `Pick Up Date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
    GROUP BY base.base_name, raw.dispatching_base_num, DATE(raw.pickup_date)
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m17:59:45.417147 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f119155a-4584-4f70-830a-364e9892ad4f&page=queryresults
[0m17:59:45.565787 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]; reason: invalidQuery, location: query, message: Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]')
[0m17:59:46.552021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0a527d70-81d8-4b31-b6bc-0ff0a130b0a1&page=queryresults
[0m17:59:46.674205 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0a527d70-81d8-4b31-b6bc-0ff0a130b0a1&page=queryresults
[0m17:59:46.675827 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 17:59:44.595335 => 17:59:46.675265
[0m17:59:46.685797 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:59:46.687109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87961c90-1940-4b08-affb-f807ba62a870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdcf4feb10>]}
[0m17:59:46.688843 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 2.11s]
[0m17:59:46.690724 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m17:59:46.692006 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:59:46.694252 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m17:59:46.698091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m17:59:46.701737 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:59:46.710023 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:59:46.712720 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 17:59:46.703276 => 17:59:46.711635
[0m17:59:46.715047 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:59:46.743706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:47.216591 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m17:59:47.218232 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m17:59:47.404516 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1207211b-cb88-462d-889f-d6aed2451db1&page=queryresults
[0m17:59:49.288223 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 17:59:46.722412 => 17:59:49.287228
[0m17:59:49.291381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87961c90-1940-4b08-affb-f807ba62a870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdcf1ac470>]}
[0m17:59:49.293708 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.59s]
[0m17:59:49.297034 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m17:59:49.299844 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:59:49.304166 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m17:59:49.308600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m17:59:49.311165 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:59:49.320047 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:59:49.323414 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 17:59:49.312924 => 17:59:49.322168
[0m17:59:49.325533 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:59:49.337728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:49.829766 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m17:59:49.831921 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m17:59:50.068509 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:af94f100-be1a-4796-887d-43bfe659a677&page=queryresults
[0m17:59:51.938913 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 17:59:49.326735 => 17:59:51.937758
[0m17:59:51.942265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87961c90-1940-4b08-affb-f807ba62a870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdcf1ac3b0>]}
[0m17:59:51.944862 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.64s]
[0m17:59:51.947663 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m17:59:51.958077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:51.963876 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m17:59:51.969233 [info ] [MainThread]: 
[0m17:59:51.972122 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.86 seconds (10.86s).
[0m17:59:51.976974 [debug] [MainThread]: Command end result
[0m17:59:52.025252 [info ] [MainThread]: 
[0m17:59:52.036106 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:59:52.041685 [info ] [MainThread]: 
[0m17:59:52.044921 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m17:59:52.053660 [info ] [MainThread]: 
[0m17:59:52.059500 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:59:52.078404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.21455, "process_user_time": 6.291981, "process_kernel_time": 0.27335, "process_mem_max_rss": "130532", "process_out_blocks": "1928", "command_success": false, "process_in_blocks": "0"}
[0m17:59:52.089677 [debug] [MainThread]: Command `dbt run` failed at 17:59:52.087109 after 12.23 seconds
[0m17:59:52.096239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd0febb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdcf2d8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdcf1ac530>]}
[0m17:59:52.099482 [debug] [MainThread]: Flushing usage events
[0m18:01:16.092277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce1d5dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce1e4af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce1d5ffe0>]}


============================== 18:01:16.097471 | 8d4f7b7d-a43f-4c4e-9ccd-3122a7d9958d ==============================
[0m18:01:16.097471 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:01:16.098855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:01:16.976658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d4f7b7d-a43f-4c4e-9ccd-3122a7d9958d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce026b950>]}
[0m18:01:17.150908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d4f7b7d-a43f-4c4e-9ccd-3122a7d9958d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce0023e60>]}
[0m18:01:17.152342 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:01:17.168657 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:01:17.264050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:01:17.265374 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:01:17.608432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d4f7b7d-a43f-4c4e-9ccd-3122a7d9958d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccdfd27410>]}
[0m18:01:17.622322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d4f7b7d-a43f-4c4e-9ccd-3122a7d9958d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccdfeab140>]}
[0m18:01:17.623426 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:01:17.624597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d4f7b7d-a43f-4c4e-9ccd-3122a7d9958d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccdfeab950>]}
[0m18:01:17.627652 [info ] [MainThread]: 
[0m18:01:17.629778 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:01:17.633501 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:01:17.634748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:18.141341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:01:18.142422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:18.607333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d4f7b7d-a43f-4c4e-9ccd-3122a7d9958d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce01dac00>]}
[0m18:01:18.609495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:18.610907 [info ] [MainThread]: 
[0m18:01:18.615942 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:01:18.618019 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:01:18.620332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:01:18.621549 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:01:18.635211 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:01:18.642165 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:01:18.622233 => 18:01:18.641156
[0m18:01:18.646129 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:01:18.749593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:19.245738 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:01:19.247305 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:01:19.461564 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c8ba9135-ac80-443a-a5a4-1f2e7ea92398&page=queryresults
[0m18:01:21.699202 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:01:18.649632 => 18:01:21.698666
[0m18:01:21.701163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d4f7b7d-a43f-4c4e-9ccd-3122a7d9958d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce0023b90>]}
[0m18:01:21.702761 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 3.08s]
[0m18:01:21.705264 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:01:21.707061 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:01:21.709090 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:01:21.713174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:01:21.716061 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:01:21.725214 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:01:21.728632 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:01:21.717986 => 18:01:21.727247
[0m18:01:21.730864 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:01:21.747856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:22.306776 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:01:22.309704 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH ranked_cte AS (
    SELECT base.base_name AS `Base Name`,
          raw.dispatching_base_num AS `Dispatching Base Number`,
          RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY DATE(raw.pickup_date)) AS `Rank`,
          COUNT(*) AS `Count`,
          DATE(raw.pickup_date) AS `Pick Up Date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
    GROUP BY base.base_name, raw.dispatching_base_num, DATE(raw.pickup_date)
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3);
    );
  
[0m18:01:22.415963 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:503818ad-e13c-4655-be1e-3a3f23ccc505&page=queryresults
[0m18:01:22.418352 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [28:33]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [28:33]')
[0m18:01:23.362358 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:29e0a8c3-2415-4e9d-aff3-cdb14f01ab1c&page=queryresults
[0m18:01:23.363811 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:29e0a8c3-2415-4e9d-aff3-cdb14f01ab1c&page=queryresults
[0m18:01:23.365654 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:01:21.732173 => 18:01:23.365038
[0m18:01:23.381008 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Syntax error: Expected ")" but got ";" at [28:33]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:01:23.383460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d4f7b7d-a43f-4c4e-9ccd-3122a7d9958d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccdf554500>]}
[0m18:01:23.386428 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.67s]
[0m18:01:23.389070 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:01:23.390383 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:01:23.391938 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:01:23.395496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:01:23.397771 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:01:23.406410 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:01:23.415947 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:01:23.399214 => 18:01:23.412444
[0m18:01:23.418959 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:01:23.443547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:23.977584 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:01:23.979218 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:01:24.241035 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:fe5563d4-bb55-4da3-a9dd-0928539802a9&page=queryresults
[0m18:01:26.426955 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:01:23.420633 => 18:01:26.425776
[0m18:01:26.429230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d4f7b7d-a43f-4c4e-9ccd-3122a7d9958d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccdfd4d9a0>]}
[0m18:01:26.430590 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 3.04s]
[0m18:01:26.432249 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:01:26.433359 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:01:26.434606 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:01:26.436398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:01:26.438066 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:01:26.442056 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:01:26.443683 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:01:26.438920 => 18:01:26.443024
[0m18:01:26.444918 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:01:26.449430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:26.893845 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:01:26.895281 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:01:27.123259 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c7e844cc-b790-4fd8-9a6d-7c2e6fb503ee&page=queryresults
[0m18:01:29.015889 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:01:26.445617 => 18:01:29.014392
[0m18:01:29.019916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d4f7b7d-a43f-4c4e-9ccd-3122a7d9958d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce00942f0>]}
[0m18:01:29.021820 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.58s]
[0m18:01:29.023462 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:01:29.026732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:29.028301 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:01:29.029476 [info ] [MainThread]: 
[0m18:01:29.030512 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.40 seconds (11.40s).
[0m18:01:29.033375 [debug] [MainThread]: Command end result
[0m18:01:29.093865 [info ] [MainThread]: 
[0m18:01:29.096712 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:01:29.102768 [info ] [MainThread]: 
[0m18:01:29.108286 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Syntax error: Expected ")" but got ";" at [28:33]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:01:29.115374 [info ] [MainThread]: 
[0m18:01:29.123658 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:01:29.136000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.11809, "process_user_time": 6.457537, "process_kernel_time": 0.280339, "process_mem_max_rss": "134068", "process_out_blocks": "2848", "command_success": false, "process_in_blocks": "0"}
[0m18:01:29.141565 [debug] [MainThread]: Command `dbt run` failed at 18:01:29.140215 after 13.12 seconds
[0m18:01:29.145183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce1d5c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce03aa450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccdd449910>]}
[0m18:01:29.147935 [debug] [MainThread]: Flushing usage events
[0m18:01:46.141569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f459895d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4598a49820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f459895f590>]}


============================== 18:01:46.146703 | 0e53e285-5275-448c-829c-9331f7775cd9 ==============================
[0m18:01:46.146703 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:01:46.148161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:01:46.978464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e53e285-5275-448c-829c-9331f7775cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4596e01880>]}
[0m18:01:47.152256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e53e285-5275-448c-829c-9331f7775cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4596bf3d40>]}
[0m18:01:47.153669 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:01:47.170517 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:01:47.259397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:01:47.260682 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:01:47.604305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e53e285-5275-448c-829c-9331f7775cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4596b8a330>]}
[0m18:01:47.617935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e53e285-5275-448c-829c-9331f7775cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4596ae4d40>]}
[0m18:01:47.619037 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:01:47.620066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e53e285-5275-448c-829c-9331f7775cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4596bc6c30>]}
[0m18:01:47.623111 [info ] [MainThread]: 
[0m18:01:47.624978 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:01:47.628638 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:01:47.629895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:48.212295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:01:48.213443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:48.677561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e53e285-5275-448c-829c-9331f7775cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4596e9ac00>]}
[0m18:01:48.679289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:48.680352 [info ] [MainThread]: 
[0m18:01:48.684424 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:01:48.685812 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:01:48.688353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:01:48.689512 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:01:48.711658 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:01:48.720525 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:01:48.690174 => 18:01:48.718019
[0m18:01:48.725533 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:01:48.825890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:49.299426 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:01:49.300973 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:01:49.514256 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b94d8c84-0fe7-455d-8865-0dd9bcee23b5&page=queryresults
[0m18:01:52.068966 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:01:48.730220 => 18:01:52.068053
[0m18:01:52.071922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e53e285-5275-448c-829c-9331f7775cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4596c23b90>]}
[0m18:01:52.074009 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 3.38s]
[0m18:01:52.076510 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:01:52.078350 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:01:52.080450 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:01:52.083608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:01:52.085226 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:01:52.090483 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:01:52.092860 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:01:52.086133 => 18:01:52.091920
[0m18:01:52.094725 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:01:52.101401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:52.583949 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:01:52.585739 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH ranked_cte AS (
    SELECT base.base_name AS `Base Name`,
          raw.dispatching_base_num AS `Dispatching Base Number`,
          RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY DATE(raw.pickup_date)) AS `Rank`,
          COUNT(*) AS `Count`,
          DATE(raw.pickup_date) AS `Pick Up Date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
    GROUP BY base.base_name, raw.dispatching_base_num, DATE(raw.pickup_date)
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m18:01:52.789636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:9de309fa-a523-4eb4-b7d0-28f039709ae2&page=queryresults
[0m18:01:53.177154 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]; reason: invalidQuery, location: query, message: Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]')
[0m18:01:53.621219 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:9a260178-a052-4f4f-9560-0f28840e2535&page=queryresults
[0m18:01:53.770694 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:9a260178-a052-4f4f-9560-0f28840e2535&page=queryresults
[0m18:01:53.772423 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:01:52.095390 => 18:01:53.771837
[0m18:01:53.782783 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:01:53.784196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e53e285-5275-448c-829c-9331f7775cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4596d1f200>]}
[0m18:01:53.785864 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.70s]
[0m18:01:53.787517 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:01:53.788732 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:01:53.791151 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:01:53.795203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:01:53.800048 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:01:53.819101 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:01:53.829376 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:01:53.804288 => 18:01:53.825063
[0m18:01:53.833059 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:01:53.850446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:54.299082 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:01:54.301741 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:01:54.562774 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f8002e34-3ded-4aa7-9255-218d3fc45898&page=queryresults
[0m18:01:56.708147 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:01:53.835786 => 18:01:56.706939
[0m18:01:56.712677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e53e285-5275-448c-829c-9331f7775cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f459615d190>]}
[0m18:01:56.715726 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.92s]
[0m18:01:56.719185 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:01:56.721750 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:01:56.725835 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:01:56.730614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:01:56.733263 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:01:56.742497 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:01:56.746900 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:01:56.735411 => 18:01:56.744869
[0m18:01:56.749043 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:01:56.762542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:57.238139 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:01:57.239848 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:01:57.461435 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b343c752-cce7-431c-bd06-d4f0dd78071e&page=queryresults
[0m18:01:59.918189 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:01:56.750284 => 18:01:59.916982
[0m18:01:59.922633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e53e285-5275-448c-829c-9331f7775cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4594034470>]}
[0m18:01:59.925527 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.19s]
[0m18:01:59.929121 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:01:59.936803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:59.938632 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:01:59.940307 [info ] [MainThread]: 
[0m18:01:59.942051 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.32 seconds (12.32s).
[0m18:01:59.946510 [debug] [MainThread]: Command end result
[0m18:02:00.022126 [info ] [MainThread]: 
[0m18:02:00.027158 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:02:00.031890 [info ] [MainThread]: 
[0m18:02:00.038540 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:02:00.044424 [info ] [MainThread]: 
[0m18:02:00.048960 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:02:00.060026 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.993514, "process_user_time": 6.459779, "process_kernel_time": 0.315986, "process_mem_max_rss": "136244", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m18:02:00.065136 [debug] [MainThread]: Command `dbt run` failed at 18:02:00.063145 after 14.00 seconds
[0m18:02:00.069807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f459c5bb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4599892150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4594049d90>]}
[0m18:02:00.073366 [debug] [MainThread]: Flushing usage events
[0m18:03:16.151031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2028cc9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2029363b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2028dac8c0>]}


============================== 18:03:16.156008 | 52e2e750-a036-44ff-aa2c-fc607a83f573 ==============================
[0m18:03:16.156008 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:03:16.157342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:03:17.065985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52e2e750-a036-44ff-aa2c-fc607a83f573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20271954c0>]}
[0m18:03:17.239504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52e2e750-a036-44ff-aa2c-fc607a83f573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2027837920>]}
[0m18:03:17.241001 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:03:17.262811 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:03:17.353325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:03:17.354198 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:03:17.364308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52e2e750-a036-44ff-aa2c-fc607a83f573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2027570ad0>]}
[0m18:03:17.378287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52e2e750-a036-44ff-aa2c-fc607a83f573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026fc7c20>]}
[0m18:03:17.379454 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:03:17.380486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52e2e750-a036-44ff-aa2c-fc607a83f573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20290889b0>]}
[0m18:03:17.383471 [info ] [MainThread]: 
[0m18:03:17.385341 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:03:17.389024 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:03:17.390181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:17.942397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:03:17.943396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:18.369168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52e2e750-a036-44ff-aa2c-fc607a83f573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20270106b0>]}
[0m18:03:18.370836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:03:18.372044 [info ] [MainThread]: 
[0m18:03:18.376095 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:03:18.377471 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:03:18.379976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:03:18.381151 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:03:18.394525 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:03:18.397161 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:03:18.381899 => 18:03:18.396264
[0m18:03:18.400134 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:03:18.470785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:18.987256 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:03:18.989277 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:03:19.236753 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:aefb40e3-8455-4c15-85a7-5bba2cf81a1b&page=queryresults
[0m18:03:21.241313 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:03:18.401256 => 18:03:21.240500
[0m18:03:21.243698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52e2e750-a036-44ff-aa2c-fc607a83f573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2027044230>]}
[0m18:03:21.245622 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.86s]
[0m18:03:21.247695 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:03:21.248855 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:03:21.250176 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:03:21.252492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:03:21.253998 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:03:21.258174 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:03:21.260165 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:03:21.254808 => 18:03:21.259327
[0m18:03:21.261368 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:03:21.437965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:21.879626 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:03:21.881424 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH ranked_cte AS (
    SELECT base.base_name AS `Base Name`,
          raw.dispatching_base_num AS `Dispatching Base Number`,
          RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY DATE(raw.pickup_date)) AS `Rank`,
          COUNT(*) AS `Count`,
          DATE(raw.pickup_date) AS `Pick Up Date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
    GROUP BY base.base_name, raw.dispatching_base_num, DATE(raw.pickup_date)
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m18:03:22.083630 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0539b7bc-a14d-47a2-8652-db8f2473b2e3&page=queryresults
[0m18:03:22.234830 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]; reason: invalidQuery, location: query, message: Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]')
[0m18:03:22.730805 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:88acb41e-fe3e-4321-bcd1-273c0cddbb7f&page=queryresults
[0m18:03:22.863250 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:88acb41e-fe3e-4321-bcd1-273c0cddbb7f&page=queryresults
[0m18:03:22.865574 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:03:21.262119 => 18:03:22.864753
[0m18:03:22.877025 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:03:22.878275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52e2e750-a036-44ff-aa2c-fc607a83f573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026f4e990>]}
[0m18:03:22.879790 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.63s]
[0m18:03:22.882283 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:03:22.884770 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:03:22.887236 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:03:22.890643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:03:22.892863 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:03:22.901012 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:03:22.903551 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:03:22.894489 => 18:03:22.902528
[0m18:03:22.905490 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:03:22.918586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:23.432832 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:03:23.434691 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:03:23.716093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e31c6e91-e34f-444b-a238-f860091f4a2e&page=queryresults
[0m18:03:25.566283 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:03:22.906889 => 18:03:25.565760
[0m18:03:25.568042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52e2e750-a036-44ff-aa2c-fc607a83f573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026e96360>]}
[0m18:03:25.569450 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.68s]
[0m18:03:25.571060 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:03:25.572160 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:03:25.573358 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:03:25.576072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:03:25.578951 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:03:25.586303 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:03:25.589929 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:03:25.580519 => 18:03:25.588375
[0m18:03:25.592490 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:03:25.601012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:26.065916 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:03:26.067840 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:03:26.314562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:62988566-f34d-4b75-b27e-8d205e964086&page=queryresults
[0m18:03:28.171260 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:03:25.593923 => 18:03:28.170703
[0m18:03:28.173073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52e2e750-a036-44ff-aa2c-fc607a83f573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026e96720>]}
[0m18:03:28.174427 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.60s]
[0m18:03:28.175969 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:03:28.179245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:28.180168 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:03:28.181446 [info ] [MainThread]: 
[0m18:03:28.182963 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.80 seconds (10.80s).
[0m18:03:28.185775 [debug] [MainThread]: Command end result
[0m18:03:28.203216 [info ] [MainThread]: 
[0m18:03:28.208803 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:03:28.214182 [info ] [MainThread]: 
[0m18:03:28.217495 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Window ORDER BY expression references raw.pickup_date which is neither grouped nor aggregated at [18:75]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:03:28.223600 [info ] [MainThread]: 
[0m18:03:28.228897 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:03:28.233605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.158321, "process_user_time": 6.248216, "process_kernel_time": 0.329459, "process_mem_max_rss": "130172", "process_out_blocks": "1936", "command_success": false, "process_in_blocks": "0"}
[0m18:03:28.238610 [debug] [MainThread]: Command `dbt run` failed at 18:03:28.237976 after 12.16 seconds
[0m18:03:28.240505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2028cf7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026d63e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026fc5be0>]}
[0m18:03:28.242476 [debug] [MainThread]: Flushing usage events
[0m18:03:49.464413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e64444d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e65ced20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e6447410>]}


============================== 18:03:49.469492 | f8f5e20b-36f9-4655-a06b-12b55f55fd2a ==============================
[0m18:03:49.469492 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:03:49.471338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:03:50.302097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8f5e20b-36f9-4655-a06b-12b55f55fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e485b590>]}
[0m18:03:50.473168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8f5e20b-36f9-4655-a06b-12b55f55fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e4715c70>]}
[0m18:03:50.474639 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:03:50.491444 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:03:50.582976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:03:50.584197 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:03:50.926388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8f5e20b-36f9-4655-a06b-12b55f55fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e43fea80>]}
[0m18:03:50.940533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8f5e20b-36f9-4655-a06b-12b55f55fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e459a9f0>]}
[0m18:03:50.941823 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:03:50.942802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8f5e20b-36f9-4655-a06b-12b55f55fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e4989d00>]}
[0m18:03:50.945856 [info ] [MainThread]: 
[0m18:03:50.948526 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:03:50.952236 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:03:50.953431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:51.525206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:03:51.526287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:51.973917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8f5e20b-36f9-4655-a06b-12b55f55fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e47ebe00>]}
[0m18:03:51.975688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:03:51.976825 [info ] [MainThread]: 
[0m18:03:51.981090 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:03:51.983251 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:03:51.985292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:03:51.986329 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:03:52.004415 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:03:52.012138 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:03:51.986966 => 18:03:52.010203
[0m18:03:52.014489 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:03:52.108898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:52.587790 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:03:52.589601 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:03:52.777250 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:dc6166e3-3611-465c-b078-a7efc53841e8&page=queryresults
[0m18:03:54.683063 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:03:52.016449 => 18:03:54.682174
[0m18:03:54.685996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f5e20b-36f9-4655-a06b-12b55f55fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e44651c0>]}
[0m18:03:54.688195 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.70s]
[0m18:03:54.690788 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:03:54.692482 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:03:54.694437 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:03:54.697831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:03:54.699558 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:03:54.705009 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:03:54.707715 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:03:54.700489 => 18:03:54.706508
[0m18:03:54.708927 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:03:54.716201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:55.200615 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:03:55.202408 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH ranked_cte AS (
    SELECT base.base_name AS `Base Name`,
          raw.dispatching_base_num AS `Dispatching Base Number`,
          RANK() OVER(PARTITION BY raw.dispatching_base_num ORDER BY DATE(raw.pickup_date)) AS `Rank`,
          COUNT(*) AS `Count`,
          DATE(raw.pickup_date) AS `Pick Up Date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
    GROUP BY base.base_name, raw.dispatching_base_num, raw.pickup_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m18:03:55.398465 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f9023ca1-48da-4be9-bacb-8f1b5dc5d8d4&page=queryresults
[0m18:04:02.165517 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:03:54.709564 => 18:04:02.165012
[0m18:04:02.167480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f5e20b-36f9-4655-a06b-12b55f55fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e4439ac0>]}
[0m18:04:02.168859 [info ] [Thread-1 (]: 2 of 4 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (49.0k rows, 217.8 MiB processed)[0m in 7.47s]
[0m18:04:02.170491 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:04:02.171889 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:04:02.173282 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:04:02.175901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:04:02.177194 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:04:02.182025 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:04:02.184325 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:04:02.177956 => 18:04:02.183403
[0m18:04:02.185499 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:04:02.191845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:02.684662 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:04:02.686390 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:04:02.865832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0cf70c71-9bcf-4de2-9249-266f8d4e6779&page=queryresults
[0m18:04:05.601074 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:04:02.186156 => 18:04:05.600526
[0m18:04:05.602884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f5e20b-36f9-4655-a06b-12b55f55fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e1c38740>]}
[0m18:04:05.604219 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 3.43s]
[0m18:04:05.605875 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:04:05.606933 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:04:05.608172 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:04:05.609933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:04:05.611769 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:04:05.616019 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:04:05.617639 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:04:05.612731 => 18:04:05.616968
[0m18:04:05.618927 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:04:05.623363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:06.074175 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:04:06.075835 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:04:06.340937 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:892239d9-7882-444c-bc98-c48128d311bb&page=queryresults
[0m18:04:08.201672 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:04:05.619659 => 18:04:08.201164
[0m18:04:08.203631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f5e20b-36f9-4655-a06b-12b55f55fd2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e4464170>]}
[0m18:04:08.205224 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.59s]
[0m18:04:08.207232 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:04:08.214773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:08.216184 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:04:08.218075 [info ] [MainThread]: 
[0m18:04:08.219683 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 17.27 seconds (17.27s).
[0m18:04:08.224312 [debug] [MainThread]: Command end result
[0m18:04:08.296037 [info ] [MainThread]: 
[0m18:04:08.304810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:08.309475 [info ] [MainThread]: 
[0m18:04:08.311483 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:04:08.320935 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.931293, "process_user_time": 6.309136, "process_kernel_time": 0.299581, "process_mem_max_rss": "133204", "process_out_blocks": "2848", "process_in_blocks": "0"}
[0m18:04:08.326393 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:08.324717 after 18.94 seconds
[0m18:04:08.329386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e6608ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e1c53c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e1c53350>]}
[0m18:04:08.336712 [debug] [MainThread]: Flushing usage events
[0m18:10:29.446450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6bb449bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6bb8ebe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6bb53e6c0>]}


============================== 18:10:29.452186 | 2c6c5e13-ffd1-4737-a2fd-22e91495934a ==============================
[0m18:10:29.452186 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:10:29.453508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:10:30.321382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c6c5e13-ffd1-4737-a2fd-22e91495934a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b98f6e40>]}
[0m18:10:30.499497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c6c5e13-ffd1-4737-a2fd-22e91495934a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b9b77350>]}
[0m18:10:30.500971 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:10:30.522042 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:10:30.625042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:10:30.626368 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:10:30.987414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c6c5e13-ffd1-4737-a2fd-22e91495934a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b93a48f0>]}
[0m18:10:31.001808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c6c5e13-ffd1-4737-a2fd-22e91495934a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b95932f0>]}
[0m18:10:31.002855 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:10:31.003972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c6c5e13-ffd1-4737-a2fd-22e91495934a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b95907d0>]}
[0m18:10:31.007054 [info ] [MainThread]: 
[0m18:10:31.008963 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:10:31.013094 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:10:31.014993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:31.585818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:10:31.586922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:32.073883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c6c5e13-ffd1-4737-a2fd-22e91495934a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b9592060>]}
[0m18:10:32.075932 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:32.077305 [info ] [MainThread]: 
[0m18:10:32.083548 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:10:32.085229 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:10:32.087230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:10:32.088335 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:10:32.111607 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:10:32.116117 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:10:32.088978 => 18:10:32.114915
[0m18:10:32.120288 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:10:32.184901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:32.705059 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:10:32.706546 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:10:32.952959 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ba2e2cbf-b503-4861-9cc9-f4373cd000ba&page=queryresults
[0m18:10:34.889371 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:10:32.124303 => 18:10:34.888358
[0m18:10:34.892372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6c5e13-ffd1-4737-a2fd-22e91495934a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b9645c70>]}
[0m18:10:34.894449 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.81s]
[0m18:10:34.896111 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:10:34.897492 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:10:34.898889 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:10:34.901305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:10:34.902689 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:10:34.906436 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:10:34.908493 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:10:34.903569 => 18:10:34.907546
[0m18:10:34.910163 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:10:34.919171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:35.408418 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:10:35.410213 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `Base_Name`,
          raw.dispatching_base_num AS `Dispatching_Base_Number`,
          DATE(raw.pickup_date) AS `Pick_Up_Date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
)

with rank_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY pickup_date) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pickup_date
)


SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m18:10:35.521709 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:9e46ac71-1db4-4986-9b90-8de94deb4621&page=queryresults
[0m18:10:35.523296 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword DEPTH but got identifier "rank_cte" at [23:6]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword DEPTH but got identifier "rank_cte" at [23:6]')
[0m18:10:35.659082 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e1bcb9e1-5387-462d-a13c-478cd3c2d1cd&page=queryresults
[0m18:10:35.660329 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e1bcb9e1-5387-462d-a13c-478cd3c2d1cd&page=queryresults
[0m18:10:35.662012 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:10:34.911525 => 18:10:35.661343
[0m18:10:35.677530 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Syntax error: Expected keyword DEPTH but got identifier "rank_cte" at [23:6]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:10:35.679668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6c5e13-ffd1-4737-a2fd-22e91495934a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b8240b00>]}
[0m18:10:35.682329 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 0.78s]
[0m18:10:35.685071 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:10:35.687302 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:10:35.690499 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:10:35.698029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:10:35.703584 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:10:35.721592 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:10:35.728875 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:10:35.705826 => 18:10:35.726301
[0m18:10:35.732001 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:10:35.750656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:36.240948 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:10:36.242589 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:10:36.483284 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1cd34873-652f-421b-a5df-302ef4e01bd4&page=queryresults
[0m18:10:38.379899 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:10:35.734920 => 18:10:38.379243
[0m18:10:38.382816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6c5e13-ffd1-4737-a2fd-22e91495934a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b9439b50>]}
[0m18:10:38.384652 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.69s]
[0m18:10:38.386635 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:10:38.388055 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:10:38.389589 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:10:38.392702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:10:38.394227 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:10:38.400259 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:10:38.402980 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:10:38.395245 => 18:10:38.401957
[0m18:10:38.404710 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:10:38.410573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:38.907647 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:10:38.910374 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:10:39.163537 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:2bb3a9a2-2245-4b4e-8306-687db14e8b8b&page=queryresults
[0m18:10:41.035686 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:10:38.405771 => 18:10:41.035022
[0m18:10:41.037542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6c5e13-ffd1-4737-a2fd-22e91495934a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b8147ec0>]}
[0m18:10:41.038886 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.65s]
[0m18:10:41.040514 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:10:41.043733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:41.044629 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:10:41.045785 [info ] [MainThread]: 
[0m18:10:41.047759 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.04 seconds (10.04s).
[0m18:10:41.052491 [debug] [MainThread]: Command end result
[0m18:10:41.143845 [info ] [MainThread]: 
[0m18:10:41.147643 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:10:41.149621 [info ] [MainThread]: 
[0m18:10:41.153762 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Syntax error: Expected keyword DEPTH but got identifier "rank_cte" at [23:6]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:10:41.161961 [info ] [MainThread]: 
[0m18:10:41.165334 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:10:41.173092 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.840619, "process_user_time": 6.825556, "process_kernel_time": 0.321509, "process_mem_max_rss": "135992", "process_out_blocks": "2848", "command_success": false, "process_in_blocks": "0"}
[0m18:10:41.177194 [debug] [MainThread]: Command `dbt run` failed at 18:10:41.175788 after 11.84 seconds
[0m18:10:41.183798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6bb27fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b81386b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b813b9b0>]}
[0m18:10:41.186997 [debug] [MainThread]: Flushing usage events
[0m18:11:02.341838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81aad20230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81aae896a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ab9ba0f0>]}


============================== 18:11:02.346912 | 74149b20-e575-45f7-94bb-f375fb7866e6 ==============================
[0m18:11:02.346912 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:11:02.348349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:11:03.311448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74149b20-e575-45f7-94bb-f375fb7866e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a8f87f80>]}
[0m18:11:03.495355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74149b20-e575-45f7-94bb-f375fb7866e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a90133b0>]}
[0m18:11:03.496770 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:11:03.512458 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:11:03.611385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:11:03.612687 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:11:03.984705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74149b20-e575-45f7-94bb-f375fb7866e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a91154c0>]}
[0m18:11:03.998832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74149b20-e575-45f7-94bb-f375fb7866e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a8e93500>]}
[0m18:11:03.999865 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:11:04.000978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74149b20-e575-45f7-94bb-f375fb7866e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a8c3e150>]}
[0m18:11:04.003916 [info ] [MainThread]: 
[0m18:11:04.006736 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:11:04.010364 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:11:04.011675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:04.802992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:11:04.804166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:05.243745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74149b20-e575-45f7-94bb-f375fb7866e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81aab50440>]}
[0m18:11:05.245455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:05.246515 [info ] [MainThread]: 
[0m18:11:05.250468 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:11:05.251736 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:11:05.254280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:11:05.255480 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:11:05.274245 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:11:05.284790 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:11:05.256138 => 18:11:05.282132
[0m18:11:05.288628 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:11:05.405215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:05.862856 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:11:05.864692 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:11:06.113822 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:109b25d8-2d06-4e03-a3c5-481858c00661&page=queryresults
[0m18:11:08.902940 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:11:05.293770 => 18:11:08.901966
[0m18:11:08.905931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74149b20-e575-45f7-94bb-f375fb7866e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a9bbbe00>]}
[0m18:11:08.908470 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 3.65s]
[0m18:11:08.911313 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:11:08.913511 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:11:08.916514 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:11:08.919649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:11:08.921667 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:11:08.929078 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:11:08.932090 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:11:08.923001 => 18:11:08.930937
[0m18:11:08.934899 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:11:08.945158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:09.444136 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:11:09.447822 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `Base_Name`,
          raw.dispatching_base_num AS `Dispatching_Base_Number`,
          DATE(raw.pickup_date) AS `Pick_Up_Date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
)

with ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY pickup_date) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pickup_date
)


SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m18:11:09.551445 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:eb488a35-8a76-4aff-a611-970b044072aa&page=queryresults
[0m18:11:09.553463 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword DEPTH but got identifier "ranked_cte" at [23:6]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword DEPTH but got identifier "ranked_cte" at [23:6]')
[0m18:11:10.286699 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e8f9598b-243e-47cd-b28e-017f2e47d9fa&page=queryresults
[0m18:11:10.288450 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e8f9598b-243e-47cd-b28e-017f2e47d9fa&page=queryresults
[0m18:11:10.290410 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:11:08.936201 => 18:11:10.289662
[0m18:11:10.302247 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Syntax error: Expected keyword DEPTH but got identifier "ranked_cte" at [23:6]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:11:10.303523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74149b20-e575-45f7-94bb-f375fb7866e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a8e00350>]}
[0m18:11:10.305138 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.39s]
[0m18:11:10.306846 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:11:10.308045 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:11:10.311365 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:11:10.323895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:11:10.328054 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:11:10.340895 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:11:10.349534 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:11:10.329726 => 18:11:10.346550
[0m18:11:10.353306 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:11:10.367472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:10.891735 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:11:10.893271 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:11:11.107006 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a30bce49-6cb0-4aaf-adc9-9027c46f1bd3&page=queryresults
[0m18:11:13.284233 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:11:10.354646 => 18:11:13.283666
[0m18:11:13.286226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74149b20-e575-45f7-94bb-f375fb7866e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a8d40e90>]}
[0m18:11:13.287710 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.97s]
[0m18:11:13.289392 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:11:13.290525 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:11:13.291826 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:11:13.294196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:11:13.295955 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:11:13.300222 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:11:13.302487 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:11:13.296708 => 18:11:13.301391
[0m18:11:13.303794 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:11:13.309313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:13.751097 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:11:13.752769 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:11:13.991260 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:9bc1f19e-649d-483f-ba03-9793d105f40d&page=queryresults
[0m18:11:16.804864 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:11:13.304801 => 18:11:16.804368
[0m18:11:16.806722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74149b20-e575-45f7-94bb-f375fb7866e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a8d41220>]}
[0m18:11:16.808345 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.51s]
[0m18:11:16.809963 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:11:16.814893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:16.816259 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:11:16.817463 [info ] [MainThread]: 
[0m18:11:16.818692 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.81 seconds (12.81s).
[0m18:11:16.821642 [debug] [MainThread]: Command end result
[0m18:11:16.875395 [info ] [MainThread]: 
[0m18:11:16.881450 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:11:16.884553 [info ] [MainThread]: 
[0m18:11:16.891932 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Syntax error: Expected keyword DEPTH but got identifier "ranked_cte" at [23:6]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:11:16.899909 [info ] [MainThread]: 
[0m18:11:16.903039 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:11:16.915962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.648805, "process_user_time": 6.81047, "process_kernel_time": 0.342441, "process_mem_max_rss": "134304", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m18:11:16.923072 [debug] [MainThread]: Command `dbt run` failed at 18:11:16.922108 after 14.66 seconds
[0m18:11:16.931553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81aad20320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a8f530e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a821b3b0>]}
[0m18:11:16.936337 [debug] [MainThread]: Flushing usage events
[0m18:12:41.680448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc88eff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc8b277a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc88ed9a0>]}


============================== 18:12:41.685812 | 03de5f20-ea9f-42e8-b087-a19d8be8486d ==============================
[0m18:12:41.685812 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:12:41.687254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:12:42.628833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03de5f20-ea9f-42e8-b087-a19d8be8486d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc6e7acf0>]}
[0m18:12:42.807636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03de5f20-ea9f-42e8-b087-a19d8be8486d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc6ffe870>]}
[0m18:12:42.809122 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:12:42.830574 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:12:42.923416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:12:42.924745 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:12:43.279894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03de5f20-ea9f-42e8-b087-a19d8be8486d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc6c64b30>]}
[0m18:12:43.294278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03de5f20-ea9f-42e8-b087-a19d8be8486d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc6ba36e0>]}
[0m18:12:43.295408 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:12:43.296471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03de5f20-ea9f-42e8-b087-a19d8be8486d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc69989b0>]}
[0m18:12:43.299476 [info ] [MainThread]: 
[0m18:12:43.301332 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:12:43.305101 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:12:43.306359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:43.803248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:12:43.804354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:44.245306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03de5f20-ea9f-42e8-b087-a19d8be8486d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc6ba1e20>]}
[0m18:12:44.247037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:44.248132 [info ] [MainThread]: 
[0m18:12:44.252564 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:12:44.254400 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:12:44.257130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:12:44.258290 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:12:44.279861 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:12:44.288165 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:12:44.258956 => 18:12:44.286140
[0m18:12:44.293255 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:12:44.405906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:44.892631 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:12:44.895616 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:12:45.090816 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:708072d3-cd19-4bcd-90de-0902aba9ccc5&page=queryresults
[0m18:12:47.004922 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:12:44.299515 => 18:12:47.004404
[0m18:12:47.006649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de5f20-ea9f-42e8-b087-a19d8be8486d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc69f8200>]}
[0m18:12:47.008025 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.75s]
[0m18:12:47.009670 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:12:47.010914 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:12:47.012226 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:12:47.014054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:12:47.015733 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:12:47.019627 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:12:47.021567 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:12:47.016633 => 18:12:47.020623
[0m18:12:47.022777 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:12:47.027607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:47.523802 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:12:47.525516 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `Base_Name`,
          raw.dispatching_base_num AS `Dispatching_Base_Number`,
          DATE(raw.pickup_date) AS `Pick_Up_Date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY pickup_date) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pickup_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m18:12:47.620025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f9e15965-f61c-49a3-a510-0b324211f89c&page=queryresults
[0m18:12:47.621375 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "RANK" at [25:12]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "RANK" at [25:12]')
[0m18:12:47.760024 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:72039774-7b19-447c-bc1b-1f6b8ceed951&page=queryresults
[0m18:12:47.761453 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:72039774-7b19-447c-bc1b-1f6b8ceed951&page=queryresults
[0m18:12:47.763415 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:12:47.023527 => 18:12:47.762757
[0m18:12:47.774673 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Syntax error: Expected ")" but got identifier "RANK" at [25:12]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:12:47.775997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de5f20-ea9f-42e8-b087-a19d8be8486d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc6fff800>]}
[0m18:12:47.777723 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 0.76s]
[0m18:12:47.779879 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:12:47.781321 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:12:47.783392 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:12:47.790867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:12:47.796561 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:12:47.811363 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:12:47.814962 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:12:47.798480 => 18:12:47.813791
[0m18:12:47.816880 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:12:47.826823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:48.338081 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:12:48.339519 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:12:48.541796 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:11fc2727-63cc-42df-aece-1a8737724b16&page=queryresults
[0m18:12:50.394518 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:12:47.818267 => 18:12:50.392828
[0m18:12:50.399650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de5f20-ea9f-42e8-b087-a19d8be8486d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc6a4d640>]}
[0m18:12:50.402301 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.61s]
[0m18:12:50.405569 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:12:50.407823 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:12:50.410354 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:12:50.416090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:12:50.419473 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:12:50.430788 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:12:50.435039 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:12:50.421582 => 18:12:50.433306
[0m18:12:50.437826 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:12:50.448917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:50.931675 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:12:50.933205 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:12:51.154464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e6408f8f-0d7d-4405-8320-c1f914947c18&page=queryresults
[0m18:12:53.029324 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:12:50.439552 => 18:12:53.028834
[0m18:12:53.031185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de5f20-ea9f-42e8-b087-a19d8be8486d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc4167fe0>]}
[0m18:12:53.032508 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.62s]
[0m18:12:53.034148 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:12:53.037319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:53.038259 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:12:53.039676 [info ] [MainThread]: 
[0m18:12:53.041737 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.74 seconds (9.74s).
[0m18:12:53.046279 [debug] [MainThread]: Command end result
[0m18:12:53.139380 [info ] [MainThread]: 
[0m18:12:53.147622 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:12:53.154843 [info ] [MainThread]: 
[0m18:12:53.159770 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Syntax error: Expected ")" but got identifier "RANK" at [25:12]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:12:53.163747 [info ] [MainThread]: 
[0m18:12:53.167604 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:12:53.175924 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.576514, "process_user_time": 6.748215, "process_kernel_time": 0.372244, "process_mem_max_rss": "136288", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m18:12:53.179412 [debug] [MainThread]: Command `dbt run` failed at 18:12:53.178421 after 11.58 seconds
[0m18:12:53.182377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc891bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc6cfed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc41567b0>]}
[0m18:12:53.186544 [debug] [MainThread]: Flushing usage events
[0m18:13:55.288753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2934ccc770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2935051700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2934ccc500>]}


============================== 18:13:55.293800 | 5adadbdc-4c91-4242-bdb4-89e7952eb666 ==============================
[0m18:13:55.293800 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:13:55.295473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:13:56.137916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5adadbdc-4c91-4242-bdb4-89e7952eb666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2933195b80>]}
[0m18:13:56.309140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5adadbdc-4c91-4242-bdb4-89e7952eb666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2932f468d0>]}
[0m18:13:56.310567 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:13:56.327057 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:13:56.419055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:13:56.420337 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:13:56.761476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5adadbdc-4c91-4242-bdb4-89e7952eb666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293307f200>]}
[0m18:13:56.776188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5adadbdc-4c91-4242-bdb4-89e7952eb666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2932fbc140>]}
[0m18:13:56.777275 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:13:56.778441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5adadbdc-4c91-4242-bdb4-89e7952eb666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2934ccc7a0>]}
[0m18:13:56.781511 [info ] [MainThread]: 
[0m18:13:56.783374 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:13:56.786977 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:13:56.788541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:57.287944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:13:57.289041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:57.736859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5adadbdc-4c91-4242-bdb4-89e7952eb666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2932d6a3c0>]}
[0m18:13:57.739440 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:57.741119 [info ] [MainThread]: 
[0m18:13:57.747153 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:13:57.748691 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:13:57.750625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:13:57.751849 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:13:57.776442 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:13:57.782571 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:13:57.752528 => 18:13:57.781082
[0m18:13:57.788420 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:13:57.882478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:58.369528 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:13:58.371069 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:13:58.593459 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1f0315d7-288c-465c-89d1-32d483199692&page=queryresults
[0m18:14:00.636544 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:13:57.791907 => 18:14:00.636027
[0m18:14:00.638451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5adadbdc-4c91-4242-bdb4-89e7952eb666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2932f46ff0>]}
[0m18:14:00.640094 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.89s]
[0m18:14:00.641820 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:14:00.642968 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:14:00.644328 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:14:00.646056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:14:00.647605 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:14:00.651615 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:14:00.653220 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:14:00.648562 => 18:14:00.652579
[0m18:14:00.654461 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:14:00.659758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:01.121133 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:14:01.123357 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `Base_Name`,
          raw.dispatching_base_num AS `Dispatching_Base_Number`,
          DATE(raw.pickup_date) AS `Pick_Up_Date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY pickup_date) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pickup_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m18:14:01.338901 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:be20e517-c077-4125-bab0-a099972f3424&page=queryresults
[0m18:14:01.483220 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: dispatching_base_num; Did you mean Dispatching_Base_Number? at [24:12]; reason: invalidQuery, location: query, message: Unrecognized name: dispatching_base_num; Did you mean Dispatching_Base_Number? at [24:12]')
[0m18:14:02.472756 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:2e368beb-1923-4e7e-a242-269230d29bfb&page=queryresults
[0m18:14:02.610653 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:2e368beb-1923-4e7e-a242-269230d29bfb&page=queryresults
[0m18:14:02.614411 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:14:00.655210 => 18:14:02.613036
[0m18:14:02.644194 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Unrecognized name: dispatching_base_num; Did you mean Dispatching_Base_Number? at [24:12]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:14:02.646186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5adadbdc-4c91-4242-bdb4-89e7952eb666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293267fd10>]}
[0m18:14:02.648743 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 2.00s]
[0m18:14:02.652160 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:14:02.655355 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:14:02.657976 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:14:02.669557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:14:02.673220 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:14:02.694293 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:14:02.698969 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:14:02.675342 => 18:14:02.697128
[0m18:14:02.703728 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:14:02.716743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:03.206448 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:14:03.208138 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:14:03.661036 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:562ca053-6d90-4833-8412-6a8b774f09b9&page=queryresults
[0m18:14:05.530570 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:14:02.706574 => 18:14:05.530017
[0m18:14:05.532677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5adadbdc-4c91-4242-bdb4-89e7952eb666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2932e6d460>]}
[0m18:14:05.534148 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.87s]
[0m18:14:05.535867 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:14:05.537100 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:14:05.538492 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:14:05.540423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:14:05.542263 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:14:05.546925 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:14:05.549013 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:14:05.543201 => 18:14:05.548159
[0m18:14:05.550287 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:14:05.555323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:06.023746 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:14:06.025165 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:14:06.233325 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1e6bfbe7-6c5e-47e8-af47-ed1485bdcc28&page=queryresults
[0m18:14:08.114546 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:14:05.551159 => 18:14:08.113934
[0m18:14:08.117741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5adadbdc-4c91-4242-bdb4-89e7952eb666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2932e6d460>]}
[0m18:14:08.120591 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.58s]
[0m18:14:08.123972 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:14:08.132274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:08.134475 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:14:08.136622 [info ] [MainThread]: 
[0m18:14:08.138381 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.35 seconds (11.35s).
[0m18:14:08.141444 [debug] [MainThread]: Command end result
[0m18:14:08.193505 [info ] [MainThread]: 
[0m18:14:08.201073 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:14:08.205035 [info ] [MainThread]: 
[0m18:14:08.210335 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Unrecognized name: dispatching_base_num; Did you mean Dispatching_Base_Number? at [24:12]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:14:08.213554 [info ] [MainThread]: 
[0m18:14:08.218748 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:14:08.227926 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.013198, "process_user_time": 6.422522, "process_kernel_time": 0.287049, "process_mem_max_rss": "134228", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m18:14:08.233832 [debug] [MainThread]: Command `dbt run` failed at 18:14:08.232439 after 13.02 seconds
[0m18:14:08.238979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2934f76ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293556c9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293056e0c0>]}
[0m18:14:08.242512 [debug] [MainThread]: Flushing usage events
[0m18:15:10.355946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2571bbfe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2572222720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2571e20bc0>]}


============================== 18:15:10.361206 | ba339c20-9a67-40d2-9a8c-a9f7805c78d0 ==============================
[0m18:15:10.361206 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:15:10.362522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:15:11.203693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba339c20-9a67-40d2-9a8c-a9f7805c78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2571bea900>]}
[0m18:15:11.375817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba339c20-9a67-40d2-9a8c-a9f7805c78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2570078260>]}
[0m18:15:11.377250 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:15:11.393613 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:15:11.481206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:15:11.482449 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:15:11.825817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba339c20-9a67-40d2-9a8c-a9f7805c78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f256fd1fbf0>]}
[0m18:15:11.839689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba339c20-9a67-40d2-9a8c-a9f7805c78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f256febc230>]}
[0m18:15:11.840775 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:15:11.841818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba339c20-9a67-40d2-9a8c-a9f7805c78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f256fd6f260>]}
[0m18:15:11.844895 [info ] [MainThread]: 
[0m18:15:11.847307 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:15:11.850360 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:15:11.851575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:12.320921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:15:12.322255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:12.785281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba339c20-9a67-40d2-9a8c-a9f7805c78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2570579f70>]}
[0m18:15:12.787292 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:15:12.788442 [info ] [MainThread]: 
[0m18:15:12.792435 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:15:12.793819 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:15:12.796520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:15:12.797714 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:15:12.816006 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:15:12.825626 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:15:12.798410 => 18:15:12.823781
[0m18:15:12.828294 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:15:12.903512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:13.378246 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:15:13.379788 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:15:13.624783 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c5294c3f-caac-43e4-9a9e-290cc2773fa7&page=queryresults
[0m18:15:15.540149 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:15:12.829806 => 18:15:15.539290
[0m18:15:15.542905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba339c20-9a67-40d2-9a8c-a9f7805c78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f256fd5d490>]}
[0m18:15:15.544958 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.75s]
[0m18:15:15.547430 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:15:15.549084 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:15:15.550961 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:15:15.554255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:15:15.555923 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:15:15.561511 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:15:15.564400 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:15:15.556869 => 18:15:15.563245
[0m18:15:15.565665 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:15:15.570555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:16.061424 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:15:16.063137 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_number`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY pickup_date) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pickup_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m18:15:16.262485 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e99a1fd2-621b-4255-8dd2-c946978b0a59&page=queryresults
[0m18:15:16.425927 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: dispatching_base_num; Did you mean dispatching_base_number? at [24:12]; reason: invalidQuery, location: query, message: Unrecognized name: dispatching_base_num; Did you mean dispatching_base_number? at [24:12]')
[0m18:15:16.933628 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e9978aa0-f2ca-47cf-9d9c-7a6ef8d968bd&page=queryresults
[0m18:15:17.062895 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e9978aa0-f2ca-47cf-9d9c-7a6ef8d968bd&page=queryresults
[0m18:15:17.064682 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:15:15.566423 => 18:15:17.064102
[0m18:15:17.079514 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Unrecognized name: dispatching_base_num; Did you mean dispatching_base_number? at [24:12]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:15:17.081883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba339c20-9a67-40d2-9a8c-a9f7805c78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f256ffbac60>]}
[0m18:15:17.084512 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.53s]
[0m18:15:17.087292 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:15:17.089367 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:15:17.092487 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:15:17.096678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:15:17.100602 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:15:17.118596 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:15:17.128538 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:15:17.103962 => 18:15:17.127241
[0m18:15:17.136209 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:15:17.150265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:17.615597 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:15:17.619521 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:15:17.812252 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:59bfd1b6-f1a0-42c3-ab3e-7fb4bc822bcd&page=queryresults
[0m18:15:19.670597 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:15:17.138573 => 18:15:19.670094
[0m18:15:19.672557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba339c20-9a67-40d2-9a8c-a9f7805c78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f256f5939e0>]}
[0m18:15:19.673883 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.58s]
[0m18:15:19.675508 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:15:19.676583 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:15:19.677854 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:15:19.679664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:15:19.681046 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:15:19.686141 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:15:19.688113 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:15:19.682303 => 18:15:19.687305
[0m18:15:19.689932 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:15:19.694702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:20.158179 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:15:20.159807 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:15:20.371944 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e2c09ec5-792d-4b3c-8d49-39fe5036dc62&page=queryresults
[0m18:15:22.258748 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:15:19.690830 => 18:15:22.257622
[0m18:15:22.262897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba339c20-9a67-40d2-9a8c-a9f7805c78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f256f547230>]}
[0m18:15:22.265800 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.58s]
[0m18:15:22.268285 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:15:22.271518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:22.272371 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:15:22.273933 [info ] [MainThread]: 
[0m18:15:22.275914 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.43 seconds (10.43s).
[0m18:15:22.279082 [debug] [MainThread]: Command end result
[0m18:15:22.361367 [info ] [MainThread]: 
[0m18:15:22.364369 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:15:22.367173 [info ] [MainThread]: 
[0m18:15:22.371725 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Unrecognized name: dispatching_base_num; Did you mean dispatching_base_number? at [24:12]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:15:22.377965 [info ] [MainThread]: 
[0m18:15:22.383937 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:15:22.394481 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.114727, "process_user_time": 6.409343, "process_kernel_time": 0.287632, "process_mem_max_rss": "136412", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m18:15:22.403136 [debug] [MainThread]: Command `dbt run` failed at 18:15:22.401038 after 12.12 seconds
[0m18:15:22.406703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2571ca0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25700c8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f256d488d40>]}
[0m18:15:22.409237 [debug] [MainThread]: Flushing usage events
[0m18:15:40.177567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fe9ec03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4feac13140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fe9ec0200>]}


============================== 18:15:40.182895 | 628c6032-ecb3-4a0d-8a0c-a9e175f38f5c ==============================
[0m18:15:40.182895 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:15:40.184355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:15:41.033094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '628c6032-ecb3-4a0d-8a0c-a9e175f38f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fe857bfb0>]}
[0m18:15:41.208395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '628c6032-ecb3-4a0d-8a0c-a9e175f38f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fe812f470>]}
[0m18:15:41.209803 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:15:41.225297 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:15:41.348688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:15:41.351171 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:15:41.959677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '628c6032-ecb3-4a0d-8a0c-a9e175f38f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fe8023350>]}
[0m18:15:41.990378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '628c6032-ecb3-4a0d-8a0c-a9e175f38f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fe81d8140>]}
[0m18:15:41.992695 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:15:41.995051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '628c6032-ecb3-4a0d-8a0c-a9e175f38f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fe89fbe90>]}
[0m18:15:42.002130 [info ] [MainThread]: 
[0m18:15:42.006845 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:15:42.013430 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:15:42.015478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:42.557227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:15:42.558376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:43.036470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '628c6032-ecb3-4a0d-8a0c-a9e175f38f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fe81d9d60>]}
[0m18:15:43.038606 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:15:43.040073 [info ] [MainThread]: 
[0m18:15:43.044971 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:15:43.046942 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:15:43.050079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:15:43.052002 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:15:43.081824 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:15:43.087940 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:15:43.053135 => 18:15:43.086094
[0m18:15:43.095528 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:15:43.191471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:43.650283 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:15:43.651793 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:15:43.857645 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:62b21706-cfb7-4acf-94b8-dab0d5963723&page=queryresults
[0m18:15:45.769577 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:15:43.098934 => 18:15:45.768729
[0m18:15:45.772339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '628c6032-ecb3-4a0d-8a0c-a9e175f38f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fe9f1d610>]}
[0m18:15:45.774395 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.72s]
[0m18:15:45.776743 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:15:45.778372 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:15:45.780321 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:15:45.784173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:15:45.787055 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:15:45.796590 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:15:45.800264 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:15:45.788833 => 18:15:45.798813
[0m18:15:45.802319 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:15:45.812377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:46.417229 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:15:46.421671 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY pickup_date) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pickup_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m18:15:46.660192 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:6e86404c-0168-4049-b926-f89adfab3ab8&page=queryresults
[0m18:15:46.861128 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: pickup_date; Did you mean pick_up_date? at [25:67]; reason: invalidQuery, location: query, message: Unrecognized name: pickup_date; Did you mean pick_up_date? at [25:67]')
[0m18:15:47.657139 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:41b57fc5-4448-4080-ab29-5bd5a50a5e6d&page=queryresults
[0m18:15:47.869809 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:41b57fc5-4448-4080-ab29-5bd5a50a5e6d&page=queryresults
[0m18:15:47.873311 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:15:45.803433 => 18:15:47.872086
[0m18:15:47.889489 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Unrecognized name: pickup_date; Did you mean pick_up_date? at [25:67]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:15:47.890761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '628c6032-ecb3-4a0d-8a0c-a9e175f38f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fe768fc20>]}
[0m18:15:47.892105 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 2.11s]
[0m18:15:47.894031 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:15:47.896124 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:15:47.898991 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:15:47.903367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:15:47.907964 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:15:47.927030 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:15:47.934437 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:15:47.912174 => 18:15:47.932190
[0m18:15:47.938621 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:15:47.955618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:48.378652 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:15:48.380074 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:15:48.550256 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:56f6f861-c351-40b5-916b-6cc8c69c315b&page=queryresults
[0m18:15:50.390528 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:15:47.940193 => 18:15:50.390036
[0m18:15:50.392376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '628c6032-ecb3-4a0d-8a0c-a9e175f38f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fe8085370>]}
[0m18:15:50.393678 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.49s]
[0m18:15:50.395315 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:15:50.396392 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:15:50.397534 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:15:50.399491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:15:50.401431 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:15:50.415537 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:15:50.420206 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:15:50.403715 => 18:15:50.418403
[0m18:15:50.422419 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:15:50.431841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:50.890525 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:15:50.891970 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:15:51.084793 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:948c3306-f67e-4132-b3db-a2f7dd1a25c0&page=queryresults
[0m18:15:52.939355 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:15:50.423588 => 18:15:52.938865
[0m18:15:52.941149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '628c6032-ecb3-4a0d-8a0c-a9e175f38f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fe8085370>]}
[0m18:15:52.942463 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.54s]
[0m18:15:52.944103 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:15:52.947384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:52.948329 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:15:52.949842 [info ] [MainThread]: 
[0m18:15:52.951795 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.94 seconds (10.94s).
[0m18:15:52.956295 [debug] [MainThread]: Command end result
[0m18:15:53.032192 [info ] [MainThread]: 
[0m18:15:53.041858 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:15:53.046331 [info ] [MainThread]: 
[0m18:15:53.056000 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Unrecognized name: pickup_date; Did you mean pick_up_date? at [25:67]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:15:53.060218 [info ] [MainThread]: 
[0m18:15:53.065596 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:15:53.078155 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.975963, "process_user_time": 6.769211, "process_kernel_time": 0.306194, "process_mem_max_rss": "134208", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m18:15:53.083665 [debug] [MainThread]: Command `dbt run` failed at 18:15:53.082793 after 12.98 seconds
[0m18:15:53.089495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fe9ec03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fe8579820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fe5583530>]}
[0m18:15:53.094401 [debug] [MainThread]: Flushing usage events
[0m18:16:21.781815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb051fbc230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb052621820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0520aaf30>]}


============================== 18:16:21.786881 | f4848863-e8d3-4587-802b-34958a75d01e ==============================
[0m18:16:21.786881 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:16:21.788275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:16:22.612060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4848863-e8d3-4587-802b-34958a75d01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0504aa660>]}
[0m18:16:22.786666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4848863-e8d3-4587-802b-34958a75d01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05033bf20>]}
[0m18:16:22.788151 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:16:22.803434 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:16:22.893478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:16:22.894773 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:16:23.239363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4848863-e8d3-4587-802b-34958a75d01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05011f1a0>]}
[0m18:16:23.253500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4848863-e8d3-4587-802b-34958a75d01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0502cf380>]}
[0m18:16:23.254636 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:16:23.255695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4848863-e8d3-4587-802b-34958a75d01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05007e0f0>]}
[0m18:16:23.258720 [info ] [MainThread]: 
[0m18:16:23.260632 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:16:23.264037 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:16:23.265165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:23.782041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:16:23.783040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:24.222176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4848863-e8d3-4587-802b-34958a75d01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0502cdfa0>]}
[0m18:16:24.224450 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:16:24.225753 [info ] [MainThread]: 
[0m18:16:24.231043 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:16:24.232992 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:16:24.235083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:16:24.236150 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:16:24.257210 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:16:24.265242 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:16:24.236803 => 18:16:24.263378
[0m18:16:24.268907 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:16:24.358789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:24.842563 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:16:24.844095 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:16:25.082562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0210180c-50a1-441a-97a1-8ecc4c5ca567&page=queryresults
[0m18:16:27.263539 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:16:24.274600 => 18:16:27.263013
[0m18:16:27.265363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4848863-e8d3-4587-802b-34958a75d01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04f93c200>]}
[0m18:16:27.266698 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 3.03s]
[0m18:16:27.268313 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:16:27.269417 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:16:27.270636 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:16:27.272375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:16:27.273718 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:16:27.277692 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:16:27.279619 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:16:27.274800 => 18:16:27.278773
[0m18:16:27.281226 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:16:27.287490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:27.747925 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:16:27.749773 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY pick_up_date) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pickup_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m18:16:27.941793 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:30934dfa-d549-4958-bb2c-db861dea0335&page=queryresults
[0m18:16:28.100411 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: pickup_date; Did you mean pick_up_date? at [29:47]; reason: invalidQuery, location: query, message: Unrecognized name: pickup_date; Did you mean pick_up_date? at [29:47]')
[0m18:16:28.292787 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e03d32b6-21e8-4798-b417-30be5f98e2bb&page=queryresults
[0m18:16:28.673603 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e03d32b6-21e8-4798-b417-30be5f98e2bb&page=queryresults
[0m18:16:28.677287 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:16:27.282406 => 18:16:28.675979
[0m18:16:28.696585 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Unrecognized name: pickup_date; Did you mean pick_up_date? at [29:47]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:16:28.698592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4848863-e8d3-4587-802b-34958a75d01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05017e1e0>]}
[0m18:16:28.701303 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.43s]
[0m18:16:28.704900 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:16:28.708063 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:16:28.715309 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:16:28.722077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:16:28.727094 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:16:28.740606 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:16:28.744646 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:16:28.732149 => 18:16:28.743378
[0m18:16:28.746153 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:16:28.759941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:29.250480 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:16:29.252019 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:16:29.459063 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:27d37729-2c41-4168-a7e8-f2fecbf9e226&page=queryresults
[0m18:16:31.307966 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:16:28.746812 => 18:16:31.307209
[0m18:16:31.311137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4848863-e8d3-4587-802b-34958a75d01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05017d3a0>]}
[0m18:16:31.313496 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.59s]
[0m18:16:31.315671 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:16:31.316810 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:16:31.318088 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:16:31.320828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:16:31.322848 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:16:31.330294 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:16:31.333044 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:16:31.324094 => 18:16:31.331959
[0m18:16:31.334906 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:16:31.344592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:31.837130 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:16:31.838648 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:16:32.061121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:13896847-5671-416b-8fd5-a87c456a712c&page=queryresults
[0m18:16:33.922468 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:16:31.335966 => 18:16:33.921360
[0m18:16:33.926639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4848863-e8d3-4587-802b-34958a75d01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04d868230>]}
[0m18:16:33.928437 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.61s]
[0m18:16:33.930023 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:16:33.933232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:33.934173 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:16:33.935491 [info ] [MainThread]: 
[0m18:16:33.936954 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.68 seconds (10.68s).
[0m18:16:33.940028 [debug] [MainThread]: Command end result
[0m18:16:34.027106 [info ] [MainThread]: 
[0m18:16:34.031399 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:16:34.033696 [info ] [MainThread]: 
[0m18:16:34.037410 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Unrecognized name: pickup_date; Did you mean pick_up_date? at [29:47]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:16:34.041924 [info ] [MainThread]: 
[0m18:16:34.044886 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:16:34.054406 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.348548, "process_user_time": 6.331671, "process_kernel_time": 0.358603, "process_mem_max_rss": "134352", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m18:16:34.058907 [debug] [MainThread]: Command `dbt run` failed at 18:16:34.058063 after 12.35 seconds
[0m18:16:34.062832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb052621820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04d88f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04d88c3e0>]}
[0m18:16:34.065823 [debug] [MainThread]: Flushing usage events
[0m18:16:49.929824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3d2bc6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3e0336e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3d2bc7d0>]}


============================== 18:16:49.935192 | 39c10375-4a7b-4a56-8111-9a233ae3d1cd ==============================
[0m18:16:49.935192 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:16:49.936625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:16:50.781233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39c10375-4a7b-4a56-8111-9a233ae3d1cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3b9d74a0>]}
[0m18:16:50.977103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39c10375-4a7b-4a56-8111-9a233ae3d1cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3b747e00>]}
[0m18:16:50.979368 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:16:51.005904 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:16:51.116504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:16:51.117804 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:16:51.472125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39c10375-4a7b-4a56-8111-9a233ae3d1cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3b422f60>]}
[0m18:16:51.486073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39c10375-4a7b-4a56-8111-9a233ae3d1cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3b5d37a0>]}
[0m18:16:51.487122 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:16:51.488253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39c10375-4a7b-4a56-8111-9a233ae3d1cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3b37c590>]}
[0m18:16:51.491247 [info ] [MainThread]: 
[0m18:16:51.493125 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:16:51.496921 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:16:51.498154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:51.977829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:16:51.979533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:52.415510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39c10375-4a7b-4a56-8111-9a233ae3d1cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3b6bf440>]}
[0m18:16:52.417412 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:16:52.418431 [info ] [MainThread]: 
[0m18:16:52.422494 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:16:52.423856 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:16:52.426567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:16:52.427723 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:16:52.446743 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:16:52.455781 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:16:52.428394 => 18:16:52.453943
[0m18:16:52.459513 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:16:52.555911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:53.067070 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:16:53.068647 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:16:53.277754 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:6324a22e-6f81-4ec9-a4b5-1a496e74f7a9&page=queryresults
[0m18:16:55.153517 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:16:52.464199 => 18:16:55.152984
[0m18:16:55.155304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39c10375-4a7b-4a56-8111-9a233ae3d1cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3b7acb00>]}
[0m18:16:55.156643 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.73s]
[0m18:16:55.158326 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:16:55.159436 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:16:55.160975 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:16:55.163330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:16:55.164579 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:16:55.168344 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:16:55.170364 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:16:55.165481 => 18:16:55.169675
[0m18:16:55.171595 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:16:55.176544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:55.619497 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:16:55.621274 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY pick_up_date) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m18:16:55.807656 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:30266838-19ca-4be6-9d44-a82331e894fd&page=queryresults
[0m18:16:57.933046 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:16:55.172374 => 18:16:57.931932
[0m18:16:57.937277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39c10375-4a7b-4a56-8111-9a233ae3d1cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3ac43fe0>]}
[0m18:16:57.938788 [info ] [Thread-1 (]: 2 of 4 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (24.0 rows, 217.8 MiB processed)[0m in 2.77s]
[0m18:16:57.940392 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:16:57.941564 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:16:57.942879 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:16:57.945332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:16:57.946801 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:16:57.950965 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:16:57.952934 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:16:57.947541 => 18:16:57.952068
[0m18:16:57.954135 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:16:57.960359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:58.415328 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:16:58.416721 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:16:58.627905 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7fbc4dd8-5236-4cca-b330-5a5e2f8d9d15&page=queryresults
[0m18:17:00.493005 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:16:57.954783 => 18:17:00.492448
[0m18:17:00.495101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39c10375-4a7b-4a56-8111-9a233ae3d1cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3b5d35c0>]}
[0m18:17:00.500301 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.55s]
[0m18:17:00.503920 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:17:00.507898 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:17:00.516061 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:17:00.525294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:17:00.528916 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:17:00.537068 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:17:00.541752 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:17:00.530192 => 18:17:00.540075
[0m18:17:00.546591 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:17:00.564504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:01.098233 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:17:01.099632 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:17:01.358133 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:969279f1-53d3-43f2-b818-0a43ae5a0121&page=queryresults
[0m18:17:03.675579 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:17:00.549626 => 18:17:03.674474
[0m18:17:03.679287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39c10375-4a7b-4a56-8111-9a233ae3d1cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3b481280>]}
[0m18:17:03.686299 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.16s]
[0m18:17:03.725596 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:17:03.755157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:03.766990 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:17:03.778442 [info ] [MainThread]: 
[0m18:17:03.788680 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.29 seconds (12.29s).
[0m18:17:03.828709 [debug] [MainThread]: Command end result
[0m18:17:04.018269 [info ] [MainThread]: 
[0m18:17:04.024866 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:04.032761 [info ] [MainThread]: 
[0m18:17:04.038253 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:17:04.042897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.189732, "process_user_time": 6.514677, "process_kernel_time": 0.298123, "process_mem_max_rss": "133556", "process_out_blocks": "2856", "process_in_blocks": "0"}
[0m18:17:04.046676 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:04.045401 after 14.19 seconds
[0m18:17:04.051979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3d2ebd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3ac9c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3ac9dd60>]}
[0m18:17:04.056928 [debug] [MainThread]: Flushing usage events
[0m18:18:53.549376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5bbb3f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5bbd2b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5bbb3eb10>]}


============================== 18:18:53.554627 | 3ba7ba79-e678-4c90-89d2-f8c3f0331c5a ==============================
[0m18:18:53.554627 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:18:53.556025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:18:54.446585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ba7ba79-e678-4c90-89d2-f8c3f0331c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ba3ff800>]}
[0m18:18:54.637737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ba7ba79-e678-4c90-89d2-f8c3f0331c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5bbb3cad0>]}
[0m18:18:54.639205 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:18:54.659241 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:18:54.745135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:18:54.746521 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:18:55.099875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ba7ba79-e678-4c90-89d2-f8c3f0331c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b9fd7980>]}
[0m18:18:55.114418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ba7ba79-e678-4c90-89d2-f8c3f0331c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b9e776e0>]}
[0m18:18:55.115521 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:18:55.116586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ba7ba79-e678-4c90-89d2-f8c3f0331c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b9c3c590>]}
[0m18:18:55.120037 [info ] [MainThread]: 
[0m18:18:55.122454 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:18:55.125634 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:18:55.126917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:55.626228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:18:55.627457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:56.067379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ba7ba79-e678-4c90-89d2-f8c3f0331c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b9c199d0>]}
[0m18:18:56.069108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:18:56.070150 [info ] [MainThread]: 
[0m18:18:56.074194 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:18:56.075487 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:18:56.078158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:18:56.079670 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:18:56.096382 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:18:56.105124 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:18:56.080441 => 18:18:56.102200
[0m18:18:56.108186 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:18:56.206973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:56.696590 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:18:56.698412 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:18:56.919867 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:22782f45-3a69-4cca-b142-3c5cff4b7e09&page=queryresults
[0m18:18:58.848864 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:18:56.110215 => 18:18:58.848323
[0m18:18:58.850813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba7ba79-e678-4c90-89d2-f8c3f0331c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b9e74920>]}
[0m18:18:58.852196 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.77s]
[0m18:18:58.854334 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:18:58.855493 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:18:58.856779 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:18:58.858529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:18:58.860270 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:18:58.864555 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:18:58.866635 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:18:58.861118 => 18:18:58.865771
[0m18:18:58.867749 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:18:58.872390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:59.341713 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:18:59.344085 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY pick_up_date) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.rank DESC, ranked_cte,base_name ASC
    );
  
[0m18:18:59.540991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8414ed7c-4b42-49a9-9f93-e6e79aa7d98a&page=queryresults
[0m18:18:59.686329 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: base_name; Did you mean Base Name? at [35:43]; reason: invalidQuery, location: query, message: Unrecognized name: base_name; Did you mean Base Name? at [35:43]')
[0m18:19:00.886396 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:652883dd-567a-4d6a-b52d-95f0b950de12&page=queryresults
[0m18:19:01.266310 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:652883dd-567a-4d6a-b52d-95f0b950de12&page=queryresults
[0m18:19:01.267946 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:18:58.868400 => 18:19:01.267368
[0m18:19:01.278108 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Unrecognized name: base_name; Did you mean Base Name? at [35:43]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:19:01.279340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba7ba79-e678-4c90-89d2-f8c3f0331c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b9e74920>]}
[0m18:19:01.280972 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 2.42s]
[0m18:19:01.283011 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:19:01.284236 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:19:01.285679 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:19:01.290557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:19:01.292283 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:19:01.305479 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:19:01.310737 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:19:01.293166 => 18:19:01.309401
[0m18:19:01.312174 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:19:01.323402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:01.816768 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:19:01.818574 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:19:02.049081 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:95dcf2ab-7ec3-487f-8417-bb6d1afc2590&page=queryresults
[0m18:19:04.200246 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:19:01.313787 => 18:19:04.199756
[0m18:19:04.202261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba7ba79-e678-4c90-89d2-f8c3f0331c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b9d21370>]}
[0m18:19:04.203582 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.92s]
[0m18:19:04.205175 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:19:04.206242 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:19:04.207450 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:19:04.209300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:19:04.211164 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:19:04.215349 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:19:04.217352 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:19:04.211990 => 18:19:04.216379
[0m18:19:04.218498 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:19:04.222935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:04.660701 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:19:04.662457 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:19:04.883248 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1750881c-3e2d-45e2-96c8-c69354a8ffee&page=queryresults
[0m18:19:07.013291 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:19:04.219221 => 18:19:07.012791
[0m18:19:07.015328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba7ba79-e678-4c90-89d2-f8c3f0331c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b83e3fb0>]}
[0m18:19:07.016718 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.81s]
[0m18:19:07.018830 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:19:07.022391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:07.023871 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:19:07.025109 [info ] [MainThread]: 
[0m18:19:07.026289 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.90 seconds (11.90s).
[0m18:19:07.029076 [debug] [MainThread]: Command end result
[0m18:19:07.081136 [info ] [MainThread]: 
[0m18:19:07.083590 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:19:07.087930 [info ] [MainThread]: 
[0m18:19:07.091293 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Unrecognized name: base_name; Did you mean Base Name? at [35:43]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:19:07.096272 [info ] [MainThread]: 
[0m18:19:07.102216 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:19:07.107940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.634244, "process_user_time": 6.625543, "process_kernel_time": 0.311995, "process_mem_max_rss": "138524", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m18:19:07.111165 [debug] [MainThread]: Command `dbt run` failed at 18:19:07.109791 after 13.64 seconds
[0m18:19:07.115458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5bf9bb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5bcc3e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b83ecfe0>]}
[0m18:19:07.121005 [debug] [MainThread]: Flushing usage events
[0m18:19:26.858393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2104d44470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21052157f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2104ecd580>]}


============================== 18:19:26.864024 | d373044a-e8ec-4dd4-903b-aa85f8a2c296 ==============================
[0m18:19:26.864024 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:19:26.865375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:19:27.743336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd373044a-e8ec-4dd4-903b-aa85f8a2c296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2103424e30>]}
[0m18:19:27.921575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd373044a-e8ec-4dd4-903b-aa85f8a2c296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2102ff8ce0>]}
[0m18:19:27.923015 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:19:27.938317 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:19:28.029264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:19:28.030536 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:19:28.404817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd373044a-e8ec-4dd4-903b-aa85f8a2c296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2102de14f0>]}
[0m18:19:28.419752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd373044a-e8ec-4dd4-903b-aa85f8a2c296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2102e63dd0>]}
[0m18:19:28.420879 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:19:28.422159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd373044a-e8ec-4dd4-903b-aa85f8a2c296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2102c2d100>]}
[0m18:19:28.425195 [info ] [MainThread]: 
[0m18:19:28.426982 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:19:28.430604 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:19:28.431859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:28.949767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:19:28.950935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:29.380730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd373044a-e8ec-4dd4-903b-aa85f8a2c296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2102e62090>]}
[0m18:19:29.382506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:19:29.383568 [info ] [MainThread]: 
[0m18:19:29.387650 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:19:29.389655 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:19:29.393407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:19:29.395491 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:19:29.417029 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:19:29.422349 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:19:29.396798 => 18:19:29.420436
[0m18:19:29.426966 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:19:29.544018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:30.019163 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:19:30.020745 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:19:30.204745 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4f74438d-a425-4fb0-9013-e20369c45f96&page=queryresults
[0m18:19:32.109261 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:19:29.431188 => 18:19:32.107771
[0m18:19:32.113736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd373044a-e8ec-4dd4-903b-aa85f8a2c296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2102f26b40>]}
[0m18:19:32.116973 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.72s]
[0m18:19:32.120573 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:19:32.122266 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:19:32.123640 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:19:32.126944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:19:32.128994 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:19:32.136167 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:19:32.138932 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:19:32.130158 => 18:19:32.137831
[0m18:19:32.141039 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:19:32.150001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:32.656666 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:19:32.658600 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY pick_up_date) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.rank DESC, ranked_cte.base_name ASC
    );
  
[0m18:19:32.844649 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:3aa298d6-b089-45c1-864c-faa8ab915835&page=queryresults
[0m18:19:32.998126 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name base_name not found inside ranked_cte at [35:43]; reason: invalidQuery, location: query, message: Name base_name not found inside ranked_cte at [35:43]')
[0m18:19:33.549272 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7571807f-63b1-4820-b662-d2b687b43831&page=queryresults
[0m18:19:33.685423 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7571807f-63b1-4820-b662-d2b687b43831&page=queryresults
[0m18:19:33.686993 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:19:32.142526 => 18:19:33.686423
[0m18:19:33.696684 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Name base_name not found inside ranked_cte at [35:43]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:19:33.697827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd373044a-e8ec-4dd4-903b-aa85f8a2c296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2102c53530>]}
[0m18:19:33.699696 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.57s]
[0m18:19:33.702572 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:19:33.705045 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:19:33.707528 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:19:33.711699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:19:33.714084 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:19:33.722053 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:19:33.725055 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:19:33.715547 => 18:19:33.723696
[0m18:19:33.727461 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:19:33.743399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:34.257687 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:19:34.259412 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:19:34.471410 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:72f112f6-b027-4a7a-8a10-d4ffbbd0d040&page=queryresults
[0m18:19:39.435033 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:19:33.729262 => 18:19:39.434540
[0m18:19:39.436865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd373044a-e8ec-4dd4-903b-aa85f8a2c296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f210033e7e0>]}
[0m18:19:39.438283 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 5.73s]
[0m18:19:39.440416 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:19:39.441815 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:19:39.443074 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:19:39.445869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:19:39.448092 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:19:39.455622 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:19:39.458357 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:19:39.449361 => 18:19:39.457221
[0m18:19:39.460406 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:19:39.468951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:39.975936 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:19:39.977388 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:19:40.190846 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ff866fe8-b02c-46c3-acc9-6e2492143420&page=queryresults
[0m18:19:42.057855 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:19:39.461704 => 18:19:42.056669
[0m18:19:42.063255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd373044a-e8ec-4dd4-903b-aa85f8a2c296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2102f255b0>]}
[0m18:19:42.068093 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.62s]
[0m18:19:42.075158 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:19:42.081308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:42.082491 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:19:42.083371 [info ] [MainThread]: 
[0m18:19:42.084421 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 13.66 seconds (13.66s).
[0m18:19:42.097393 [debug] [MainThread]: Command end result
[0m18:19:42.152264 [info ] [MainThread]: 
[0m18:19:42.159155 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:19:42.165600 [info ] [MainThread]: 
[0m18:19:42.169678 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Name base_name not found inside ranked_cte at [35:43]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:19:42.172671 [info ] [MainThread]: 
[0m18:19:42.177607 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:19:42.182838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.4067, "process_user_time": 6.791706, "process_kernel_time": 0.280425, "process_mem_max_rss": "134164", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m18:19:42.194403 [debug] [MainThread]: Command `dbt run` failed at 18:19:42.192548 after 15.42 seconds
[0m18:19:42.199147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2106c78e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2103438f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2100232690>]}
[0m18:19:42.201540 [debug] [MainThread]: Flushing usage events
[0m18:20:05.944813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6d9bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6dc516a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6ea6e840>]}


============================== 18:20:05.949944 | 1c4e3b01-8faf-463e-a420-3467cbfc88ab ==============================
[0m18:20:05.949944 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:20:05.951403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:20:06.840652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c4e3b01-8faf-463e-a420-3467cbfc88ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f70f45e80>]}
[0m18:20:07.018493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c4e3b01-8faf-463e-a420-3467cbfc88ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6c027290>]}
[0m18:20:07.019950 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:20:07.035927 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:20:07.136066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:20:07.137382 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:20:07.487693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c4e3b01-8faf-463e-a420-3467cbfc88ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6bdb81d0>]}
[0m18:20:07.501831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c4e3b01-8faf-463e-a420-3467cbfc88ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6bbcb2c0>]}
[0m18:20:07.502868 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:20:07.503869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c4e3b01-8faf-463e-a420-3467cbfc88ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6bf04980>]}
[0m18:20:07.506906 [info ] [MainThread]: 
[0m18:20:07.509374 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:20:07.512230 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:20:07.513350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:08.009397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:20:08.010509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:20:08.445268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c4e3b01-8faf-463e-a420-3467cbfc88ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6b98f4a0>]}
[0m18:20:08.446958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:20:08.448134 [info ] [MainThread]: 
[0m18:20:08.452011 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:20:08.453222 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:20:08.455931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:20:08.457607 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:20:08.475429 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:20:08.481122 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:20:08.458807 => 18:20:08.478050
[0m18:20:08.487610 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:20:08.592129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:09.117814 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:20:09.119315 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:20:09.340876 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7b1b78a8-fcc0-46d0-9a40-b08a199b9432&page=queryresults
[0m18:20:11.217696 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:20:08.490072 => 18:20:11.217114
[0m18:20:11.219453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c4e3b01-8faf-463e-a420-3467cbfc88ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6bf8cfb0>]}
[0m18:20:11.220798 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.76s]
[0m18:20:11.222372 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:20:11.223464 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:20:11.224756 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:20:11.226434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:20:11.227930 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:20:11.231852 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:20:11.233422 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:20:11.228985 => 18:20:11.232824
[0m18:20:11.234727 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:20:11.240601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:11.690385 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:20:11.692156 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY pick_up_date) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.rank DESC, ranked_cte.'Base Name' ASC
    );
  
[0m18:20:11.790302 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0a7a7e6c-2679-456c-982b-c1bed17531b0&page=queryresults
[0m18:20:11.791664 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'Base Name' at [35:43]; reason: invalidQuery, location: query, message: Syntax error: Unexpected string literal 'Base Name' at [35:43]")
[0m18:20:12.598249 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:761888b1-b25b-4894-bed2-9a9f631d712b&page=queryresults
[0m18:20:12.603910 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:761888b1-b25b-4894-bed2-9a9f631d712b&page=queryresults
[0m18:20:12.610202 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:20:11.235950 => 18:20:12.607905
[0m18:20:12.639548 [debug] [Thread-1 (]: Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Syntax error: Unexpected string literal 'Base Name' at [35:43]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:20:12.641859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c4e3b01-8faf-463e-a420-3467cbfc88ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6ba70f80>]}
[0m18:20:12.649551 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[31mERROR[0m in 1.42s]
[0m18:20:12.659304 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:20:12.671641 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:20:12.675911 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:20:12.683420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:20:12.690863 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:20:12.707962 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:20:12.715074 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:20:12.693582 => 18:20:12.713275
[0m18:20:12.717150 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:20:12.729171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:13.240907 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:20:13.242491 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:20:13.439022 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:2c29ca1b-b0fd-4664-9045-7e74fabdcd8d&page=queryresults
[0m18:20:15.292070 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:20:12.718511 => 18:20:15.291563
[0m18:20:15.295307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c4e3b01-8faf-463e-a420-3467cbfc88ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6ba713d0>]}
[0m18:20:15.298245 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.62s]
[0m18:20:15.301605 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:20:15.304001 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:20:15.307260 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:20:15.312183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:20:15.314273 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:20:15.318808 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:20:15.320786 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:20:15.315290 => 18:20:15.319953
[0m18:20:15.322082 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:20:15.331082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:15.800083 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:20:15.801543 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:20:16.001567 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:efbf858d-9e4d-4306-a721-42eb2ee7a796&page=queryresults
[0m18:20:17.864823 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:20:15.322724 => 18:20:17.863858
[0m18:20:17.868192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c4e3b01-8faf-463e-a420-3467cbfc88ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6ba70f80>]}
[0m18:20:17.870764 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.56s]
[0m18:20:17.873524 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:20:17.878522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:17.880269 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:20:17.882239 [info ] [MainThread]: 
[0m18:20:17.884487 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.37 seconds (10.37s).
[0m18:20:17.889557 [debug] [MainThread]: Command end result
[0m18:20:17.983410 [info ] [MainThread]: 
[0m18:20:17.986261 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:20:17.988490 [info ] [MainThread]: 
[0m18:20:17.993463 [error] [MainThread]:   Database Error in model top_3_most_common_pick_ups_per_base_name (models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql)
  Syntax error: Unexpected string literal 'Base Name' at [35:43]
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:20:17.996965 [info ] [MainThread]: 
[0m18:20:18.000850 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:20:18.010766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.152702, "process_user_time": 6.848498, "process_kernel_time": 0.376549, "process_mem_max_rss": "134384", "process_out_blocks": "2856", "command_success": false, "process_in_blocks": "0"}
[0m18:20:18.018182 [debug] [MainThread]: Command `dbt run` failed at 18:20:18.015964 after 12.16 seconds
[0m18:20:18.023201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6d9bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6bf65970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6bcac560>]}
[0m18:20:18.027171 [debug] [MainThread]: Flushing usage events
[0m18:20:38.417931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb525b41580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb525c2d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb525b41820>]}


============================== 18:20:38.423150 | c085d14f-d36f-47b7-aa43-7e60420ef1a1 ==============================
[0m18:20:38.423150 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:20:38.424537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:20:39.311383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c085d14f-d36f-47b7-aa43-7e60420ef1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb523d3eb70>]}
[0m18:20:39.491030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c085d14f-d36f-47b7-aa43-7e60420ef1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5241bbb90>]}
[0m18:20:39.492567 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:20:39.509383 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:20:39.604498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:20:39.605762 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:20:39.976827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c085d14f-d36f-47b7-aa43-7e60420ef1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb523af92b0>]}
[0m18:20:39.991212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c085d14f-d36f-47b7-aa43-7e60420ef1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb523c87440>]}
[0m18:20:39.992448 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:20:39.993471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c085d14f-d36f-47b7-aa43-7e60420ef1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5266d09b0>]}
[0m18:20:39.998364 [info ] [MainThread]: 
[0m18:20:40.002196 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:20:40.006525 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:20:40.008738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:40.513850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:20:40.514961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:20:40.985482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c085d14f-d36f-47b7-aa43-7e60420ef1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb523bf2f00>]}
[0m18:20:40.987207 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:20:40.988302 [info ] [MainThread]: 
[0m18:20:40.992303 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:20:40.994126 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:20:40.997817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:20:41.000088 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:20:41.026174 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:20:41.033237 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:20:41.001377 => 18:20:41.031210
[0m18:20:41.036811 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:20:41.134254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:41.603261 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:20:41.604829 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:20:41.768678 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a8f3659e-e6ca-4a64-ab42-916bc7cf111f&page=queryresults
[0m18:20:43.670128 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:20:41.040552 => 18:20:43.669323
[0m18:20:43.673079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c085d14f-d36f-47b7-aa43-7e60420ef1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb523e03b90>]}
[0m18:20:43.675179 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.68s]
[0m18:20:43.677473 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:20:43.679139 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:20:43.681110 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:20:43.684226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:20:43.685989 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:20:43.691204 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:20:43.693763 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:20:43.686933 => 18:20:43.692639
[0m18:20:43.695013 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:20:43.702531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:44.159322 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:20:44.161121 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY pick_up_date) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.rank DESC
    );
  
[0m18:20:44.372156 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:9db44ea4-f3de-4b64-8223-a576256d976a&page=queryresults
[0m18:20:46.509160 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:20:43.695647 => 18:20:46.508663
[0m18:20:46.511134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c085d14f-d36f-47b7-aa43-7e60420ef1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb523fb91f0>]}
[0m18:20:46.512472 [info ] [Thread-1 (]: 2 of 4 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (24.0 rows, 217.8 MiB processed)[0m in 2.83s]
[0m18:20:46.514042 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:20:46.515174 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:20:46.516460 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:20:46.518305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:20:46.520289 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:20:46.524680 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:20:46.526498 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:20:46.521181 => 18:20:46.525704
[0m18:20:46.527709 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:20:46.532257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:46.990860 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:20:46.992589 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:20:47.220411 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8e98a8f8-914e-4bac-b457-aa94a1d94327&page=queryresults
[0m18:20:49.075081 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:20:46.528459 => 18:20:49.074564
[0m18:20:49.076952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c085d14f-d36f-47b7-aa43-7e60420ef1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb523b31940>]}
[0m18:20:49.078358 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.56s]
[0m18:20:49.079962 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:20:49.081045 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:20:49.082286 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:20:49.084107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:20:49.086026 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:20:49.090309 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:20:49.092336 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:20:49.086852 => 18:20:49.091452
[0m18:20:49.093631 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:20:49.098261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:49.544766 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:20:49.546463 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:20:49.761835 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8c72db01-48b7-4746-9eed-b68e8e59351f&page=queryresults
[0m18:20:51.593236 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:20:49.094454 => 18:20:51.592675
[0m18:20:51.595137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c085d14f-d36f-47b7-aa43-7e60420ef1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb523b315b0>]}
[0m18:20:51.596491 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.51s]
[0m18:20:51.598360 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:20:51.602468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:51.603855 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:20:51.605490 [info ] [MainThread]: 
[0m18:20:51.607016 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.60 seconds (11.60s).
[0m18:20:51.610029 [debug] [MainThread]: Command end result
[0m18:20:51.675071 [info ] [MainThread]: 
[0m18:20:51.677777 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:20:51.680866 [info ] [MainThread]: 
[0m18:20:51.686562 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:20:51.692621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.371151, "process_user_time": 6.618021, "process_kernel_time": 0.285806, "process_mem_max_rss": "135516", "process_out_blocks": "2848", "process_in_blocks": "0"}
[0m18:20:51.699530 [debug] [MainThread]: Command `dbt run` succeeded at 18:20:51.698487 after 13.38 seconds
[0m18:20:51.702700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb52410f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb52135bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb52135b470>]}
[0m18:20:51.706720 [debug] [MainThread]: Flushing usage events
[0m18:23:08.263451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784c4bfb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784dd695b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784c3cdc40>]}


============================== 18:23:08.268570 | edabe774-4d05-47fe-84ff-9217cf51d9b5 ==============================
[0m18:23:08.268570 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:23:08.269943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:23:09.345675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edabe774-4d05-47fe-84ff-9217cf51d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784a89a720>]}
[0m18:23:09.546500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edabe774-4d05-47fe-84ff-9217cf51d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784aa6ad20>]}
[0m18:23:09.548023 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:23:09.571099 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:23:09.676744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:23:09.679078 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:23:10.071500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edabe774-4d05-47fe-84ff-9217cf51d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784a472f60>]}
[0m18:23:10.085420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edabe774-4d05-47fe-84ff-9217cf51d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784a6cf0b0>]}
[0m18:23:10.086495 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:23:10.087569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edabe774-4d05-47fe-84ff-9217cf51d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784a4920f0>]}
[0m18:23:10.090553 [info ] [MainThread]: 
[0m18:23:10.092431 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:23:10.095689 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:23:10.097198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:10.588171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:23:10.589256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:11.033847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edabe774-4d05-47fe-84ff-9217cf51d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784c3cc860>]}
[0m18:23:11.035745 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:23:11.036889 [info ] [MainThread]: 
[0m18:23:11.041694 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:23:11.043445 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:23:11.045404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:23:11.046431 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:23:11.062212 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:23:11.069469 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:23:11.047146 => 18:23:11.066999
[0m18:23:11.074265 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:23:11.162096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:11.647862 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:23:11.649686 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:23:11.881499 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:6f69c63d-ea4f-4185-85ef-e151489fe5be&page=queryresults
[0m18:23:13.796585 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:23:11.076619 => 18:23:13.796026
[0m18:23:13.798564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edabe774-4d05-47fe-84ff-9217cf51d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784b001ee0>]}
[0m18:23:13.800266 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.75s]
[0m18:23:13.802452 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:23:13.803943 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:23:13.805637 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:23:13.808735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:23:13.810247 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:23:13.815224 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:23:13.817559 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:23:13.811160 => 18:23:13.816639
[0m18:23:13.818718 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:23:13.824352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:14.277189 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:23:14.278758 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY pick_up_date) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
    );
  
[0m18:23:14.487208 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b23de00f-72d5-4f52-b68a-2dc2ae58a652&page=queryresults
[0m18:23:16.957313 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:23:13.819402 => 18:23:16.955026
[0m18:23:16.964612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edabe774-4d05-47fe-84ff-9217cf51d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784a8bff20>]}
[0m18:23:16.970297 [info ] [Thread-1 (]: 2 of 4 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (24.0 rows, 217.8 MiB processed)[0m in 3.16s]
[0m18:23:16.975937 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:23:16.980005 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:23:16.984419 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:23:16.990772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:23:16.994081 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:23:17.005339 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:23:17.008986 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:23:16.996021 => 18:23:17.007861
[0m18:23:17.011073 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:23:17.023700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:17.462530 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:23:17.463923 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:23:17.654672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a291635c-dbc9-4c2d-bf39-0fc9a1abfd30&page=queryresults
[0m18:23:19.532421 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:23:17.013336 => 18:23:19.531920
[0m18:23:19.534232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edabe774-4d05-47fe-84ff-9217cf51d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7849b7cd70>]}
[0m18:23:19.535553 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.55s]
[0m18:23:19.537163 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:23:19.538370 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:23:19.539551 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:23:19.541388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:23:19.542871 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:23:19.547163 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:23:19.548777 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:23:19.543572 => 18:23:19.548186
[0m18:23:19.549850 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:23:19.555222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:20.035147 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:23:20.037087 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:23:20.241880 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1d7280c0-bfbe-4755-9dc3-2c37a64835f5&page=queryresults
[0m18:23:22.117842 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:23:19.550523 => 18:23:22.117305
[0m18:23:22.119575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edabe774-4d05-47fe-84ff-9217cf51d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784a5753a0>]}
[0m18:23:22.121138 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.58s]
[0m18:23:22.122748 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:23:22.126056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:22.126926 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:23:22.128286 [info ] [MainThread]: 
[0m18:23:22.129585 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.04 seconds (12.04s).
[0m18:23:22.132806 [debug] [MainThread]: Command end result
[0m18:23:22.213875 [info ] [MainThread]: 
[0m18:23:22.215287 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:23:22.217032 [info ] [MainThread]: 
[0m18:23:22.221506 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:23:22.226696 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.040996, "process_user_time": 7.189901, "process_kernel_time": 0.33739, "process_mem_max_rss": "135480", "process_out_blocks": "2856", "process_in_blocks": "0"}
[0m18:23:22.234333 [debug] [MainThread]: Command `dbt run` succeeded at 18:23:22.231712 after 14.05 seconds
[0m18:23:22.237414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784c3fbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7849b97c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7849b97f80>]}
[0m18:23:22.238600 [debug] [MainThread]: Flushing usage events
[0m18:26:12.730932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea7a464530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea7a7e96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea7a7eb020>]}


============================== 18:26:12.736023 | b536afc2-2c25-4594-b67a-e082b5b4156d ==============================
[0m18:26:12.736023 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:26:12.737390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:26:13.556393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b536afc2-2c25-4594-b67a-e082b5b4156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea7a6680e0>]}
[0m18:26:13.733794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b536afc2-2c25-4594-b67a-e082b5b4156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea7a3893d0>]}
[0m18:26:13.735351 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:26:13.757393 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:26:13.871810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:13.874252 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:26:14.266754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b536afc2-2c25-4594-b67a-e082b5b4156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea78627a10>]}
[0m18:26:14.280503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b536afc2-2c25-4594-b67a-e082b5b4156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea7879b830>]}
[0m18:26:14.281595 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:26:14.282602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b536afc2-2c25-4594-b67a-e082b5b4156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea78798c50>]}
[0m18:26:14.285598 [info ] [MainThread]: 
[0m18:26:14.287385 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:26:14.291211 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:26:14.292368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:14.804074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:26:14.805128 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:15.246904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b536afc2-2c25-4594-b67a-e082b5b4156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea78536120>]}
[0m18:26:15.248617 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:26:15.249598 [info ] [MainThread]: 
[0m18:26:15.253429 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:26:15.254716 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:26:15.258056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:26:15.260115 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:26:15.275450 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:26:15.279393 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:26:15.261750 => 18:26:15.278316
[0m18:26:15.281394 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:26:15.366245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:15.821173 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:26:15.822984 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:26:16.087624 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:68d54a10-056f-4cec-8bf9-e4655399cb48&page=queryresults
[0m18:26:18.033235 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:26:15.282582 => 18:26:18.032370
[0m18:26:18.036199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b536afc2-2c25-4594-b67a-e082b5b4156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea788cb620>]}
[0m18:26:18.038375 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.78s]
[0m18:26:18.040847 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:26:18.042535 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:26:18.044479 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:26:18.047758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:26:18.049282 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:26:18.054652 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:26:18.057060 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:26:18.050209 => 18:26:18.055887
[0m18:26:18.058647 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:26:18.064276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:18.503898 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:26:18.505762 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY pick_up_date) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.rank, ranked_cte.`Base NAME` ASC
    );
  
[0m18:26:18.714538 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7d09bc35-0411-46c9-a4ff-f69805fb4f94&page=queryresults
[0m18:26:21.138614 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:26:18.059400 => 18:26:21.138105
[0m18:26:21.140569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b536afc2-2c25-4594-b67a-e082b5b4156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea77c5b740>]}
[0m18:26:21.141976 [info ] [Thread-1 (]: 2 of 4 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (24.0 rows, 217.8 MiB processed)[0m in 3.09s]
[0m18:26:21.143562 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:26:21.144718 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:26:21.145950 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:26:21.147750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:26:21.149149 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:26:21.153747 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:26:21.155553 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:26:21.150082 => 18:26:21.154835
[0m18:26:21.156623 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:26:21.161345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:21.628141 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:26:21.629643 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:26:21.833105 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:466ab552-5188-4762-aa70-a902942d5e4a&page=queryresults
[0m18:26:23.973038 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:26:21.157242 => 18:26:23.971875
[0m18:26:23.977711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b536afc2-2c25-4594-b67a-e082b5b4156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea786456d0>]}
[0m18:26:23.981075 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.83s]
[0m18:26:23.984722 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:26:23.987417 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:26:23.991261 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:26:23.996043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:26:23.999397 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:26:24.006771 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:26:24.008776 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:26:24.001697 => 18:26:24.007917
[0m18:26:24.010075 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:26:24.014786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:24.481501 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:26:24.482942 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:26:24.691381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:aaa67c76-f39a-4b3a-93fe-26dfec558c8f&page=queryresults
[0m18:26:26.286943 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:26:24.010863 => 18:26:26.286423
[0m18:26:26.288772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b536afc2-2c25-4594-b67a-e082b5b4156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea78645790>]}
[0m18:26:26.290054 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.30s]
[0m18:26:26.291698 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:26:26.294983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:26.295846 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:26:26.297242 [info ] [MainThread]: 
[0m18:26:26.299048 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.01 seconds (12.01s).
[0m18:26:26.303654 [debug] [MainThread]: Command end result
[0m18:26:26.377941 [info ] [MainThread]: 
[0m18:26:26.380492 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:26:26.385155 [info ] [MainThread]: 
[0m18:26:26.390469 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:26:26.397876 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.744409, "process_user_time": 6.408692, "process_kernel_time": 0.267364, "process_mem_max_rss": "133208", "process_out_blocks": "2856", "process_in_blocks": "0"}
[0m18:26:26.400528 [debug] [MainThread]: Command `dbt run` succeeded at 18:26:26.400022 after 13.75 seconds
[0m18:26:26.402619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea7e63b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea78b45970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea77c80e30>]}
[0m18:26:26.405990 [debug] [MainThread]: Flushing usage events
[0m18:29:04.177916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aa7bd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aaa3f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aa9eaf30>]}


============================== 18:29:04.183374 | 1369432e-de12-4920-9d48-3d774c6ab76f ==============================
[0m18:29:04.183374 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:29:04.184767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:29:04.992295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1369432e-de12-4920-9d48-3d774c6ab76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a8ca7440>]}
[0m18:29:05.165040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1369432e-de12-4920-9d48-3d774c6ab76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aa7ec230>]}
[0m18:29:05.166461 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:29:05.182612 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:29:05.247377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:29:05.248631 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:29:05.589897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1369432e-de12-4920-9d48-3d774c6ab76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a891f080>]}
[0m18:29:05.604738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1369432e-de12-4920-9d48-3d774c6ab76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a8adef00>]}
[0m18:29:05.605790 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:29:05.606815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1369432e-de12-4920-9d48-3d774c6ab76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a8b5b710>]}
[0m18:29:05.609817 [info ] [MainThread]: 
[0m18:29:05.612579 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:29:05.617205 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:29:05.618449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:06.107393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:29:06.108551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:29:06.539812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1369432e-de12-4920-9d48-3d774c6ab76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a90b5370>]}
[0m18:29:06.541838 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:29:06.542914 [info ] [MainThread]: 
[0m18:29:06.546826 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:29:06.548315 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:29:06.551462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:29:06.553360 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:29:06.575502 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:29:06.580497 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:29:06.554674 => 18:29:06.579350
[0m18:29:06.584095 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:29:06.656720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:07.149718 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:29:07.151765 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:29:07.395434 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:bfe2fb3d-03d0-4714-b37d-ba540036e1fd&page=queryresults
[0m18:29:09.638091 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:29:06.585927 => 18:29:09.637584
[0m18:29:09.639852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1369432e-de12-4920-9d48-3d774c6ab76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a8ccbb90>]}
[0m18:29:09.641214 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 3.09s]
[0m18:29:09.642764 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:29:09.643891 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:29:09.645272 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:29:09.646962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:29:09.648380 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:29:09.652421 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:29:09.654142 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:29:09.649222 => 18:29:09.653456
[0m18:29:09.655303 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:29:09.661183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:10.155006 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:29:10.157177 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num, pick_up_date ORDER BY pick_up_date) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.rank ASC, ranked_cte.`Base NAME` ASC
    );
  
[0m18:29:10.444577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:794d5b2c-5b2f-4caa-9761-03b6d2d48104&page=queryresults
[0m18:29:12.916381 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:29:09.655976 => 18:29:12.915804
[0m18:29:12.918941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1369432e-de12-4920-9d48-3d774c6ab76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a8142210>]}
[0m18:29:12.920348 [info ] [Thread-1 (]: 2 of 4 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (1.1k rows, 217.8 MiB processed)[0m in 3.27s]
[0m18:29:12.921925 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:29:12.922985 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:29:12.924203 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:29:12.925957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:29:12.927460 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:29:12.931976 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:29:12.933906 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:29:12.928236 => 18:29:12.933057
[0m18:29:12.935140 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:29:12.940008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:13.354333 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:29:13.356322 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:29:13.598152 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d244c3d2-2dd1-4f70-9743-f89ec88f3386&page=queryresults
[0m18:29:15.547235 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:29:12.935786 => 18:29:15.546131
[0m18:29:15.551437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1369432e-de12-4920-9d48-3d774c6ab76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a8981820>]}
[0m18:29:15.554465 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.63s]
[0m18:29:15.558206 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:29:15.560744 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:29:15.564235 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:29:15.568906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:29:15.571705 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:29:15.588206 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:29:15.593102 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:29:15.574840 => 18:29:15.591168
[0m18:29:15.596730 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:29:15.611784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:16.086677 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:29:16.088574 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:29:16.303242 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a892c295-7476-4ad5-898d-46bad5ccd875&page=queryresults
[0m18:29:18.165757 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:29:15.598823 => 18:29:18.164664
[0m18:29:18.169708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1369432e-de12-4920-9d48-3d774c6ab76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a89819d0>]}
[0m18:29:18.172630 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.60s]
[0m18:29:18.176222 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:29:18.184086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:18.186051 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:29:18.188463 [info ] [MainThread]: 
[0m18:29:18.191495 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.58 seconds (12.58s).
[0m18:29:18.199350 [debug] [MainThread]: Command end result
[0m18:29:18.267307 [info ] [MainThread]: 
[0m18:29:18.269577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:29:18.272847 [info ] [MainThread]: 
[0m18:29:18.276074 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:29:18.279203 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.178827, "process_user_time": 6.216026, "process_kernel_time": 0.312578, "process_mem_max_rss": "133288", "process_out_blocks": "2848", "process_in_blocks": "0"}
[0m18:29:18.283641 [debug] [MainThread]: Command `dbt run` succeeded at 18:29:18.281741 after 14.18 seconds
[0m18:29:18.289046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aa7efbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a8cca6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a81a3830>]}
[0m18:29:18.292665 [debug] [MainThread]: Flushing usage events
[0m18:30:34.396793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0239bc3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc023c757f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc023d42f30>]}


============================== 18:30:34.401830 | 29b7771a-ba50-4367-a497-ad95dc679cf7 ==============================
[0m18:30:34.401830 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:30:34.403215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:30:35.218039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29b7771a-ba50-4367-a497-ad95dc679cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc021d8f170>]}
[0m18:30:35.390877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29b7771a-ba50-4367-a497-ad95dc679cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc021f66930>]}
[0m18:30:35.392289 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:30:35.414574 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:30:35.493070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:30:35.494383 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:30:35.834336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29b7771a-ba50-4367-a497-ad95dc679cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc021b1f7d0>]}
[0m18:30:35.848129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29b7771a-ba50-4367-a497-ad95dc679cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc021cac1a0>]}
[0m18:30:35.849200 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:30:35.850211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29b7771a-ba50-4367-a497-ad95dc679cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc021cacce0>]}
[0m18:30:35.853252 [info ] [MainThread]: 
[0m18:30:35.855092 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:30:35.858111 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:30:35.859428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:36.325429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:30:36.326580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:36.759477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29b7771a-ba50-4367-a497-ad95dc679cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc021cae360>]}
[0m18:30:36.761453 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:30:36.762550 [info ] [MainThread]: 
[0m18:30:36.767438 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:30:36.769865 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:30:36.773013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:30:36.774962 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:30:36.798078 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:30:36.805732 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:30:36.776192 => 18:30:36.803813
[0m18:30:36.808942 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:30:36.888843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:37.378508 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:30:37.380027 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:30:37.618579 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:09b10b29-55fd-4274-9b1c-be3ef9f0e6dd&page=queryresults
[0m18:30:39.568267 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:30:36.812280 => 18:30:39.566928
[0m18:30:39.571415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b7771a-ba50-4367-a497-ad95dc679cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc021b76210>]}
[0m18:30:39.573516 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.80s]
[0m18:30:39.576141 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:30:39.577909 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:30:39.580130 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:30:39.583182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:30:39.584770 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:30:39.590795 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:30:39.593171 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:30:39.585709 => 18:30:39.592215
[0m18:30:39.594657 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:30:39.600552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:40.066839 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:30:40.068879 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*)) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.rank ASC, ranked_cte.`Base NAME` ASC
    );
  
[0m18:30:40.283171 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:67c1c829-8088-4036-bf4c-20f44873810e&page=queryresults
[0m18:30:43.045466 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:30:39.595383 => 18:30:43.044902
[0m18:30:43.047650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b7771a-ba50-4367-a497-ad95dc679cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc021b76060>]}
[0m18:30:43.048989 [info ] [Thread-1 (]: 2 of 4 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (24.0 rows, 217.8 MiB processed)[0m in 3.47s]
[0m18:30:43.051011 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:30:43.052127 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:30:43.053407 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:30:43.055216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:30:43.056698 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:30:43.061493 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:30:43.063374 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:30:43.057537 => 18:30:43.062565
[0m18:30:43.064486 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:30:43.069239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:43.512577 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:30:43.514316 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:30:43.714334 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e6167482-d2d0-42ea-8eb4-a26a9f79106f&page=queryresults
[0m18:30:45.301152 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:30:43.065234 => 18:30:45.300555
[0m18:30:45.303059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b7771a-ba50-4367-a497-ad95dc679cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc021150b00>]}
[0m18:30:45.304398 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.25s]
[0m18:30:45.306020 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:30:45.307094 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:30:45.308315 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:30:45.310089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:30:45.311956 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:30:45.319355 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:30:45.322045 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:30:45.313092 => 18:30:45.320895
[0m18:30:45.324092 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:30:45.332411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:45.774022 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:30:45.775399 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:30:46.003829 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:9ae874ef-83c8-428f-828a-f6e50615d93a&page=queryresults
[0m18:30:47.883797 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:30:45.325483 => 18:30:47.882781
[0m18:30:47.885873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b7771a-ba50-4367-a497-ad95dc679cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc021b75ca0>]}
[0m18:30:47.887268 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.58s]
[0m18:30:47.888989 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:30:47.892528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:47.893456 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:30:47.895101 [info ] [MainThread]: 
[0m18:30:47.896370 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.04 seconds (12.04s).
[0m18:30:47.901662 [debug] [MainThread]: Command end result
[0m18:30:47.973460 [info ] [MainThread]: 
[0m18:30:47.976764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:30:47.981804 [info ] [MainThread]: 
[0m18:30:47.984254 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:30:47.992111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.672183, "process_user_time": 6.331381, "process_kernel_time": 0.276102, "process_mem_max_rss": "135472", "process_out_blocks": "2848", "process_in_blocks": "0"}
[0m18:30:47.995663 [debug] [MainThread]: Command `dbt run` succeeded at 18:30:47.994732 after 13.68 seconds
[0m18:30:47.997906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0239ebe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc021d50fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0211ac050>]}
[0m18:30:47.999700 [debug] [MainThread]: Flushing usage events
[0m18:32:15.860531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca78b24770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca78c177a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca78b25ac0>]}


============================== 18:32:15.865601 | 52d33b88-46e3-4abe-8d83-b542f657a286 ==============================
[0m18:32:15.865601 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:32:15.867054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:32:16.681054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52d33b88-46e3-4abe-8d83-b542f657a286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca77389f40>]}
[0m18:32:16.854492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52d33b88-46e3-4abe-8d83-b542f657a286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca76ff4620>]}
[0m18:32:16.855977 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:32:16.877915 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:32:16.947960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:32:16.949900 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:32:17.295312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52d33b88-46e3-4abe-8d83-b542f657a286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca76cf28d0>]}
[0m18:32:17.309054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52d33b88-46e3-4abe-8d83-b542f657a286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca76e72fc0>]}
[0m18:32:17.310079 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:32:17.311156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52d33b88-46e3-4abe-8d83-b542f657a286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca76e70740>]}
[0m18:32:17.314151 [info ] [MainThread]: 
[0m18:32:17.316009 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:32:17.319448 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:32:17.320690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:17.824941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:32:17.826014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:18.277614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52d33b88-46e3-4abe-8d83-b542f657a286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca76e72060>]}
[0m18:32:18.279337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:32:18.280426 [info ] [MainThread]: 
[0m18:32:18.284381 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:32:18.285728 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:32:18.288849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:32:18.290798 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:32:18.312851 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:32:18.317118 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:32:18.292116 => 18:32:18.315354
[0m18:32:18.319410 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:32:18.395959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:18.879718 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:32:18.881224 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:32:19.097684 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4f3eb589-9f29-4043-8f84-9d179e456cdb&page=queryresults
[0m18:32:21.317006 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:32:18.322261 => 18:32:21.316496
[0m18:32:21.319279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52d33b88-46e3-4abe-8d83-b542f657a286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca76d3d9d0>]}
[0m18:32:21.321329 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 3.03s]
[0m18:32:21.323764 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:32:21.325434 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:32:21.327193 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:32:21.330766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:32:21.333516 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:32:21.342981 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:32:21.346333 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:32:21.335296 => 18:32:21.345022
[0m18:32:21.348830 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:32:21.359436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:21.829769 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:32:21.831555 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.rank ASC, ranked_cte.`Base NAME` ASC
    );
  
[0m18:32:22.049618 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:08e9f1b2-08c1-412c-bb18-c37fb5645bdf&page=queryresults
[0m18:32:23.974766 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:32:21.350510 => 18:32:23.973544
[0m18:32:23.979000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52d33b88-46e3-4abe-8d83-b542f657a286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca76cbf410>]}
[0m18:32:23.982025 [info ] [Thread-1 (]: 2 of 4 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.65s]
[0m18:32:23.985451 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:32:23.987956 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:32:23.991666 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:32:23.995857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:32:23.998728 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:32:24.008330 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:32:24.012873 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:32:24.000713 => 18:32:24.011151
[0m18:32:24.014566 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:32:24.023048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:24.499391 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:32:24.500976 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:32:24.694034 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:9c126ed9-9126-4cb9-a135-3b991a05ca60&page=queryresults
[0m18:32:26.306754 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:32:24.015189 => 18:32:26.305970
[0m18:32:26.309887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52d33b88-46e3-4abe-8d83-b542f657a286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca76f2e990>]}
[0m18:32:26.311485 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.32s]
[0m18:32:26.313067 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:32:26.314290 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:32:26.315550 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:32:26.317680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:32:26.319479 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:32:26.325526 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:32:26.328377 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:32:26.320755 => 18:32:26.327153
[0m18:32:26.330114 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:32:26.335667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:26.786819 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:32:26.788293 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:32:26.996999 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ba541871-8aac-44d6-a04c-cafb3b0db1dd&page=queryresults
[0m18:32:28.915699 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:32:26.331065 => 18:32:28.911643
[0m18:32:28.927886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52d33b88-46e3-4abe-8d83-b542f657a286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca76d3c800>]}
[0m18:32:28.932489 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.61s]
[0m18:32:28.934908 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:32:28.969331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:28.975432 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:32:28.981589 [info ] [MainThread]: 
[0m18:32:28.985195 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.66 seconds (11.66s).
[0m18:32:28.999544 [debug] [MainThread]: Command end result
[0m18:32:29.092984 [info ] [MainThread]: 
[0m18:32:29.105749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:32:29.110760 [info ] [MainThread]: 
[0m18:32:29.113422 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:32:29.127693 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.341473, "process_user_time": 6.384765, "process_kernel_time": 0.289893, "process_mem_max_rss": "135228", "process_out_blocks": "2856", "process_in_blocks": "0"}
[0m18:32:29.130215 [debug] [MainThread]: Command `dbt run` succeeded at 18:32:29.129525 after 13.35 seconds
[0m18:32:29.132665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca78b24770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca774381d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca742e3ad0>]}
[0m18:32:29.135625 [debug] [MainThread]: Flushing usage events
[0m18:35:13.603169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526f062570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526f1638f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526ee59b50>]}


============================== 18:35:13.608282 | 175308a2-267f-41a8-8c91-425c23bffafd ==============================
[0m18:35:13.608282 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:35:13.609705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:35:14.439307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '175308a2-267f-41a8-8c91-425c23bffafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526edc88f0>]}
[0m18:35:14.614294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '175308a2-267f-41a8-8c91-425c23bffafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526d0594f0>]}
[0m18:35:14.615937 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m18:35:14.638101 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:35:14.725528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:35:14.726900 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_most_common_pick_ups_per_base_name.sql
[0m18:35:15.084161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '175308a2-267f-41a8-8c91-425c23bffafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526cf23200>]}
[0m18:35:15.099116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '175308a2-267f-41a8-8c91-425c23bffafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526d0d3ce0>]}
[0m18:35:15.100197 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m18:35:15.101283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '175308a2-267f-41a8-8c91-425c23bffafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526d781af0>]}
[0m18:35:15.104332 [info ] [MainThread]: 
[0m18:35:15.106141 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:35:15.111273 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m18:35:15.113142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:15.597349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m18:35:15.598434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:16.009428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '175308a2-267f-41a8-8c91-425c23bffafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526d0d1f40>]}
[0m18:35:16.011708 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:16.013119 [info ] [MainThread]: 
[0m18:35:16.018412 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:35:16.020033 [info ] [Thread-1 (]: 1 of 4 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m18:35:16.022272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m18:35:16.023473 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:35:16.037582 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:35:16.044237 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 18:35:16.024223 => 18:35:16.041578
[0m18:35:16.049310 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:35:16.130502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:16.626349 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m18:35:16.627886 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m18:35:16.877280 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e6c15ba8-5d5b-4996-8734-ffcd58b877ec&page=queryresults
[0m18:35:18.831755 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 18:35:16.051584 => 18:35:18.831101
[0m18:35:18.833607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '175308a2-267f-41a8-8c91-425c23bffafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526d05bb90>]}
[0m18:35:18.835005 [info ] [Thread-1 (]: 1 of 4 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.81s]
[0m18:35:18.836652 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m18:35:18.837776 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:35:18.839002 [info ] [Thread-1 (]: 2 of 4 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m18:35:18.840765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m18:35:18.842684 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:35:18.849564 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:35:18.852314 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 18:35:18.843838 => 18:35:18.851208
[0m18:35:18.854209 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:35:18.862877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:19.294207 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m18:35:19.295938 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m18:35:19.486526 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:53bedaf7-b9cb-429a-8bdc-5443918136ef&page=queryresults
[0m18:35:21.655753 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 18:35:18.855398 => 18:35:21.655247
[0m18:35:21.657712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '175308a2-267f-41a8-8c91-425c23bffafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526c543e60>]}
[0m18:35:21.659027 [info ] [Thread-1 (]: 2 of 4 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.82s]
[0m18:35:21.660642 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m18:35:21.662323 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:35:21.664237 [info ] [Thread-1 (]: 3 of 4 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m18:35:21.666943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m18:35:21.669141 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:35:21.677321 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:35:21.679956 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 18:35:21.670424 => 18:35:21.678907
[0m18:35:21.682040 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:35:21.690427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:22.117660 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m18:35:22.119296 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m18:35:22.327998 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ec75505f-e4d7-485a-af84-7bb7056806e5&page=queryresults
[0m18:35:24.352433 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 18:35:21.683252 => 18:35:24.342701
[0m18:35:24.357736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '175308a2-267f-41a8-8c91-425c23bffafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526cf814c0>]}
[0m18:35:24.382052 [info ] [Thread-1 (]: 3 of 4 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.69s]
[0m18:35:24.387713 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m18:35:24.396414 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:35:24.412210 [info ] [Thread-1 (]: 4 of 4 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m18:35:24.426985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m18:35:24.434222 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:35:24.464057 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:35:24.474066 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 18:35:24.440959 => 18:35:24.471878
[0m18:35:24.482693 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:35:24.529918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:25.444575 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m18:35:25.450003 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m18:35:25.679616 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:cd2baa91-1dc9-4cf4-a121-8707d7bd36bf&page=queryresults
[0m18:35:27.598654 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 18:35:24.496321 => 18:35:27.597673
[0m18:35:27.610164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '175308a2-267f-41a8-8c91-425c23bffafd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526cf81970>]}
[0m18:35:27.615276 [info ] [Thread-1 (]: 4 of 4 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.19s]
[0m18:35:27.618802 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m18:35:27.626244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:27.627951 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m18:35:27.630238 [info ] [MainThread]: 
[0m18:35:27.632986 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.52 seconds (12.52s).
[0m18:35:27.639404 [debug] [MainThread]: Command end result
[0m18:35:27.719303 [info ] [MainThread]: 
[0m18:35:27.721538 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:27.724585 [info ] [MainThread]: 
[0m18:35:27.730423 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:35:27.738082 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.208295, "process_user_time": 6.587872, "process_kernel_time": 0.331037, "process_mem_max_rss": "133708", "process_out_blocks": "2856", "process_in_blocks": "0"}
[0m18:35:27.742456 [debug] [MainThread]: Command `dbt run` succeeded at 18:35:27.741582 after 14.22 seconds
[0m18:35:27.749298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526f062570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526c5abad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526c5abfe0>]}
[0m18:35:27.760499 [debug] [MainThread]: Flushing usage events
[0m20:41:40.210377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40250696a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f402506a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40250699d0>]}


============================== 20:41:40.215333 | 03dc6c38-e19d-4d28-a95a-e9213f88bf90 ==============================
[0m20:41:40.215333 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:41:40.216701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:41:41.059600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03dc6c38-e19d-4d28-a95a-e9213f88bf90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40237d5c70>]}
[0m20:41:41.232231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03dc6c38-e19d-4d28-a95a-e9213f88bf90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4023357170>]}
[0m20:41:41.233931 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m20:41:41.249061 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m20:41:41.319225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:41:41.320405 [debug] [MainThread]: Partial parsing: added file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:41:41.665209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03dc6c38-e19d-4d28-a95a-e9213f88bf90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40231aa300>]}
[0m20:41:41.679147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03dc6c38-e19d-4d28-a95a-e9213f88bf90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40233dafc0>]}
[0m20:41:41.680272 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m20:41:41.681484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03dc6c38-e19d-4d28-a95a-e9213f88bf90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40236b3bf0>]}
[0m20:41:41.684746 [info ] [MainThread]: 
[0m20:41:41.687046 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:41:41.690676 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m20:41:41.692084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:42.202328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m20:41:42.203449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:42.678890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03dc6c38-e19d-4d28-a95a-e9213f88bf90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40233da0c0>]}
[0m20:41:42.681276 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:41:42.682648 [info ] [MainThread]: 
[0m20:41:42.688072 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:41:42.690454 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m20:41:42.693606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m20:41:42.695504 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:41:42.719915 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:41:42.742516 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 20:41:42.696851 => 20:41:42.740529
[0m20:41:42.746119 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:41:42.856725 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:41:42.858095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:42.861083 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS 'Month'
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

montly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(month_extract.Month) AS `Monthly Count`,
           AVG(COUNT(month_extract.Month)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.Month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.Month / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Difference (%)`
FROM monthly_counts_and_avg
    );
  
[0m20:41:43.717683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:63b4689f-0696-4a6a-8f32-87f25eb3efed&page=queryresults
[0m20:41:43.721629 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'Month' at [24:20]; reason: invalidQuery, location: query, message: Syntax error: Unexpected string literal 'Month' at [24:20]")
[0m20:41:45.183005 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:e8b1fd28-05b8-4972-8322-5e69a16c50db&page=queryresults
[0m20:41:45.184862 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:e8b1fd28-05b8-4972-8322-5e69a16c50db&page=queryresults
[0m20:41:45.187868 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 20:41:42.747193 => 20:41:45.186786
[0m20:41:45.208758 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Syntax error: Unexpected string literal 'Month' at [24:20]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:41:45.211079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03dc6c38-e19d-4d28-a95a-e9213f88bf90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40232a87a0>]}
[0m20:41:45.213630 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 2.52s]
[0m20:41:45.216374 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:41:45.219553 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:41:45.222406 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m20:41:45.234884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m20:41:45.243564 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:41:45.257624 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:41:45.266260 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 20:41:45.248897 => 20:41:45.261980
[0m20:41:45.268668 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:41:45.279275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:45.771685 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:41:45.773499 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m20:41:46.101658 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8938dc92-2f84-4a3d-9daf-1b988950cd32&page=queryresults
[0m20:41:48.132151 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 20:41:45.270020 => 20:41:48.131661
[0m20:41:48.134505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03dc6c38-e19d-4d28-a95a-e9213f88bf90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40235a90d0>]}
[0m20:41:48.136587 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.90s]
[0m20:41:48.138773 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:41:48.140371 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:41:48.142127 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m20:41:48.145197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m20:41:48.146839 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:41:48.151784 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:41:48.153786 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 20:41:48.148044 => 20:41:48.152870
[0m20:41:48.155014 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:41:48.160712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:48.643417 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:41:48.645182 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m20:41:48.890222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e10643bb-168d-4de2-b2bd-d3fab8955e1c&page=queryresults
[0m20:41:51.095962 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 20:41:48.155764 => 20:41:51.094835
[0m20:41:51.100452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03dc6c38-e19d-4d28-a95a-e9213f88bf90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40232817f0>]}
[0m20:41:51.103383 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.96s]
[0m20:41:51.107015 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:41:51.110521 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:41:51.114883 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m20:41:51.117994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m20:41:51.119361 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:41:51.123884 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:41:51.125926 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 20:41:51.120224 => 20:41:51.125261
[0m20:41:51.127146 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:41:51.133278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:51.586034 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:41:51.587544 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m20:41:51.830826 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8ac03506-436c-4710-89f5-8909394f161b&page=queryresults
[0m20:41:53.482463 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 20:41:51.128189 => 20:41:53.481983
[0m20:41:53.484406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03dc6c38-e19d-4d28-a95a-e9213f88bf90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4023281d60>]}
[0m20:41:53.485737 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.37s]
[0m20:41:53.487380 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:41:53.488475 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:41:53.489691 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m20:41:53.491472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m20:41:53.492764 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:41:53.523008 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:41:53.525324 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 20:41:53.493610 => 20:41:53.524424
[0m20:41:53.526807 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:41:53.534559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:53.979473 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:41:53.981001 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m20:41:54.214783 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7fc271dc-fa4f-4b2b-8d85-a2114625372b&page=queryresults
[0m20:41:56.117130 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 20:41:53.527572 => 20:41:56.115963
[0m20:41:56.121219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03dc6c38-e19d-4d28-a95a-e9213f88bf90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4022a5c290>]}
[0m20:41:56.124241 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.63s]
[0m20:41:56.127738 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:41:56.134386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:56.135398 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m20:41:56.136608 [info ] [MainThread]: 
[0m20:41:56.137886 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 14.45 seconds (14.45s).
[0m20:41:56.141105 [debug] [MainThread]: Command end result
[0m20:41:56.161785 [info ] [MainThread]: 
[0m20:41:56.163832 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:41:56.165035 [info ] [MainThread]: 
[0m20:41:56.171450 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Syntax error: Unexpected string literal 'Month' at [24:20]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:41:56.177190 [info ] [MainThread]: 
[0m20:41:56.179116 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:41:56.181719 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.071936, "process_user_time": 6.501967, "process_kernel_time": 0.289865, "process_mem_max_rss": "136312", "process_in_blocks": "7160", "process_out_blocks": "2912", "command_success": false}
[0m20:41:56.183254 [debug] [MainThread]: Command `dbt run` failed at 20:41:56.182776 after 16.07 seconds
[0m20:41:56.184319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f402921b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f402317e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4020962390>]}
[0m20:41:56.186142 [debug] [MainThread]: Flushing usage events
[0m20:42:56.177264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7756abdd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7756abddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7756abdbb0>]}


============================== 20:42:56.182252 | 6a2bfdf4-1afa-406a-ae76-e4b35d9c5f0d ==============================
[0m20:42:56.182252 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:42:56.183684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:42:56.984755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a2bfdf4-1afa-406a-ae76-e4b35d9c5f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7754ebff50>]}
[0m20:42:57.197570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a2bfdf4-1afa-406a-ae76-e4b35d9c5f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7754faab40>]}
[0m20:42:57.200259 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m20:42:57.225104 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m20:42:57.299223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:42:57.300483 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:42:57.664813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a2bfdf4-1afa-406a-ae76-e4b35d9c5f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7754b98980>]}
[0m20:42:57.680785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a2bfdf4-1afa-406a-ae76-e4b35d9c5f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7754dd72c0>]}
[0m20:42:57.682645 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m20:42:57.683951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a2bfdf4-1afa-406a-ae76-e4b35d9c5f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7754d8fc50>]}
[0m20:42:57.687082 [info ] [MainThread]: 
[0m20:42:57.689835 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:42:57.693562 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m20:42:57.695159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:58.218273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m20:42:58.219370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:58.662758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a2bfdf4-1afa-406a-ae76-e4b35d9c5f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7754d8c860>]}
[0m20:42:58.664622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:42:58.665687 [info ] [MainThread]: 
[0m20:42:58.670533 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:42:58.672067 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m20:42:58.674250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m20:42:58.675534 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:42:58.689143 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:42:58.696286 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 20:42:58.676528 => 20:42:58.695302
[0m20:42:58.698155 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:42:58.863898 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:42:58.866802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:58.872962 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

montly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(month_extract.Month) AS `Monthly Count`,
           AVG(COUNT(month_extract.Month)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.Month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.Month / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Difference (%)`
FROM monthly_counts_and_avg
    );
  
[0m20:42:59.375869 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8247e7d3-fc86-4e79-bd96-9e371bc4a517&page=queryresults
[0m20:42:59.377594 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "monthly_counts_and_avg" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: monthly_counts_and_avg, message: Table "monthly_counts_and_avg" must be qualified with a dataset (e.g. dataset.table).')
[0m20:43:00.454846 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:057acea6-286b-4295-8c2d-956d3589901f&page=queryresults
[0m20:43:00.457728 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:057acea6-286b-4295-8c2d-956d3589901f&page=queryresults
[0m20:43:00.461072 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 20:42:58.699996 => 20:43:00.459932
[0m20:43:00.481577 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Table "monthly_counts_and_avg" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:43:00.483959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2bfdf4-1afa-406a-ae76-e4b35d9c5f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7754c81f10>]}
[0m20:43:00.486742 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 1.81s]
[0m20:43:00.491583 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:43:00.494368 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:43:00.497124 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m20:43:00.500412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m20:43:00.502208 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:43:00.511456 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:43:00.514494 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 20:43:00.504010 => 20:43:00.513318
[0m20:43:00.518218 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:43:00.532734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:01.014418 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:43:01.016186 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m20:43:01.264906 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1015029d-8ef0-47d4-933e-9c42a157b097&page=queryresults
[0m20:43:02.904319 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 20:43:00.521098 => 20:43:02.903690
[0m20:43:02.906244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2bfdf4-1afa-406a-ae76-e4b35d9c5f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7754c83f80>]}
[0m20:43:02.907691 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.41s]
[0m20:43:02.909341 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:43:02.910562 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:43:02.911953 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m20:43:02.914505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m20:43:02.916547 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:43:02.923903 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:43:02.926608 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 20:43:02.917800 => 20:43:02.925507
[0m20:43:02.928530 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:43:02.937817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:03.391734 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:43:03.393531 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m20:43:03.607333 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:fb964687-bb38-49e7-953f-96c745ba4544&page=queryresults
[0m20:43:05.458267 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 20:43:02.929858 => 20:43:05.457128
[0m20:43:05.462383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2bfdf4-1afa-406a-ae76-e4b35d9c5f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7754c81220>]}
[0m20:43:05.465392 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.55s]
[0m20:43:05.469238 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:43:05.472099 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:43:05.475618 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m20:43:05.480194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m20:43:05.482634 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:43:05.492634 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:43:05.495996 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 20:43:05.485091 => 20:43:05.494723
[0m20:43:05.498514 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:43:05.507883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:05.981040 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:43:05.982470 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m20:43:06.189508 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c46f2ea3-073c-46f9-9b5e-c58570c6475a&page=queryresults
[0m20:43:07.767398 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 20:43:05.499943 => 20:43:07.766808
[0m20:43:07.769339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2bfdf4-1afa-406a-ae76-e4b35d9c5f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7754c80aa0>]}
[0m20:43:07.770714 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.29s]
[0m20:43:07.772239 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:43:07.773358 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:43:07.774622 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m20:43:07.776565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m20:43:07.778285 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:43:07.802328 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:43:07.804613 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 20:43:07.779022 => 20:43:07.803545
[0m20:43:07.806282 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:43:07.814077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:08.233714 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:43:08.235388 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m20:43:08.435310 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:07077230-6e7d-4a09-8703-c45c5eb09e20&page=queryresults
[0m20:43:10.267941 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 20:43:07.807749 => 20:43:10.267447
[0m20:43:10.269646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2bfdf4-1afa-406a-ae76-e4b35d9c5f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7754471460>]}
[0m20:43:10.271015 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.49s]
[0m20:43:10.272553 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:43:10.275901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:43:10.276811 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m20:43:10.278087 [info ] [MainThread]: 
[0m20:43:10.279401 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 12.59 seconds (12.59s).
[0m20:43:10.282620 [debug] [MainThread]: Command end result
[0m20:43:10.297012 [info ] [MainThread]: 
[0m20:43:10.298513 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:43:10.300686 [info ] [MainThread]: 
[0m20:43:10.302991 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Table "monthly_counts_and_avg" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:43:10.305753 [info ] [MainThread]: 
[0m20:43:10.308044 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:43:10.316027 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.215224, "process_user_time": 6.5816, "process_kernel_time": 0.314197, "process_mem_max_rss": "136708", "process_out_blocks": "2912", "command_success": false, "process_in_blocks": "0"}
[0m20:43:10.318697 [debug] [MainThread]: Command `dbt run` failed at 20:43:10.318006 after 14.22 seconds
[0m20:43:10.324562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7755178d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7757bc5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7754471850>]}
[0m20:43:10.327994 [debug] [MainThread]: Flushing usage events
[0m20:46:16.421543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e626be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e68c8bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e62697f0>]}


============================== 20:46:16.440957 | 416c9a3c-2d2f-404b-a8e2-e5f13d5958f6 ==============================
[0m20:46:16.440957 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:46:16.446796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:46:17.352184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '416c9a3c-2d2f-404b-a8e2-e5f13d5958f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e47a74a0>]}
[0m20:46:17.525140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '416c9a3c-2d2f-404b-a8e2-e5f13d5958f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e468f350>]}
[0m20:46:17.526693 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m20:46:17.542075 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m20:46:17.640565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:46:17.641799 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:46:17.984576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '416c9a3c-2d2f-404b-a8e2-e5f13d5958f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e437f7d0>]}
[0m20:46:17.998774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '416c9a3c-2d2f-404b-a8e2-e5f13d5958f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e45cf440>]}
[0m20:46:17.999886 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m20:46:18.000975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '416c9a3c-2d2f-404b-a8e2-e5f13d5958f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e45cc110>]}
[0m20:46:18.004181 [info ] [MainThread]: 
[0m20:46:18.006046 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:46:18.009909 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m20:46:18.011547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:18.522737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m20:46:18.524403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:19.013560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '416c9a3c-2d2f-404b-a8e2-e5f13d5958f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e45ce300>]}
[0m20:46:19.015524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:46:19.016796 [info ] [MainThread]: 
[0m20:46:19.020574 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:46:19.022207 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m20:46:19.024312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m20:46:19.025789 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:46:19.047674 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:46:19.055295 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 20:46:19.026524 => 20:46:19.051476
[0m20:46:19.058842 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:46:19.161115 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:46:19.162550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:19.165568 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(month_extract.Month) AS `Monthly Count`,
           AVG(COUNT(month_extract.Month)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.Month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.Month / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Difference (%)`
FROM monthly_counts_and_avg
    );
  
[0m20:46:19.694053 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b24ba279-546e-46b7-9704-70c05278eaec&page=queryresults
[0m20:46:19.849827 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator / for argument types: STRING, FLOAT64. Supported signatures: FLOAT64 / FLOAT64; NUMERIC / NUMERIC; BIGNUMERIC / BIGNUMERIC; INTERVAL / INT64 at [39:10]; reason: invalidQuery, location: query, message: No matching signature for operator / for argument types: STRING, FLOAT64. Supported signatures: FLOAT64 / FLOAT64; NUMERIC / NUMERIC; BIGNUMERIC / BIGNUMERIC; INTERVAL / INT64 at [39:10]')
[0m20:46:20.813815 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:59907293-4a23-4684-8465-9d344438b56c&page=queryresults
[0m20:46:21.221253 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:59907293-4a23-4684-8465-9d344438b56c&page=queryresults
[0m20:46:21.224642 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 20:46:19.061576 => 20:46:21.223379
[0m20:46:21.235691 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  No matching signature for operator / for argument types: STRING, FLOAT64. Supported signatures: FLOAT64 / FLOAT64; NUMERIC / NUMERIC; BIGNUMERIC / BIGNUMERIC; INTERVAL / INT64 at [39:10]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:46:21.237071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '416c9a3c-2d2f-404b-a8e2-e5f13d5958f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e447e330>]}
[0m20:46:21.238976 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 2.21s]
[0m20:46:21.240898 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:46:21.242109 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:46:21.243630 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m20:46:21.247507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m20:46:21.250347 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:46:21.261196 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:46:21.264213 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 20:46:21.251761 => 20:46:21.263157
[0m20:46:21.272763 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:46:21.288407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:21.749235 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:46:21.750728 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m20:46:21.953662 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ea7dbd8f-217f-4a9c-96fb-68c362bef1a6&page=queryresults
[0m20:46:23.856554 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 20:46:21.276315 => 20:46:23.855993
[0m20:46:23.858284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '416c9a3c-2d2f-404b-a8e2-e5f13d5958f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e3c4b5c0>]}
[0m20:46:23.859618 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.61s]
[0m20:46:23.861319 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:46:23.862430 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:46:23.863750 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m20:46:23.866539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m20:46:23.868465 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:46:23.876171 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:46:23.878795 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 20:46:23.869685 => 20:46:23.877759
[0m20:46:23.880792 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:46:23.889359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:24.348612 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:46:24.350114 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m20:46:24.538146 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a43c3196-85fb-4703-aa0c-a00506732b62&page=queryresults
[0m20:46:26.402182 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 20:46:23.882017 => 20:46:26.401695
[0m20:46:26.404588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '416c9a3c-2d2f-404b-a8e2-e5f13d5958f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e1b15430>]}
[0m20:46:26.406766 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.54s]
[0m20:46:26.409334 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:46:26.411360 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:46:26.413554 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m20:46:26.418712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m20:46:26.422337 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:46:26.432357 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:46:26.435532 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 20:46:26.424587 => 20:46:26.434327
[0m20:46:26.437641 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:46:26.449032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:26.928836 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:46:26.930265 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m20:46:27.120121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:90afb86e-8901-4d2d-beda-89a392839e02&page=queryresults
[0m20:46:29.002398 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 20:46:26.438793 => 20:46:29.001914
[0m20:46:29.004308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '416c9a3c-2d2f-404b-a8e2-e5f13d5958f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e3c4b5c0>]}
[0m20:46:29.005670 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.59s]
[0m20:46:29.007243 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:46:29.008386 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:46:29.009679 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m20:46:29.011514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m20:46:29.013084 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:46:29.052392 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:46:29.054288 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 20:46:29.014388 => 20:46:29.053640
[0m20:46:29.055383 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:46:29.072233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:29.510424 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:46:29.512161 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m20:46:29.727148 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:248e9344-8ad3-458b-9eb9-1cc79c6091e8&page=queryresults
[0m20:46:31.317834 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 20:46:29.056049 => 20:46:31.316710
[0m20:46:31.322156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '416c9a3c-2d2f-404b-a8e2-e5f13d5958f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e447d640>]}
[0m20:46:31.325631 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.31s]
[0m20:46:31.329376 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:46:31.335363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:31.337059 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m20:46:31.338777 [info ] [MainThread]: 
[0m20:46:31.339909 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 13.33 seconds (13.33s).
[0m20:46:31.343505 [debug] [MainThread]: Command end result
[0m20:46:31.367976 [info ] [MainThread]: 
[0m20:46:31.373002 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:46:31.374648 [info ] [MainThread]: 
[0m20:46:31.376658 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  No matching signature for operator / for argument types: STRING, FLOAT64. Supported signatures: FLOAT64 / FLOAT64; NUMERIC / NUMERIC; BIGNUMERIC / BIGNUMERIC; INTERVAL / INT64 at [39:10]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:46:31.384531 [info ] [MainThread]: 
[0m20:46:31.389083 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:46:31.391952 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.095771, "process_user_time": 6.852071, "process_kernel_time": 0.293597, "process_mem_max_rss": "134380", "process_in_blocks": "608", "process_out_blocks": "2912", "command_success": false}
[0m20:46:31.394416 [debug] [MainThread]: Command `dbt run` failed at 20:46:31.393808 after 15.10 seconds
[0m20:46:31.396210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e65169f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e1b3de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e47c8f20>]}
[0m20:46:31.398062 [debug] [MainThread]: Flushing usage events
[0m20:48:18.128245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74c8619d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74cb5a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74c8607a0>]}


============================== 20:48:18.133320 | 254e456e-e851-44ab-b493-d36b0528285a ==============================
[0m20:48:18.133320 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:48:18.134662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:48:18.951783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '254e456e-e851-44ab-b493-d36b0528285a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74ac8b380>]}
[0m20:48:19.124841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '254e456e-e851-44ab-b493-d36b0528285a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74c8606e0>]}
[0m20:48:19.126280 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m20:48:19.142227 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m20:48:19.215459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:48:19.216735 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:48:19.560693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '254e456e-e851-44ab-b493-d36b0528285a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74aa27920>]}
[0m20:48:19.574723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '254e456e-e851-44ab-b493-d36b0528285a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74abbfc80>]}
[0m20:48:19.575804 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m20:48:19.576990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '254e456e-e851-44ab-b493-d36b0528285a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74a9bb920>]}
[0m20:48:19.580158 [info ] [MainThread]: 
[0m20:48:19.582336 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:48:19.586225 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m20:48:19.588319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:20.099387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m20:48:20.100478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:20.533498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '254e456e-e851-44ab-b493-d36b0528285a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74adc2f30>]}
[0m20:48:20.535199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:48:20.536197 [info ] [MainThread]: 
[0m20:48:20.540146 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:48:20.541465 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m20:48:20.543755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m20:48:20.545140 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:48:20.579167 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:48:20.590587 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 20:48:20.545919 => 20:48:20.586035
[0m20:48:20.593683 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:48:20.703152 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:48:20.704567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:20.707595 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(month_extract.Month) AS `Monthly Count`,
           AVG(COUNT(month_extract.Month)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.Month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       (((CAST(monthly_counts_and_avg.`Month` AS FLOAT64)) / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Difference (%)`
FROM monthly_counts_and_avg
    );
  
[0m20:48:21.296834 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:af0461a0-9354-4ba4-8c43-3c17bafa259f&page=queryresults
[0m20:48:21.414932 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Illegal field name: Difference (%); reason: invalidQuery, location: query, message: Illegal field name: Difference (%)')
[0m20:48:22.572771 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d86b72c5-dfd7-450b-9a6f-bdaaefb4e111&page=queryresults
[0m20:48:23.375435 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d86b72c5-dfd7-450b-9a6f-bdaaefb4e111&page=queryresults
[0m20:48:23.379290 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 20:48:20.595172 => 20:48:23.377904
[0m20:48:23.402219 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Illegal field name: Difference (%)
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:48:23.404225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '254e456e-e851-44ab-b493-d36b0528285a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74ad230e0>]}
[0m20:48:23.406636 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 2.86s]
[0m20:48:23.410420 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:48:23.413003 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:48:23.420208 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m20:48:23.429931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m20:48:23.436324 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:48:23.446331 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:48:23.451045 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 20:48:23.439188 => 20:48:23.449920
[0m20:48:23.457430 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:48:23.466855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:23.922843 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:48:23.924559 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m20:48:24.155379 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:356fa0bb-3e9e-4da7-97c8-d5e4ef70f7fe&page=queryresults
[0m20:48:25.806200 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 20:48:23.458715 => 20:48:25.805369
[0m20:48:25.809014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '254e456e-e851-44ab-b493-d36b0528285a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74cf8f050>]}
[0m20:48:25.811448 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.38s]
[0m20:48:25.813799 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:48:25.815627 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:48:25.818384 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m20:48:25.822419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m20:48:25.824410 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:48:25.829356 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:48:25.831296 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 20:48:25.825560 => 20:48:25.830579
[0m20:48:25.832442 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:48:25.838675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:26.272952 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:48:26.274705 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m20:48:26.467507 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f8fe3ae5-14a5-4af0-aa60-0d1892ee01fd&page=queryresults
[0m20:48:28.343118 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 20:48:25.833098 => 20:48:28.341975
[0m20:48:28.346989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '254e456e-e851-44ab-b493-d36b0528285a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74ad20fe0>]}
[0m20:48:28.349911 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.53s]
[0m20:48:28.353583 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:48:28.356071 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:48:28.360721 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m20:48:28.366199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m20:48:28.368919 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:48:28.377236 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:48:28.380799 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 20:48:28.371129 => 20:48:28.379304
[0m20:48:28.382869 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:48:28.394533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:28.841386 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:48:28.842891 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m20:48:29.061021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ed385f3a-35f1-4e15-b78d-7e281d045bb1&page=queryresults
[0m20:48:30.986003 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 20:48:28.384168 => 20:48:30.985530
[0m20:48:30.987836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '254e456e-e851-44ab-b493-d36b0528285a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74aa6da60>]}
[0m20:48:30.989126 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.62s]
[0m20:48:30.992118 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:48:30.994540 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:48:30.997841 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m20:48:31.002693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m20:48:31.005957 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:48:31.045165 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:48:31.058956 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 20:48:31.007566 => 20:48:31.055335
[0m20:48:31.064833 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:48:31.079069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:31.513468 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:48:31.514888 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m20:48:31.740289 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:69dffe1a-1ab5-4c55-9add-b46c373707fc&page=queryresults
[0m20:48:33.349085 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 20:48:31.070103 => 20:48:33.347645
[0m20:48:33.352500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '254e456e-e851-44ab-b493-d36b0528285a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74a236ae0>]}
[0m20:48:33.354247 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.35s]
[0m20:48:33.363565 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:48:33.371066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:33.372476 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m20:48:33.374585 [info ] [MainThread]: 
[0m20:48:33.377319 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 13.79 seconds (13.79s).
[0m20:48:33.384537 [debug] [MainThread]: Command end result
[0m20:48:33.415063 [info ] [MainThread]: 
[0m20:48:33.417008 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:48:33.418975 [info ] [MainThread]: 
[0m20:48:33.420866 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Illegal field name: Difference (%)
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:48:33.422979 [info ] [MainThread]: 
[0m20:48:33.424821 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:48:33.427998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.376137, "process_user_time": 6.621569, "process_kernel_time": 0.263064, "process_mem_max_rss": "136512", "process_out_blocks": "2912", "command_success": false, "process_in_blocks": "0"}
[0m20:48:33.431013 [debug] [MainThread]: Command `dbt run` failed at 20:48:33.430246 after 15.38 seconds
[0m20:48:33.433866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74c8619d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74a9b8da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb74a9b81d0>]}
[0m20:48:33.436080 [debug] [MainThread]: Flushing usage events
[0m20:49:14.298584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db55629f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db578f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db5561280>]}


============================== 20:49:14.304326 | cb779752-ae7f-4ddb-abf5-1c2f8a972880 ==============================
[0m20:49:14.304326 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:49:14.306849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:49:15.245533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb779752-ae7f-4ddb-abf5-1c2f8a972880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db3a3ecc0>]}
[0m20:49:15.419440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb779752-ae7f-4ddb-abf5-1c2f8a972880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db3aa49b0>]}
[0m20:49:15.420959 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m20:49:15.436008 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m20:49:15.511989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:49:15.513238 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:49:15.860003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb779752-ae7f-4ddb-abf5-1c2f8a972880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db3e82840>]}
[0m20:49:15.874071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb779752-ae7f-4ddb-abf5-1c2f8a972880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db38d7ce0>]}
[0m20:49:15.875124 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m20:49:15.876178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb779752-ae7f-4ddb-abf5-1c2f8a972880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db38d7140>]}
[0m20:49:15.879511 [info ] [MainThread]: 
[0m20:49:15.881378 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:49:15.884547 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m20:49:15.885926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:16.403677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m20:49:16.405454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:16.840464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb779752-ae7f-4ddb-abf5-1c2f8a972880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db38d5ac0>]}
[0m20:49:16.843006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:49:16.844706 [info ] [MainThread]: 
[0m20:49:16.850721 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:49:16.852283 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m20:49:16.854867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m20:49:16.856029 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:49:16.885563 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:49:16.892822 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 20:49:16.856855 => 20:49:16.890139
[0m20:49:16.896725 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:49:17.006704 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:49:17.008159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:17.011140 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(month_extract.Month) AS `Monthly Count`,
           AVG(COUNT(month_extract.Month)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.Month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       (((CAST(monthly_counts_and_avg.`Month` AS FLOAT64)) / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
    );
  
[0m20:49:17.509900 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0500a3b1-e735-47bd-9535-9d4849ac1dda&page=queryresults
[0m20:49:18.416083 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Bad double value: June; reason: invalidQuery, location: query, message: Bad double value: June')
[0m20:49:18.715655 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1dc22bd4-29bb-4f2b-a6d4-8cfbca69aad3&page=queryresults
[0m20:49:19.356085 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1dc22bd4-29bb-4f2b-a6d4-8cfbca69aad3&page=queryresults
[0m20:49:19.359723 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 20:49:16.900015 => 20:49:19.358302
[0m20:49:19.375786 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Bad double value: April
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:49:19.377136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb779752-ae7f-4ddb-abf5-1c2f8a972880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db3a27950>]}
[0m20:49:19.378534 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 2.52s]
[0m20:49:19.380808 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:49:19.382844 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:49:19.385740 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m20:49:19.389181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m20:49:19.391123 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:49:19.402072 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:49:19.409398 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 20:49:19.394558 => 20:49:19.406829
[0m20:49:19.416960 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:49:19.427711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:19.875725 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:49:19.877477 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m20:49:20.057799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:fee7a40a-7671-4273-be17-ce6c132fde75&page=queryresults
[0m20:49:21.679328 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 20:49:19.418725 => 20:49:21.678833
[0m20:49:21.681150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb779752-ae7f-4ddb-abf5-1c2f8a972880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db5c93170>]}
[0m20:49:21.682482 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.29s]
[0m20:49:21.684109 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:49:21.685218 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:49:21.686501 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m20:49:21.688167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m20:49:21.689506 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:49:21.693812 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:49:21.696079 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 20:49:21.690302 => 20:49:21.695332
[0m20:49:21.697172 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:49:21.702674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:22.174105 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:49:22.175585 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m20:49:22.383822 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0ddf81fc-3d3a-4be9-a313-62e74c0e5ce5&page=queryresults
[0m20:49:24.276308 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 20:49:21.697819 => 20:49:24.275794
[0m20:49:24.278125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb779752-ae7f-4ddb-abf5-1c2f8a972880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db377d730>]}
[0m20:49:24.279473 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.59s]
[0m20:49:24.281059 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:49:24.282096 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:49:24.283321 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m20:49:24.284966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m20:49:24.286394 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:49:24.290598 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:49:24.292298 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 20:49:24.287253 => 20:49:24.291681
[0m20:49:24.293358 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:49:24.298330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:24.741101 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:49:24.742819 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m20:49:24.936846 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1dd24089-7388-4dee-bd59-297899f5c96c&page=queryresults
[0m20:49:26.487710 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 20:49:24.294007 => 20:49:26.486579
[0m20:49:26.491774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb779752-ae7f-4ddb-abf5-1c2f8a972880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db377d850>]}
[0m20:49:26.494869 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.21s]
[0m20:49:26.498465 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:49:26.500965 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:49:26.504527 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m20:49:26.508824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m20:49:26.511469 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:49:26.573991 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:49:26.578816 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 20:49:26.513464 => 20:49:26.576199
[0m20:49:26.583110 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:49:26.593188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:27.052541 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:49:27.054202 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m20:49:27.311073 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0d164ef6-78e2-4b28-93f3-f7aa442cc0e0&page=queryresults
[0m20:49:29.178005 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 20:49:26.584493 => 20:49:29.176877
[0m20:49:29.182135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb779752-ae7f-4ddb-abf5-1c2f8a972880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db0c143b0>]}
[0m20:49:29.185403 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.67s]
[0m20:49:29.188962 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:49:29.199233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:29.202663 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m20:49:29.204705 [info ] [MainThread]: 
[0m20:49:29.206388 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 13.32 seconds (13.32s).
[0m20:49:29.212034 [debug] [MainThread]: Command end result
[0m20:49:29.240461 [info ] [MainThread]: 
[0m20:49:29.246134 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:49:29.249874 [info ] [MainThread]: 
[0m20:49:29.254507 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Bad double value: April
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:49:29.257877 [info ] [MainThread]: 
[0m20:49:29.261235 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:49:29.268943 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.046462, "process_user_time": 6.690498, "process_kernel_time": 0.329671, "process_mem_max_rss": "134720", "process_out_blocks": "2912", "command_success": false, "process_in_blocks": "0"}
[0m20:49:29.271152 [debug] [MainThread]: Command `dbt run` failed at 20:49:29.270776 after 15.05 seconds
[0m20:49:29.272856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db58c89e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db3852570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db3a274a0>]}
[0m20:49:29.275369 [debug] [MainThread]: Flushing usage events
[0m20:51:13.268519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8564525640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85647aaf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8564527dd0>]}


============================== 20:51:13.273779 | 5960b618-54ee-48d6-8745-2b16875a35a6 ==============================
[0m20:51:13.273779 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:51:13.275178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:51:14.090528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5960b618-54ee-48d6-8745-2b16875a35a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8562feef00>]}
[0m20:51:14.264084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5960b618-54ee-48d6-8745-2b16875a35a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85629c0830>]}
[0m20:51:14.265690 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m20:51:14.281402 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m20:51:14.344312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:51:14.345516 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:51:14.686683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5960b618-54ee-48d6-8745-2b16875a35a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8562927710>]}
[0m20:51:14.700850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5960b618-54ee-48d6-8745-2b16875a35a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8562850320>]}
[0m20:51:14.701930 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m20:51:14.702948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5960b618-54ee-48d6-8745-2b16875a35a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856264e6c0>]}
[0m20:51:14.706103 [info ] [MainThread]: 
[0m20:51:14.707946 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:51:14.712142 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m20:51:14.714301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:15.252224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m20:51:15.253320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:15.697618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5960b618-54ee-48d6-8745-2b16875a35a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856264c2c0>]}
[0m20:51:15.699612 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:15.700760 [info ] [MainThread]: 
[0m20:51:15.705403 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:51:15.707594 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m20:51:15.710707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m20:51:15.712630 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:51:15.737202 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:51:15.763851 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 20:51:15.714089 => 20:51:15.762454
[0m20:51:15.765653 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:51:15.867454 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:51:15.868845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:15.871758 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.Month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       (((CAST(monthly_counts_and_avg.`Month` AS FLOAT64)) / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
    );
  
[0m20:51:16.414508 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:369ec95d-e9dd-4f4f-8569-e21dd6a3052c&page=queryresults
[0m20:51:17.076172 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Bad double value: April; reason: invalidQuery, location: query, message: Bad double value: April; reason: invalidQuery, location: query, message: Bad double value: June')
[0m20:51:17.796130 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:23fac989-83c7-470b-a5a8-90944eee6901&page=queryresults
[0m20:51:18.453503 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:23fac989-83c7-470b-a5a8-90944eee6901&page=queryresults
[0m20:51:18.457229 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 20:51:15.766605 => 20:51:18.455752
[0m20:51:18.481144 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Bad double value: June
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:51:18.483272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5960b618-54ee-48d6-8745-2b16875a35a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85626c1ee0>]}
[0m20:51:18.485853 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 2.77s]
[0m20:51:18.489030 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:51:18.491774 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:51:18.494647 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m20:51:18.498250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m20:51:18.500665 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:51:18.508901 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:51:18.512708 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 20:51:18.502033 => 20:51:18.511528
[0m20:51:18.516038 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:51:18.529097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:19.068622 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:51:19.070317 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m20:51:19.261213 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:07b3b451-b4fa-44b5-b2d5-d525ba67743a&page=queryresults
[0m20:51:20.889838 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 20:51:18.518023 => 20:51:20.888947
[0m20:51:20.892413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5960b618-54ee-48d6-8745-2b16875a35a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85627052b0>]}
[0m20:51:20.894451 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.40s]
[0m20:51:20.896936 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:51:20.898513 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:51:20.900607 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m20:51:20.903698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m20:51:20.905940 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:51:20.916187 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:51:20.919648 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 20:51:20.907729 => 20:51:20.918214
[0m20:51:20.922147 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:51:20.933270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:21.384932 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:51:21.386358 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m20:51:21.567824 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:efb04888-8a10-4ea9-84a2-84d49dee7518&page=queryresults
[0m20:51:23.411227 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 20:51:20.923595 => 20:51:23.410736
[0m20:51:23.413144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5960b618-54ee-48d6-8745-2b16875a35a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85627054c0>]}
[0m20:51:23.414454 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.51s]
[0m20:51:23.415970 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:51:23.417158 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:51:23.418418 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m20:51:23.420144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m20:51:23.421514 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:51:23.425584 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:51:23.427300 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 20:51:23.422331 => 20:51:23.426626
[0m20:51:23.428513 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:51:23.433442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:23.877844 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:51:23.879281 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m20:51:24.083329 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:98b6c69b-5ff5-4e03-a50a-d86569e2d0bc&page=queryresults
[0m20:51:25.932189 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 20:51:23.429296 => 20:51:25.931064
[0m20:51:25.936036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5960b618-54ee-48d6-8745-2b16875a35a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85603f89b0>]}
[0m20:51:25.938951 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.52s]
[0m20:51:25.942631 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:51:25.945129 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:51:25.950113 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m20:51:25.956443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m20:51:25.959585 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:51:26.015800 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:51:26.018733 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 20:51:25.961260 => 20:51:26.017420
[0m20:51:26.021709 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:51:26.031805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:26.465586 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:51:26.467316 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m20:51:26.687420 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:3ecd7109-5c54-4378-a211-67602dc31d95&page=queryresults
[0m20:51:28.282446 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 20:51:26.022994 => 20:51:28.281944
[0m20:51:28.284203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5960b618-54ee-48d6-8745-2b16875a35a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8562c40830>]}
[0m20:51:28.285569 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.33s]
[0m20:51:28.287224 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:51:28.290516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:28.291370 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m20:51:28.292809 [info ] [MainThread]: 
[0m20:51:28.294155 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 13.59 seconds (13.59s).
[0m20:51:28.297418 [debug] [MainThread]: Command end result
[0m20:51:28.327841 [info ] [MainThread]: 
[0m20:51:28.333275 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:51:28.336925 [info ] [MainThread]: 
[0m20:51:28.341438 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Bad double value: June
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:51:28.347298 [info ] [MainThread]: 
[0m20:51:28.352535 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:51:28.357784 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.1643, "process_user_time": 6.575673, "process_kernel_time": 0.306523, "process_mem_max_rss": "138408", "process_out_blocks": "2912", "command_success": false, "process_in_blocks": "0"}
[0m20:51:28.359763 [debug] [MainThread]: Command `dbt run` failed at 20:51:28.359133 after 15.17 seconds
[0m20:51:28.360723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856455bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8564559220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85629c3e60>]}
[0m20:51:28.361722 [debug] [MainThread]: Flushing usage events
[0m20:54:57.420929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41364d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41364ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41364c5f0>]}


============================== 20:54:57.425855 | 986503f1-180f-4d3f-8977-bdad963b5959 ==============================
[0m20:54:57.425855 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:54:57.427198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:54:58.240991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '986503f1-180f-4d3f-8977-bdad963b5959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb411aef3e0>]}
[0m20:54:58.412636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '986503f1-180f-4d3f-8977-bdad963b5959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4118df920>]}
[0m20:54:58.414135 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m20:54:58.433755 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m20:54:58.506140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:54:58.507689 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:54:58.850496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '986503f1-180f-4d3f-8977-bdad963b5959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb411847ce0>]}
[0m20:54:58.864266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '986503f1-180f-4d3f-8977-bdad963b5959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41177c380>]}
[0m20:54:58.865312 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m20:54:58.866470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '986503f1-180f-4d3f-8977-bdad963b5959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb411550860>]}
[0m20:54:58.869586 [info ] [MainThread]: 
[0m20:54:58.871559 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:54:58.875544 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m20:54:58.877152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:59.360861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m20:54:59.361928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:59.804524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '986503f1-180f-4d3f-8977-bdad963b5959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4118b16d0>]}
[0m20:54:59.806236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:59.807672 [info ] [MainThread]: 
[0m20:54:59.814872 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:54:59.817136 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m20:54:59.820182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m20:54:59.822150 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:54:59.847084 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:54:59.858139 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 20:54:59.823386 => 20:54:59.856155
[0m20:54:59.864112 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:54:59.975622 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:54:59.977104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:59.980131 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS month_number,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.month_number) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       (((CAST(monthly_counts_and_avg.`Month` AS FLOAT64)) / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
    );
  
[0m20:55:00.521136 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:cbf6d769-7803-4ca7-ba2f-17ce2a0915f5&page=queryresults
[0m20:55:00.680052 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Window ORDER BY expression references month_extract.month_number which is neither grouped nor aggregated at [34:92]; reason: invalidQuery, location: query, message: Window ORDER BY expression references month_extract.month_number which is neither grouped nor aggregated at [34:92]')
[0m20:55:01.066105 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:42bb8acd-9389-410c-aed7-360c5fb062ad&page=queryresults
[0m20:55:01.240275 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:42bb8acd-9389-410c-aed7-360c5fb062ad&page=queryresults
[0m20:55:01.243753 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 20:54:59.867247 => 20:55:01.242441
[0m20:55:01.264920 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Window ORDER BY expression references month_extract.month_number which is neither grouped nor aggregated at [34:92]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:55:01.266231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986503f1-180f-4d3f-8977-bdad963b5959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41162e4e0>]}
[0m20:55:01.267738 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 1.45s]
[0m20:55:01.269345 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:55:01.271326 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:55:01.274497 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m20:55:01.279246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m20:55:01.284233 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:55:01.289194 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:55:01.332894 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 20:55:01.285666 => 20:55:01.332091
[0m20:55:01.337931 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:55:01.350366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:01.796032 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:55:01.797887 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m20:55:01.984361 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8739d970-ea10-4cd4-bb97-b913980a5f80&page=queryresults
[0m20:55:03.930639 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 20:55:01.338801 => 20:55:03.929930
[0m20:55:03.933664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986503f1-180f-4d3f-8977-bdad963b5959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb411627d10>]}
[0m20:55:03.935748 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.66s]
[0m20:55:03.938017 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:55:03.939539 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:55:03.941343 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m20:55:03.944851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m20:55:03.946468 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:55:03.952626 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:55:03.955359 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 20:55:03.947516 => 20:55:03.954227
[0m20:55:03.957001 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:55:03.963477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:04.436173 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:55:04.438841 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m20:55:04.641314 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:fb66708d-f81d-4ebc-b643-b7aa0560ef79&page=queryresults
[0m20:55:06.560702 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 20:55:03.958036 => 20:55:06.559061
[0m20:55:06.564865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986503f1-180f-4d3f-8977-bdad963b5959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41162cda0>]}
[0m20:55:06.566219 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.62s]
[0m20:55:06.567831 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:55:06.568950 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:55:06.570245 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m20:55:06.572385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m20:55:06.574386 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:55:06.581088 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:55:06.583776 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 20:55:06.575588 => 20:55:06.582629
[0m20:55:06.585640 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:55:06.594242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:07.265946 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:55:07.268060 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m20:55:07.462079 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e8071a42-26bf-4e60-b049-24c74994f63a&page=queryresults
[0m20:55:09.301840 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 20:55:06.586796 => 20:55:09.301340
[0m20:55:09.303808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986503f1-180f-4d3f-8977-bdad963b5959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41162d7f0>]}
[0m20:55:09.305248 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.73s]
[0m20:55:09.307051 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:55:09.308182 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:55:09.309639 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m20:55:09.311431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m20:55:09.312718 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:55:09.344541 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:55:09.348664 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 20:55:09.313540 => 20:55:09.345889
[0m20:55:09.354759 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:55:09.365879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:09.819030 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:55:09.821021 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m20:55:10.037554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a5213ca8-486f-473e-8c96-c95052c65e13&page=queryresults
[0m20:55:11.609105 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 20:55:09.357032 => 20:55:11.607968
[0m20:55:11.613574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986503f1-180f-4d3f-8977-bdad963b5959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4115ffb90>]}
[0m20:55:11.616637 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.30s]
[0m20:55:11.620127 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:55:11.627506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:11.629261 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m20:55:11.631312 [info ] [MainThread]: 
[0m20:55:11.632989 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 12.76 seconds (12.76s).
[0m20:55:11.638195 [debug] [MainThread]: Command end result
[0m20:55:11.671031 [info ] [MainThread]: 
[0m20:55:11.676079 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:55:11.682872 [info ] [MainThread]: 
[0m20:55:11.686309 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Window ORDER BY expression references month_extract.month_number which is neither grouped nor aggregated at [34:92]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:55:11.691889 [info ] [MainThread]: 
[0m20:55:11.697219 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:55:11.699844 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.354374, "process_user_time": 6.887097, "process_kernel_time": 0.279914, "process_mem_max_rss": "135968", "process_out_blocks": "2912", "command_success": false, "process_in_blocks": "0"}
[0m20:55:11.701224 [debug] [MainThread]: Command `dbt run` failed at 20:55:11.700826 after 14.36 seconds
[0m20:55:11.702962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41765b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb410715130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb410717e60>]}
[0m20:55:11.706041 [debug] [MainThread]: Flushing usage events
[0m20:56:03.277596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab75244380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab75334bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab752445f0>]}


============================== 20:56:03.282552 | b79efb9c-9736-4622-90d1-e9cc7d9fcf2b ==============================
[0m20:56:03.282552 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:56:03.283913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:56:04.098946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b79efb9c-9736-4622-90d1-e9cc7d9fcf2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab73816e40>]}
[0m20:56:04.273967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b79efb9c-9736-4622-90d1-e9cc7d9fcf2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab735304d0>]}
[0m20:56:04.275422 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m20:56:04.291410 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m20:56:04.363719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:56:04.364946 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:56:04.717308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b79efb9c-9736-4622-90d1-e9cc7d9fcf2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab7333d2e0>]}
[0m20:56:04.731131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b79efb9c-9736-4622-90d1-e9cc7d9fcf2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab7337c0e0>]}
[0m20:56:04.732190 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m20:56:04.733268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b79efb9c-9736-4622-90d1-e9cc7d9fcf2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab7337c170>]}
[0m20:56:04.736439 [info ] [MainThread]: 
[0m20:56:04.738277 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:56:04.742237 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m20:56:04.744269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:05.237932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m20:56:05.239000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:05.657844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b79efb9c-9736-4622-90d1-e9cc7d9fcf2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab73443e00>]}
[0m20:56:05.660002 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:56:05.661048 [info ] [MainThread]: 
[0m20:56:05.665029 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:56:05.666499 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m20:56:05.669636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m20:56:05.671190 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:56:05.685542 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:56:05.713494 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 20:56:05.671949 => 20:56:05.710880
[0m20:56:05.717587 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:56:05.829493 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:56:05.831191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:05.834241 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS month_number,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.month_number) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_number
)

SELECT *,
       (((CAST(monthly_counts_and_avg.`Month` AS FLOAT64)) / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
    );
  
[0m20:56:06.367918 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:99e03c70-646a-4275-9b8d-3a9614da7c77&page=queryresults
[0m20:56:07.049131 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Bad double value: January; reason: invalidQuery, location: query, message: Bad double value: January')
[0m20:56:07.351917 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e9851a94-9671-48d5-accc-139b6e76b50c&page=queryresults
[0m20:56:07.985379 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e9851a94-9671-48d5-accc-139b6e76b50c&page=queryresults
[0m20:56:07.987097 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 20:56:05.719368 => 20:56:07.986460
[0m20:56:07.996932 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Bad double value: January
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:56:07.998193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b79efb9c-9736-4622-90d1-e9cc7d9fcf2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab7337e480>]}
[0m20:56:07.999795 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 2.33s]
[0m20:56:08.001810 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:56:08.003279 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:56:08.004742 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m20:56:08.007010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m20:56:08.009332 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:56:08.016747 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:56:08.023320 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 20:56:08.010796 => 20:56:08.020327
[0m20:56:08.027155 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:56:08.040875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:08.507945 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:56:08.510247 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m20:56:08.698144 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c6277923-6506-4826-9a79-1ea5c66ee1ac&page=queryresults
[0m20:56:10.352689 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 20:56:08.029630 => 20:56:10.351844
[0m20:56:10.355515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b79efb9c-9736-4622-90d1-e9cc7d9fcf2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab7322cf80>]}
[0m20:56:10.357683 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.35s]
[0m20:56:10.360105 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:56:10.361707 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:56:10.363587 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m20:56:10.366561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m20:56:10.368178 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:56:10.373943 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:56:10.376054 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 20:56:10.369179 => 20:56:10.375212
[0m20:56:10.377583 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:56:10.382726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:10.833157 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:56:10.834648 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m20:56:11.015933 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4d43ad41-d740-46aa-8632-85f79352de59&page=queryresults
[0m20:56:12.869980 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 20:56:10.378534 => 20:56:12.868753
[0m20:56:12.874085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b79efb9c-9736-4622-90d1-e9cc7d9fcf2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab7322d7c0>]}
[0m20:56:12.877089 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.51s]
[0m20:56:12.880580 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:56:12.883353 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:56:12.886903 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m20:56:12.891738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m20:56:12.894841 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:56:12.905601 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:56:12.910192 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 20:56:12.897711 => 20:56:12.908189
[0m20:56:12.913172 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:56:12.925582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:13.384998 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:56:13.386743 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m20:56:13.589241 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1f835db1-7f20-4d99-8455-34facb991f5f&page=queryresults
[0m20:56:15.202635 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 20:56:12.914621 => 20:56:15.201636
[0m20:56:15.208591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b79efb9c-9736-4622-90d1-e9cc7d9fcf2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab7322cf80>]}
[0m20:56:15.210557 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.32s]
[0m20:56:15.212631 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:56:15.223154 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:56:15.225535 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m20:56:15.227896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m20:56:15.229349 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:56:15.301321 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:56:15.307377 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 20:56:15.230494 => 20:56:15.304374
[0m20:56:15.310673 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:56:15.323623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:15.760855 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:56:15.762613 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m20:56:15.959757 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:444583c6-cc05-4ec3-8230-e5bfad62865f&page=queryresults
[0m20:56:17.837584 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 20:56:15.312288 => 20:56:17.837087
[0m20:56:17.839380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b79efb9c-9736-4622-90d1-e9cc7d9fcf2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab7322cf80>]}
[0m20:56:17.841364 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.61s]
[0m20:56:17.844754 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:56:17.851851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:17.853478 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m20:56:17.855190 [info ] [MainThread]: 
[0m20:56:17.856966 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 13.12 seconds (13.12s).
[0m20:56:17.862305 [debug] [MainThread]: Command end result
[0m20:56:17.892229 [info ] [MainThread]: 
[0m20:56:17.894837 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:56:17.896060 [info ] [MainThread]: 
[0m20:56:17.897469 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Bad double value: January
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:56:17.901254 [info ] [MainThread]: 
[0m20:56:17.909272 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:56:17.912329 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.711367, "process_user_time": 6.645977, "process_kernel_time": 0.29742, "process_mem_max_rss": "136444", "process_out_blocks": "2912", "command_success": false, "process_in_blocks": "0"}
[0m20:56:17.914637 [debug] [MainThread]: Command `dbt run` failed at 20:56:17.914014 after 14.71 seconds
[0m20:56:17.916270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab75077c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab73274170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab7393be60>]}
[0m20:56:17.917637 [debug] [MainThread]: Flushing usage events
[0m20:58:30.278018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823c4e8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823c85d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823c777920>]}


============================== 20:58:30.283073 | 78bf02c3-f54e-4af8-a17d-9b9268693ce6 ==============================
[0m20:58:30.283073 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:58:30.284471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:58:31.113781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78bf02c3-f54e-4af8-a17d-9b9268693ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823a9a3b00>]}
[0m20:58:31.287845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78bf02c3-f54e-4af8-a17d-9b9268693ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823abdc470>]}
[0m20:58:31.289364 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m20:58:31.308091 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m20:58:31.379706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:58:31.380975 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:58:31.724609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78bf02c3-f54e-4af8-a17d-9b9268693ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823aa24470>]}
[0m20:58:31.739245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78bf02c3-f54e-4af8-a17d-9b9268693ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823a7abc80>]}
[0m20:58:31.740377 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m20:58:31.741498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78bf02c3-f54e-4af8-a17d-9b9268693ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823a5789b0>]}
[0m20:58:31.744653 [info ] [MainThread]: 
[0m20:58:31.746606 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:58:31.750458 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m20:58:31.751950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:32.235999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m20:58:32.237188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:32.687887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78bf02c3-f54e-4af8-a17d-9b9268693ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823a52cf50>]}
[0m20:58:32.690148 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:58:32.691203 [info ] [MainThread]: 
[0m20:58:32.695170 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:58:32.696537 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m20:58:32.698783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m20:58:32.699998 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:58:32.712784 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:58:32.731528 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 20:58:32.700926 => 20:58:32.729576
[0m20:58:32.733949 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:58:32.839181 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:58:32.840733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:32.843752 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS month_number,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.month_number) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_number
)

SELECT *,
       ((monthly_counts_and_avg.`Month` AS FLOAT64 / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
    );
  
[0m20:58:33.634640 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:fc1f25bf-15a4-44ad-8052-abe5bc194871&page=queryresults
[0m20:58:33.636335 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [40:41]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword AS at [40:41]')
[0m20:58:34.849512 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:6fa8a7fa-69af-44fb-8de2-8ea1d0cc76ed&page=queryresults
[0m20:58:34.850956 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:6fa8a7fa-69af-44fb-8de2-8ea1d0cc76ed&page=queryresults
[0m20:58:34.852614 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 20:58:32.735274 => 20:58:34.852009
[0m20:58:34.868428 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Syntax error: Unexpected keyword AS at [40:41]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:58:34.870541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78bf02c3-f54e-4af8-a17d-9b9268693ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823a656210>]}
[0m20:58:34.873093 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 2.17s]
[0m20:58:34.876157 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:58:34.878467 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:58:34.880761 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m20:58:34.884200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m20:58:34.886482 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:58:34.894214 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:58:34.897164 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 20:58:34.888029 => 20:58:34.896001
[0m20:58:34.899867 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:58:34.913491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:35.457114 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:58:35.458691 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m20:58:35.670478 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:bef8b448-cf5f-46b7-977d-3b03a6169e65&page=queryresults
[0m20:58:37.286272 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 20:58:34.901359 => 20:58:37.285774
[0m20:58:37.288050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78bf02c3-f54e-4af8-a17d-9b9268693ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823a655cd0>]}
[0m20:58:37.289397 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.41s]
[0m20:58:37.291632 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:58:37.293195 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:58:37.294987 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m20:58:37.297622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m20:58:37.299198 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:58:37.304742 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:58:37.307034 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 20:58:37.300276 => 20:58:37.306008
[0m20:58:37.308514 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:58:37.314154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:37.765999 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:58:37.767549 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m20:58:37.976121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:5397bc6d-e679-422e-aeb7-2b580e5d7809&page=queryresults
[0m20:58:40.125082 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 20:58:37.309438 => 20:58:40.124584
[0m20:58:40.127013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78bf02c3-f54e-4af8-a17d-9b9268693ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823a6553d0>]}
[0m20:58:40.128350 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.83s]
[0m20:58:40.129934 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:58:40.131034 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:58:40.132292 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m20:58:40.134070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m20:58:40.135463 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:58:40.139958 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:58:40.141648 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 20:58:40.136216 => 20:58:40.140981
[0m20:58:40.142743 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:58:40.147779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:40.591904 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:58:40.593478 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m20:58:40.817014 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:337839a2-b9ae-4e82-821f-9182d88d01ed&page=queryresults
[0m20:58:42.417826 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 20:58:40.143457 => 20:58:42.416708
[0m20:58:42.421968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78bf02c3-f54e-4af8-a17d-9b9268693ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8238542780>]}
[0m20:58:42.424877 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.29s]
[0m20:58:42.428261 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:58:42.430715 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:58:42.434065 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m20:58:42.438499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m20:58:42.441151 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:58:42.488133 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:58:42.494867 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 20:58:42.443726 => 20:58:42.491259
[0m20:58:42.497851 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:58:42.511248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:42.943915 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:58:42.945640 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m20:58:43.155067 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:39ee016b-0110-4cd0-89e8-ddef1fe92366&page=queryresults
[0m20:58:45.030912 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 20:58:42.499964 => 20:58:45.030412
[0m20:58:45.032761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78bf02c3-f54e-4af8-a17d-9b9268693ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8239e44380>]}
[0m20:58:45.034148 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.60s]
[0m20:58:45.035665 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:58:45.039193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:45.040202 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m20:58:45.041532 [info ] [MainThread]: 
[0m20:58:45.043114 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 13.30 seconds (13.30s).
[0m20:58:45.046964 [debug] [MainThread]: Command end result
[0m20:58:45.062085 [info ] [MainThread]: 
[0m20:58:45.064926 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:58:45.067052 [info ] [MainThread]: 
[0m20:58:45.069205 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Syntax error: Unexpected keyword AS at [40:41]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:58:45.074253 [info ] [MainThread]: 
[0m20:58:45.077081 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:58:45.083948 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.880029, "process_user_time": 6.583647, "process_kernel_time": 0.270044, "process_mem_max_rss": "136592", "process_out_blocks": "2912", "command_success": false, "process_in_blocks": "0"}
[0m20:58:45.091305 [debug] [MainThread]: Command `dbt run` failed at 20:58:45.089630 after 14.89 seconds
[0m20:58:45.096708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823c6fa3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823c549670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8238561640>]}
[0m20:58:45.099025 [debug] [MainThread]: Flushing usage events
[0m20:59:17.382881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0d2cfe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0d2ccb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0d2cf1a0>]}


============================== 20:59:17.388033 | 7768fbf7-4be4-4a46-b30b-af13bf93bc75 ==============================
[0m20:59:17.388033 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:59:17.389473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:59:18.201364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7768fbf7-4be4-4a46-b30b-af13bf93bc75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0b67dc10>]}
[0m20:59:18.373600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7768fbf7-4be4-4a46-b30b-af13bf93bc75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0b716f30>]}
[0m20:59:18.375078 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m20:59:18.390644 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m20:59:18.462636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:59:18.463921 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:59:18.808932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7768fbf7-4be4-4a46-b30b-af13bf93bc75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0b427c20>]}
[0m20:59:18.822959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7768fbf7-4be4-4a46-b30b-af13bf93bc75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0b5ac560>]}
[0m20:59:18.824072 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m20:59:18.825183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7768fbf7-4be4-4a46-b30b-af13bf93bc75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0b54b710>]}
[0m20:59:18.828322 [info ] [MainThread]: 
[0m20:59:18.830311 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:59:18.833855 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m20:59:18.835463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:19.352832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m20:59:19.354057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:19.771479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7768fbf7-4be4-4a46-b30b-af13bf93bc75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0b38b7a0>]}
[0m20:59:19.773946 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:59:19.775357 [info ] [MainThread]: 
[0m20:59:19.780701 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:59:19.782513 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m20:59:19.784651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m20:59:19.786106 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:59:19.799321 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:59:19.808048 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 20:59:19.786927 => 20:59:19.806923
[0m20:59:19.810421 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:59:19.964862 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m20:59:19.967929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:19.974220 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS month_number,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.month_number) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_number
)

SELECT *,
       ((monthly_counts_and_avg.`Month` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
    );
  
[0m20:59:20.515435 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:19b5b406-2444-4c29-aa60-699fdbcd4f4d&page=queryresults
[0m20:59:20.667865 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator / for argument types: STRING, FLOAT64. Supported signatures: FLOAT64 / FLOAT64; NUMERIC / NUMERIC; BIGNUMERIC / BIGNUMERIC; INTERVAL / INT64 at [40:10]; reason: invalidQuery, location: query, message: No matching signature for operator / for argument types: STRING, FLOAT64. Supported signatures: FLOAT64 / FLOAT64; NUMERIC / NUMERIC; BIGNUMERIC / BIGNUMERIC; INTERVAL / INT64 at [40:10]')
[0m20:59:21.449835 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:05f2c180-3a1a-441d-969d-16a4a6b382b6&page=queryresults
[0m20:59:21.590317 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:05f2c180-3a1a-441d-969d-16a4a6b382b6&page=queryresults
[0m20:59:21.594602 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 20:59:19.811535 => 20:59:21.593303
[0m20:59:21.609631 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  No matching signature for operator / for argument types: STRING, FLOAT64. Supported signatures: FLOAT64 / FLOAT64; NUMERIC / NUMERIC; BIGNUMERIC / BIGNUMERIC; INTERVAL / INT64 at [40:10]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:59:21.611192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7768fbf7-4be4-4a46-b30b-af13bf93bc75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0b466630>]}
[0m20:59:21.612741 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 1.83s]
[0m20:59:21.615247 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m20:59:21.616842 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:59:21.618338 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m20:59:21.621180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m20:59:21.623442 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:59:21.633539 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:59:21.637428 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 20:59:21.625041 => 20:59:21.635882
[0m20:59:21.639860 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:59:21.650768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:22.104937 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m20:59:22.106997 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m20:59:22.311444 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:faefed18-fa9e-4417-ad66-4e7efafc42e5&page=queryresults
[0m20:59:24.222143 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 20:59:21.640621 => 20:59:24.221631
[0m20:59:24.224169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7768fbf7-4be4-4a46-b30b-af13bf93bc75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0b414da0>]}
[0m20:59:24.225640 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.60s]
[0m20:59:24.227470 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m20:59:24.228857 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:59:24.230473 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m20:59:24.233837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m20:59:24.235549 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:59:24.240107 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:59:24.241741 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 20:59:24.236416 => 20:59:24.241147
[0m20:59:24.242982 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:59:24.248517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:24.678125 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m20:59:24.679559 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m20:59:24.864360 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:80251da7-b2a4-48d0-987d-6d224877bbbb&page=queryresults
[0m20:59:26.752615 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 20:59:24.243737 => 20:59:26.751501
[0m20:59:26.754694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7768fbf7-4be4-4a46-b30b-af13bf93bc75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0b4165d0>]}
[0m20:59:26.756021 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.52s]
[0m20:59:26.757667 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m20:59:26.758738 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:59:26.759993 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m20:59:26.761750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m20:59:26.763572 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:59:26.770334 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:59:26.773094 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 20:59:26.764800 => 20:59:26.771998
[0m20:59:26.775010 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:59:26.784259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:27.226979 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m20:59:27.228603 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m20:59:27.427188 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a20be786-6b83-4a55-b59e-9740873898b6&page=queryresults
[0m20:59:29.274934 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 20:59:26.776180 => 20:59:29.274436
[0m20:59:29.276840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7768fbf7-4be4-4a46-b30b-af13bf93bc75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0b4165d0>]}
[0m20:59:29.278236 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.52s]
[0m20:59:29.279836 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m20:59:29.280986 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:59:29.282301 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m20:59:29.284216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m20:59:29.285824 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:59:29.314770 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:59:29.318019 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 20:59:29.286660 => 20:59:29.316832
[0m20:59:29.321668 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:59:29.327791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:29.775632 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m20:59:29.777150 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m20:59:30.010433 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:6c8a9c28-383b-4df0-a54e-72b7857cd9ac&page=queryresults
[0m20:59:31.891964 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 20:59:29.323804 => 20:59:31.891464
[0m20:59:31.893677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7768fbf7-4be4-4a46-b30b-af13bf93bc75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0b5aec90>]}
[0m20:59:31.895032 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.61s]
[0m20:59:31.896729 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m20:59:31.900063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:31.900922 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m20:59:31.902617 [info ] [MainThread]: 
[0m20:59:31.904364 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 13.07 seconds (13.07s).
[0m20:59:31.909402 [debug] [MainThread]: Command end result
[0m20:59:31.933338 [info ] [MainThread]: 
[0m20:59:31.936313 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:59:31.939457 [info ] [MainThread]: 
[0m20:59:31.943844 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  No matching signature for operator / for argument types: STRING, FLOAT64. Supported signatures: FLOAT64 / FLOAT64; NUMERIC / NUMERIC; BIGNUMERIC / BIGNUMERIC; INTERVAL / INT64 at [40:10]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m20:59:31.946509 [info ] [MainThread]: 
[0m20:59:31.949573 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:59:31.958511 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.65769, "process_user_time": 6.589046, "process_kernel_time": 0.256925, "process_mem_max_rss": "134496", "process_out_blocks": "2912", "command_success": false, "process_in_blocks": "0"}
[0m20:59:31.961921 [debug] [MainThread]: Command `dbt run` failed at 20:59:31.961294 after 14.66 seconds
[0m20:59:31.963883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0d651ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0b4b0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0bbd5af0>]}
[0m20:59:31.965692 [debug] [MainThread]: Flushing usage events
[0m21:00:24.632637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eb4015e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e9c4faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e9c4c590>]}


============================== 21:00:24.637694 | 2988a1d2-5693-4755-a883-0b3bab588366 ==============================
[0m21:00:24.637694 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:00:24.639050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:25.449073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2988a1d2-5693-4755-a883-0b3bab588366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e7e46780>]}
[0m21:00:25.625579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2988a1d2-5693-4755-a883-0b3bab588366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e9b68a40>]}
[0m21:00:25.627066 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m21:00:25.645864 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:00:25.714370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:00:25.715680 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:00:26.056921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2988a1d2-5693-4755-a883-0b3bab588366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e7f0a3f0>]}
[0m21:00:26.071588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2988a1d2-5693-4755-a883-0b3bab588366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e7d83770>]}
[0m21:00:26.072678 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m21:00:26.073841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2988a1d2-5693-4755-a883-0b3bab588366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e7b34590>]}
[0m21:00:26.076976 [info ] [MainThread]: 
[0m21:00:26.079210 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:00:26.082273 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m21:00:26.084088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:26.583839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m21:00:26.584920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:27.035942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2988a1d2-5693-4755-a883-0b3bab588366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e7b74b00>]}
[0m21:00:27.037726 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:00:27.038784 [info ] [MainThread]: 
[0m21:00:27.042760 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:00:27.044259 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m21:00:27.047332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m21:00:27.049244 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:00:27.071685 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:00:27.085304 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 21:00:27.050533 => 21:00:27.084067
[0m21:00:27.089856 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:00:27.215358 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:00:27.217053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:27.220906 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS month_number,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.month_number) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_number
)

SELECT *,
       (((monthly_counts_and_avg.`Month`)::FLOAT32 / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
    );
  
[0m21:00:27.955143 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:7c1c8650-fac4-47eb-a658-813cad72a778&page=queryresults
[0m21:00:27.956794 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ":" at [40:42]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ":" at [40:42]')
[0m21:00:29.078520 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:0e7ec6c3-84b0-464f-a720-573f0c61d4d9&page=queryresults
[0m21:00:29.081430 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:0e7ec6c3-84b0-464f-a720-573f0c61d4d9&page=queryresults
[0m21:00:29.083727 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 21:00:27.091083 => 21:00:29.083092
[0m21:00:29.096924 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Syntax error: Unexpected ":" at [40:42]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:00:29.098206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2988a1d2-5693-4755-a883-0b3bab588366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e7c326f0>]}
[0m21:00:29.099860 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 2.05s]
[0m21:00:29.101694 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:00:29.102990 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:00:29.104649 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m21:00:29.106779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m21:00:29.108382 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:00:29.114797 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:00:29.117908 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 21:00:29.109161 => 21:00:29.116770
[0m21:00:29.121297 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:00:29.130185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:29.613137 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:00:29.614621 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m21:00:29.836933 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:2238c834-dd9c-4b69-a0d7-96ac755005d8&page=queryresults
[0m21:00:32.047825 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 21:00:29.123108 => 21:00:32.047327
[0m21:00:32.049584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2988a1d2-5693-4755-a883-0b3bab588366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e7c31040>]}
[0m21:00:32.051266 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.94s]
[0m21:00:32.053761 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:00:32.055294 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:00:32.057236 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m21:00:32.060302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m21:00:32.061811 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:00:32.067614 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:00:32.069951 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 21:00:32.063110 => 21:00:32.069044
[0m21:00:32.071378 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:00:32.077554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:32.596747 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:00:32.598629 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m21:00:32.817426 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b482172a-3667-4d7d-bd32-750affd6a3fa&page=queryresults
[0m21:00:35.295878 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 21:00:32.072346 => 21:00:35.295290
[0m21:00:35.298608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2988a1d2-5693-4755-a883-0b3bab588366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e7c31730>]}
[0m21:00:35.304870 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 3.24s]
[0m21:00:35.308977 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:00:35.312244 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:00:35.316164 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m21:00:35.318282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m21:00:35.319524 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:00:35.323837 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:00:35.325797 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 21:00:35.320251 => 21:00:35.324942
[0m21:00:35.327002 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:00:35.331265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:35.774607 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:00:35.776735 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m21:00:36.019953 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8f79cb65-6f79-4302-9060-c1ba34707d1d&page=queryresults
[0m21:00:37.884934 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 21:00:35.327648 => 21:00:37.884440
[0m21:00:37.886789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2988a1d2-5693-4755-a883-0b3bab588366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e7c31040>]}
[0m21:00:37.888086 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.57s]
[0m21:00:37.889610 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:00:37.890705 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:00:37.891886 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m21:00:37.893627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m21:00:37.895048 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:00:37.925683 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:00:37.928105 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 21:00:37.895811 => 21:00:37.927371
[0m21:00:37.929292 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:00:37.937512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:38.389295 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:00:38.391089 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m21:00:38.598117 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e6124f0f-f777-4e6c-9035-3ec5cf4919c1&page=queryresults
[0m21:00:40.768470 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 21:00:37.929989 => 21:00:40.767384
[0m21:00:40.772478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2988a1d2-5693-4755-a883-0b3bab588366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e7c27f80>]}
[0m21:00:40.775351 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.88s]
[0m21:00:40.778782 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:00:40.787819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:40.789839 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m21:00:40.792366 [info ] [MainThread]: 
[0m21:00:40.794015 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 14.71 seconds (14.71s).
[0m21:00:40.797173 [debug] [MainThread]: Command end result
[0m21:00:40.830974 [info ] [MainThread]: 
[0m21:00:40.836612 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:00:40.840301 [info ] [MainThread]: 
[0m21:00:40.846755 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Syntax error: Unexpected ":" at [40:42]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:00:40.852422 [info ] [MainThread]: 
[0m21:00:40.854618 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m21:00:40.856942 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.300362, "process_user_time": 6.682801, "process_kernel_time": 0.267831, "process_mem_max_rss": "134484", "process_out_blocks": "2912", "command_success": false, "process_in_blocks": "0"}
[0m21:00:40.858540 [debug] [MainThread]: Command `dbt run` failed at 21:00:40.858077 after 16.30 seconds
[0m21:00:40.859787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e9a83b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e532ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e7fe6210>]}
[0m21:00:40.861208 [debug] [MainThread]: Flushing usage events
[0m21:01:04.700731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e65c5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e692d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e66e0bc0>]}


============================== 21:01:04.705703 | 93dfe402-4856-426b-934c-abda00067853 ==============================
[0m21:01:04.705703 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:01:04.707069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:01:05.514490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93dfe402-4856-426b-934c-abda00067853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e4c23650>]}
[0m21:01:05.688561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93dfe402-4856-426b-934c-abda00067853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e5187c50>]}
[0m21:01:05.690033 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m21:01:05.711304 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:01:05.784543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:01:05.785759 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:01:06.128184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93dfe402-4856-426b-934c-abda00067853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e4687dd0>]}
[0m21:01:06.141958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93dfe402-4856-426b-934c-abda00067853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e48732f0>]}
[0m21:01:06.143057 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m21:01:06.144127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93dfe402-4856-426b-934c-abda00067853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e4873fb0>]}
[0m21:01:06.147235 [info ] [MainThread]: 
[0m21:01:06.148998 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:01:06.152184 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m21:01:06.153599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:06.685530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m21:01:06.686757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:07.093820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93dfe402-4856-426b-934c-abda00067853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e6cd9fa0>]}
[0m21:01:07.095708 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:01:07.097429 [info ] [MainThread]: 
[0m21:01:07.104550 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:01:07.105940 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m21:01:07.108217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m21:01:07.109343 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:01:07.122569 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:01:07.144966 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 21:01:07.110158 => 21:01:07.143192
[0m21:01:07.148497 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:01:07.262718 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:01:07.264194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:07.267189 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS month_number,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.month_number) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_number
)

SELECT *,
       ((CAST(monthly_counts_and_avg.`Month` AS FLOAT32) / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
    );
  
[0m21:01:07.826460 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:cbed9918-d503-4beb-aa1e-069dbc2f5893&page=queryresults
[0m21:01:08.225404 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Type not found: FLOAT32 at [40:49]; reason: invalidQuery, location: query, message: Type not found: FLOAT32 at [40:49]')
[0m21:01:08.606642 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d00496f8-fa37-4e3a-b943-24325213033b&page=queryresults
[0m21:01:08.744371 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d00496f8-fa37-4e3a-b943-24325213033b&page=queryresults
[0m21:01:08.746028 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 21:01:07.151556 => 21:01:08.745450
[0m21:01:08.756029 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Type not found: FLOAT32 at [40:49]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:01:08.757290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93dfe402-4856-426b-934c-abda00067853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e4717980>]}
[0m21:01:08.758932 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 1.65s]
[0m21:01:08.760886 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:01:08.762467 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:01:08.764265 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m21:01:08.767027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m21:01:08.768896 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:01:08.776077 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:01:08.780140 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 21:01:08.770445 => 21:01:08.777799
[0m21:01:08.786923 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:01:08.799651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:09.238798 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:01:09.240551 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m21:01:09.417420 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d3c50dc8-1847-4c3d-89ec-b325aae557da&page=queryresults
[0m21:01:11.301678 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 21:01:08.788373 => 21:01:11.300852
[0m21:01:11.304507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93dfe402-4856-426b-934c-abda00067853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e476c440>]}
[0m21:01:11.306564 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.54s]
[0m21:01:11.308766 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:01:11.310314 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:01:11.312109 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m21:01:11.316273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m21:01:11.318902 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:01:11.325269 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:01:11.327941 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 21:01:11.320591 => 21:01:11.326781
[0m21:01:11.329635 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:01:11.336840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:11.811171 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:01:11.812908 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m21:01:12.009240 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a379248f-ffac-4d21-b5ce-3951dfb4a034&page=queryresults
[0m21:01:14.174801 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 21:01:11.330964 => 21:01:14.174109
[0m21:01:14.177313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93dfe402-4856-426b-934c-abda00067853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e476ce30>]}
[0m21:01:14.179136 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.86s]
[0m21:01:14.181315 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:01:14.182816 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:01:14.184567 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m21:01:14.187958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m21:01:14.190624 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:01:14.200282 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:01:14.204120 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 21:01:14.192370 => 21:01:14.202475
[0m21:01:14.206823 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:01:14.218809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:14.653233 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:01:14.654855 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m21:01:14.877546 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:78921b3b-1417-4c05-a8da-980a16270ebb&page=queryresults
[0m21:01:16.471124 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 21:01:14.208566 => 21:01:16.470009
[0m21:01:16.474055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93dfe402-4856-426b-934c-abda00067853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e476c680>]}
[0m21:01:16.475401 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.29s]
[0m21:01:16.476994 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:01:16.478066 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:01:16.479292 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m21:01:16.481081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m21:01:16.482547 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:01:16.512277 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:01:16.514342 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 21:01:16.483297 => 21:01:16.513674
[0m21:01:16.515428 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:01:16.520155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:16.942657 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:01:16.944390 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m21:01:17.171893 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f1123603-19f9-4de5-926c-62a6e443c94e&page=queryresults
[0m21:01:19.046134 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 21:01:16.516101 => 21:01:19.045020
[0m21:01:19.050000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93dfe402-4856-426b-934c-abda00067853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e476c440>]}
[0m21:01:19.052852 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.57s]
[0m21:01:19.056285 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:01:19.062726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:19.064356 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m21:01:19.065990 [info ] [MainThread]: 
[0m21:01:19.067739 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 12.92 seconds (12.92s).
[0m21:01:19.073280 [debug] [MainThread]: Command end result
[0m21:01:19.101673 [info ] [MainThread]: 
[0m21:01:19.104437 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:01:19.107395 [info ] [MainThread]: 
[0m21:01:19.114358 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Type not found: FLOAT32 at [40:49]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:01:19.122650 [info ] [MainThread]: 
[0m21:01:19.127835 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m21:01:19.139284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.514376, "process_user_time": 6.634397, "process_kernel_time": 0.249872, "process_mem_max_rss": "136532", "process_out_blocks": "2912", "command_success": false, "process_in_blocks": "0"}
[0m21:01:19.142822 [debug] [MainThread]: Command `dbt run` failed at 21:01:19.141960 after 14.52 seconds
[0m21:01:19.146845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e66b77a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e46abad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75e46ab0e0>]}
[0m21:01:19.152395 [debug] [MainThread]: Flushing usage events
[0m21:01:33.439704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869d35b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869d359550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869d35b590>]}


============================== 21:01:33.444852 | 4e138697-ae8a-4e1c-a2a4-8edd5d9b7913 ==============================
[0m21:01:33.444852 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:01:33.446184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:01:34.277402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e138697-ae8a-4e1c-a2a4-8edd5d9b7913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869b9e23f0>]}
[0m21:01:34.452880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e138697-ae8a-4e1c-a2a4-8edd5d9b7913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869b5faf90>]}
[0m21:01:34.454985 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m21:01:34.475425 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:01:34.552054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:01:34.553327 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:01:34.899647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e138697-ae8a-4e1c-a2a4-8edd5d9b7913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869b3278f0>]}
[0m21:01:34.914262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e138697-ae8a-4e1c-a2a4-8edd5d9b7913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869b49b1d0>]}
[0m21:01:34.915364 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m21:01:34.916454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e138697-ae8a-4e1c-a2a4-8edd5d9b7913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869d18d2e0>]}
[0m21:01:34.919598 [info ] [MainThread]: 
[0m21:01:34.921576 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:01:34.924974 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m21:01:34.926829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:35.414062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m21:01:35.415145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:35.833095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e138697-ae8a-4e1c-a2a4-8edd5d9b7913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869b49a210>]}
[0m21:01:35.834812 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:01:35.835851 [info ] [MainThread]: 
[0m21:01:35.839950 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:01:35.841743 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m21:01:35.844169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m21:01:35.845361 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:01:35.858737 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:01:35.878111 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 21:01:35.846117 => 21:01:35.876216
[0m21:01:35.879853 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:01:35.991573 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:01:35.993301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:35.996383 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS month_number,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.month_number) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_number
)

SELECT *,
       ((CAST(monthly_counts_and_avg.`Month` AS FLOAT64) / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
    );
  
[0m21:01:36.503657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:340651c9-40ed-459f-9272-26f89d335ae4&page=queryresults
[0m21:01:37.440746 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Bad double value: January; reason: invalidQuery, location: query, message: Bad double value: January')
[0m21:01:37.804481 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:407d7475-44a3-44dc-a697-e18e9b6c223c&page=queryresults
[0m21:01:38.717146 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:407d7475-44a3-44dc-a697-e18e9b6c223c&page=queryresults
[0m21:01:38.721158 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 21:01:35.881110 => 21:01:38.719816
[0m21:01:38.738097 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Bad double value: January
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:01:38.739411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e138697-ae8a-4e1c-a2a4-8edd5d9b7913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869b5f8a40>]}
[0m21:01:38.741042 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 2.90s]
[0m21:01:38.742762 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:01:38.744629 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:01:38.747106 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m21:01:38.751454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m21:01:38.753642 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:01:38.764011 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:01:38.769806 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 21:01:38.755319 => 21:01:38.767063
[0m21:01:38.775105 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:01:38.792626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:39.241436 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:01:39.243278 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m21:01:39.531850 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7d99fabb-4175-463e-a470-51e95c08d61e&page=queryresults
[0m21:01:41.399484 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 21:01:38.777213 => 21:01:41.398961
[0m21:01:41.401413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e138697-ae8a-4e1c-a2a4-8edd5d9b7913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869b349370>]}
[0m21:01:41.402796 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.65s]
[0m21:01:41.404444 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:01:41.405559 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:01:41.406876 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m21:01:41.408977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m21:01:41.410348 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:01:41.414939 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:01:41.416942 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 21:01:41.411168 => 21:01:41.416017
[0m21:01:41.418157 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:01:41.423155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:41.876648 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:01:41.878278 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m21:01:42.064800 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ce91df9a-51d2-4cbf-93af-7f8f3b860530&page=queryresults
[0m21:01:44.227238 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 21:01:41.418856 => 21:01:44.225926
[0m21:01:44.231354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e138697-ae8a-4e1c-a2a4-8edd5d9b7913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869b349370>]}
[0m21:01:44.234626 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.82s]
[0m21:01:44.237947 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:01:44.240407 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:01:44.244493 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m21:01:44.251150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m21:01:44.254553 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:01:44.260934 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:01:44.262930 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 21:01:44.256033 => 21:01:44.262053
[0m21:01:44.264329 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:01:44.270240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:44.716518 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:01:44.718535 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m21:01:45.047081 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:44834f86-2938-4354-9901-1bbfa24c7661&page=queryresults
[0m21:01:46.884493 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 21:01:44.265169 => 21:01:46.883990
[0m21:01:46.886319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e138697-ae8a-4e1c-a2a4-8edd5d9b7913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869b349370>]}
[0m21:01:46.887712 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.64s]
[0m21:01:46.889285 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:01:46.890447 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:01:46.891654 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m21:01:46.893435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m21:01:46.894764 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:01:46.927098 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:01:46.929145 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 21:01:46.895635 => 21:01:46.928273
[0m21:01:46.931725 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:01:46.939466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:47.383860 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:01:47.385649 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m21:01:47.586794 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c0b67a81-2120-4d5d-9668-90a82cb41795&page=queryresults
[0m21:01:49.450119 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 21:01:46.933362 => 21:01:49.449513
[0m21:01:49.451959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e138697-ae8a-4e1c-a2a4-8edd5d9b7913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869aa0fbc0>]}
[0m21:01:49.453790 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.56s]
[0m21:01:49.455699 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:01:49.460797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:49.461937 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m21:01:49.463072 [info ] [MainThread]: 
[0m21:01:49.464594 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 14.54 seconds (14.54s).
[0m21:01:49.467803 [debug] [MainThread]: Command end result
[0m21:01:49.490053 [info ] [MainThread]: 
[0m21:01:49.493537 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:01:49.498219 [info ] [MainThread]: 
[0m21:01:49.505728 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Bad double value: January
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:01:49.511822 [info ] [MainThread]: 
[0m21:01:49.513727 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m21:01:49.518458 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.15587, "process_user_time": 6.616261, "process_kernel_time": 0.240928, "process_mem_max_rss": "134456", "process_in_blocks": "8", "process_out_blocks": "2912", "command_success": false}
[0m21:01:49.525638 [debug] [MainThread]: Command `dbt run` failed at 21:01:49.522787 after 16.16 seconds
[0m21:01:49.528440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869d35be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869b8a31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8698850ef0>]}
[0m21:01:49.529872 [debug] [MainThread]: Flushing usage events
[0m21:03:41.653967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43454293a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43451a87d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434555cbc0>]}


============================== 21:03:41.659000 | c7dd4e80-107e-4283-ab87-24bbeb6826a4 ==============================
[0m21:03:41.659000 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:03:41.660433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:03:42.479800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7dd4e80-107e-4283-ab87-24bbeb6826a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43434636e0>]}
[0m21:03:42.655237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7dd4e80-107e-4283-ab87-24bbeb6826a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43450f0a40>]}
[0m21:03:42.656687 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m21:03:42.672126 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:03:42.746770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:03:42.748055 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:03:43.095057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7dd4e80-107e-4283-ab87-24bbeb6826a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43435b0f80>]}
[0m21:03:43.109270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7dd4e80-107e-4283-ab87-24bbeb6826a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43433e6d20>]}
[0m21:03:43.110396 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m21:03:43.111441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7dd4e80-107e-4283-ab87-24bbeb6826a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43434609b0>]}
[0m21:03:43.114560 [info ] [MainThread]: 
[0m21:03:43.116405 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:03:43.120104 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m21:03:43.121315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:43.626024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m21:03:43.627134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:44.052475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7dd4e80-107e-4283-ab87-24bbeb6826a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43435d2540>]}
[0m21:03:44.054217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:03:44.055317 [info ] [MainThread]: 
[0m21:03:44.059336 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:03:44.060988 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m21:03:44.064102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m21:03:44.066072 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:03:44.088794 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:03:44.107677 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 21:03:44.067491 => 21:03:44.105177
[0m21:03:44.110200 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:03:44.216569 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:03:44.218019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:44.221046 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS month_number,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((CAST(monthly_counts_and_avg.`Month` AS FLOAT64) / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
    );
  
[0m21:03:44.743560 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:80f55b65-3051-456d-97ff-0a1307f0a05e&page=queryresults
[0m21:03:45.418271 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Bad double value: June; reason: invalidQuery, location: query, message: Bad double value: June')
[0m21:03:46.182542 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a16dd345-9618-48d5-9b29-bcbed351f690&page=queryresults
[0m21:03:47.102673 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a16dd345-9618-48d5-9b29-bcbed351f690&page=queryresults
[0m21:03:47.106580 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 21:03:44.112278 => 21:03:47.105162
[0m21:03:47.140255 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Bad double value: April
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:03:47.142432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7dd4e80-107e-4283-ab87-24bbeb6826a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4342a4a300>]}
[0m21:03:47.145045 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 3.08s]
[0m21:03:47.148004 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:03:47.151096 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:03:47.155283 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m21:03:47.164549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m21:03:47.170205 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:03:47.186059 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:03:47.190807 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 21:03:47.174458 => 21:03:47.188177
[0m21:03:47.200276 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:03:47.213138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:47.669835 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:03:47.672041 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m21:03:47.860732 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:53e0bc48-1b95-41e7-96a9-c25ad36fa1f0&page=queryresults
[0m21:03:49.793829 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 21:03:47.201519 => 21:03:49.793287
[0m21:03:49.795604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7dd4e80-107e-4283-ab87-24bbeb6826a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4342a4a300>]}
[0m21:03:49.796998 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.64s]
[0m21:03:49.798635 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:03:49.799732 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:03:49.800970 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m21:03:49.802679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m21:03:49.804141 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:03:49.808187 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:03:49.810218 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 21:03:49.804901 => 21:03:49.809344
[0m21:03:49.811336 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:03:49.815962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:50.229901 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:03:50.231667 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m21:03:50.436923 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:eaef637c-227f-456f-8c99-a9d039f41caf&page=queryresults
[0m21:03:52.310031 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 21:03:49.812045 => 21:03:52.308830
[0m21:03:52.314038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7dd4e80-107e-4283-ab87-24bbeb6826a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4342a4af90>]}
[0m21:03:52.316979 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.51s]
[0m21:03:52.320620 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:03:52.323242 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:03:52.328444 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m21:03:52.334986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m21:03:52.340136 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:03:52.356140 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:03:52.360052 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 21:03:52.342890 => 21:03:52.358725
[0m21:03:52.361549 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:03:52.367280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:52.794397 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:03:52.796125 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m21:03:52.985121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:271d5264-3680-4db5-a248-b071d7a2a839&page=queryresults
[0m21:03:54.869078 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 21:03:52.362421 => 21:03:54.868589
[0m21:03:54.872383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7dd4e80-107e-4283-ab87-24bbeb6826a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4342a4af90>]}
[0m21:03:54.875408 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.54s]
[0m21:03:54.879119 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:03:54.881542 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:03:54.884850 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m21:03:54.888946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m21:03:54.892048 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:03:54.914801 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:03:54.916382 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 21:03:54.893469 => 21:03:54.915745
[0m21:03:54.917421 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:03:54.921889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:55.412001 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:03:55.413700 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m21:03:55.624577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8f9efe13-7b0f-4bed-b8b7-6cfceb1a41ab&page=queryresults
[0m21:03:57.496722 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 21:03:54.918079 => 21:03:57.495550
[0m21:03:57.500566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7dd4e80-107e-4283-ab87-24bbeb6826a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43433979e0>]}
[0m21:03:57.503611 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.61s]
[0m21:03:57.507133 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:03:57.517368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:57.520897 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m21:03:57.524936 [info ] [MainThread]: 
[0m21:03:57.528841 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 14.41 seconds (14.41s).
[0m21:03:57.541352 [debug] [MainThread]: Command end result
[0m21:03:57.595781 [info ] [MainThread]: 
[0m21:03:57.600825 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:03:57.605072 [info ] [MainThread]: 
[0m21:03:57.607665 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Bad double value: April
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:03:57.610036 [info ] [MainThread]: 
[0m21:03:57.611983 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m21:03:57.615929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.037886, "process_user_time": 6.68989, "process_kernel_time": 0.227357, "process_mem_max_rss": "134500", "process_out_blocks": "2912", "command_success": false, "process_in_blocks": "0"}
[0m21:03:57.620641 [debug] [MainThread]: Command `dbt run` failed at 21:03:57.619294 after 16.04 seconds
[0m21:03:57.626910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4345eb3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4343443ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43434c21e0>]}
[0m21:03:57.630900 [debug] [MainThread]: Flushing usage events
[0m21:06:14.958792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489b4c7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489b4c4f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489b4c75f0>]}


============================== 21:06:14.984885 | 696f9401-88e2-417d-9f4e-f5f7f7b4ce5f ==============================
[0m21:06:14.984885 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:06:14.986236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:06:15.822433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '696f9401-88e2-417d-9f4e-f5f7f7b4ce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4899a2d2e0>]}
[0m21:06:15.999034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '696f9401-88e2-417d-9f4e-f5f7f7b4ce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48999166f0>]}
[0m21:06:16.000502 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m21:06:16.016850 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:06:16.095637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:06:16.096937 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:06:16.499986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '696f9401-88e2-417d-9f4e-f5f7f7b4ce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489961f4d0>]}
[0m21:06:16.515907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '696f9401-88e2-417d-9f4e-f5f7f7b4ce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48997b8200>]}
[0m21:06:16.517047 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m21:06:16.518067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '696f9401-88e2-417d-9f4e-f5f7f7b4ce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48997bb380>]}
[0m21:06:16.521160 [info ] [MainThread]: 
[0m21:06:16.523934 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:06:16.527780 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m21:06:16.529435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:17.062450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m21:06:17.063675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:06:17.535704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '696f9401-88e2-417d-9f4e-f5f7f7b4ce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4899e697c0>]}
[0m21:06:17.538045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:06:17.539806 [info ] [MainThread]: 
[0m21:06:17.545989 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:06:17.548026 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m21:06:17.550632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m21:06:17.551930 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:06:17.568385 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:06:17.577845 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 21:06:17.552751 => 21:06:17.576747
[0m21:06:17.580210 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:06:17.704110 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:06:17.705948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:17.709230 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
    );
  
[0m21:06:18.275754 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:fb46c48d-12e7-4b9f-820a-3982e27fc59e&page=queryresults
[0m21:06:20.217144 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 21:06:17.582429 => 21:06:20.216213
[0m21:06:20.220181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '696f9401-88e2-417d-9f4e-f5f7f7b4ce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489956a690>]}
[0m21:06:20.222475 [info ] [Thread-1 (]: 1 of 5 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.67s]
[0m21:06:20.225703 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:06:20.227687 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:06:20.230328 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m21:06:20.233208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m21:06:20.235095 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:06:20.241319 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:06:20.245447 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 21:06:20.236060 => 21:06:20.244103
[0m21:06:20.247444 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:06:20.256181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:20.746082 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:06:20.749410 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m21:06:20.961121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:66ad9d8d-106c-4efa-9c0f-1743b0b8099e&page=queryresults
[0m21:06:22.856397 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 21:06:20.248330 => 21:06:22.855675
[0m21:06:22.858818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '696f9401-88e2-417d-9f4e-f5f7f7b4ce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4899669c70>]}
[0m21:06:22.861367 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.63s]
[0m21:06:22.863744 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:06:22.865268 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:06:22.866999 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m21:06:22.870707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m21:06:22.873411 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:06:22.883447 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:06:22.886892 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 21:06:22.875233 => 21:06:22.885588
[0m21:06:22.888840 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:06:22.898442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:23.366507 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:06:23.368202 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m21:06:23.591288 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:10c008bc-74b4-4043-a9c4-eeaa7c38e53d&page=queryresults
[0m21:06:25.489988 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 21:06:22.890040 => 21:06:25.489428
[0m21:06:25.491914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '696f9401-88e2-417d-9f4e-f5f7f7b4ce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4898c7a3c0>]}
[0m21:06:25.493328 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.62s]
[0m21:06:25.495378 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:06:25.496776 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:06:25.498134 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m21:06:25.500839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m21:06:25.502924 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:06:25.510788 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:06:25.513879 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 21:06:25.504216 => 21:06:25.512535
[0m21:06:25.516064 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:06:25.526194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:25.979611 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:06:25.981193 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m21:06:26.180094 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d315d392-0611-41b9-8d5a-1883011b1065&page=queryresults
[0m21:06:28.102737 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 21:06:25.517513 => 21:06:28.096726
[0m21:06:28.108954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '696f9401-88e2-417d-9f4e-f5f7f7b4ce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4898c9f770>]}
[0m21:06:28.112345 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.61s]
[0m21:06:28.123235 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:06:28.129878 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:06:28.138022 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m21:06:28.153920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m21:06:28.164815 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:06:28.300741 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:06:28.316181 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 21:06:28.170074 => 21:06:28.310445
[0m21:06:28.322593 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:06:28.355348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:29.046094 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:06:29.048466 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m21:06:29.256451 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:be9b8af7-ddc3-43ae-8305-6909251b04a6&page=queryresults
[0m21:06:30.843972 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 21:06:28.325173 => 21:06:30.843253
[0m21:06:30.846338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '696f9401-88e2-417d-9f4e-f5f7f7b4ce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4898c5b470>]}
[0m21:06:30.848041 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.70s]
[0m21:06:30.850356 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:06:30.857757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:30.859453 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m21:06:30.860792 [info ] [MainThread]: 
[0m21:06:30.862339 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 14.34 seconds (14.34s).
[0m21:06:30.867452 [debug] [MainThread]: Command end result
[0m21:06:30.904369 [info ] [MainThread]: 
[0m21:06:30.909329 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:06:30.920280 [info ] [MainThread]: 
[0m21:06:30.922851 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:06:30.930977 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.04812, "process_user_time": 7.319268, "process_kernel_time": 0.319639, "process_mem_max_rss": "135544", "process_in_blocks": "1480", "process_out_blocks": "2904"}
[0m21:06:30.935801 [debug] [MainThread]: Command `dbt run` succeeded at 21:06:30.934526 after 16.06 seconds
[0m21:06:30.945587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f489b5b7f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4899d71430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4899a55f40>]}
[0m21:06:30.950033 [debug] [MainThread]: Flushing usage events
[0m21:08:20.352489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f95bc9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f95bcb800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f95bc9880>]}


============================== 21:08:20.357544 | 5797d546-75a8-47e9-9f34-d019b3bd677e ==============================
[0m21:08:20.357544 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:08:20.358880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:08:21.238056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5797d546-75a8-47e9-9f34-d019b3bd677e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f9414fbc0>]}
[0m21:08:21.427754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5797d546-75a8-47e9-9f34-d019b3bd677e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f945c2ed0>]}
[0m21:08:21.429236 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m21:08:21.445598 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:08:21.510460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:08:21.511738 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:08:21.871343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5797d546-75a8-47e9-9f34-d019b3bd677e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f93e43e90>]}
[0m21:08:21.885549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5797d546-75a8-47e9-9f34-d019b3bd677e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f93ebb350>]}
[0m21:08:21.886662 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m21:08:21.887788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5797d546-75a8-47e9-9f34-d019b3bd677e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f95bc89b0>]}
[0m21:08:21.890942 [info ] [MainThread]: 
[0m21:08:21.893157 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:08:21.896956 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m21:08:21.898775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:22.432477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m21:08:22.433511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:22.890706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5797d546-75a8-47e9-9f34-d019b3bd677e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f93c68a40>]}
[0m21:08:22.892366 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:08:22.893478 [info ] [MainThread]: 
[0m21:08:22.897444 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:08:22.898851 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m21:08:22.901155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m21:08:22.902524 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:08:22.923282 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:08:22.927817 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 21:08:22.903342 => 21:08:22.925142
[0m21:08:22.932176 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:08:22.990187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:23.504863 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:08:23.506454 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.base_name ASC, monthly_counts_and_avg.month ASC
    );
  
[0m21:08:23.688965 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d9c250f8-59e5-457d-a9a8-a2b9b35a6bd1&page=queryresults
[0m21:08:23.854127 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name base_name not found inside monthly_counts_and_avg at [41:33]; reason: invalidQuery, location: query, message: Name base_name not found inside monthly_counts_and_avg at [41:33]')
[0m21:08:24.302849 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:291ba1e4-ab2d-4c2a-ab67-b548862b5d29&page=queryresults
[0m21:08:24.424978 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:291ba1e4-ab2d-4c2a-ab67-b548862b5d29&page=queryresults
[0m21:08:24.428482 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 21:08:22.934185 => 21:08:24.427206
[0m21:08:24.454124 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Name base_name not found inside monthly_counts_and_avg at [41:33]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:08:24.456407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5797d546-75a8-47e9-9f34-d019b3bd677e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f93537da0>]}
[0m21:08:24.458935 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 1.56s]
[0m21:08:24.461785 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:08:24.464429 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:08:24.466854 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m21:08:24.471593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m21:08:24.475305 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:08:24.491931 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:08:24.498908 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 21:08:24.477565 => 21:08:24.496895
[0m21:08:24.501197 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:08:24.514910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:24.944933 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:08:24.946643 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m21:08:25.153078 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:52af87d5-ffc1-4d83-9fe6-6a126a574dd0&page=queryresults
[0m21:08:27.069913 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 21:08:24.503659 => 21:08:27.069362
[0m21:08:27.071954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5797d546-75a8-47e9-9f34-d019b3bd677e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f9353c830>]}
[0m21:08:27.073503 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.60s]
[0m21:08:27.075222 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:08:27.076341 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:08:27.077589 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m21:08:27.079262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m21:08:27.081174 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:08:27.088167 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:08:27.090943 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 21:08:27.082495 => 21:08:27.089931
[0m21:08:27.092929 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:08:27.102042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:27.554320 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:08:27.556451 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m21:08:27.757258 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:313aeaed-2d3d-4041-b885-575193e95c31&page=queryresults
[0m21:08:29.621578 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 21:08:27.094166 => 21:08:29.621078
[0m21:08:29.623759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5797d546-75a8-47e9-9f34-d019b3bd677e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f9353c860>]}
[0m21:08:29.625168 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.54s]
[0m21:08:29.626829 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:08:29.627942 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:08:29.629178 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m21:08:29.631060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m21:08:29.632725 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:08:29.637883 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:08:29.639912 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 21:08:29.633519 => 21:08:29.638981
[0m21:08:29.641160 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:08:29.645938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:30.088240 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:08:30.090141 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m21:08:30.348382 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1d12db9e-6f1d-4657-bc6f-201c6bb868ce&page=queryresults
[0m21:08:31.954705 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 21:08:29.641961 => 21:08:31.953737
[0m21:08:31.960690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5797d546-75a8-47e9-9f34-d019b3bd677e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f93d69580>]}
[0m21:08:31.964269 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.33s]
[0m21:08:31.966702 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:08:31.968044 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:08:31.969390 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m21:08:31.972086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m21:08:31.973680 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:08:32.007536 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:08:32.012407 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 21:08:31.974564 => 21:08:32.010937
[0m21:08:32.014360 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:08:32.025447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:32.512654 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:08:32.514074 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m21:08:32.716961 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d31ebacf-3e8f-478d-8377-ff942e25a8fe&page=queryresults
[0m21:08:34.621492 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 21:08:32.015877 => 21:08:34.620982
[0m21:08:34.623363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5797d546-75a8-47e9-9f34-d019b3bd677e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f91464bc0>]}
[0m21:08:34.624671 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.65s]
[0m21:08:34.626214 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:08:34.629845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:08:34.630722 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m21:08:34.631987 [info ] [MainThread]: 
[0m21:08:34.633265 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 12.74 seconds (12.74s).
[0m21:08:34.636831 [debug] [MainThread]: Command end result
[0m21:08:34.653490 [info ] [MainThread]: 
[0m21:08:34.656256 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:08:34.658611 [info ] [MainThread]: 
[0m21:08:34.662850 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Name base_name not found inside monthly_counts_and_avg at [41:33]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:08:34.665568 [info ] [MainThread]: 
[0m21:08:34.668555 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m21:08:34.677119 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.404969, "process_user_time": 6.712465, "process_kernel_time": 0.32507, "process_mem_max_rss": "136704", "process_out_blocks": "2912", "command_success": false, "process_in_blocks": "0"}
[0m21:08:34.680146 [debug] [MainThread]: Command `dbt run` failed at 21:08:34.679672 after 14.41 seconds
[0m21:08:34.681304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f95bc9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f94602b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f91498e30>]}
[0m21:08:34.682695 [debug] [MainThread]: Flushing usage events
[0m21:09:03.298862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eee540410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eee5429f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eee540380>]}


============================== 21:09:03.304196 | 9103945d-56c2-4ec7-9d36-1c0036c3999d ==============================
[0m21:09:03.304196 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:09:03.305588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:09:04.173092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9103945d-56c2-4ec7-9d36-1c0036c3999d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eed413e00>]}
[0m21:09:04.351145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9103945d-56c2-4ec7-9d36-1c0036c3999d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eec7de600>]}
[0m21:09:04.352589 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m21:09:04.369339 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:09:04.441775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:09:04.443118 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:09:04.808302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9103945d-56c2-4ec7-9d36-1c0036c3999d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eec4fb0e0>]}
[0m21:09:04.831672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9103945d-56c2-4ec7-9d36-1c0036c3999d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eec68b080>]}
[0m21:09:04.832768 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m21:09:04.833867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9103945d-56c2-4ec7-9d36-1c0036c3999d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eee56f8c0>]}
[0m21:09:04.837336 [info ] [MainThread]: 
[0m21:09:04.839473 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:09:04.842522 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m21:09:04.844140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:05.354129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m21:09:05.355124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:09:05.808233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9103945d-56c2-4ec7-9d36-1c0036c3999d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eec68a360>]}
[0m21:09:05.809962 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:09:05.811077 [info ] [MainThread]: 
[0m21:09:05.816064 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:09:05.817718 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m21:09:05.819918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m21:09:05.821093 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:09:05.840119 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:09:05.842433 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 21:09:05.821842 => 21:09:05.841333
[0m21:09:05.845373 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:09:05.899780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:09:06.364078 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:09:06.365966 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.`Dispatching Base Name` ORDER BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Dispatching Base Name` ASC, monthly_counts_and_avg.month ASC
    );
  
[0m21:09:06.598625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:9581c92b-7a8b-4518-b4ab-f4849231bca0&page=queryresults
[0m21:09:08.545159 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 21:09:05.846975 => 21:09:08.544351
[0m21:09:08.547982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9103945d-56c2-4ec7-9d36-1c0036c3999d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eec560aa0>]}
[0m21:09:08.550286 [info ] [Thread-1 (]: 1 of 5 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.73s]
[0m21:09:08.552646 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:09:08.554381 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:09:08.556596 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m21:09:08.560346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m21:09:08.562145 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:09:08.569157 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:09:08.571850 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 21:09:08.563140 => 21:09:08.570617
[0m21:09:08.573614 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:09:08.581865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:09:09.033041 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:09:09.037450 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m21:09:09.280107 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:5a5e0e7b-a404-4988-88eb-38f21e367e97&page=queryresults
[0m21:09:10.850087 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 21:09:08.574565 => 21:09:10.849451
[0m21:09:10.851871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9103945d-56c2-4ec7-9d36-1c0036c3999d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eec535790>]}
[0m21:09:10.853257 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.29s]
[0m21:09:10.854873 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:09:10.855956 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:09:10.857259 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m21:09:10.858988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m21:09:10.860889 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:09:10.869010 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:09:10.871599 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 21:09:10.862316 => 21:09:10.870575
[0m21:09:10.873512 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:09:10.882462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:09:11.850044 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:09:11.860640 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m21:09:12.105294 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b136248d-b869-4c94-ae73-3444f075a9a6&page=queryresults
[0m21:09:14.055606 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 21:09:10.874752 => 21:09:14.041712
[0m21:09:14.062321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9103945d-56c2-4ec7-9d36-1c0036c3999d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee9d4cec0>]}
[0m21:09:14.082426 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 3.20s]
[0m21:09:14.097567 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:09:14.104334 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:09:14.110663 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m21:09:14.118357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m21:09:14.121948 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:09:14.147295 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:09:14.167582 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 21:09:14.127638 => 21:09:14.149371
[0m21:09:14.174780 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:09:14.247115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:09:15.080553 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:09:15.082941 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m21:09:15.329307 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e89d02cf-009b-4ce0-ac50-0dd27bb59d85&page=queryresults
[0m21:09:17.213825 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 21:09:14.175997 => 21:09:17.212844
[0m21:09:17.223952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9103945d-56c2-4ec7-9d36-1c0036c3999d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eec535e20>]}
[0m21:09:17.232484 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 3.11s]
[0m21:09:17.241870 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:09:17.247135 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:09:17.249609 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m21:09:17.253366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m21:09:17.267364 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:09:17.289842 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:09:17.302346 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 21:09:17.271612 => 21:09:17.301326
[0m21:09:17.308398 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:09:17.404006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:09:18.317188 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:09:18.334042 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m21:09:18.569557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:3f1edeec-7f92-49a7-a731-fe0633e0bdda&page=queryresults
[0m21:09:20.561831 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 21:09:17.317077 => 21:09:20.551435
[0m21:09:20.575902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9103945d-56c2-4ec7-9d36-1c0036c3999d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee9dabbf0>]}
[0m21:09:20.587290 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.32s]
[0m21:09:20.595848 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:09:20.619060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:09:20.622029 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m21:09:20.629312 [info ] [MainThread]: 
[0m21:09:20.636486 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 15.79 seconds (15.79s).
[0m21:09:20.653542 [debug] [MainThread]: Command end result
[0m21:09:20.694853 [info ] [MainThread]: 
[0m21:09:20.698966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:09:20.703616 [info ] [MainThread]: 
[0m21:09:20.706021 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:09:20.711624 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.488527, "process_user_time": 7.735779, "process_kernel_time": 0.397717, "process_mem_max_rss": "135516", "process_out_blocks": "2904", "process_in_blocks": "0"}
[0m21:09:20.740786 [debug] [MainThread]: Command `dbt run` succeeded at 21:09:20.737274 after 17.52 seconds
[0m21:09:20.753897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eee377d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eeea6b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eeea6b230>]}
[0m21:09:20.765933 [debug] [MainThread]: Flushing usage events
[0m21:10:49.790021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369ddc94f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369e1fe120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369ddca870>]}


============================== 21:10:49.795080 | 0e31a577-93ae-4e38-9ca4-a818c6e83fa5 ==============================
[0m21:10:49.795080 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:10:49.796856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:10:50.648120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e31a577-93ae-4e38-9ca4-a818c6e83fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369c76b650>]}
[0m21:10:50.825526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e31a577-93ae-4e38-9ca4-a818c6e83fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369c2154f0>]}
[0m21:10:50.827020 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m21:10:50.849731 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:10:50.934025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:10:50.935264 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:10:51.298471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e31a577-93ae-4e38-9ca4-a818c6e83fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369be6a030>]}
[0m21:10:51.312683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e31a577-93ae-4e38-9ca4-a818c6e83fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369c0bb470>]}
[0m21:10:51.314094 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m21:10:51.315241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e31a577-93ae-4e38-9ca4-a818c6e83fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369be3b320>]}
[0m21:10:51.318416 [info ] [MainThread]: 
[0m21:10:51.320482 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:10:51.324180 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m21:10:51.325449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:10:51.829510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m21:10:51.831189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:10:52.269708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e31a577-93ae-4e38-9ca4-a818c6e83fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369beac5f0>]}
[0m21:10:52.271534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:10:52.272768 [info ] [MainThread]: 
[0m21:10:52.277039 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:10:52.278711 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m21:10:52.280793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m21:10:52.282222 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:10:52.302628 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:10:52.305309 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 21:10:52.283347 => 21:10:52.304241
[0m21:10:52.307324 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:10:52.383903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:52.848472 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:10:52.850061 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month  ORDER BY month_extract.`Dispatching Base Name`) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Dispatching Base Name` ASC, monthly_counts_and_avg.month ASC
    );
  
[0m21:10:53.086040 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f68532f6-faef-4d6f-862d-dc277b57e650&page=queryresults
[0m21:10:54.989170 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 21:10:52.308922 => 21:10:54.988501
[0m21:10:54.991491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e31a577-93ae-4e38-9ca4-a818c6e83fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369c1e3b90>]}
[0m21:10:54.993287 [info ] [Thread-1 (]: 1 of 5 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.71s]
[0m21:10:54.995506 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:10:54.997012 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:10:54.998726 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m21:10:55.001656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m21:10:55.003304 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:10:55.011047 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:10:55.014647 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 21:10:55.004178 => 21:10:55.013256
[0m21:10:55.017339 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:10:55.029128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:55.502129 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:10:55.504782 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m21:10:55.710046 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0810fd9a-2876-42e6-a966-636b874b35b0&page=queryresults
[0m21:10:57.310856 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 21:10:55.018957 => 21:10:57.309795
[0m21:10:57.321673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e31a577-93ae-4e38-9ca4-a818c6e83fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369bf69760>]}
[0m21:10:57.328318 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.32s]
[0m21:10:57.335219 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:10:57.341333 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:10:57.348441 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m21:10:57.354918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m21:10:57.361699 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:10:57.375755 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:10:57.388182 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 21:10:57.363032 => 21:10:57.386580
[0m21:10:57.393420 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:10:57.433032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:58.387948 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:10:58.392294 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m21:10:58.628757 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:955891e9-64b8-4d05-9f7d-a044530a98a9&page=queryresults
[0m21:11:00.847537 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 21:10:57.394792 => 21:11:00.844459
[0m21:11:00.852133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e31a577-93ae-4e38-9ca4-a818c6e83fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369bf6a4e0>]}
[0m21:11:00.854196 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 3.50s]
[0m21:11:00.858034 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:11:00.863124 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:11:00.868137 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m21:11:00.884299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m21:11:00.887774 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:11:00.919393 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:11:00.936460 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 21:11:00.893245 => 21:11:00.928854
[0m21:11:00.945960 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:11:00.973194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:02.039958 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:11:02.050392 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m21:11:02.267705 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e7dce50a-021e-4caf-b0f9-ab49100b3aa0&page=queryresults
[0m21:11:04.458878 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 21:11:00.951751 => 21:11:04.458282
[0m21:11:04.468061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e31a577-93ae-4e38-9ca4-a818c6e83fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369bf69df0>]}
[0m21:11:04.472599 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 3.59s]
[0m21:11:04.481278 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:11:04.487038 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:11:04.492753 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m21:11:04.513721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m21:11:04.519161 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:11:04.536600 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:11:04.558208 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 21:11:04.523296 => 21:11:04.547463
[0m21:11:04.565415 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:11:04.780280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:05.593396 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:11:05.599667 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m21:11:05.823705 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:78d38873-41a3-4683-8c5b-8084489cb896&page=queryresults
[0m21:11:07.728655 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 21:11:04.566980 => 21:11:07.726678
[0m21:11:07.738263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e31a577-93ae-4e38-9ca4-a818c6e83fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369b77f590>]}
[0m21:11:07.747437 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.24s]
[0m21:11:07.757814 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:11:07.799963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:11:07.803785 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m21:11:07.816783 [info ] [MainThread]: 
[0m21:11:07.820877 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 16.49 seconds (16.49s).
[0m21:11:07.834330 [debug] [MainThread]: Command end result
[0m21:11:07.875944 [info ] [MainThread]: 
[0m21:11:07.882042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:11:07.887201 [info ] [MainThread]: 
[0m21:11:07.889399 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:11:07.897187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.1843, "process_user_time": 8.000714, "process_kernel_time": 0.421426, "process_mem_max_rss": "135548", "process_in_blocks": "928", "process_out_blocks": "2912"}
[0m21:11:07.902324 [debug] [MainThread]: Command `dbt run` succeeded at 21:11:07.901687 after 18.19 seconds
[0m21:11:07.905918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369bf1f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369c0465d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369c044b60>]}
[0m21:11:07.909246 [debug] [MainThread]: Flushing usage events
[0m21:11:57.902523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87718cc3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87718cee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87718cc320>]}


============================== 21:11:57.907592 | e5552431-4d69-4aaa-92f9-244493746089 ==============================
[0m21:11:57.907592 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:11:57.909029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:11:58.785461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5552431-4d69-4aaa-92f9-244493746089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f876fc7d4c0>]}
[0m21:11:58.965957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5552431-4d69-4aaa-92f9-244493746089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8770778a70>]}
[0m21:11:58.968606 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m21:11:58.994176 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:11:59.075820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:11:59.077083 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:11:59.431330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5552431-4d69-4aaa-92f9-244493746089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f876fa27650>]}
[0m21:11:59.445027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5552431-4d69-4aaa-92f9-244493746089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f876fbbb860>]}
[0m21:11:59.446054 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m21:11:59.447221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5552431-4d69-4aaa-92f9-244493746089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f876fbbb7a0>]}
[0m21:11:59.450539 [info ] [MainThread]: 
[0m21:11:59.452374 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:11:59.455897 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m21:11:59.457893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:00.002037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m21:12:00.003156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:00.442233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5552431-4d69-4aaa-92f9-244493746089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87701a9550>]}
[0m21:12:00.444253 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:12:00.445783 [info ] [MainThread]: 
[0m21:12:00.450650 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:12:00.452162 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m21:12:00.454772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m21:12:00.456193 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:12:00.479874 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:12:00.483760 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 21:12:00.457165 => 21:12:00.482332
[0m21:12:00.485603 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:12:00.553510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:01.041177 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:12:01.042781 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Dispatching Base Name` ASC, monthly_counts_and_avg.month ASC
    );
  
[0m21:12:01.261308 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:17367983-76cc-493e-9dac-049ef90b37ad&page=queryresults
[0m21:12:03.153821 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 21:12:00.487015 => 21:12:03.153007
[0m21:12:03.156400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5552431-4d69-4aaa-92f9-244493746089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f876fa99280>]}
[0m21:12:03.158401 [info ] [Thread-1 (]: 1 of 5 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.70s]
[0m21:12:03.160821 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:12:03.162391 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:12:03.164499 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m21:12:03.168907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m21:12:03.172117 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:12:03.180033 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:12:03.182451 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 21:12:03.173802 => 21:12:03.181291
[0m21:12:03.184452 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:12:03.189482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:03.637955 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:12:03.639562 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m21:12:03.867729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:119fb3a6-f315-4a30-a198-a16c5c11601d&page=queryresults
[0m21:12:05.464832 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 21:12:03.185144 => 21:12:05.464348
[0m21:12:05.466762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5552431-4d69-4aaa-92f9-244493746089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f876fa698e0>]}
[0m21:12:05.468172 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.30s]
[0m21:12:05.469936 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:12:05.471158 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:12:05.472342 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m21:12:05.474230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m21:12:05.475792 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:12:05.484323 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:12:05.485936 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 21:12:05.476533 => 21:12:05.485295
[0m21:12:05.487039 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:12:05.491986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:06.311916 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:12:06.316974 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m21:12:06.517203 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:cd7a6814-0781-44af-b137-f800b79f76f3&page=queryresults
[0m21:12:08.374202 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 21:12:05.487737 => 21:12:08.373391
[0m21:12:08.378259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5552431-4d69-4aaa-92f9-244493746089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f876f09db20>]}
[0m21:12:08.383083 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.90s]
[0m21:12:08.386597 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:12:08.389076 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:12:08.390855 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m21:12:08.394279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m21:12:08.397004 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:12:08.406220 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:12:08.412186 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 21:12:08.398819 => 21:12:08.410444
[0m21:12:08.414044 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:12:08.422064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:08.926262 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:12:08.928065 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m21:12:09.100366 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:563b59e8-b2ca-452e-b2e8-db1e922c5217&page=queryresults
[0m21:12:10.972058 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 21:12:08.415309 => 21:12:10.969941
[0m21:12:10.979226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5552431-4d69-4aaa-92f9-244493746089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f876fa69ee0>]}
[0m21:12:10.983498 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.59s]
[0m21:12:10.987178 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:12:10.990281 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:12:10.997186 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m21:12:11.006224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m21:12:11.018673 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:12:11.101043 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:12:11.111172 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 21:12:11.023872 => 21:12:11.107330
[0m21:12:11.119487 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:12:11.139984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:11.909039 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:12:11.919145 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m21:12:12.165176 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e1a22f3d-1e1d-4864-8bf1-5402c79e287c&page=queryresults
[0m21:12:14.105212 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 21:12:11.122535 => 21:12:14.102007
[0m21:12:14.112484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5552431-4d69-4aaa-92f9-244493746089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f876f0bcef0>]}
[0m21:12:14.120156 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.11s]
[0m21:12:14.127829 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:12:14.171187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:12:14.173346 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m21:12:14.175367 [info ] [MainThread]: 
[0m21:12:14.186673 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 14.72 seconds (14.72s).
[0m21:12:14.198501 [debug] [MainThread]: Command end result
[0m21:12:14.273323 [info ] [MainThread]: 
[0m21:12:14.280623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:12:14.291855 [info ] [MainThread]: 
[0m21:12:14.304927 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:12:14.331129 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.501202, "process_user_time": 7.418233, "process_kernel_time": 0.263742, "process_mem_max_rss": "131864", "process_out_blocks": "2912", "process_in_blocks": "0"}
[0m21:12:14.342825 [debug] [MainThread]: Command `dbt run` succeeded at 21:12:14.335038 after 16.51 seconds
[0m21:12:14.358261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87723960f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f876f0d75c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f876f0d78f0>]}
[0m21:12:14.365814 [debug] [MainThread]: Flushing usage events
[0m21:13:39.736685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b60900380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b60d4af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b60cd0bc0>]}


============================== 21:13:39.741711 | ea154698-284f-4f6f-a7d0-b7d0e12a064d ==============================
[0m21:13:39.741711 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:13:39.743091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:13:40.673438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea154698-284f-4f6f-a7d0-b7d0e12a064d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5f1d2510>]}
[0m21:13:40.852024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea154698-284f-4f6f-a7d0-b7d0e12a064d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5edbb590>]}
[0m21:13:40.853573 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m21:13:40.871096 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:13:40.951619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:13:40.953532 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:13:41.301732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea154698-284f-4f6f-a7d0-b7d0e12a064d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5ea275f0>]}
[0m21:13:41.316094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea154698-284f-4f6f-a7d0-b7d0e12a064d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5ebc71d0>]}
[0m21:13:41.317194 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m21:13:41.318200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea154698-284f-4f6f-a7d0-b7d0e12a064d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5e96f8c0>]}
[0m21:13:41.321345 [info ] [MainThread]: 
[0m21:13:41.323203 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:13:41.326757 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m21:13:41.328762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:41.831802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m21:13:41.832867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:42.298834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea154698-284f-4f6f-a7d0-b7d0e12a064d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5ebc6090>]}
[0m21:13:42.300619 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:42.301635 [info ] [MainThread]: 
[0m21:13:42.305607 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:13:42.307150 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m21:13:42.310339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m21:13:42.312253 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:13:42.347693 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:13:42.354190 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 21:13:42.313502 => 21:13:42.351005
[0m21:13:42.357395 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:13:42.415168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:42.935910 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:13:42.938899 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Dispatching Base Name` ASC
    );
  
[0m21:13:43.182877 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:224aff7f-a379-4ab4-8954-b7394171705f&page=queryresults
[0m21:13:45.429898 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 21:13:42.359925 => 21:13:45.429264
[0m21:13:45.432235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea154698-284f-4f6f-a7d0-b7d0e12a064d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5ea9d190>]}
[0m21:13:45.435182 [info ] [Thread-1 (]: 1 of 5 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.12s]
[0m21:13:45.438021 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:13:45.440032 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:13:45.442366 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m21:13:45.444528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m21:13:45.445710 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:13:45.451147 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:13:45.453047 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 21:13:45.446697 => 21:13:45.452190
[0m21:13:45.454288 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:13:45.459132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:45.910900 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:13:45.912751 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m21:13:46.116723 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e7e51105-dbf6-42fb-9893-ebe93390fc9b&page=queryresults
[0m21:13:48.565327 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 21:13:45.455015 => 21:13:48.564365
[0m21:13:48.568422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea154698-284f-4f6f-a7d0-b7d0e12a064d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5ea719d0>]}
[0m21:13:48.570850 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 3.12s]
[0m21:13:48.572615 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:13:48.573783 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:13:48.575135 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m21:13:48.576984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m21:13:48.578409 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:13:48.587459 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:13:48.589378 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 21:13:48.579358 => 21:13:48.588511
[0m21:13:48.590612 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:13:48.595761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:49.027640 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:13:49.029025 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m21:13:49.217004 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:041bd0a9-05d6-40b0-9693-01f671c1c380&page=queryresults
[0m21:13:51.363324 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 21:13:48.591350 => 21:13:51.362336
[0m21:13:51.366321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea154698-284f-4f6f-a7d0-b7d0e12a064d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5e29f3b0>]}
[0m21:13:51.368712 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.79s]
[0m21:13:51.371053 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:13:51.372160 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:13:51.373364 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m21:13:51.375331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m21:13:51.377382 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:13:51.384756 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:13:51.387579 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 21:13:51.378636 => 21:13:51.386399
[0m21:13:51.389546 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:13:51.398239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:51.859660 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:13:51.861083 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m21:13:52.037194 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:2a117d4c-fdf7-47de-8cdc-222c709d1257&page=queryresults
[0m21:13:53.613315 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 21:13:51.390761 => 21:13:53.612789
[0m21:13:53.615157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea154698-284f-4f6f-a7d0-b7d0e12a064d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5e2c32f0>]}
[0m21:13:53.616624 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.24s]
[0m21:13:53.618177 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:13:53.619264 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:13:53.620525 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m21:13:53.622270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m21:13:53.623680 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:13:53.644562 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:13:53.647659 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 21:13:53.624383 => 21:13:53.645976
[0m21:13:53.649943 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:13:53.662218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:54.119728 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:13:54.121174 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m21:13:54.329395 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:020a408b-525b-46fd-a99d-dfe217d1aa65&page=queryresults
[0m21:13:56.787898 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 21:13:53.653950 => 21:13:56.786883
[0m21:13:56.791116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea154698-284f-4f6f-a7d0-b7d0e12a064d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5e2c5e80>]}
[0m21:13:56.793490 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.17s]
[0m21:13:56.795289 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:13:56.798601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:56.799936 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m21:13:56.801264 [info ] [MainThread]: 
[0m21:13:56.802560 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 15.48 seconds (15.48s).
[0m21:13:56.805896 [debug] [MainThread]: Command end result
[0m21:13:56.832299 [info ] [MainThread]: 
[0m21:13:56.839880 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:13:56.845735 [info ] [MainThread]: 
[0m21:13:56.851995 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:13:56.858542 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.200575, "process_user_time": 6.834777, "process_kernel_time": 0.274738, "process_mem_max_rss": "131832", "process_out_blocks": "2912", "process_in_blocks": "0"}
[0m21:13:56.866736 [debug] [MainThread]: Command `dbt run` succeeded at 21:13:56.865012 after 17.21 seconds
[0m21:13:56.868503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b60901c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5f014890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5ef323c0>]}
[0m21:13:56.869573 [debug] [MainThread]: Flushing usage events
[0m21:17:37.751955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2973849880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2973a377a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2973ae4bc0>]}


============================== 21:17:37.758102 | 526585b0-9bec-48ba-a3ba-5839827d6f62 ==============================
[0m21:17:37.758102 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:17:37.759477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:17:38.622825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '526585b0-9bec-48ba-a3ba-5839827d6f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2971f97530>]}
[0m21:17:38.817213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '526585b0-9bec-48ba-a3ba-5839827d6f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29721c8a40>]}
[0m21:17:38.818760 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m21:17:38.834882 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:17:38.913455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:17:38.914885 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m21:17:39.263981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '526585b0-9bec-48ba-a3ba-5839827d6f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29717fb3b0>]}
[0m21:17:39.278164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '526585b0-9bec-48ba-a3ba-5839827d6f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f297198fbf0>]}
[0m21:17:39.279255 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m21:17:39.280364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '526585b0-9bec-48ba-a3ba-5839827d6f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f297198f050>]}
[0m21:17:39.283491 [info ] [MainThread]: 
[0m21:17:39.285282 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:17:39.288365 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m21:17:39.289517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:39.818082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m21:17:39.819179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:17:40.273600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '526585b0-9bec-48ba-a3ba-5839827d6f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29718f3e00>]}
[0m21:17:40.275331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:17:40.276442 [info ] [MainThread]: 
[0m21:17:40.281015 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:17:40.282662 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m21:17:40.284616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m21:17:40.285689 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:17:40.304556 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:17:40.308558 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 21:17:40.286429 => 21:17:40.307316
[0m21:17:40.312842 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:17:40.397063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:40.896172 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m21:17:40.897777 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Average for Month`, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m21:17:41.173341 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:dcf3ecde-6fc8-472f-9f14-e522ccd9d5e1&page=queryresults
[0m21:17:43.395154 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 21:17:40.315353 => 21:17:43.393794
[0m21:17:43.397972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526585b0-9bec-48ba-a3ba-5839827d6f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2971861130>]}
[0m21:17:43.400316 [info ] [Thread-1 (]: 1 of 5 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.11s]
[0m21:17:43.402877 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m21:17:43.404597 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:17:43.406476 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m21:17:43.409413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m21:17:43.411292 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:17:43.418158 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:17:43.421951 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 21:17:43.412525 => 21:17:43.420517
[0m21:17:43.424657 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:17:43.436086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:43.894671 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m21:17:43.898126 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m21:17:44.093346 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4a43a281-7683-4f69-954a-4c96cb490dd6&page=queryresults
[0m21:17:45.982462 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 21:17:43.426414 => 21:17:45.981466
[0m21:17:45.986078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526585b0-9bec-48ba-a3ba-5839827d6f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2971860560>]}
[0m21:17:45.988941 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.58s]
[0m21:17:45.992319 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m21:17:45.994662 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:17:45.998604 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m21:17:46.002772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m21:17:46.005570 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:17:46.023055 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:17:46.026620 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 21:17:46.007720 => 21:17:46.024938
[0m21:17:46.029431 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:17:46.046013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:46.516767 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m21:17:46.518403 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m21:17:46.689214 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:638c1a10-6a2c-4147-880e-1a80945d820e&page=queryresults
[0m21:17:48.668624 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 21:17:46.031795 => 21:17:48.662817
[0m21:17:48.701112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526585b0-9bec-48ba-a3ba-5839827d6f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29718604a0>]}
[0m21:17:48.718534 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.69s]
[0m21:17:48.734367 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m21:17:48.764046 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:17:48.786150 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m21:17:48.820287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m21:17:48.834767 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:17:48.866650 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:17:48.875742 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 21:17:48.843511 => 21:17:48.870268
[0m21:17:48.880755 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:17:48.901488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:49.536740 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m21:17:49.538276 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m21:17:49.749508 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:9d3e1899-5fa0-4381-9566-17aa9c65be73&page=queryresults
[0m21:17:51.381693 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 21:17:48.885663 => 21:17:51.380614
[0m21:17:51.385598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526585b0-9bec-48ba-a3ba-5839827d6f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29717548f0>]}
[0m21:17:51.399997 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.58s]
[0m21:17:51.404032 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m21:17:51.406893 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:17:51.410857 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m21:17:51.414587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m21:17:51.416811 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:17:51.498606 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:17:51.511450 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 21:17:51.418286 => 21:17:51.509064
[0m21:17:51.516741 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:17:51.532949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:52.221078 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:17:52.230630 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m21:17:52.469160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c3922080-a0ff-44d8-944c-d01a4a52633e&page=queryresults
[0m21:17:54.085755 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 21:17:51.526973 => 21:17:54.081702
[0m21:17:54.094412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526585b0-9bec-48ba-a3ba-5839827d6f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2970674650>]}
[0m21:17:54.103620 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.68s]
[0m21:17:54.118088 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:17:54.154836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:17:54.179718 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m21:17:54.183220 [info ] [MainThread]: 
[0m21:17:54.188268 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 14.90 seconds (14.90s).
[0m21:17:54.234669 [debug] [MainThread]: Command end result
[0m21:17:54.463454 [info ] [MainThread]: 
[0m21:17:54.465465 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:17:54.467954 [info ] [MainThread]: 
[0m21:17:54.488769 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:17:54.514159 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.840052, "process_user_time": 7.440961, "process_kernel_time": 0.292629, "process_mem_max_rss": "133564", "process_out_blocks": "2912", "process_in_blocks": "0"}
[0m21:17:54.548492 [debug] [MainThread]: Command `dbt run` succeeded at 21:17:54.546228 after 16.88 seconds
[0m21:17:54.553983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f297783f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2971a46f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f297384a660>]}
[0m21:17:54.559037 [debug] [MainThread]: Flushing usage events
[0m22:23:21.843281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30736c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30736f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30736c500>]}


============================== 22:23:21.868781 | a4f04baa-ae0d-4c82-a1f8-a3e952f50c24 ==============================
[0m22:23:21.868781 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:23:21.870154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:23:22.833726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4f04baa-ae0d-4c82-a1f8-a3e952f50c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30579aab0>]}
[0m22:23:23.033616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4f04baa-ae0d-4c82-a1f8-a3e952f50c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3058c0410>]}
[0m22:23:23.035086 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:23:23.050807 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:23:23.151586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:23:23.152774 [debug] [MainThread]: Partial parsing: added file: uber_transformations://models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m22:23:23.522299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4f04baa-ae0d-4c82-a1f8-a3e952f50c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3054a7dd0>]}
[0m22:23:23.536917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4f04baa-ae0d-4c82-a1f8-a3e952f50c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3056db320>]}
[0m22:23:23.538022 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:23:23.539068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4f04baa-ae0d-4c82-a1f8-a3e952f50c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30545b230>]}
[0m22:23:23.542836 [info ] [MainThread]: 
[0m22:23:23.545934 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:23:23.550637 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:23:23.552943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:24.098306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:23:24.099410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:23:24.565721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4f04baa-ae0d-4c82-a1f8-a3e952f50c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3054c71a0>]}
[0m22:23:24.567499 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:23:24.568569 [info ] [MainThread]: 
[0m22:23:24.573239 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:23:24.575345 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m22:23:24.578283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m22:23:24.580323 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:23:24.619698 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:23:24.644939 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 22:23:24.581457 => 22:23:24.640384
[0m22:23:24.650674 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:23:24.722552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:25.224236 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:23:25.226796 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Average for Month`, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:23:25.526268 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f234a06e-becb-4023-a2d3-de2bff82eb87&page=queryresults
[0m22:23:27.746577 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 22:23:24.652575 => 22:23:27.746049
[0m22:23:27.748417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4f04baa-ae0d-4c82-a1f8-a3e952f50c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3055b13a0>]}
[0m22:23:27.749815 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.17s]
[0m22:23:27.751885 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:23:27.753058 [debug] [Thread-1 (]: Began running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:23:27.754356 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [RUN]
[0m22:23:27.756989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.percentage_of_pick_ups_by_base_per_month)
[0m22:23:27.758927 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:23:27.766320 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:23:27.768909 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (compile): 22:23:27.760131 => 22:23:27.767842
[0m22:23:27.771036 [debug] [Thread-1 (]: Began executing node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:23:27.785760 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:23:27.792047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:27.796633 [debug] [Thread-1 (]: On model.uber_transformations.percentage_of_pick_ups_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`percentage_of_pick_ups_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month AS `Month`
           COUNT(*) OVER (PARTITION BY month_extract.`Dispatching Base Name`) AS `Count per Base per Month`
           COUNT(*) as `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`
)

SELECT *,
       (counting_cte.`Count per Month` / counting_cte.`Count per Base per Month`) AS `Percentile of Pick Ups`
FROM counting_cte
    );
  
[0m22:23:28.652142 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:0f12635a-fd39-4328-a5c2-e41fe211cea5&page=queryresults
[0m22:23:28.653674 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "COUNT" at [32:12]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "COUNT" at [32:12]')
[0m22:23:29.524597 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:56315b4c-cb68-4b1b-83ec-ca08ab5ba629&page=queryresults
[0m22:23:29.526006 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:56315b4c-cb68-4b1b-83ec-ca08ab5ba629&page=queryresults
[0m22:23:29.528034 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (execute): 22:23:27.772277 => 22:23:29.527444
[0m22:23:29.538705 [debug] [Thread-1 (]: Database Error in model percentage_of_pick_ups_by_base_per_month (models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql)
  Syntax error: Expected ")" but got identifier "COUNT" at [32:12]
  compiled Code at target/run/uber_transformations/models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m22:23:29.540058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4f04baa-ae0d-4c82-a1f8-a3e952f50c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb305581760>]}
[0m22:23:29.542144 [error] [Thread-1 (]: 2 of 6 ERROR creating sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [[31mERROR[0m in 1.78s]
[0m22:23:29.545425 [debug] [Thread-1 (]: Finished running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:23:29.547944 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:23:29.552171 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m22:23:29.556346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.percentage_of_pick_ups_by_base_per_month, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m22:23:29.559421 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:23:29.567540 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:23:29.573585 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 22:23:29.560862 => 22:23:29.571877
[0m22:23:29.578568 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:23:29.596607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:30.087725 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:23:30.089147 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:23:30.432037 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:dd62eaeb-36a9-4384-94fc-b94cbe84d397&page=queryresults
[0m22:23:32.353252 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 22:23:29.582651 => 22:23:32.351930
[0m22:23:32.359442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4f04baa-ae0d-4c82-a1f8-a3e952f50c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30445c710>]}
[0m22:23:32.362786 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.80s]
[0m22:23:32.367933 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:23:32.371371 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:23:32.375033 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m22:23:32.383853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m22:23:32.385480 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:23:32.389746 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:23:32.391880 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 22:23:32.386243 => 22:23:32.391023
[0m22:23:32.393014 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:23:32.400919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:32.897865 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:23:32.899644 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:23:33.148648 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:343f1c47-c2cb-4ec2-8a67-14e30d9c4070&page=queryresults
[0m22:23:35.391218 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 22:23:32.393659 => 22:23:35.390597
[0m22:23:35.393555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4f04baa-ae0d-4c82-a1f8-a3e952f50c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb304454560>]}
[0m22:23:35.394991 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 3.01s]
[0m22:23:35.396922 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:23:35.398070 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:23:35.399335 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m22:23:35.401755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m22:23:35.403280 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:23:35.426767 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:23:35.428499 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 22:23:35.403944 => 22:23:35.427866
[0m22:23:35.429575 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:23:35.437978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:35.919572 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:23:35.923948 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:23:36.131430 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7007d31f-9693-44bf-98e0-7f2c143d8be4&page=queryresults
[0m22:23:37.790185 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 22:23:35.430485 => 22:23:37.789662
[0m22:23:37.791960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4f04baa-ae0d-4c82-a1f8-a3e952f50c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30445e120>]}
[0m22:23:37.793362 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.39s]
[0m22:23:37.794905 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:23:37.796048 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:23:37.797348 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:23:37.799209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:23:37.801471 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:23:37.814347 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:23:37.817140 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:23:37.802825 => 22:23:37.816079
[0m22:23:37.819343 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:23:37.828734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:38.266514 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:23:38.267956 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:23:38.551298 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:5b167d9f-7ee8-46dd-8864-ee70ebee4f56&page=queryresults
[0m22:23:40.461240 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:23:37.820684 => 22:23:40.460736
[0m22:23:40.463146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4f04baa-ae0d-4c82-a1f8-a3e952f50c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3058b70e0>]}
[0m22:23:40.465046 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.66s]
[0m22:23:40.468911 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:23:40.476716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:40.478969 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:23:40.481073 [info ] [MainThread]: 
[0m22:23:40.482890 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 16.94 seconds (16.94s).
[0m22:23:40.486326 [debug] [MainThread]: Command end result
[0m22:23:40.506974 [info ] [MainThread]: 
[0m22:23:40.511739 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:23:40.515233 [info ] [MainThread]: 
[0m22:23:40.521337 [error] [MainThread]:   Database Error in model percentage_of_pick_ups_by_base_per_month (models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql)
  Syntax error: Expected ")" but got identifier "COUNT" at [32:12]
  compiled Code at target/run/uber_transformations/models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m22:23:40.524050 [info ] [MainThread]: 
[0m22:23:40.526910 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m22:23:40.535277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 18.768019, "process_user_time": 7.147959, "process_kernel_time": 0.333403, "process_mem_max_rss": "136232", "process_in_blocks": "10048", "process_out_blocks": "2976", "command_success": false}
[0m22:23:40.538990 [debug] [MainThread]: Command `dbt run` failed at 22:23:40.538225 after 18.77 seconds
[0m22:23:40.540484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30739bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb305483710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb305adaf60>]}
[0m22:23:40.541870 [debug] [MainThread]: Flushing usage events
[0m22:24:05.928825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba99c4c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba99c4f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba99c4c710>]}


============================== 22:24:05.933882 | 22a2cb96-acc5-4124-9c27-0f39580d96e5 ==============================
[0m22:24:05.933882 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:24:05.935363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:24:06.796632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22a2cb96-acc5-4124-9c27-0f39580d96e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba99a7dd60>]}
[0m22:24:06.973900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22a2cb96-acc5-4124-9c27-0f39580d96e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba97e47ad0>]}
[0m22:24:06.975374 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:24:06.991039 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:24:07.066716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:24:07.067951 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m22:24:07.420026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22a2cb96-acc5-4124-9c27-0f39580d96e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba97e73140>]}
[0m22:24:07.434750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22a2cb96-acc5-4124-9c27-0f39580d96e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba97d742c0>]}
[0m22:24:07.435785 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:24:07.436872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22a2cb96-acc5-4124-9c27-0f39580d96e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba97b789b0>]}
[0m22:24:07.440302 [info ] [MainThread]: 
[0m22:24:07.442698 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:24:07.445642 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:24:07.447632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:07.982671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:24:07.983804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:08.455046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22a2cb96-acc5-4124-9c27-0f39580d96e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba97b3b8c0>]}
[0m22:24:08.459327 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:24:08.461566 [info ] [MainThread]: 
[0m22:24:08.468191 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:24:08.469645 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m22:24:08.472312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m22:24:08.474047 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:24:08.504476 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:24:08.509776 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 22:24:08.474856 => 22:24:08.506582
[0m22:24:08.516430 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:24:08.592666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:09.117956 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:24:09.119566 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Average for Month`, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:24:09.375725 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:01b76905-8fd8-43e9-93b9-597393d99336&page=queryresults
[0m22:24:11.545565 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 22:24:08.519351 => 22:24:11.544487
[0m22:24:11.548993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22a2cb96-acc5-4124-9c27-0f39580d96e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba97c2ecf0>]}
[0m22:24:11.551560 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.08s]
[0m22:24:11.554308 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:24:11.556313 [debug] [Thread-1 (]: Began running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:24:11.558681 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [RUN]
[0m22:24:11.561290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.percentage_of_pick_ups_by_base_per_month)
[0m22:24:11.562595 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:24:11.567173 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:24:11.569554 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (compile): 22:24:11.563361 => 22:24:11.568589
[0m22:24:11.570950 [debug] [Thread-1 (]: Began executing node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:24:11.591801 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:24:11.600967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:11.613782 [debug] [Thread-1 (]: On model.uber_transformations.percentage_of_pick_ups_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`percentage_of_pick_ups_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month AS `Month`,
           COUNT(*) OVER (PARTITION BY month_extract.`Dispatching Base Name`) AS `Count per Base per Month`,
           COUNT(*) as `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`
)

SELECT *,
       (counting_cte.`Count per Month` / counting_cte.`Count per Base per Month`) AS `Percentile of Pick Ups`
FROM counting_cte
    );
  
[0m22:24:12.169803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d4a6f4db-7681-4b7f-af39-a6e26d23ca98&page=queryresults
[0m22:24:14.328485 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (execute): 22:24:11.571677 => 22:24:14.327477
[0m22:24:14.332238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22a2cb96-acc5-4124-9c27-0f39580d96e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba97bf61e0>]}
[0m22:24:14.334916 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.77s]
[0m22:24:14.338186 [debug] [Thread-1 (]: Finished running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:24:14.340842 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:24:14.344693 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m22:24:14.349736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.percentage_of_pick_ups_by_base_per_month, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m22:24:14.352476 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:24:14.367920 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:24:14.373291 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 22:24:14.355211 => 22:24:14.371125
[0m22:24:14.376848 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:24:14.387407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:14.864142 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:24:14.866323 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:24:15.095236 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:23f50062-6866-4b5f-8cf7-8c52b7a81891&page=queryresults
[0m22:24:17.015387 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 22:24:14.378810 => 22:24:17.014287
[0m22:24:17.022142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22a2cb96-acc5-4124-9c27-0f39580d96e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9545a360>]}
[0m22:24:17.031074 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.67s]
[0m22:24:17.037439 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:24:17.043575 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:24:17.046130 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m22:24:17.054598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m22:24:17.057304 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:24:17.088864 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:24:17.093965 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 22:24:17.062634 => 22:24:17.092848
[0m22:24:17.099428 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:24:17.117502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:17.690918 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:24:17.692718 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:24:17.896319 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f3ef99ad-168f-49dd-8d4d-fa2bb4066667&page=queryresults
[0m22:24:20.055079 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 22:24:17.102654 => 22:24:20.054583
[0m22:24:20.057016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22a2cb96-acc5-4124-9c27-0f39580d96e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9548bbf0>]}
[0m22:24:20.059134 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 3.00s]
[0m22:24:20.062858 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:24:20.065875 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:24:20.070628 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m22:24:20.076405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m22:24:20.079046 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:24:20.134963 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:24:20.140875 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 22:24:20.080936 => 22:24:20.136857
[0m22:24:20.149868 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:24:20.165663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:20.594455 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:24:20.595950 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:24:20.802804 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:eb6b1901-9041-405f-8cca-cfd6d20e730a&page=queryresults
[0m22:24:22.707124 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 22:24:20.151494 => 22:24:22.705610
[0m22:24:22.714493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22a2cb96-acc5-4124-9c27-0f39580d96e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9548bcb0>]}
[0m22:24:22.717728 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.64s]
[0m22:24:22.720484 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:24:22.723549 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:24:22.727957 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:24:22.733860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:24:22.735709 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:24:22.747310 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:24:22.750381 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:24:22.738157 => 22:24:22.748824
[0m22:24:22.752347 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:24:22.762074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:23.790934 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:24:23.797427 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:24:24.087630 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:621244ac-e7c5-4c8f-ae2e-ac0e7549c017&page=queryresults
[0m22:24:25.992254 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:24:22.753669 => 22:24:25.990973
[0m22:24:26.001146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22a2cb96-acc5-4124-9c27-0f39580d96e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba954813a0>]}
[0m22:24:26.009529 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.27s]
[0m22:24:26.030015 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:24:26.056994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:26.070637 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:24:26.072896 [info ] [MainThread]: 
[0m22:24:26.077892 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 18.63 seconds (18.63s).
[0m22:24:26.086144 [debug] [MainThread]: Command end result
[0m22:24:26.136892 [info ] [MainThread]: 
[0m22:24:26.140787 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:24:26.148145 [info ] [MainThread]: 
[0m22:24:26.151671 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:24:26.155256 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.304195, "process_user_time": 7.436309, "process_kernel_time": 0.329306, "process_mem_max_rss": "133724", "process_out_blocks": "2976", "process_in_blocks": "0"}
[0m22:24:26.162600 [debug] [MainThread]: Command `dbt run` succeeded at 22:24:26.160719 after 20.31 seconds
[0m22:24:26.167883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba99c4d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9a1870e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9836ffb0>]}
[0m22:24:26.170839 [debug] [MainThread]: Flushing usage events
[0m22:26:25.427069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff364ec1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3651728a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff364ec0350>]}


============================== 22:26:25.432562 | 61ec5b8d-93d0-41c0-940b-ce007b46f96b ==============================
[0m22:26:25.432562 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:26:25.433918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:26:26.301618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61ec5b8d-93d0-41c0-940b-ce007b46f96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3633cf500>]}
[0m22:26:26.483758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61ec5b8d-93d0-41c0-940b-ce007b46f96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3639fbfe0>]}
[0m22:26:26.486094 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:26:26.502876 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:26:26.585118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:26:26.586439 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m22:26:26.976506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61ec5b8d-93d0-41c0-940b-ce007b46f96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff362f9e6c0>]}
[0m22:26:26.998219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61ec5b8d-93d0-41c0-940b-ce007b46f96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3631c3b90>]}
[0m22:26:27.000281 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:26:27.002350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61ec5b8d-93d0-41c0-940b-ce007b46f96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3631c12b0>]}
[0m22:26:27.007427 [info ] [MainThread]: 
[0m22:26:27.009490 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:26:27.014848 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:26:27.016850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:27.551007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:26:27.552229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:26:28.004271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61ec5b8d-93d0-41c0-940b-ce007b46f96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3631c2f90>]}
[0m22:26:28.006355 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:26:28.007396 [info ] [MainThread]: 
[0m22:26:28.011231 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:26:28.013163 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m22:26:28.016320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m22:26:28.018324 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:26:28.056576 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:26:28.069637 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 22:26:28.019601 => 22:26:28.064900
[0m22:26:28.077830 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:26:28.146958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:28.694567 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:26:28.696926 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Average for Month`, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:26:28.926505 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:3fe25cd6-23c7-4f79-b7aa-a76f7d96952d&page=queryresults
[0m22:26:31.247167 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 22:26:28.079674 => 22:26:31.245785
[0m22:26:31.250939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ec5b8d-93d0-41c0-940b-ce007b46f96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3639f8ef0>]}
[0m22:26:31.253885 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.24s]
[0m22:26:31.257080 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:26:31.259797 [debug] [Thread-1 (]: Began running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:26:31.262353 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [RUN]
[0m22:26:31.266395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.percentage_of_pick_ups_by_base_per_month)
[0m22:26:31.268531 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:26:31.273859 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:26:31.275956 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (compile): 22:26:31.269887 => 22:26:31.275105
[0m22:26:31.277054 [debug] [Thread-1 (]: Began executing node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:26:31.291844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:31.766808 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:26:31.768615 [debug] [Thread-1 (]: On model.uber_transformations.percentage_of_pick_ups_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`percentage_of_pick_ups_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month AS `Month`,
           COUNT(*) OVER (PARTITION BY month_extract.month, month_extract.`Dispatching Base Name`) AS `Count per Base per Month`,
           COUNT(*) as `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`
)

SELECT *,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
    );
  
[0m22:26:32.003484 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:953555f2-c9ad-441a-b581-e06d4f80a2e3&page=queryresults
[0m22:26:34.193732 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (execute): 22:26:31.278153 => 22:26:34.192585
[0m22:26:34.197426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ec5b8d-93d0-41c0-940b-ce007b46f96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff36284f260>]}
[0m22:26:34.199973 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.93s]
[0m22:26:34.202661 [debug] [Thread-1 (]: Finished running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:26:34.204663 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:26:34.206969 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m22:26:34.209650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.percentage_of_pick_ups_by_base_per_month, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m22:26:34.210936 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:26:34.215372 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:26:34.217537 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 22:26:34.211694 => 22:26:34.216500
[0m22:26:34.219833 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:26:34.228907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:34.743576 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:26:34.746598 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:26:34.945165 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:80ef5e9a-bfaf-42f5-b059-0388ad2b0528&page=queryresults
[0m22:26:47.821933 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 22:26:34.221008 => 22:26:47.818377
[0m22:26:47.831897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ec5b8d-93d0-41c0-940b-ce007b46f96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3628b8590>]}
[0m22:26:47.841699 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 13.62s]
[0m22:26:47.846164 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:26:47.855197 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:26:47.871678 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m22:26:47.895262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m22:26:47.900953 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:26:47.921527 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:26:47.931316 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 22:26:47.910615 => 22:26:47.928330
[0m22:26:47.938160 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:26:47.958924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:49.144788 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:26:49.152640 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:26:49.372877 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0f38d150-35f7-4147-955c-90afd653f862&page=queryresults
[0m22:26:51.833624 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 22:26:47.942868 => 22:26:51.832013
[0m22:26:51.845118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ec5b8d-93d0-41c0-940b-ce007b46f96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3628d38f0>]}
[0m22:26:51.851164 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 3.97s]
[0m22:26:51.859815 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:26:51.862212 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:26:51.864929 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m22:26:51.870730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m22:26:51.876849 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:26:51.932434 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:26:51.941629 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 22:26:51.878427 => 22:26:51.936827
[0m22:26:51.946368 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:26:51.965481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:52.821771 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:26:52.828096 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:26:53.045954 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4dff2a0d-e284-4266-8b07-2022dd8f7ea4&page=queryresults
[0m22:26:54.646758 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 22:26:51.949223 => 22:26:54.645625
[0m22:26:54.650384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ec5b8d-93d0-41c0-940b-ce007b46f96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff362898650>]}
[0m22:26:54.653322 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.78s]
[0m22:26:54.656717 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:26:54.659277 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:26:54.661888 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:26:54.666049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:26:54.668417 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:26:54.676845 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:26:54.679899 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:26:54.669925 => 22:26:54.678639
[0m22:26:54.682729 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:26:54.692625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:55.298442 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:26:55.300376 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:26:55.542882 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:14685471-878a-43d9-834a-f778ee76c5b0&page=queryresults
[0m22:26:57.156681 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:26:54.684479 => 22:26:57.155554
[0m22:26:57.159834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ec5b8d-93d0-41c0-940b-ce007b46f96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff36307a5a0>]}
[0m22:26:57.162379 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.50s]
[0m22:26:57.165467 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:26:57.170294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:57.171642 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:26:57.173439 [info ] [MainThread]: 
[0m22:26:57.176035 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 30.16 seconds (30.16s).
[0m22:26:57.184780 [debug] [MainThread]: Command end result
[0m22:26:57.230800 [info ] [MainThread]: 
[0m22:26:57.236779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:26:57.242179 [info ] [MainThread]: 
[0m22:26:57.249736 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:26:57.257080 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 31.904942, "process_user_time": 8.138041, "process_kernel_time": 0.449526, "process_mem_max_rss": "135940", "process_in_blocks": "240", "process_out_blocks": "2968"}
[0m22:26:57.263964 [debug] [MainThread]: Command `dbt run` succeeded at 22:26:57.262962 after 31.92 seconds
[0m22:26:57.269288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff364ec0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff362880860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3639f8ef0>]}
[0m22:26:57.273846 [debug] [MainThread]: Flushing usage events
[0m22:29:22.095496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ebac59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ebd2b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ebe4a720>]}


============================== 22:29:22.100522 | 4dc1df42-73eb-4e37-9768-57cfc096407b ==============================
[0m22:29:22.100522 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:29:22.101889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:29:22.937907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dc1df42-73eb-4e37-9768-57cfc096407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ea1bedb0>]}
[0m22:29:23.111751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dc1df42-73eb-4e37-9768-57cfc096407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e9d45f40>]}
[0m22:29:23.113467 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:29:23.128812 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:29:23.207286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:29:23.208621 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m22:29:23.563460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dc1df42-73eb-4e37-9768-57cfc096407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e9d47980>]}
[0m22:29:23.578723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dc1df42-73eb-4e37-9768-57cfc096407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e9dbf080>]}
[0m22:29:23.579821 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:29:23.580902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dc1df42-73eb-4e37-9768-57cfc096407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e9bad760>]}
[0m22:29:23.584065 [info ] [MainThread]: 
[0m22:29:23.586632 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:29:23.589972 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:29:23.591818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:24.155985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:29:24.157092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:29:24.597852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dc1df42-73eb-4e37-9768-57cfc096407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e9dbe360>]}
[0m22:29:24.600508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:29:24.602059 [info ] [MainThread]: 
[0m22:29:24.608729 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:29:24.610251 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m22:29:24.612708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m22:29:24.614002 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:29:24.643056 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:29:24.645478 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 22:29:24.614780 => 22:29:24.644173
[0m22:29:24.648428 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:29:24.710408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:25.215045 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:29:25.216640 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Average for Month`, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:29:25.468684 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:bd265076-66fe-4fd4-94dc-f6635461054a&page=queryresults
[0m22:29:27.688232 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 22:29:24.651484 => 22:29:27.687710
[0m22:29:27.690018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc1df42-73eb-4e37-9768-57cfc096407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e9c968a0>]}
[0m22:29:27.691380 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.08s]
[0m22:29:27.693058 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:29:27.694190 [debug] [Thread-1 (]: Began running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:29:27.695418 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [RUN]
[0m22:29:27.697189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.percentage_of_pick_ups_by_base_per_month)
[0m22:29:27.698812 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:29:27.706017 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:29:27.708485 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (compile): 22:29:27.700068 => 22:29:27.707514
[0m22:29:27.710418 [debug] [Thread-1 (]: Began executing node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:29:27.718949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:28.162442 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:29:28.164228 [debug] [Thread-1 (]: On model.uber_transformations.percentage_of_pick_ups_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`percentage_of_pick_ups_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month AS `Month`,
           COUNT(*) OVER (PARTITION BY month_extract.`Dispatching Base Name`, month_extract.month) AS `Count per Base per Month`,
           COUNT(*) as `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`
)

SELECT *,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
    );
  
[0m22:29:28.397424 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b04ea00e-bcaa-4e16-8c49-72cea1e031a9&page=queryresults
[0m22:29:30.349922 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (execute): 22:29:27.711541 => 22:29:30.348720
[0m22:29:30.354916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc1df42-73eb-4e37-9768-57cfc096407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e9c14e30>]}
[0m22:29:30.357878 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.66s]
[0m22:29:30.361525 [debug] [Thread-1 (]: Finished running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:29:30.364462 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:29:30.367640 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m22:29:30.372093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.percentage_of_pick_ups_by_base_per_month, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m22:29:30.374579 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:29:30.383569 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:29:30.387766 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 22:29:30.376518 => 22:29:30.385883
[0m22:29:30.390007 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:29:30.400794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:30.939906 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:29:30.941972 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:29:31.146062 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:5fe2f752-7521-475d-944f-4f480aa3bbcf&page=queryresults
[0m22:29:32.771533 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 22:29:30.391786 => 22:29:32.768070
[0m22:29:32.775515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc1df42-73eb-4e37-9768-57cfc096407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e9c69e20>]}
[0m22:29:32.778491 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.40s]
[0m22:29:32.781719 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:29:32.784195 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:29:32.786569 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m22:29:32.791211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m22:29:32.793365 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:29:32.801819 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:29:32.813357 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 22:29:32.794947 => 22:29:32.809023
[0m22:29:32.818538 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:29:32.828252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:33.582043 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:29:33.589949 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:29:33.827540 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:196bf3ba-8fec-4e68-a7cc-876185419841&page=queryresults
[0m22:29:35.710912 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 22:29:32.820174 => 22:29:35.709998
[0m22:29:35.714650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc1df42-73eb-4e37-9768-57cfc096407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e9c6a060>]}
[0m22:29:35.718239 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.93s]
[0m22:29:35.731852 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:29:35.734259 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:29:35.737050 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m22:29:35.743060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m22:29:35.747208 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:29:35.897477 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:29:35.906519 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 22:29:35.749651 => 22:29:35.904220
[0m22:29:35.912460 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:29:35.947687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:36.672538 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:29:36.675518 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:29:36.879468 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:5622f225-6566-4ccf-9094-7edc34add946&page=queryresults
[0m22:29:38.544773 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 22:29:35.919856 => 22:29:38.540551
[0m22:29:38.549936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc1df42-73eb-4e37-9768-57cfc096407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e9c6a060>]}
[0m22:29:38.552776 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.81s]
[0m22:29:38.561256 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:29:38.566974 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:29:38.581989 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:29:38.607730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:29:38.614594 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:29:38.636745 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:29:38.648368 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:29:38.617108 => 22:29:38.644066
[0m22:29:38.653786 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:29:38.680481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:39.562072 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:29:39.575468 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:29:39.814034 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:9c0c6e61-0938-406c-8b40-32171c8987a5&page=queryresults
[0m22:29:41.748459 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:29:38.657837 => 22:29:41.746176
[0m22:29:41.756364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc1df42-73eb-4e37-9768-57cfc096407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e947e780>]}
[0m22:29:41.764328 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.16s]
[0m22:29:41.773034 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:29:41.794418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:41.799475 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:29:41.807590 [info ] [MainThread]: 
[0m22:29:41.828278 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 18.22 seconds (18.22s).
[0m22:29:41.855275 [debug] [MainThread]: Command end result
[0m22:29:41.963684 [info ] [MainThread]: 
[0m22:29:41.977360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:29:41.984953 [info ] [MainThread]: 
[0m22:29:41.990121 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:29:42.011792 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.98746, "process_user_time": 7.836729, "process_kernel_time": 0.431205, "process_mem_max_rss": "135712", "process_out_blocks": "2968", "process_in_blocks": "0"}
[0m22:29:42.019551 [debug] [MainThread]: Command `dbt run` succeeded at 22:29:42.018786 after 20.00 seconds
[0m22:29:42.025898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ebac54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e9c19490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e9e7c140>]}
[0m22:29:42.031125 [debug] [MainThread]: Flushing usage events
[0m22:34:03.173149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49113d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49113fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49113d9d0>]}


============================== 22:34:03.178348 | c9b83eea-9fc1-4d30-997f-d9f6ebb8bea3 ==============================
[0m22:34:03.178348 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:34:03.179819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:34:04.003194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9b83eea-9fc1-4d30-997f-d9f6ebb8bea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48f9fb7a0>]}
[0m22:34:04.172655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9b83eea-9fc1-4d30-997f-d9f6ebb8bea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48f794380>]}
[0m22:34:04.174086 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:34:04.190298 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:34:04.266067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:34:04.267298 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m22:34:04.610959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9b83eea-9fc1-4d30-997f-d9f6ebb8bea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48f2ff9e0>]}
[0m22:34:04.625072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9b83eea-9fc1-4d30-997f-d9f6ebb8bea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48f4575f0>]}
[0m22:34:04.626169 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:34:04.627239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9b83eea-9fc1-4d30-997f-d9f6ebb8bea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48f264590>]}
[0m22:34:04.630460 [info ] [MainThread]: 
[0m22:34:04.632346 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:34:04.636331 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:34:04.637635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:05.145146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:34:05.146237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:05.582015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9b83eea-9fc1-4d30-997f-d9f6ebb8bea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48f264230>]}
[0m22:34:05.583804 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:34:05.584917 [info ] [MainThread]: 
[0m22:34:05.588921 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:34:05.591259 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m22:34:05.594390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m22:34:05.596215 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:34:05.624836 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:34:05.627816 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 22:34:05.597473 => 22:34:05.626753
[0m22:34:05.633353 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:34:05.687631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:06.201562 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:34:06.203144 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Average for Month`, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:34:06.420814 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:3f4b3727-af5c-4c2c-81bc-d2474110eb22&page=queryresults
[0m22:34:08.618106 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 22:34:05.636273 => 22:34:08.617596
[0m22:34:08.619861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9b83eea-9fc1-4d30-997f-d9f6ebb8bea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48f34cef0>]}
[0m22:34:08.621246 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.03s]
[0m22:34:08.622856 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:34:08.623973 [debug] [Thread-1 (]: Began running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:34:08.625117 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [RUN]
[0m22:34:08.626928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.percentage_of_pick_ups_by_base_per_month)
[0m22:34:08.628338 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:34:08.632727 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:34:08.634804 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (compile): 22:34:08.629162 => 22:34:08.633977
[0m22:34:08.636139 [debug] [Thread-1 (]: Began executing node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:34:08.640801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:09.086140 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:34:09.087896 [debug] [Thread-1 (]: On model.uber_transformations.percentage_of_pick_ups_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`percentage_of_pick_ups_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract GROUP BY month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`
)

SELECT *,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
    );
  
[0m22:34:09.277593 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:bdc3c686-5b37-4825-b524-f0415efb0b6f&page=queryresults
[0m22:34:09.943388 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Scalar subquery produced more than one element; reason: invalidQuery, location: query, message: Scalar subquery produced more than one element')
[0m22:34:10.157122 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:baa2233c-9dec-4bb7-8c66-c1ec9c978b1b&page=queryresults
[0m22:34:10.817358 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:baa2233c-9dec-4bb7-8c66-c1ec9c978b1b&page=queryresults
[0m22:34:10.819154 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (execute): 22:34:08.636838 => 22:34:10.818462
[0m22:34:10.833882 [debug] [Thread-1 (]: Database Error in model percentage_of_pick_ups_by_base_per_month (models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql)
  Scalar subquery produced more than one element
  compiled Code at target/run/uber_transformations/models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m22:34:10.836238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9b83eea-9fc1-4d30-997f-d9f6ebb8bea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48f34c410>]}
[0m22:34:10.838591 [error] [Thread-1 (]: 2 of 6 ERROR creating sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [[31mERROR[0m in 2.21s]
[0m22:34:10.841284 [debug] [Thread-1 (]: Finished running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:34:10.843285 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:34:10.845600 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m22:34:10.848670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.percentage_of_pick_ups_by_base_per_month, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m22:34:10.850576 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:34:10.857445 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:34:10.860208 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 22:34:10.851694 => 22:34:10.858967
[0m22:34:10.862272 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:34:10.872166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:11.370592 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:34:11.372227 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:34:11.576059 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:6eaf082a-32ae-437d-83b5-64ebc6356305&page=queryresults
[0m22:34:13.467472 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 22:34:10.863576 => 22:34:13.466638
[0m22:34:13.469604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9b83eea-9fc1-4d30-997f-d9f6ebb8bea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48e94b410>]}
[0m22:34:13.471021 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.62s]
[0m22:34:13.474073 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:34:13.476742 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:34:13.480059 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m22:34:13.483571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m22:34:13.485972 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:34:13.492736 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:34:13.495176 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 22:34:13.487194 => 22:34:13.494240
[0m22:34:13.496873 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:34:13.504010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:14.257935 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:34:14.269089 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:34:14.460414 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:305f1da8-5c3c-4e60-a699-27c706688fba&page=queryresults
[0m22:34:16.391659 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 22:34:13.497977 => 22:34:16.387435
[0m22:34:16.402078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9b83eea-9fc1-4d30-997f-d9f6ebb8bea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48c7ef2c0>]}
[0m22:34:16.415117 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.92s]
[0m22:34:16.423059 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:34:16.427664 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:34:16.443475 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m22:34:16.455720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m22:34:16.464695 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:34:16.602982 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:34:16.606361 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 22:34:16.477022 => 22:34:16.605133
[0m22:34:16.609084 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:34:16.620590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:17.202644 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:34:17.204714 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:34:17.410580 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8fbc5b76-72cf-4576-9c2e-858a044753a0&page=queryresults
[0m22:34:19.343304 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 22:34:16.610881 => 22:34:19.342708
[0m22:34:19.345896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9b83eea-9fc1-4d30-997f-d9f6ebb8bea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48f2e94c0>]}
[0m22:34:19.348241 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.90s]
[0m22:34:19.350143 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:34:19.351463 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:34:19.353217 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:34:19.356864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:34:19.359237 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:34:19.374472 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:34:19.376696 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:34:19.360672 => 22:34:19.375726
[0m22:34:19.378225 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:34:19.387884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:20.068288 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:34:20.071498 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:34:20.367409 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c238c774-cfed-4665-b823-fb7cb24ec75e&page=queryresults
[0m22:34:22.262155 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:34:19.379547 => 22:34:22.260964
[0m22:34:22.265217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9b83eea-9fc1-4d30-997f-d9f6ebb8bea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48f322300>]}
[0m22:34:22.267649 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.91s]
[0m22:34:22.270112 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:34:22.278387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:22.281892 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:34:22.284080 [info ] [MainThread]: 
[0m22:34:22.286601 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 17.65 seconds (17.65s).
[0m22:34:22.293952 [debug] [MainThread]: Command end result
[0m22:34:22.337917 [info ] [MainThread]: 
[0m22:34:22.344024 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:34:22.368981 [info ] [MainThread]: 
[0m22:34:22.381048 [error] [MainThread]:   Database Error in model percentage_of_pick_ups_by_base_per_month (models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql)
  Scalar subquery produced more than one element
  compiled Code at target/run/uber_transformations/models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m22:34:22.392247 [info ] [MainThread]: 
[0m22:34:22.396938 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m22:34:22.401815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 19.304367, "process_user_time": 7.362231, "process_kernel_time": 0.363963, "process_mem_max_rss": "136660", "process_out_blocks": "2976", "command_success": false, "process_in_blocks": "0"}
[0m22:34:22.412132 [debug] [MainThread]: Command `dbt run` failed at 22:34:22.410213 after 19.31 seconds
[0m22:34:22.415496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49113faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48f2477d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48f4cef30>]}
[0m22:34:22.418072 [debug] [MainThread]: Flushing usage events
[0m22:35:18.798126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bff1c96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bff1ca210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bff1c9a60>]}


============================== 22:35:18.803109 | f47830f1-f994-451a-a82a-1a91e7355dcc ==============================
[0m22:35:18.803109 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:35:18.804475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:35:19.623886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f47830f1-f994-451a-a82a-1a91e7355dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bfd5474a0>]}
[0m22:35:19.798127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f47830f1-f994-451a-a82a-1a91e7355dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bfd61b3b0>]}
[0m22:35:19.799596 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:35:19.815170 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:35:19.891002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:35:19.892270 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m22:35:20.251923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f47830f1-f994-451a-a82a-1a91e7355dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bff1cbe90>]}
[0m22:35:20.266816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f47830f1-f994-451a-a82a-1a91e7355dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bfd4bc110>]}
[0m22:35:20.267992 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:35:20.269185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f47830f1-f994-451a-a82a-1a91e7355dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bfd26c590>]}
[0m22:35:20.272347 [info ] [MainThread]: 
[0m22:35:20.274215 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:35:20.277452 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:35:20.278832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:20.755127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:35:20.756254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:35:21.208522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f47830f1-f994-451a-a82a-1a91e7355dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bfd723fe0>]}
[0m22:35:21.210390 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:35:21.211453 [info ] [MainThread]: 
[0m22:35:21.215479 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:35:21.217000 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m22:35:21.219067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m22:35:21.220270 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:35:21.241420 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:35:21.244068 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 22:35:21.221259 => 22:35:21.243105
[0m22:35:21.246992 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:35:21.323881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:21.836528 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:35:21.838099 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Average for Month`, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:35:22.055942 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:60373c2e-9e65-4481-8c78-33829d25ccef&page=queryresults
[0m22:35:23.969995 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 22:35:21.249528 => 22:35:23.969471
[0m22:35:23.971767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f47830f1-f994-451a-a82a-1a91e7355dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bfd61b3b0>]}
[0m22:35:23.973144 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.75s]
[0m22:35:23.974725 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:35:23.975869 [debug] [Thread-1 (]: Began running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:35:23.977134 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [RUN]
[0m22:35:23.978801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.percentage_of_pick_ups_by_base_per_month)
[0m22:35:23.980194 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:35:23.984618 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:35:23.986827 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (compile): 22:35:23.980984 => 22:35:23.986100
[0m22:35:23.987979 [debug] [Thread-1 (]: Began executing node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:35:23.992736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:24.454274 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:35:24.456340 [debug] [Thread-1 (]: On model.uber_transformations.percentage_of_pick_ups_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`percentage_of_pick_ups_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`
)

SELECT *,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
    );
  
[0m22:35:24.677504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:cd619314-49ab-411c-91e2-f179cb3ebd0f&page=queryresults
[0m22:35:29.002783 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (execute): 22:35:23.988751 => 22:35:29.002223
[0m22:35:29.004711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f47830f1-f994-451a-a82a-1a91e7355dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bfd369490>]}
[0m22:35:29.006086 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 5.03s]
[0m22:35:29.007685 [debug] [Thread-1 (]: Finished running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:35:29.008827 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:35:29.010146 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m22:35:29.013054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.percentage_of_pick_ups_by_base_per_month, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m22:35:29.016234 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:35:29.024951 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:35:29.027636 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 22:35:29.017837 => 22:35:29.026748
[0m22:35:29.028714 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:35:29.034927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:29.488197 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:35:29.490386 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:35:29.692785 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:3bf70f36-5876-4c0d-834b-953daf3263ea&page=queryresults
[0m22:35:31.556455 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 22:35:29.029591 => 22:35:31.555899
[0m22:35:31.558389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f47830f1-f994-451a-a82a-1a91e7355dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bfd369490>]}
[0m22:35:31.559884 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.55s]
[0m22:35:31.562073 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:35:31.564148 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:35:31.565925 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m22:35:31.568334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m22:35:31.569661 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:35:31.574641 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:35:31.576788 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 22:35:31.570571 => 22:35:31.575805
[0m22:35:31.578326 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:35:31.585670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:32.074711 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:35:32.077841 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:35:32.290389 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4255794e-3c0f-4a2c-8c3e-d7b827fa0d01&page=queryresults
[0m22:35:34.187033 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 22:35:31.579767 => 22:35:34.185571
[0m22:35:34.191276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f47830f1-f994-451a-a82a-1a91e7355dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bfd369850>]}
[0m22:35:34.194165 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.62s]
[0m22:35:34.197446 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:35:34.200686 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:35:34.204515 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m22:35:34.208960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m22:35:34.212410 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:35:34.276354 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:35:34.287386 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 22:35:34.213974 => 22:35:34.282085
[0m22:35:34.293488 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:35:34.304846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:34.926485 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:35:34.931492 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:35:35.142830 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:67328e7f-6a03-4112-b869-3660354e77a0&page=queryresults
[0m22:35:36.766176 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 22:35:34.298519 => 22:35:36.764733
[0m22:35:36.770840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f47830f1-f994-451a-a82a-1a91e7355dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bfcb3cfb0>]}
[0m22:35:36.776097 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.56s]
[0m22:35:36.785436 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:35:36.790599 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:35:36.796601 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:35:36.807881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:35:36.812242 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:35:36.835701 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:35:36.839566 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:35:36.814089 => 22:35:36.838023
[0m22:35:36.842259 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:35:36.864590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:37.514319 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:35:37.521402 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:35:37.750504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c2e11dcc-322f-4b5d-831c-7b927c663a8f&page=queryresults
[0m22:35:39.374548 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:35:36.843758 => 22:35:39.370316
[0m22:35:39.384025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f47830f1-f994-451a-a82a-1a91e7355dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bfd369d00>]}
[0m22:35:39.389736 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.58s]
[0m22:35:39.398198 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:35:39.405992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:35:39.407662 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:35:39.410118 [info ] [MainThread]: 
[0m22:35:39.418047 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 19.14 seconds (19.14s).
[0m22:35:39.437462 [debug] [MainThread]: Command end result
[0m22:35:39.482646 [info ] [MainThread]: 
[0m22:35:39.489326 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:35:39.491871 [info ] [MainThread]: 
[0m22:35:39.499266 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:35:39.508994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.78649, "process_user_time": 7.262576, "process_kernel_time": 0.311146, "process_mem_max_rss": "135732", "process_out_blocks": "2968", "process_in_blocks": "0"}
[0m22:35:39.522117 [debug] [MainThread]: Command `dbt run` succeeded at 22:35:39.519680 after 20.80 seconds
[0m22:35:39.524737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bff3f69f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bfd246b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bfd79e840>]}
[0m22:35:39.527512 [debug] [MainThread]: Flushing usage events
[0m22:40:59.498025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feedc6c44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feedc6c43b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feedc6c5af0>]}


============================== 22:40:59.503167 | 4102c33a-57e2-419b-b14e-d899efb00d62 ==============================
[0m22:40:59.503167 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:40:59.504607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:41:00.362211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4102c33a-57e2-419b-b14e-d899efb00d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feedab97320>]}
[0m22:41:00.535162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4102c33a-57e2-419b-b14e-d899efb00d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feedb1e3dd0>]}
[0m22:41:00.536653 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:41:00.553005 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:41:00.635887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:41:00.637155 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m22:41:00.997583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4102c33a-57e2-419b-b14e-d899efb00d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeda8279b0>]}
[0m22:41:01.012026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4102c33a-57e2-419b-b14e-d899efb00d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeda9983e0>]}
[0m22:41:01.013169 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:41:01.014219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4102c33a-57e2-419b-b14e-d899efb00d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeda99bb60>]}
[0m22:41:01.017475 [info ] [MainThread]: 
[0m22:41:01.019316 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:41:01.022640 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:41:01.023960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:01.561029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:41:01.562191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:02.003132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4102c33a-57e2-419b-b14e-d899efb00d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feedab95670>]}
[0m22:41:02.005047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:41:02.006284 [info ] [MainThread]: 
[0m22:41:02.011690 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:41:02.013570 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m22:41:02.016216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m22:41:02.017521 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:41:02.044765 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:41:02.049256 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 22:41:02.018357 => 22:41:02.047599
[0m22:41:02.054285 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:41:02.124370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:02.628280 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:41:02.629844 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Average for Month`, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:41:02.875465 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:93d770b9-c004-47b9-b0b8-7d7b40a57941&page=queryresults
[0m22:41:05.137799 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 22:41:02.057906 => 22:41:05.137151
[0m22:41:05.140282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4102c33a-57e2-419b-b14e-d899efb00d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeda99bc20>]}
[0m22:41:05.141944 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.13s]
[0m22:41:05.143813 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:41:05.145082 [debug] [Thread-1 (]: Began running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:41:05.146525 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [RUN]
[0m22:41:05.148443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.percentage_of_pick_ups_by_base_per_month)
[0m22:41:05.150072 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:41:05.154954 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:41:05.157125 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (compile): 22:41:05.151016 => 22:41:05.156149
[0m22:41:05.158309 [debug] [Thread-1 (]: Began executing node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:41:05.165882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:05.637597 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:41:05.639333 [debug] [Thread-1 (]: On model.uber_transformations.percentage_of_pick_ups_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`percentage_of_pick_ups_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`
)

SELECT *,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month DESC
    );
  
[0m22:41:05.880275 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:295c93ea-560c-4403-973c-3afe8b21baa3&page=queryresults
[0m22:41:10.239666 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (execute): 22:41:05.159102 => 22:41:10.237781
[0m22:41:10.243393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4102c33a-57e2-419b-b14e-d899efb00d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeda8657f0>]}
[0m22:41:10.246053 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 5.10s]
[0m22:41:10.249244 [debug] [Thread-1 (]: Finished running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:41:10.251519 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:41:10.253609 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m22:41:10.255602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.percentage_of_pick_ups_by_base_per_month, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m22:41:10.257237 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:41:10.261531 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:41:10.263724 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 22:41:10.258080 => 22:41:10.262654
[0m22:41:10.265057 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:41:10.270814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:10.794367 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:41:10.796060 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:41:11.035434 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:98120215-9210-4b20-8b74-8e59aab8ece8&page=queryresults
[0m22:41:12.772129 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 22:41:10.265849 => 22:41:12.765695
[0m22:41:12.807580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4102c33a-57e2-419b-b14e-d899efb00d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeda865a60>]}
[0m22:41:12.823401 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.55s]
[0m22:41:12.856683 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:41:12.868721 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:41:12.903607 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m22:41:12.937974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m22:41:12.952603 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:41:12.982848 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:41:13.007747 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 22:41:12.973208 => 22:41:13.003896
[0m22:41:13.016359 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:41:13.061691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:13.912323 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:41:13.917144 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:41:14.134962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0f3fbb81-8cbd-45b1-965b-956a4180b4b4&page=queryresults
[0m22:41:16.004939 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 22:41:13.017898 => 22:41:16.003280
[0m22:41:16.008193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4102c33a-57e2-419b-b14e-d899efb00d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeda865a60>]}
[0m22:41:16.010993 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 3.09s]
[0m22:41:16.012916 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:41:16.014964 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:41:16.017651 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m22:41:16.021026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m22:41:16.023336 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:41:16.077056 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:41:16.083071 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 22:41:16.024639 => 22:41:16.080943
[0m22:41:16.088525 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:41:16.099335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:16.946530 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:41:16.950773 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:41:17.165330 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c74061d9-4c00-43c9-b627-324c94d64e69&page=queryresults
[0m22:41:18.808534 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 22:41:16.093173 => 22:41:18.805190
[0m22:41:18.815490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4102c33a-57e2-419b-b14e-d899efb00d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feed9e544d0>]}
[0m22:41:18.821100 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.80s]
[0m22:41:18.830438 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:41:18.838262 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:41:18.844557 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:41:18.851171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:41:18.865374 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:41:18.899956 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:41:18.907931 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:41:18.867723 => 22:41:18.904149
[0m22:41:18.912637 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:41:18.924684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:19.863246 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:41:19.867156 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:41:20.101303 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:bf663f2a-5f5e-4f36-95dd-e12f2c6b80e0&page=queryresults
[0m22:41:22.050865 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:41:18.913631 => 22:41:22.049484
[0m22:41:22.054438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4102c33a-57e2-419b-b14e-d899efb00d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeda8662d0>]}
[0m22:41:22.064251 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 3.21s]
[0m22:41:22.074830 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:41:22.103870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:22.114018 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:41:22.121379 [info ] [MainThread]: 
[0m22:41:22.127921 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 21.10 seconds (21.10s).
[0m22:41:22.174220 [debug] [MainThread]: Command end result
[0m22:41:22.303135 [info ] [MainThread]: 
[0m22:41:22.314155 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:41:22.320350 [info ] [MainThread]: 
[0m22:41:22.335308 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:41:22.346412 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.92308, "process_user_time": 8.112519, "process_kernel_time": 0.382151, "process_mem_max_rss": "135416", "process_out_blocks": "2968", "process_in_blocks": "0"}
[0m22:41:22.354152 [debug] [MainThread]: Command `dbt run` succeeded at 22:41:22.351824 after 22.93 seconds
[0m22:41:22.368475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee08a7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeda970fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feedaaa6720>]}
[0m22:41:22.383458 [debug] [MainThread]: Flushing usage events
[0m22:43:19.626210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb8ceb0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb8ce9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb8ceb950>]}


============================== 22:43:19.631251 | ec2a6802-2658-4a15-9fb4-eccf954c482e ==============================
[0m22:43:19.631251 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:43:19.632628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:43:20.494517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec2a6802-2658-4a15-9fb4-eccf954c482e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb74ef2c0>]}
[0m22:43:20.672937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec2a6802-2658-4a15-9fb4-eccf954c482e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb71007a0>]}
[0m22:43:20.674513 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:43:20.692614 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:43:20.769239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:43:20.770713 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m22:43:21.146822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec2a6802-2658-4a15-9fb4-eccf954c482e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb6e23980>]}
[0m22:43:21.165979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec2a6802-2658-4a15-9fb4-eccf954c482e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb6fa33e0>]}
[0m22:43:21.167239 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:43:21.168358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec2a6802-2658-4a15-9fb4-eccf954c482e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb7154590>]}
[0m22:43:21.171690 [info ] [MainThread]: 
[0m22:43:21.173581 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:43:21.177086 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:43:21.178329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:21.695880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:43:21.697006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:22.166742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec2a6802-2658-4a15-9fb4-eccf954c482e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb6d9d8e0>]}
[0m22:43:22.168892 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:43:22.170063 [info ] [MainThread]: 
[0m22:43:22.174361 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:43:22.176143 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m22:43:22.179225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m22:43:22.181186 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:43:22.226607 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:43:22.239131 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 22:43:22.182289 => 22:43:22.234791
[0m22:43:22.243179 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:43:22.309373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:22.800301 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m22:43:22.802199 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Average for Month`, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:43:23.058591 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d5f78270-843d-4fb2-bc3a-0f3ec9abf24a&page=queryresults
[0m22:43:24.987754 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 22:43:22.248023 => 22:43:24.987238
[0m22:43:24.989650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec2a6802-2658-4a15-9fb4-eccf954c482e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb6e813d0>]}
[0m22:43:24.991177 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.81s]
[0m22:43:24.993267 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m22:43:24.994457 [debug] [Thread-1 (]: Began running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:43:24.995704 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [RUN]
[0m22:43:24.997540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.percentage_of_pick_ups_by_base_per_month)
[0m22:43:24.999418 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:43:25.003867 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:43:25.006039 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (compile): 22:43:25.000208 => 22:43:25.004940
[0m22:43:25.007983 [debug] [Thread-1 (]: Began executing node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:43:25.018843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:25.503336 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m22:43:25.505158 [debug] [Thread-1 (]: On model.uber_transformations.percentage_of_pick_ups_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`percentage_of_pick_ups_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`
)

SELECT *,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m22:43:25.778351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:db242d03-f59f-4668-895e-2c07c94147a2&page=queryresults
[0m22:43:30.431464 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (execute): 22:43:25.009750 => 22:43:30.430981
[0m22:43:30.433340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec2a6802-2658-4a15-9fb4-eccf954c482e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb6e55580>]}
[0m22:43:30.434927 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 5.44s]
[0m22:43:30.436544 [debug] [Thread-1 (]: Finished running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m22:43:30.437640 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:43:30.438881 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m22:43:30.440697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.percentage_of_pick_ups_by_base_per_month, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m22:43:30.443401 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:43:30.448722 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:43:30.450750 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 22:43:30.445447 => 22:43:30.449927
[0m22:43:30.451877 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:43:30.458358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:30.948369 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m22:43:30.951343 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:43:31.152101 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:308db9ec-89c4-40e4-983e-b4561d564bb7&page=queryresults
[0m22:43:32.761318 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 22:43:30.452797 => 22:43:32.760186
[0m22:43:32.765641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec2a6802-2658-4a15-9fb4-eccf954c482e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb6e556a0>]}
[0m22:43:32.769041 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.33s]
[0m22:43:32.772232 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m22:43:32.774307 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:43:32.777588 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m22:43:32.783331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m22:43:32.786552 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:43:32.795276 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:43:32.798218 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 22:43:32.788428 => 22:43:32.797090
[0m22:43:32.800268 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:43:32.809548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:33.294017 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m22:43:33.295829 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:43:33.534663 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:21ce2c63-2c9f-4a6d-906e-7854d072e5ce&page=queryresults
[0m22:43:35.429408 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 22:43:32.801393 => 22:43:35.428216
[0m22:43:35.431326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec2a6802-2658-4a15-9fb4-eccf954c482e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb6e55580>]}
[0m22:43:35.432853 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.65s]
[0m22:43:35.434482 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m22:43:35.435520 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:43:35.436905 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m22:43:35.439095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m22:43:35.440652 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:43:35.487106 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:43:35.494049 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 22:43:35.441373 => 22:43:35.490939
[0m22:43:35.496803 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:43:35.509532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:35.982807 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m22:43:35.985139 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:43:36.216338 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e62549bd-f0cc-4e0d-9c38-f92c92d38729&page=queryresults
[0m22:43:38.103863 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 22:43:35.497900 => 22:43:38.103339
[0m22:43:38.105638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec2a6802-2658-4a15-9fb4-eccf954c482e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb66289e0>]}
[0m22:43:38.107041 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.67s]
[0m22:43:38.108644 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m22:43:38.109807 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:43:38.111007 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:43:38.112770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:43:38.114240 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:43:38.122771 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:43:38.124746 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:43:38.115017 => 22:43:38.123813
[0m22:43:38.126235 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:43:38.131795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:38.568624 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:43:38.570326 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:43:38.797205 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:5ff6928e-de8f-4b44-a082-e34dd329cfae&page=queryresults
[0m22:43:40.372827 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:43:38.127226 => 22:43:40.370599
[0m22:43:40.377408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec2a6802-2658-4a15-9fb4-eccf954c482e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb66289e0>]}
[0m22:43:40.379995 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.26s]
[0m22:43:40.382937 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:43:40.390536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:40.392599 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:43:40.395377 [info ] [MainThread]: 
[0m22:43:40.398343 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 19.22 seconds (19.22s).
[0m22:43:40.407393 [debug] [MainThread]: Command end result
[0m22:43:40.432484 [info ] [MainThread]: 
[0m22:43:40.435302 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:40.439918 [info ] [MainThread]: 
[0m22:43:40.447180 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:43:40.455659 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.908192, "process_user_time": 7.29779, "process_kernel_time": 0.290718, "process_mem_max_rss": "133756", "process_out_blocks": "2976", "process_in_blocks": "0"}
[0m22:43:40.457825 [debug] [MainThread]: Command `dbt run` succeeded at 22:43:40.457373 after 20.91 seconds
[0m22:43:40.459300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb8d1be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb66726f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb75b82f0>]}
[0m22:43:40.466634 [debug] [MainThread]: Flushing usage events
[0m23:02:00.702734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e2d40f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e31a9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e2dfd7f0>]}


============================== 23:02:00.708084 | 069ee4f9-6971-47ab-8dbe-bd494f3719a8 ==============================
[0m23:02:00.708084 [info ] [MainThread]: Running with dbt=1.7.10
[0m23:02:00.709496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:02:01.552062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '069ee4f9-6971-47ab-8dbe-bd494f3719a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e1469a00>]}
[0m23:02:01.724482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '069ee4f9-6971-47ab-8dbe-bd494f3719a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e0fd4740>]}
[0m23:02:01.725925 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m23:02:01.741977 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m23:02:01.817726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:02:01.819011 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m23:02:02.162478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '069ee4f9-6971-47ab-8dbe-bd494f3719a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e0c329c0>]}
[0m23:02:02.176788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '069ee4f9-6971-47ab-8dbe-bd494f3719a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e0ed4da0>]}
[0m23:02:02.177862 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m23:02:02.178886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '069ee4f9-6971-47ab-8dbe-bd494f3719a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e0ed4b90>]}
[0m23:02:02.182083 [info ] [MainThread]: 
[0m23:02:02.184715 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:02:02.190009 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m23:02:02.191500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:02.769269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m23:02:02.770364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:02:03.237858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '069ee4f9-6971-47ab-8dbe-bd494f3719a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e0f21550>]}
[0m23:02:03.240014 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:02:03.241047 [info ] [MainThread]: 
[0m23:02:03.245143 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:02:03.246614 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m23:02:03.248650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m23:02:03.249904 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:02:03.279543 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m23:02:03.283412 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 23:02:03.250651 => 23:02:03.282553
[0m23:02:03.286817 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:02:03.357680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:03.861396 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m23:02:03.863319 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Average for Month`, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m23:02:04.291206 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ac678d70-4835-4c40-aac0-c89164169333&page=queryresults
[0m23:02:06.554199 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 23:02:03.290199 => 23:02:06.553376
[0m23:02:06.556151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '069ee4f9-6971-47ab-8dbe-bd494f3719a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e0c73b90>]}
[0m23:02:06.557579 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.31s]
[0m23:02:06.559167 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:02:06.560317 [debug] [Thread-1 (]: Began running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:02:06.561590 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [RUN]
[0m23:02:06.563354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.percentage_of_pick_ups_by_base_per_month)
[0m23:02:06.564738 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:02:06.570398 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m23:02:06.572178 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (compile): 23:02:06.565595 => 23:02:06.571474
[0m23:02:06.573536 [debug] [Thread-1 (]: Began executing node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:02:06.578649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:07.034494 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m23:02:07.036335 [debug] [Thread-1 (]: On model.uber_transformations.percentage_of_pick_ups_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`percentage_of_pick_ups_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m23:02:07.379329 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:43ddfbc7-377b-4a99-a406-c74dd66eece8&page=queryresults
[0m23:02:07.540392 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: counting_cte.`Count per Base per Month` at [40:8]; reason: invalidQuery, location: query, message: Function not found: counting_cte.`Count per Base per Month` at [40:8]')
[0m23:02:08.370336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a0ee4b1e-f13f-4e5f-939d-b8b3e8ad29d8&page=queryresults
[0m23:02:08.534916 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a0ee4b1e-f13f-4e5f-939d-b8b3e8ad29d8&page=queryresults
[0m23:02:08.536622 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (execute): 23:02:06.574238 => 23:02:08.536034
[0m23:02:08.546695 [debug] [Thread-1 (]: Database Error in model percentage_of_pick_ups_by_base_per_month (models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql)
  Function not found: counting_cte.`Count per Base per Month` at [40:8]
  compiled Code at target/run/uber_transformations/models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m23:02:08.547967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '069ee4f9-6971-47ab-8dbe-bd494f3719a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e0e5fe90>]}
[0m23:02:08.549710 [error] [Thread-1 (]: 2 of 6 ERROR creating sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [[31mERROR[0m in 1.99s]
[0m23:02:08.551962 [debug] [Thread-1 (]: Finished running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:02:08.553350 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:02:08.554950 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m23:02:08.557725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.percentage_of_pick_ups_by_base_per_month, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m23:02:08.560419 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:02:08.567021 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m23:02:08.574645 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 23:02:08.561545 => 23:02:08.571154
[0m23:02:08.576292 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:02:08.590991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:09.067747 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m23:02:09.069721 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m23:02:09.301016 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:46e983de-0e49-43b5-aea2-181c9f202d2d&page=queryresults
[0m23:02:11.244083 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 23:02:08.577886 => 23:02:11.242877
[0m23:02:11.248161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '069ee4f9-6971-47ab-8dbe-bd494f3719a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e0e5ff50>]}
[0m23:02:11.251263 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.69s]
[0m23:02:11.255030 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:02:11.257650 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:02:11.262093 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m23:02:11.268576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m23:02:11.272015 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:02:11.286844 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m23:02:11.288457 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 23:02:11.273718 => 23:02:11.287790
[0m23:02:11.289589 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:02:11.304165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:11.798681 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m23:02:11.800707 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m23:02:12.025734 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e06579d6-4205-4f31-9212-50eec177f5a7&page=queryresults
[0m23:02:14.239792 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 23:02:11.290590 => 23:02:14.237629
[0m23:02:14.251397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '069ee4f9-6971-47ab-8dbe-bd494f3719a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e02325a0>]}
[0m23:02:14.256318 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.98s]
[0m23:02:14.259563 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:02:14.264589 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:02:14.277689 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m23:02:14.287806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m23:02:14.291226 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:02:14.374399 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m23:02:14.383619 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 23:02:14.293561 => 23:02:14.380786
[0m23:02:14.387284 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:02:14.408462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:14.923686 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m23:02:14.925457 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m23:02:15.212983 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8a3c6f4b-da33-4210-a3e2-d3c40d3ba12a&page=queryresults
[0m23:02:17.077134 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 23:02:14.389823 => 23:02:17.076142
[0m23:02:17.081290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '069ee4f9-6971-47ab-8dbe-bd494f3719a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e023b890>]}
[0m23:02:17.083536 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.80s]
[0m23:02:17.086076 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:02:17.087856 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:02:17.090279 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m23:02:17.093001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m23:02:17.094598 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:02:17.101484 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m23:02:17.104305 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 23:02:17.095825 => 23:02:17.103217
[0m23:02:17.106210 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:02:17.117496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:17.318064 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m23:02:17.593047 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m23:02:17.594651 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m23:02:17.969124 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:480e8ad4-4fd1-4927-bf26-acd162a9052b&page=queryresults
[0m23:02:19.832634 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 23:02:17.107349 => 23:02:19.830584
[0m23:02:19.837653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '069ee4f9-6971-47ab-8dbe-bd494f3719a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e0239640>]}
[0m23:02:19.841211 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.75s]
[0m23:02:19.844882 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:02:19.847647 [info ] [MainThread]: 
[0m23:02:19.851857 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m23:02:19.855237 [info ] [MainThread]: 
[0m23:02:19.859011 [error] [MainThread]:   Database Error in model percentage_of_pick_ups_by_base_per_month (models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql)
  Function not found: counting_cte.`Count per Base per Month` at [40:8]
  compiled Code at target/run/uber_transformations/models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m23:02:19.862205 [info ] [MainThread]: 
[0m23:02:19.865481 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:02:19.868347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:19.871011 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m23:02:19.873781 [info ] [MainThread]: 
[0m23:02:19.876539 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 17.69 seconds (17.69s).
[0m23:02:19.879422 [error] [MainThread]: Encountered an error:

[0m23:02:19.936221 [error] [MainThread]: Traceback (most recent call last):
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m23:02:19.939702 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 19.313738, "process_user_time": 6.9623, "process_kernel_time": 0.319223, "process_mem_max_rss": "132912", "process_in_blocks": "272", "process_out_blocks": "2056", "command_success": false}
[0m23:02:19.941709 [debug] [MainThread]: Command `dbt run` failed at 23:02:19.941169 after 19.32 seconds
[0m23:02:19.943362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e2f04ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e0ff9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9e0c73050>]}
[0m23:02:19.945130 [debug] [MainThread]: Flushing usage events
[0m23:02:28.758907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554f929790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554f929b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554f929940>]}


============================== 23:02:28.764014 | 36c958de-da17-4229-affe-963e00f98854 ==============================
[0m23:02:28.764014 [info ] [MainThread]: Running with dbt=1.7.10
[0m23:02:28.765439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:02:29.586280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36c958de-da17-4229-affe-963e00f98854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554f92af60>]}
[0m23:02:29.760583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36c958de-da17-4229-affe-963e00f98854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554ddba330>]}
[0m23:02:29.762078 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m23:02:29.777746 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m23:02:29.855472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:02:29.856868 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m23:02:30.200268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36c958de-da17-4229-affe-963e00f98854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554dadf920>]}
[0m23:02:30.214635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36c958de-da17-4229-affe-963e00f98854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554dc72de0>]}
[0m23:02:30.215763 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m23:02:30.216784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36c958de-da17-4229-affe-963e00f98854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554da0e720>]}
[0m23:02:30.219940 [info ] [MainThread]: 
[0m23:02:30.221972 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:02:30.225158 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m23:02:30.226426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:30.666494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m23:02:30.667625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:02:31.113621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36c958de-da17-4229-affe-963e00f98854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554da51be0>]}
[0m23:02:31.115984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:02:31.117086 [info ] [MainThread]: 
[0m23:02:31.121672 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:02:31.123249 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m23:02:31.125226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m23:02:31.126579 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:02:31.162010 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m23:02:31.171776 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 23:02:31.127299 => 23:02:31.169995
[0m23:02:31.175934 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:02:31.238068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:31.734794 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m23:02:31.736723 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Average for Month`, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m23:02:31.935948 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b1491523-0f1a-4a06-9f8e-9581b2625160&page=queryresults
[0m23:02:34.160917 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 23:02:31.179599 => 23:02:34.160059
[0m23:02:34.163756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36c958de-da17-4229-affe-963e00f98854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554db3d790>]}
[0m23:02:34.165951 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.04s]
[0m23:02:34.168360 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:02:34.170033 [debug] [Thread-1 (]: Began running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:02:34.171893 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [RUN]
[0m23:02:34.175448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.percentage_of_pick_ups_by_base_per_month)
[0m23:02:34.177405 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:02:34.185164 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m23:02:34.187804 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (compile): 23:02:34.178896 => 23:02:34.186773
[0m23:02:34.189769 [debug] [Thread-1 (]: Began executing node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:02:34.198150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:34.676568 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m23:02:34.679014 [debug] [Thread-1 (]: On model.uber_transformations.percentage_of_pick_ups_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`percentage_of_pick_ups_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m23:02:34.906098 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e738983e-72fc-4300-8af4-39041191d4f1&page=queryresults
[0m23:02:39.201999 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (execute): 23:02:34.191025 => 23:02:39.200746
[0m23:02:39.206110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36c958de-da17-4229-affe-963e00f98854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554db117f0>]}
[0m23:02:39.209188 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 5.03s]
[0m23:02:39.213000 [debug] [Thread-1 (]: Finished running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:02:39.216106 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:02:39.219465 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m23:02:39.221362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.percentage_of_pick_ups_by_base_per_month, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m23:02:39.222762 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:02:39.226819 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m23:02:39.228861 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 23:02:39.223469 => 23:02:39.227972
[0m23:02:39.230178 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:02:39.236875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:39.706691 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m23:02:39.708315 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m23:02:39.972044 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:41b36b47-807a-4474-bd80-10e8fbd07f8f&page=queryresults
[0m23:02:41.839297 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 23:02:39.230915 => 23:02:41.838738
[0m23:02:41.841116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36c958de-da17-4229-affe-963e00f98854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554db11910>]}
[0m23:02:41.842458 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.62s]
[0m23:02:41.844010 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:02:41.845067 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:02:41.846304 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m23:02:41.848014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m23:02:41.849483 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:02:41.853985 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m23:02:41.855781 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 23:02:41.850253 => 23:02:41.855018
[0m23:02:41.856901 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:02:41.861366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:42.268021 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m23:02:42.269741 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m23:02:42.501868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:41ba1f46-4652-4db0-a8a8-4715334114bf&page=queryresults
[0m23:02:44.359250 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 23:02:41.857532 => 23:02:44.358037
[0m23:02:44.363288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36c958de-da17-4229-affe-963e00f98854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554db11ca0>]}
[0m23:02:44.366385 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.52s]
[0m23:02:44.369914 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:02:44.372456 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:02:44.375766 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m23:02:44.380326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m23:02:44.382932 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:02:44.428318 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m23:02:44.435168 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 23:02:44.385086 => 23:02:44.433338
[0m23:02:44.437197 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:02:44.450877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:44.936885 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m23:02:44.938575 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m23:02:45.113543 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:9e7fd967-1498-460a-b624-e0ebc9d59bea&page=queryresults
[0m23:02:46.991935 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 23:02:44.438139 => 23:02:46.990726
[0m23:02:46.995899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36c958de-da17-4229-affe-963e00f98854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554c137d10>]}
[0m23:02:46.998912 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.62s]
[0m23:02:47.002363 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:02:47.004883 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:02:47.009481 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m23:02:47.016089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m23:02:47.020527 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:02:47.030808 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m23:02:47.033500 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 23:02:47.022021 => 23:02:47.032418
[0m23:02:47.035496 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:02:47.045197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:47.490713 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m23:02:47.492263 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m23:02:47.690931 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:2a36f59e-f24f-4cf5-847a-325e61234f37&page=queryresults
[0m23:02:49.536685 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 23:02:47.036710 => 23:02:49.536175
[0m23:02:49.538393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36c958de-da17-4229-affe-963e00f98854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554c0eeab0>]}
[0m23:02:49.539793 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.53s]
[0m23:02:49.541359 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:02:49.544637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:49.545898 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m23:02:49.547094 [info ] [MainThread]: 
[0m23:02:49.548336 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 19.33 seconds (19.33s).
[0m23:02:49.552178 [debug] [MainThread]: Command end result
[0m23:02:49.574100 [info ] [MainThread]: 
[0m23:02:49.577062 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:02:49.578567 [info ] [MainThread]: 
[0m23:02:49.580081 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:02:49.589595 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.903574, "process_user_time": 6.862318, "process_kernel_time": 0.323498, "process_mem_max_rss": "137380", "process_out_blocks": "2976", "process_in_blocks": "0"}
[0m23:02:49.594386 [debug] [MainThread]: Command `dbt run` succeeded at 23:02:49.593773 after 20.91 seconds
[0m23:02:49.595457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554fa1b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554c0f5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554c137d10>]}
[0m23:02:49.596695 [debug] [MainThread]: Flushing usage events
[0m23:07:19.437052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cb3bd700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cb3bfda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cb3bfef0>]}


============================== 23:07:19.442307 | 7670beb6-2c3f-42fc-b269-c65ae7282781 ==============================
[0m23:07:19.442307 [info ] [MainThread]: Running with dbt=1.7.10
[0m23:07:19.443739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:07:20.321456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7670beb6-2c3f-42fc-b269-c65ae7282781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c978f7a0>]}
[0m23:07:20.523434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7670beb6-2c3f-42fc-b269-c65ae7282781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c9bd66f0>]}
[0m23:07:20.525013 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m23:07:20.544146 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m23:07:20.627562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:07:20.628845 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m23:07:21.016601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7670beb6-2c3f-42fc-b269-c65ae7282781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c94a7b60>]}
[0m23:07:21.030625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7670beb6-2c3f-42fc-b269-c65ae7282781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c96c7620>]}
[0m23:07:21.031656 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m23:07:21.032716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7670beb6-2c3f-42fc-b269-c65ae7282781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c945b7d0>]}
[0m23:07:21.037404 [info ] [MainThread]: 
[0m23:07:21.040662 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:07:21.045638 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m23:07:21.046911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:21.559479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m23:07:21.560563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:07:22.055462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7670beb6-2c3f-42fc-b269-c65ae7282781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c9f15370>]}
[0m23:07:22.057260 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:07:22.058405 [info ] [MainThread]: 
[0m23:07:22.062951 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:07:22.064615 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m23:07:22.066736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m23:07:22.067976 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:07:22.089769 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m23:07:22.099234 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 23:07:22.068702 => 23:07:22.097180
[0m23:07:22.101872 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:07:22.190621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:22.701673 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m23:07:22.703708 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Average for Month`, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m23:07:22.949854 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0f5b925c-1345-4ad9-9b6f-3c76134f1e26&page=queryresults
[0m23:07:24.857099 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 23:07:22.105067 => 23:07:24.856584
[0m23:07:24.858886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7670beb6-2c3f-42fc-b269-c65ae7282781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c957a330>]}
[0m23:07:24.860411 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.79s]
[0m23:07:24.862389 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:07:24.863557 [debug] [Thread-1 (]: Began running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:07:24.864963 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [RUN]
[0m23:07:24.867584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.percentage_of_pick_ups_by_base_per_month)
[0m23:07:24.868870 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:07:24.873365 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m23:07:24.875466 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (compile): 23:07:24.869673 => 23:07:24.874447
[0m23:07:24.876819 [debug] [Thread-1 (]: Began executing node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:07:24.881568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:25.345408 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m23:07:25.347692 [debug] [Thread-1 (]: On model.uber_transformations.percentage_of_pick_ups_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`percentage_of_pick_ups_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m23:07:25.833019 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:c0bafe45-d7fa-401a-95d0-364ed73da2dc&page=queryresults
[0m23:07:25.834778 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "month_extract" at [33:12]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "month_extract" at [33:12]')
[0m23:07:26.461108 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:780abae6-8ae1-4808-890c-35c815c06f7c&page=queryresults
[0m23:07:26.462651 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:US:780abae6-8ae1-4808-890c-35c815c06f7c&page=queryresults
[0m23:07:26.464254 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (execute): 23:07:24.877635 => 23:07:26.463654
[0m23:07:26.475125 [debug] [Thread-1 (]: Database Error in model percentage_of_pick_ups_by_base_per_month (models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql)
  Syntax error: Expected ")" but got identifier "month_extract" at [33:12]
  compiled Code at target/run/uber_transformations/models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m23:07:26.476539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7670beb6-2c3f-42fc-b269-c65ae7282781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c957a330>]}
[0m23:07:26.477925 [error] [Thread-1 (]: 2 of 6 ERROR creating sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [[31mERROR[0m in 1.61s]
[0m23:07:26.480006 [debug] [Thread-1 (]: Finished running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:07:26.481455 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:07:26.482868 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m23:07:26.485073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.percentage_of_pick_ups_by_base_per_month, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m23:07:26.487226 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:07:26.493513 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m23:07:26.500686 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 23:07:26.488117 => 23:07:26.497578
[0m23:07:26.503359 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:07:26.514539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:26.984274 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m23:07:26.985936 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m23:07:27.191638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f2f171b8-a34c-47e4-9747-40cd0fc2adea&page=queryresults
[0m23:07:29.086526 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 23:07:26.504224 => 23:07:29.086001
[0m23:07:29.088445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7670beb6-2c3f-42fc-b269-c65ae7282781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c9579520>]}
[0m23:07:29.089851 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.60s]
[0m23:07:29.091423 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:07:29.092589 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:07:29.093881 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m23:07:29.095959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m23:07:29.097517 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:07:29.105652 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m23:07:29.108516 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 23:07:29.099071 => 23:07:29.107469
[0m23:07:29.109786 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:07:29.115407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:29.563834 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m23:07:29.567273 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m23:07:29.791119 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ddfaad0b-2887-4d9f-b790-5dda891d7632&page=queryresults
[0m23:07:31.713710 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 23:07:29.110497 => 23:07:31.712529
[0m23:07:31.717678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7670beb6-2c3f-42fc-b269-c65ae7282781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c8278ec0>]}
[0m23:07:31.720628 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.62s]
[0m23:07:31.724306 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:07:31.726740 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:07:31.731591 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m23:07:31.738210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m23:07:31.742091 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:07:31.807378 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m23:07:31.810951 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 23:07:31.743659 => 23:07:31.809699
[0m23:07:31.815259 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:07:31.827719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:32.281036 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m23:07:32.282898 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m23:07:32.490286 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:dc10eb80-70d7-46a7-8dbb-80bed59cc599&page=queryresults
[0m23:07:34.322520 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 23:07:31.819465 => 23:07:34.321943
[0m23:07:34.324511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7670beb6-2c3f-42fc-b269-c65ae7282781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c8b6e570>]}
[0m23:07:34.326858 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.59s]
[0m23:07:34.330124 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:07:34.332442 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:07:34.334973 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m23:07:34.338389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m23:07:34.339912 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:07:34.349477 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m23:07:34.351789 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 23:07:34.340691 => 23:07:34.350553
[0m23:07:34.354569 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:07:34.366865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:34.844194 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m23:07:34.846196 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m23:07:35.066540 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4cefe352-7782-4f8f-8915-d70d7bf59456&page=queryresults
[0m23:07:37.024210 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 23:07:34.356246 => 23:07:37.023714
[0m23:07:37.026214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7670beb6-2c3f-42fc-b269-c65ae7282781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c8b6dd60>]}
[0m23:07:37.027700 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.69s]
[0m23:07:37.029357 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:07:37.033314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:37.034351 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m23:07:37.036283 [info ] [MainThread]: 
[0m23:07:37.038043 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 16.00 seconds (16.00s).
[0m23:07:37.041974 [debug] [MainThread]: Command end result
[0m23:07:37.060773 [info ] [MainThread]: 
[0m23:07:37.064987 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:07:37.069523 [info ] [MainThread]: 
[0m23:07:37.072700 [error] [MainThread]:   Database Error in model percentage_of_pick_ups_by_base_per_month (models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql)
  Syntax error: Expected ")" but got identifier "month_extract" at [33:12]
  compiled Code at target/run/uber_transformations/models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m23:07:37.077512 [info ] [MainThread]: 
[0m23:07:37.083276 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m23:07:37.092587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 17.734398, "process_user_time": 7.284207, "process_kernel_time": 0.271254, "process_mem_max_rss": "136448", "process_out_blocks": "2976", "command_success": false, "process_in_blocks": "0"}
[0m23:07:37.095049 [debug] [MainThread]: Command `dbt run` failed at 23:07:37.094380 after 17.74 seconds
[0m23:07:37.096400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cb3efb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c945b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c9a9c980>]}
[0m23:07:37.100190 [debug] [MainThread]: Flushing usage events
[0m23:08:05.630816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fb359be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fb522f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fb35aae0>]}


============================== 23:08:05.637578 | d6151692-e3e4-49ac-87d5-fd7ce2f0360b ==============================
[0m23:08:05.637578 [info ] [MainThread]: Running with dbt=1.7.10
[0m23:08:05.638976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:08:06.495450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6151692-e3e4-49ac-87d5-fd7ce2f0360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f96940e0>]}
[0m23:08:06.675792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6151692-e3e4-49ac-87d5-fd7ce2f0360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fb18d430>]}
[0m23:08:06.677239 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m23:08:06.693172 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m23:08:06.777300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:08:06.778872 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/percentage_of_pick_ups_by_base_per_month.sql
[0m23:08:07.150852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6151692-e3e4-49ac-87d5-fd7ce2f0360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f926fdd0>]}
[0m23:08:07.165553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6151692-e3e4-49ac-87d5-fd7ce2f0360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f9497710>]}
[0m23:08:07.166687 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m23:08:07.167723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6151692-e3e4-49ac-87d5-fd7ce2f0360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fb359160>]}
[0m23:08:07.170925 [info ] [MainThread]: 
[0m23:08:07.173597 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:08:07.177605 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m23:08:07.178776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:07.673672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m23:08:07.674727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:08:08.103469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6151692-e3e4-49ac-87d5-fd7ce2f0360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f9291cd0>]}
[0m23:08:08.105916 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:08:08.106939 [info ] [MainThread]: 
[0m23:08:08.112109 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:08:08.114821 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m23:08:08.117903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m23:08:08.120911 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:08:08.156556 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m23:08:08.167478 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 23:08:08.121714 => 23:08:08.161600
[0m23:08:08.173626 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:08:08.249053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:08.705103 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m23:08:08.706667 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month
)

SELECT *,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.`Average for Month`, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m23:08:08.915681 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4b5e9f87-ae97-4c03-bfde-53fa8f2544b1&page=queryresults
[0m23:08:11.123859 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 23:08:08.177718 => 23:08:11.122948
[0m23:08:11.126735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6151692-e3e4-49ac-87d5-fd7ce2f0360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f9423b90>]}
[0m23:08:11.129257 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.01s]
[0m23:08:11.132650 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:08:11.135658 [debug] [Thread-1 (]: Began running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:08:11.139215 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [RUN]
[0m23:08:11.143378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.percentage_of_pick_ups_by_base_per_month)
[0m23:08:11.144860 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:08:11.152835 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m23:08:11.155893 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (compile): 23:08:11.145816 => 23:08:11.154623
[0m23:08:11.158367 [debug] [Thread-1 (]: Began executing node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:08:11.174654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:11.613270 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m23:08:11.615611 [debug] [Thread-1 (]: On model.uber_transformations.percentage_of_pick_ups_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`percentage_of_pick_ups_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m23:08:11.834360 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:6f58f4d5-933c-42c1-b19f-b543c9981827&page=queryresults
[0m23:08:16.500185 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (execute): 23:08:11.160274 => 23:08:16.499057
[0m23:08:16.504110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6151692-e3e4-49ac-87d5-fd7ce2f0360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f934a300>]}
[0m23:08:16.507095 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 5.36s]
[0m23:08:16.510712 [debug] [Thread-1 (]: Finished running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:08:16.513173 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:08:16.516889 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m23:08:16.521047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.percentage_of_pick_ups_by_base_per_month, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m23:08:16.524852 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:08:16.540303 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m23:08:16.546649 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 23:08:16.527609 => 23:08:16.544011
[0m23:08:16.550763 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:08:16.566161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:17.065478 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m23:08:17.067042 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m23:08:17.285338 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:edd76e15-2c08-466b-8c96-5a0e8b1dfa94&page=queryresults
[0m23:08:18.873166 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 23:08:16.553122 => 23:08:18.870609
[0m23:08:18.880130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6151692-e3e4-49ac-87d5-fd7ce2f0360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f934a270>]}
[0m23:08:18.885520 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.36s]
[0m23:08:18.891504 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:08:18.896153 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:08:18.900714 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m23:08:18.906118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m23:08:18.909515 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:08:18.922165 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m23:08:18.926789 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 23:08:18.911701 => 23:08:18.924935
[0m23:08:18.929221 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:08:18.944258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:19.394525 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m23:08:19.397119 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m23:08:19.635932 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:81e2be68-d777-4777-8b71-6b952497dcd4&page=queryresults
[0m23:08:21.510076 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 23:08:18.931215 => 23:08:21.509589
[0m23:08:21.512671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6151692-e3e4-49ac-87d5-fd7ce2f0360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f9349a00>]}
[0m23:08:21.515088 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.61s]
[0m23:08:21.517177 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:08:21.518275 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:08:21.519532 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m23:08:21.521243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m23:08:21.522730 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:08:21.550246 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m23:08:21.554833 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 23:08:21.523499 => 23:08:21.552921
[0m23:08:21.558096 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:08:21.568817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:22.010304 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m23:08:22.012066 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m23:08:22.222775 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8438f6c0-90c0-4eb9-9394-c9e4413e448f&page=queryresults
[0m23:08:23.817895 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 23:08:21.559410 => 23:08:23.816658
[0m23:08:23.820673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6151692-e3e4-49ac-87d5-fd7ce2f0360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f9312660>]}
[0m23:08:23.822354 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.30s]
[0m23:08:23.823994 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:08:23.825254 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:08:23.826587 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m23:08:23.828316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m23:08:23.829749 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:08:23.837547 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m23:08:23.839506 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 23:08:23.830485 => 23:08:23.838613
[0m23:08:23.840632 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:08:23.849320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:24.314701 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m23:08:24.316333 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m23:08:24.538654 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b5d1b1b4-db47-4559-94c5-5015c9c7cec8&page=queryresults
[0m23:08:26.116239 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 23:08:23.841828 => 23:08:26.114789
[0m23:08:26.120816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6151692-e3e4-49ac-87d5-fd7ce2f0360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f9312c00>]}
[0m23:08:26.124527 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.29s]
[0m23:08:26.128336 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:08:26.136736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:26.138699 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m23:08:26.140799 [info ] [MainThread]: 
[0m23:08:26.143516 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 18.97 seconds (18.97s).
[0m23:08:26.152286 [debug] [MainThread]: Command end result
[0m23:08:26.178749 [info ] [MainThread]: 
[0m23:08:26.183763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:08:26.190757 [info ] [MainThread]: 
[0m23:08:26.196415 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:08:26.202519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.653475, "process_user_time": 7.368087, "process_kernel_time": 0.301302, "process_mem_max_rss": "135104", "process_out_blocks": "2976", "process_in_blocks": "0"}
[0m23:08:26.205170 [debug] [MainThread]: Command `dbt run` succeeded at 23:08:26.204429 after 20.66 seconds
[0m23:08:26.209368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fb18fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f923adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fb359160>]}
[0m23:08:26.214997 [debug] [MainThread]: Flushing usage events
[0m23:16:03.170629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c21608f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c21912720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c21724bc0>]}


============================== 23:16:03.181457 | d97dd139-045f-45fc-a88b-9ebaff7ca7bb ==============================
[0m23:16:03.181457 [info ] [MainThread]: Running with dbt=1.7.10
[0m23:16:03.186085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:16:06.131337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd97dd139-045f-45fc-a88b-9ebaff7ca7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c20087560>]}
[0m23:16:06.903820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd97dd139-045f-45fc-a88b-9ebaff7ca7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1f84d0a0>]}
[0m23:16:06.909543 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m23:16:07.027025 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m23:16:07.344463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:16:07.351347 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m23:16:09.040757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd97dd139-045f-45fc-a88b-9ebaff7ca7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1f723c50>]}
[0m23:16:09.093952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd97dd139-045f-45fc-a88b-9ebaff7ca7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1f8c00e0>]}
[0m23:16:09.102695 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m23:16:09.108618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd97dd139-045f-45fc-a88b-9ebaff7ca7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c216089b0>]}
[0m23:16:09.124904 [info ] [MainThread]: 
[0m23:16:09.128532 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:16:09.142596 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m23:16:09.149021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:10.228209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m23:16:10.234653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:16:11.123666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd97dd139-045f-45fc-a88b-9ebaff7ca7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1f6bc680>]}
[0m23:16:11.130156 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:16:11.133056 [info ] [MainThread]: 
[0m23:16:11.157463 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:16:11.165800 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m23:16:11.186799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m23:16:11.192605 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:16:11.283311 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m23:16:11.292527 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 23:16:11.195764 => 23:16:11.288824
[0m23:16:11.298351 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:16:11.424040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:12.441475 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m23:16:12.448570 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m23:16:12.932457 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b5a0ea85-fc77-4d2f-b9f8-f6f2925cd3b7&page=queryresults
[0m23:16:13.214694 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: monthly_counts_and_avg.`Average for Month` at [43:8]; reason: invalidQuery, location: query, message: Function not found: monthly_counts_and_avg.`Average for Month` at [43:8]')
[0m23:16:13.966801 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:957f6fbc-487f-425d-9a8c-8ab4747f9b64&page=queryresults
[0m23:16:14.163997 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:957f6fbc-487f-425d-9a8c-8ab4747f9b64&page=queryresults
[0m23:16:14.181100 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 23:16:11.302815 => 23:16:14.177384
[0m23:16:14.229810 [debug] [Thread-1 (]: Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Function not found: monthly_counts_and_avg.`Average for Month` at [43:8]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m23:16:14.236266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd97dd139-045f-45fc-a88b-9ebaff7ca7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1f6bfc50>]}
[0m23:16:14.242960 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[31mERROR[0m in 3.05s]
[0m23:16:14.250925 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:16:14.256295 [debug] [Thread-1 (]: Began running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:16:14.261632 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [RUN]
[0m23:16:14.267797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.percentage_of_pick_ups_by_base_per_month)
[0m23:16:14.293699 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:16:14.342808 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m23:16:14.347177 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (compile): 23:16:14.311437 => 23:16:14.346236
[0m23:16:14.357206 [debug] [Thread-1 (]: Began executing node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:16:14.391973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:14.991746 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m23:16:14.998345 [debug] [Thread-1 (]: On model.uber_transformations.percentage_of_pick_ups_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`percentage_of_pick_ups_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m23:16:15.223413 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d6cf88f4-815f-4237-8d8e-14830e5050e7&page=queryresults
[0m23:16:19.261694 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (execute): 23:16:14.365191 => 23:16:19.260949
[0m23:16:19.264451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd97dd139-045f-45fc-a88b-9ebaff7ca7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1ed445c0>]}
[0m23:16:19.266401 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 5.00s]
[0m23:16:19.268800 [debug] [Thread-1 (]: Finished running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:16:19.270315 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:16:19.271835 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m23:16:19.275110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.percentage_of_pick_ups_by_base_per_month, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m23:16:19.277308 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:16:19.285061 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m23:16:19.288511 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 23:16:19.278683 => 23:16:19.286802
[0m23:16:19.290736 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:16:19.300922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:19.913486 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m23:16:19.917125 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m23:16:20.234239 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0b63614e-d8fb-413f-a619-05f95cf4588e&page=queryresults
[0m23:16:21.906165 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 23:16:19.292069 => 23:16:21.905509
[0m23:16:21.908426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd97dd139-045f-45fc-a88b-9ebaff7ca7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1cc4f290>]}
[0m23:16:21.910399 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.64s]
[0m23:16:21.913555 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:16:21.915234 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:16:21.916952 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m23:16:21.922185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m23:16:21.924827 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:16:21.933634 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m23:16:21.936127 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 23:16:21.926708 => 23:16:21.935099
[0m23:16:21.937604 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:16:21.949674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:22.540175 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m23:16:22.542054 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m23:16:22.851131 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1b3c2eca-5699-4266-b4d8-04587f914bef&page=queryresults
[0m23:16:24.802517 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 23:16:21.939249 => 23:16:24.801962
[0m23:16:24.804449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd97dd139-045f-45fc-a88b-9ebaff7ca7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1cc58bc0>]}
[0m23:16:24.805841 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.88s]
[0m23:16:24.807399 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:16:24.808478 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:16:24.809767 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m23:16:24.811499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m23:16:24.812945 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:16:24.842869 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m23:16:24.849401 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 23:16:24.813762 => 23:16:24.847361
[0m23:16:24.852476 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:16:24.867662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:25.332662 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m23:16:25.334093 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m23:16:25.559119 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:cc80e251-aaab-40db-a2a5-df98550a4a2b&page=queryresults
[0m23:16:27.431281 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 23:16:24.854679 => 23:16:27.429635
[0m23:16:27.434615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd97dd139-045f-45fc-a88b-9ebaff7ca7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1f9f0f20>]}
[0m23:16:27.437600 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.62s]
[0m23:16:27.444075 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:16:27.447642 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:16:27.452881 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m23:16:27.455118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m23:16:27.456969 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:16:27.471247 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m23:16:27.475360 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 23:16:27.463574 => 23:16:27.474156
[0m23:16:27.478716 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:16:27.496415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:27.965777 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m23:16:27.967771 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m23:16:28.165360 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d29f11f1-d176-430b-80da-5ad29b13d90c&page=queryresults
[0m23:16:30.024580 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 23:16:27.480054 => 23:16:30.023017
[0m23:16:30.027893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd97dd139-045f-45fc-a88b-9ebaff7ca7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1cc9ac30>]}
[0m23:16:30.029545 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.57s]
[0m23:16:30.031477 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:16:30.035157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:16:30.036895 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m23:16:30.039036 [info ] [MainThread]: 
[0m23:16:30.041072 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 20.91 seconds (20.91s).
[0m23:16:30.052275 [debug] [MainThread]: Command end result
[0m23:16:30.079775 [info ] [MainThread]: 
[0m23:16:30.081113 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:16:30.082597 [info ] [MainThread]: 
[0m23:16:30.084484 [error] [MainThread]:   Database Error in model monthly_pick_up_count_vs_average_per_base_name (models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql)
  Function not found: monthly_counts_and_avg.`Average for Month` at [43:8]
  compiled Code at target/run/uber_transformations/models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m23:16:30.087179 [info ] [MainThread]: 
[0m23:16:30.089395 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m23:16:30.092949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 27.134937, "process_user_time": 15.636536, "process_kernel_time": 0.803711, "process_mem_max_rss": "134552", "process_out_blocks": "2976", "command_success": false, "process_in_blocks": "0"}
[0m23:16:30.095448 [debug] [MainThread]: Command `dbt run` failed at 23:16:30.094717 after 27.14 seconds
[0m23:16:30.097595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c257c7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1f9536e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1f650b90>]}
[0m23:16:30.103047 [debug] [MainThread]: Flushing usage events
[0m23:20:40.566770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7964c61730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7964c62630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7964c614f0>]}


============================== 23:20:40.571742 | 993d67b2-9dce-4e60-8b14-53ead6c108e8 ==============================
[0m23:20:40.571742 [info ] [MainThread]: Running with dbt=1.7.10
[0m23:20:40.573235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:20:41.442270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '993d67b2-9dce-4e60-8b14-53ead6c108e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7963086750>]}
[0m23:20:41.614946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '993d67b2-9dce-4e60-8b14-53ead6c108e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7965de3c80>]}
[0m23:20:41.616404 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m23:20:41.631904 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m23:20:41.705285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:20:41.706619 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/monthly_pick_up_count_vs_average_per_base_name.sql
[0m23:20:42.052567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '993d67b2-9dce-4e60-8b14-53ead6c108e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f796336d3a0>]}
[0m23:20:42.067326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '993d67b2-9dce-4e60-8b14-53ead6c108e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7962fc0110>]}
[0m23:20:42.068419 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m23:20:42.069516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '993d67b2-9dce-4e60-8b14-53ead6c108e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7964c63710>]}
[0m23:20:42.072862 [info ] [MainThread]: 
[0m23:20:42.075344 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:20:42.079190 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m23:20:42.080414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:42.566384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m23:20:42.567561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:43.035768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '993d67b2-9dce-4e60-8b14-53ead6c108e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7962d9dd90>]}
[0m23:20:43.039804 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:20:43.042958 [info ] [MainThread]: 
[0m23:20:43.060861 [debug] [Thread-1 (]: Began running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:20:43.063586 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [RUN]
[0m23:20:43.067128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name)
[0m23:20:43.069443 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:20:43.128598 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m23:20:43.132645 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (compile): 23:20:43.070915 => 23:20:43.130657
[0m23:20:43.135146 [debug] [Thread-1 (]: Began executing node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:20:43.185424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:43.678343 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"
[0m23:20:43.681504 [debug] [Thread-1 (]: On model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`monthly_pick_up_count_vs_average_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m23:20:43.918012 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e9e3868c-a157-4eb9-bdaa-cff2ae6d5a95&page=queryresults
[0m23:20:46.103220 [debug] [Thread-1 (]: Timing info for model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name (execute): 23:20:43.137398 => 23:20:46.102605
[0m23:20:46.106513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993d67b2-9dce-4e60-8b14-53ead6c108e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7962e72540>]}
[0m23:20:46.108535 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.monthly_pick_up_count_vs_average_per_base_name  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.04s]
[0m23:20:46.110958 [debug] [Thread-1 (]: Finished running node model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name
[0m23:20:46.112683 [debug] [Thread-1 (]: Began running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:20:46.114640 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [RUN]
[0m23:20:46.117546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.monthly_pick_up_count_vs_average_per_base_name, now model.uber_transformations.percentage_of_pick_ups_by_base_per_month)
[0m23:20:46.119196 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:20:46.126149 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m23:20:46.129286 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (compile): 23:20:46.120530 => 23:20:46.127934
[0m23:20:46.131124 [debug] [Thread-1 (]: Began executing node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:20:46.140078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:46.598746 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"
[0m23:20:46.600272 [debug] [Thread-1 (]: On model.uber_transformations.percentage_of_pick_ups_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.percentage_of_pick_ups_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`percentage_of_pick_ups_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m23:20:46.804229 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:51bfb323-c46c-4b76-943e-64678e471603&page=queryresults
[0m23:20:51.820801 [debug] [Thread-1 (]: Timing info for model.uber_transformations.percentage_of_pick_ups_by_base_per_month (execute): 23:20:46.132123 => 23:20:51.819859
[0m23:20:51.824673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993d67b2-9dce-4e60-8b14-53ead6c108e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7962637fe0>]}
[0m23:20:51.827099 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.percentage_of_pick_ups_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 5.71s]
[0m23:20:51.830962 [debug] [Thread-1 (]: Finished running node model.uber_transformations.percentage_of_pick_ups_by_base_per_month
[0m23:20:51.835766 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:20:51.838714 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [RUN]
[0m23:20:51.843173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.percentage_of_pick_ups_by_base_per_month, now model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups)
[0m23:20:51.846514 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:20:51.854943 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m23:20:51.858208 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (compile): 23:20:51.848277 => 23:20:51.856923
[0m23:20:51.859950 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:20:51.867574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:52.443098 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"
[0m23:20:52.446287 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_based_on_total_number_of_pick_ups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m23:20:52.671415 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0feac378-b661-44df-bf99-ea8bb4a27604&page=queryresults
[0m23:20:54.299128 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups (execute): 23:20:51.860682 => 23:20:54.296611
[0m23:20:54.305604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993d67b2-9dce-4e60-8b14-53ead6c108e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7962e71d90>]}
[0m23:20:54.308533 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_based_on_total_number_of_pick_ups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.46s]
[0m23:20:54.313492 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups
[0m23:20:54.317579 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:20:54.330475 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [RUN]
[0m23:20:54.341334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_based_on_total_number_of_pick_ups, now model.uber_transformations.top_3_most_common_pick_ups_per_base_name)
[0m23:20:54.343641 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:20:54.355610 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m23:20:54.359317 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (compile): 23:20:54.345225 => 23:20:54.358022
[0m23:20:54.360943 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:20:54.375059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:54.943172 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"
[0m23:20:54.947661 [debug] [Thread-1 (]: On model.uber_transformations.top_3_most_common_pick_ups_per_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_most_common_pick_ups_per_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_most_common_pick_ups_per_base_name`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m23:20:55.167915 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c245c886-2ad7-47dc-bcf1-8d408502de06&page=queryresults
[0m23:20:57.049824 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_most_common_pick_ups_per_base_name (execute): 23:20:54.362271 => 23:20:57.049120
[0m23:20:57.052196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993d67b2-9dce-4e60-8b14-53ead6c108e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7962e71d90>]}
[0m23:20:57.055004 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_most_common_pick_ups_per_base_name  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.71s]
[0m23:20:57.058384 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_most_common_pick_ups_per_base_name
[0m23:20:57.060750 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:20:57.063505 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [RUN]
[0m23:20:57.067004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_most_common_pick_ups_per_base_name, now model.uber_transformations.total_number_of_pickups_in_may_by_base_name)
[0m23:20:57.069195 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:20:57.136942 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m23:20:57.141974 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (compile): 23:20:57.070596 => 23:20:57.140345
[0m23:20:57.144136 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:20:57.162461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:57.620430 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"
[0m23:20:57.622306 [debug] [Thread-1 (]: On model.uber_transformations.total_number_of_pickups_in_may_by_base_name: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_number_of_pickups_in_may_by_base_name"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_number_of_pickups_in_may_by_base_name`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m23:20:57.831425 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d881aa76-9203-4d83-bd35-a6af4136cb16&page=queryresults
[0m23:20:59.439112 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_number_of_pickups_in_may_by_base_name (execute): 23:20:57.145530 => 23:20:59.438567
[0m23:20:59.441111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993d67b2-9dce-4e60-8b14-53ead6c108e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7962689a60>]}
[0m23:20:59.442692 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_number_of_pickups_in_may_by_base_name  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.38s]
[0m23:20:59.444706 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_number_of_pickups_in_may_by_base_name
[0m23:20:59.446025 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:20:59.447421 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m23:20:59.449758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_number_of_pickups_in_may_by_base_name, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m23:20:59.452973 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:20:59.467883 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m23:20:59.470506 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 23:20:59.454981 => 23:20:59.469463
[0m23:20:59.472506 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:20:59.481436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:59.886954 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m23:20:59.888706 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m23:21:00.113976 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4f08644d-6831-4888-a565-c7d189105d5a&page=queryresults
[0m23:21:01.664947 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 23:20:59.473859 => 23:21:01.664401
[0m23:21:01.666857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993d67b2-9dce-4e60-8b14-53ead6c108e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f796268a4b0>]}
[0m23:21:01.668178 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.22s]
[0m23:21:01.669812 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m23:21:01.673165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:01.674050 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m23:21:01.675348 [info ] [MainThread]: 
[0m23:21:01.676628 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 19.60 seconds (19.60s).
[0m23:21:01.680378 [debug] [MainThread]: Command end result
[0m23:21:01.698682 [info ] [MainThread]: 
[0m23:21:01.701466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:21:01.705583 [info ] [MainThread]: 
[0m23:21:01.709489 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:21:01.713923 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.224045, "process_user_time": 7.225866, "process_kernel_time": 0.281654, "process_mem_max_rss": "135760", "process_out_blocks": "2968", "process_in_blocks": "0"}
[0m23:21:01.716569 [debug] [MainThread]: Command `dbt run` succeeded at 23:21:01.715792 after 21.23 seconds
[0m23:21:01.719463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79687e1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f796301fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79631a2f60>]}
[0m23:21:01.723298 [debug] [MainThread]: Flushing usage events
[0m14:51:34.660516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed356c8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3592f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed356cbbc0>]}


============================== 14:51:34.700190 | 0692a98f-8662-43bb-9eff-904151c1fa4a ==============================
[0m14:51:34.700190 [info ] [MainThread]: Running with dbt=1.7.10
[0m14:51:34.701753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:36.941553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0692a98f-8662-43bb-9eff-904151c1fa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed33c202f0>]}
[0m14:51:37.118695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0692a98f-8662-43bb-9eff-904151c1fa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3393e9f0>]}
[0m14:51:37.120970 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m14:51:37.148830 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m14:51:37.196724 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:51:37.198815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0692a98f-8662-43bb-9eff-904151c1fa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3393dfa0>]}
[0m14:51:39.101907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0692a98f-8662-43bb-9eff-904151c1fa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed337c1f70>]}
[0m14:51:39.131285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0692a98f-8662-43bb-9eff-904151c1fa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed337e08c0>]}
[0m14:51:39.132415 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m14:51:39.133519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0692a98f-8662-43bb-9eff-904151c1fa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed339148c0>]}
[0m14:51:39.136716 [info ] [MainThread]: 
[0m14:51:39.138570 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:51:39.142169 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m14:51:39.143294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:39.669114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m14:51:39.670231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:40.153632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0692a98f-8662-43bb-9eff-904151c1fa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed337e0d70>]}
[0m14:51:40.155662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:40.156935 [info ] [MainThread]: 
[0m14:51:40.197512 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m14:51:40.200188 [info ] [Thread-1 (]: 1 of 5 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m14:51:40.204208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m14:51:40.206300 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m14:51:40.224478 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m14:51:40.226195 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 14:51:40.207971 => 14:51:40.225482
[0m14:51:40.227844 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m14:51:40.319559 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m14:51:40.321111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:40.324110 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m14:51:41.604739 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:585e76cf-2cd7-43b1-9cb5-9fae0493fd5c&page=queryresults
[0m14:51:43.870797 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 14:51:40.228647 => 14:51:43.870293
[0m14:51:43.873157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0692a98f-8662-43bb-9eff-904151c1fa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed337536b0>]}
[0m14:51:43.875318 [info ] [Thread-1 (]: 1 of 5 OK created sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.67s]
[0m14:51:43.877735 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m14:51:43.879496 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m14:51:43.881216 [info ] [Thread-1 (]: 2 of 5 START sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [RUN]
[0m14:51:43.884740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_count_vs_average_per_base, now model.uber_transformations.pickup_percentile_by_base_per_month)
[0m14:51:43.886560 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_percentile_by_base_per_month
[0m14:51:43.892605 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m14:51:43.894885 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (compile): 14:51:43.887563 => 14:51:43.893921
[0m14:51:43.896155 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_percentile_by_base_per_month
[0m14:51:43.910759 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m14:51:43.913282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:43.921783 [debug] [Thread-1 (]: On model.uber_transformations.pickup_percentile_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_percentile_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m14:51:45.097616 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f0be956e-38f4-4f0d-8e39-d32e2ba2231e&page=queryresults
[0m14:51:49.844065 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (execute): 14:51:43.897055 => 14:51:49.843589
[0m14:51:49.845772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0692a98f-8662-43bb-9eff-904151c1fa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed337cdac0>]}
[0m14:51:49.847150 [info ] [Thread-1 (]: 2 of 5 OK created sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 5.96s]
[0m14:51:49.848851 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m14:51:49.850533 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m14:51:49.853339 [info ] [Thread-1 (]: 3 of 5 START sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [RUN]
[0m14:51:49.858834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_percentile_by_base_per_month, now model.uber_transformations.top_3_base_names_by_total_pickups)
[0m14:51:49.860736 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_by_total_pickups
[0m14:51:49.864931 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m14:51:49.866874 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (compile): 14:51:49.861738 => 14:51:49.866033
[0m14:51:49.867898 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_by_total_pickups
[0m14:51:49.877954 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m14:51:49.880530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:49.886657 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_by_total_pickups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_by_total_pickups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m14:51:50.705893 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c1ecb6eb-4827-4ed2-b91a-16e2d80c52e2&page=queryresults
[0m14:51:52.416699 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (execute): 14:51:49.868501 => 14:51:52.416200
[0m14:51:52.418682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0692a98f-8662-43bb-9eff-904151c1fa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed32e7e8a0>]}
[0m14:51:52.420070 [info ] [Thread-1 (]: 3 of 5 OK created sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.56s]
[0m14:51:52.421634 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m14:51:52.422731 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_pickup_dates_per_base
[0m14:51:52.423978 [info ] [Thread-1 (]: 4 of 5 START sql table model airbyte_uber_data.top_3_pickup_dates_per_base ..... [RUN]
[0m14:51:52.426700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_by_total_pickups, now model.uber_transformations.top_3_pickup_dates_per_base)
[0m14:51:52.428064 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_pickup_dates_per_base
[0m14:51:52.436393 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m14:51:52.438170 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (compile): 14:51:52.428738 => 14:51:52.437418
[0m14:51:52.439175 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_pickup_dates_per_base
[0m14:51:52.459545 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m14:51:52.461704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:52.469763 [debug] [Thread-1 (]: On model.uber_transformations.top_3_pickup_dates_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_pickup_dates_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m14:51:53.625698 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:239189ac-2459-4df5-92af-64d420073bc5&page=queryresults
[0m14:51:55.854615 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (execute): 14:51:52.439875 => 14:51:55.854136
[0m14:51:55.857715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0692a98f-8662-43bb-9eff-904151c1fa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed32e9cb60>]}
[0m14:51:55.860707 [info ] [Thread-1 (]: 4 of 5 OK created sql table model airbyte_uber_data.top_3_pickup_dates_per_base  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 3.43s]
[0m14:51:55.864118 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_pickup_dates_per_base
[0m14:51:55.866729 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_pickups_in_may_by_base
[0m14:51:55.870220 [info ] [Thread-1 (]: 5 of 5 START sql table model airbyte_uber_data.total_pickups_in_may_by_base .... [RUN]
[0m14:51:55.875196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_pickup_dates_per_base, now model.uber_transformations.total_pickups_in_may_by_base)
[0m14:51:55.877699 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_pickups_in_may_by_base
[0m14:51:55.887955 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m14:51:55.891792 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (compile): 14:51:55.880237 => 14:51:55.890056
[0m14:51:55.894186 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_pickups_in_may_by_base
[0m14:51:55.914543 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m14:51:55.918080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:55.927846 [debug] [Thread-1 (]: On model.uber_transformations.total_pickups_in_may_by_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_pickups_in_may_by_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m14:51:56.844780 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:feafee08-16cb-4be6-8d4c-eee84136d762&page=queryresults
[0m14:51:58.747813 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (execute): 14:51:55.895727 => 14:51:58.746707
[0m14:51:58.751958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0692a98f-8662-43bb-9eff-904151c1fa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed32eb7980>]}
[0m14:51:58.754906 [info ] [Thread-1 (]: 5 of 5 OK created sql table model airbyte_uber_data.total_pickups_in_may_by_base  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.88s]
[0m14:51:58.758293 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_pickups_in_may_by_base
[0m14:51:58.765033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:58.766775 [debug] [MainThread]: Connection 'model.uber_transformations.total_pickups_in_may_by_base' was properly closed.
[0m14:51:58.768544 [info ] [MainThread]: 
[0m14:51:58.770414 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 19.63 seconds (19.63s).
[0m14:51:58.775928 [debug] [MainThread]: Command end result
[0m14:51:58.842944 [info ] [MainThread]: 
[0m14:51:58.847070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:58.852488 [info ] [MainThread]: 
[0m14:51:58.860193 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:51:58.866986 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.292053, "process_user_time": 8.017898, "process_kernel_time": 0.359138, "process_mem_max_rss": "133940", "process_in_blocks": "29592", "process_out_blocks": "2928"}
[0m14:51:58.869462 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:58.868750 after 24.29 seconds
[0m14:51:58.876842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed35a2d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed337ea060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed32ecfd70>]}
[0m14:51:58.879447 [debug] [MainThread]: Flushing usage events
[0m14:59:18.283484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab084c4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab08927200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab084c7c20>]}


============================== 14:59:18.289008 | a2e23b42-4899-4fbb-aa58-ae68df8ff3f2 ==============================
[0m14:59:18.289008 [info ] [MainThread]: Running with dbt=1.7.10
[0m14:59:18.290496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:59:19.843767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2e23b42-4899-4fbb-aa58-ae68df8ff3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab083e87a0>]}
[0m14:59:20.333731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2e23b42-4899-4fbb-aa58-ae68df8ff3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab06dbf860>]}
[0m14:59:20.335555 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m14:59:20.357868 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m14:59:20.539590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:59:20.542162 [debug] [MainThread]: Partial parsing: added file: uber_transformations://models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m14:59:21.209935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2e23b42-4899-4fbb-aa58-ae68df8ff3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab066236e0>]}
[0m14:59:21.224489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2e23b42-4899-4fbb-aa58-ae68df8ff3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab067c80e0>]}
[0m14:59:21.225588 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m14:59:21.226648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2e23b42-4899-4fbb-aa58-ae68df8ff3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab067c8bf0>]}
[0m14:59:21.229891 [info ] [MainThread]: 
[0m14:59:21.231745 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:59:21.235560 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m14:59:21.236762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:22.342685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m14:59:22.343907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:22.925278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2e23b42-4899-4fbb-aa58-ae68df8ff3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab067ca540>]}
[0m14:59:22.927063 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:59:22.928107 [info ] [MainThread]: 
[0m14:59:22.932849 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m14:59:22.934914 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m14:59:22.938055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m14:59:22.939965 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m14:59:22.984175 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m14:59:22.988162 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 14:59:22.941101 => 14:59:22.986877
[0m14:59:22.991691 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m14:59:23.081676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:23.629272 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m14:59:23.630893 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m14:59:24.465801 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d3ea9896-2595-4a3c-add3-d4c487a080bf&page=queryresults
[0m14:59:26.429991 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 14:59:22.994365 => 14:59:26.429464
[0m14:59:26.431958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e23b42-4899-4fbb-aa58-ae68df8ff3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0667e870>]}
[0m14:59:26.433367 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.50s]
[0m14:59:26.434987 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m14:59:26.436096 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m14:59:26.437413 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [RUN]
[0m14:59:26.439126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_count_vs_average_per_base, now model.uber_transformations.pickup_percentile_by_base_per_month)
[0m14:59:26.440779 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_percentile_by_base_per_month
[0m14:59:26.448228 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m14:59:26.450997 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (compile): 14:59:26.442173 => 14:59:26.449857
[0m14:59:26.453076 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_percentile_by_base_per_month
[0m14:59:26.461946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:27.441247 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m14:59:27.447448 [debug] [Thread-1 (]: On model.uber_transformations.pickup_percentile_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_percentile_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m14:59:27.909095 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:9a1220d0-3e46-4524-bab5-a4fc2a0ef30a&page=queryresults
[0m14:59:32.260638 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (execute): 14:59:26.454442 => 14:59:32.260144
[0m14:59:32.263595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e23b42-4899-4fbb-aa58-ae68df8ff3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0667d5b0>]}
[0m14:59:32.266514 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 5.82s]
[0m14:59:32.270093 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m14:59:32.272520 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m14:59:32.276263 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [RUN]
[0m14:59:32.280796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_percentile_by_base_per_month, now model.uber_transformations.top_3_base_names_by_total_pickups)
[0m14:59:32.283085 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_by_total_pickups
[0m14:59:32.293376 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m14:59:32.299520 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (compile): 14:59:32.284788 => 14:59:32.297018
[0m14:59:32.303527 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_by_total_pickups
[0m14:59:32.319230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:32.794644 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m14:59:32.796396 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_by_total_pickups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_by_total_pickups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m14:59:33.245315 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:bd06b124-8132-4469-b775-7c19e7f74218&page=queryresults
[0m14:59:35.142053 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (execute): 14:59:32.306275 => 14:59:35.140932
[0m14:59:35.146397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e23b42-4899-4fbb-aa58-ae68df8ff3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0667e600>]}
[0m14:59:35.149528 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.87s]
[0m14:59:35.153005 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m14:59:35.155607 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_pickup_dates_per_base
[0m14:59:35.159428 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_pickup_dates_per_base ..... [RUN]
[0m14:59:35.162159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_by_total_pickups, now model.uber_transformations.top_3_pickup_dates_per_base)
[0m14:59:35.163384 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_pickup_dates_per_base
[0m14:59:35.168464 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m14:59:35.170039 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (compile): 14:59:35.164384 => 14:59:35.169406
[0m14:59:35.171130 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_pickup_dates_per_base
[0m14:59:35.180785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:35.635580 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m14:59:35.637326 [debug] [Thread-1 (]: On model.uber_transformations.top_3_pickup_dates_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_pickup_dates_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m14:59:35.862942 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:cbc65d76-22ac-4b9e-9247-0e409c95def8&page=queryresults
[0m14:59:37.747846 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (execute): 14:59:35.171842 => 14:59:37.746661
[0m14:59:37.751781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e23b42-4899-4fbb-aa58-ae68df8ff3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab05cd6d20>]}
[0m14:59:37.754742 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_pickup_dates_per_base  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.59s]
[0m14:59:37.758339 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_pickup_dates_per_base
[0m14:59:37.760828 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_pickups_in_may_by_base
[0m14:59:37.764455 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_pickups_in_may_by_base .... [RUN]
[0m14:59:37.769712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_pickup_dates_per_base, now model.uber_transformations.total_pickups_in_may_by_base)
[0m14:59:37.772383 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_pickups_in_may_by_base
[0m14:59:37.843986 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m14:59:37.849689 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (compile): 14:59:37.775039 => 14:59:37.848410
[0m14:59:37.853903 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_pickups_in_may_by_base
[0m14:59:37.873489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:38.328032 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m14:59:38.330815 [debug] [Thread-1 (]: On model.uber_transformations.total_pickups_in_may_by_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_pickups_in_may_by_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m14:59:38.561964 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:634a30f7-df07-4ee4-be80-148c9fb24d55&page=queryresults
[0m14:59:40.459189 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (execute): 14:59:37.855405 => 14:59:40.458095
[0m14:59:40.463091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e23b42-4899-4fbb-aa58-ae68df8ff3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab05c68bf0>]}
[0m14:59:40.466117 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_pickups_in_may_by_base  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.70s]
[0m14:59:40.469858 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_pickups_in_may_by_base
[0m14:59:40.472533 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m14:59:40.477931 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m14:59:40.484949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_pickups_in_may_by_base, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m14:59:40.489578 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m14:59:40.506751 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m14:59:40.513244 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 14:59:40.492099 => 14:59:40.508859
[0m14:59:40.519558 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m14:59:40.556917 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m14:59:40.559035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:40.562600 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m14:59:41.200593 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:11d9ba9e-5b29-4eb2-9c67-b771e84db37f&page=queryresults
[0m14:59:43.211137 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 14:59:40.523312 => 14:59:43.204886
[0m14:59:43.222678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e23b42-4899-4fbb-aa58-ae68df8ff3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab05c6be60>]}
[0m14:59:43.236346 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.74s]
[0m14:59:43.251489 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m14:59:43.273117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:43.278799 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m14:59:43.287198 [info ] [MainThread]: 
[0m14:59:43.293953 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 22.05 seconds (22.05s).
[0m14:59:43.316228 [debug] [MainThread]: Command end result
[0m14:59:43.382127 [info ] [MainThread]: 
[0m14:59:43.384655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:59:43.387107 [info ] [MainThread]: 
[0m14:59:43.389177 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:59:43.417875 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.210852, "process_user_time": 9.642845, "process_kernel_time": 0.523616, "process_mem_max_rss": "135456", "process_out_blocks": "2968", "process_in_blocks": "0"}
[0m14:59:43.425635 [debug] [MainThread]: Command `dbt run` succeeded at 14:59:43.423784 after 25.22 seconds
[0m14:59:43.435228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0884a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab068970e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab084f0fb0>]}
[0m14:59:43.441951 [debug] [MainThread]: Flushing usage events
[0m21:45:17.416098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd73b4ae030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd73b967530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd73c3a88f0>]}


============================== 21:45:17.479966 | a6ca4d60-6164-4d77-948d-1e28b7cf0d11 ==============================
[0m21:45:17.479966 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:45:17.481493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:45:20.460523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6ca4d60-6164-4d77-948d-1e28b7cf0d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72c5e7f20>]}
[0m21:45:20.757075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6ca4d60-6164-4d77-948d-1e28b7cf0d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72c5e7350>]}
[0m21:45:20.759333 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m21:45:20.796080 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:45:20.927993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m21:45:20.929240 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m21:45:20.930286 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/pickup_count_vs_average_per_base.sql
[0m21:45:20.931356 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_base_names_by_total_pickups.sql
[0m21:45:20.933004 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/pickup_percentile_by_base_per_month.sql
[0m21:45:20.934580 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/total_pickups_in_may_by_base.sql
[0m21:45:20.935669 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_pickup_dates_per_base.sql
[0m21:45:21.337512 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/unter_grun_pickups_in_bronx.sql
[0m21:45:21.375518 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/pickup_count_vs_average_per_base.sql
[0m21:45:21.382010 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/top_3_base_names_by_total_pickups.sql
[0m21:45:21.388596 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/pickup_percentile_by_base_per_month.sql
[0m21:45:21.395052 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/total_pickups_in_may_by_base.sql
[0m21:45:21.401609 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/top_3_pickup_dates_per_base.sql
[0m21:45:21.406903 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.uber_transformations.unter_grun_pickups_in_bronx' (models/udp_transf/unter_grun_pickups_in_bronx.sql) depends on a source named 'airbyte_uber_data.base_num_and_name' which was not found
[0m21:45:21.425262 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 4.178683, "process_user_time": 6.373499, "process_kernel_time": 0.70345, "process_mem_max_rss": "183160", "process_in_blocks": "45880", "process_out_blocks": "16", "command_success": false}
[0m21:45:21.427421 [debug] [MainThread]: Command `dbt build` failed at 21:45:21.426893 after 4.18 seconds
[0m21:45:21.429684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd73b6f7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72c297560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72c9f4860>]}
[0m21:45:21.432256 [debug] [MainThread]: Flushing usage events
[0m21:49:20.968750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66bca43f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66baaa1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66bb88c470>]}


============================== 21:49:20.973826 | 88e18917-2968-4745-93c1-cd92d69855d2 ==============================
[0m21:49:20.973826 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:49:20.975276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:49:22.543648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88e18917-2968-4745-93c1-cd92d69855d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ab949850>]}
[0m21:49:22.847339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88e18917-2968-4745-93c1-cd92d69855d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ae0f00b0>]}
[0m21:49:22.848817 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m21:49:22.865551 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:49:22.945889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:49:22.947349 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:49:22.961798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88e18917-2968-4745-93c1-cd92d69855d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66b5d531d0>]}
[0m21:49:23.001172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88e18917-2968-4745-93c1-cd92d69855d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ab94bf20>]}
[0m21:49:23.002355 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m21:49:23.005910 [info ] [MainThread]: 
[0m21:49:23.007876 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:49:23.013228 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m21:49:23.014663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:23.729317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m21:49:23.730330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:49:24.313369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88e18917-2968-4745-93c1-cd92d69855d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ab810650>]}
[0m21:49:24.315595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:49:24.316738 [info ] [MainThread]: 
[0m21:49:24.363159 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m21:49:24.370174 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m21:49:24.373775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m21:49:24.376951 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m21:49:24.405943 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m21:49:24.428808 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 21:49:24.378466 => 21:49:24.426405
[0m21:49:24.433683 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m21:49:24.477685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:25.051689 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m21:49:25.054574 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m21:49:25.921555 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c158ae95-3672-43c7-93ff-5ac2fd9cb6bb&page=queryresults
[0m21:49:28.192300 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 21:49:24.435725 => 21:49:28.191781
[0m21:49:28.194157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88e18917-2968-4745-93c1-cd92d69855d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ab7975c0>]}
[0m21:49:28.195573 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.82s]
[0m21:49:28.197282 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m21:49:28.198457 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m21:49:28.199766 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [RUN]
[0m21:49:28.201994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_count_vs_average_per_base, now model.uber_transformations.pickup_percentile_by_base_per_month)
[0m21:49:28.204057 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_percentile_by_base_per_month
[0m21:49:28.208823 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m21:49:28.210672 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (compile): 21:49:28.204869 => 21:49:28.209983
[0m21:49:28.212336 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_percentile_by_base_per_month
[0m21:49:28.218683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:28.716815 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m21:49:28.718448 [debug] [Thread-1 (]: On model.uber_transformations.pickup_percentile_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_percentile_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m21:49:28.936695 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:128b62b5-0b6d-4624-8b69-1c6dbb01ad92&page=queryresults
[0m21:49:32.917934 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (execute): 21:49:28.213146 => 21:49:32.916661
[0m21:49:32.922211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88e18917-2968-4745-93c1-cd92d69855d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ab73bc20>]}
[0m21:49:32.925307 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 4.72s]
[0m21:49:32.929469 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m21:49:32.932128 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m21:49:32.936327 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [RUN]
[0m21:49:32.941186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_percentile_by_base_per_month, now model.uber_transformations.top_3_base_names_by_total_pickups)
[0m21:49:32.944543 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_by_total_pickups
[0m21:49:32.951283 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m21:49:32.953308 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (compile): 21:49:32.947301 => 21:49:32.952537
[0m21:49:32.954324 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_by_total_pickups
[0m21:49:32.961636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:33.480697 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m21:49:33.482728 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_by_total_pickups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_by_total_pickups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m21:49:33.746334 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:83d8e353-81c5-4720-8f35-47f47e7a6830&page=queryresults
[0m21:49:35.665973 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (execute): 21:49:32.955019 => 21:49:35.665112
[0m21:49:35.668509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88e18917-2968-4745-93c1-cd92d69855d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ab73aba0>]}
[0m21:49:35.670248 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.73s]
[0m21:49:35.672404 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m21:49:35.673780 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_pickup_dates_per_base
[0m21:49:35.675790 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_pickup_dates_per_base ..... [RUN]
[0m21:49:35.678858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_by_total_pickups, now model.uber_transformations.top_3_pickup_dates_per_base)
[0m21:49:35.680585 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_pickup_dates_per_base
[0m21:49:35.685740 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m21:49:35.688164 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (compile): 21:49:35.681639 => 21:49:35.687038
[0m21:49:35.689513 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_pickup_dates_per_base
[0m21:49:35.694767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:36.256274 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m21:49:36.258352 [debug] [Thread-1 (]: On model.uber_transformations.top_3_pickup_dates_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_pickup_dates_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m21:49:36.494626 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:57d98446-17c6-4f2e-9e9f-30b038303bd1&page=queryresults
[0m21:49:38.730054 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (execute): 21:49:35.690263 => 21:49:38.728754
[0m21:49:38.743919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88e18917-2968-4745-93c1-cd92d69855d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a9445ac0>]}
[0m21:49:38.752322 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_pickup_dates_per_base  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 3.06s]
[0m21:49:38.760188 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_pickup_dates_per_base
[0m21:49:38.764736 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_pickups_in_may_by_base
[0m21:49:38.770402 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_pickups_in_may_by_base .... [RUN]
[0m21:49:38.789910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_pickup_dates_per_base, now model.uber_transformations.total_pickups_in_may_by_base)
[0m21:49:38.793105 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_pickups_in_may_by_base
[0m21:49:38.885116 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m21:49:38.889775 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (compile): 21:49:38.795496 => 21:49:38.888274
[0m21:49:38.901562 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_pickups_in_may_by_base
[0m21:49:38.916491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:39.660793 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m21:49:39.670666 [debug] [Thread-1 (]: On model.uber_transformations.total_pickups_in_may_by_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_pickups_in_may_by_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m21:49:39.869985 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:99113267-6798-40f5-958f-f23e938bdce3&page=queryresults
[0m21:49:41.500084 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (execute): 21:49:38.906462 => 21:49:41.499499
[0m21:49:41.502374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88e18917-2968-4745-93c1-cd92d69855d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ab9a5640>]}
[0m21:49:41.504090 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_pickups_in_may_by_base  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.71s]
[0m21:49:41.505826 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_pickups_in_may_by_base
[0m21:49:41.506990 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:49:41.508298 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m21:49:41.510226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_pickups_in_may_by_base, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m21:49:41.512506 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:49:41.519877 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:49:41.523062 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 21:49:41.514000 => 21:49:41.521677
[0m21:49:41.526059 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:49:41.534832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:42.077335 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:49:42.078885 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m21:49:42.311760 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7f4d3093-ff8d-4070-a569-777613e9f94d&page=queryresults
[0m21:49:43.993902 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 21:49:41.527270 => 21:49:43.993413
[0m21:49:43.995639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88e18917-2968-4745-93c1-cd92d69855d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ab694cb0>]}
[0m21:49:43.996927 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.49s]
[0m21:49:43.998494 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:49:44.001766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:44.002642 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m21:49:44.003847 [info ] [MainThread]: 
[0m21:49:44.005378 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 21.00 seconds (21.00s).
[0m21:49:44.009046 [debug] [MainThread]: Command end result
[0m21:49:44.033314 [info ] [MainThread]: 
[0m21:49:44.035481 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:49:44.037232 [info ] [MainThread]: 
[0m21:49:44.039653 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:49:44.045870 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 23.193798, "process_user_time": 8.350082, "process_kernel_time": 0.734643, "process_mem_max_rss": "192848", "process_in_blocks": "1496", "process_out_blocks": "2040"}
[0m21:49:44.051817 [debug] [MainThread]: Command `dbt build` succeeded at 21:49:44.050855 after 23.20 seconds
[0m21:49:44.055117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66bb4eddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ab6dffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ac0b61b0>]}
[0m21:49:44.058779 [debug] [MainThread]: Flushing usage events
[0m21:58:54.733741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb436d48110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb437556a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb436e08bc0>]}


============================== 21:58:54.739147 | afe44265-f265-4f04-834c-51f1e6aa3a63 ==============================
[0m21:58:54.739147 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:58:54.740627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:58:56.333428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afe44265-f265-4f04-834c-51f1e6aa3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb427f8f3b0>]}
[0m21:58:56.628706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afe44265-f265-4f04-834c-51f1e6aa3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4282de1e0>]}
[0m21:58:56.630272 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m21:58:56.647266 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:58:56.729793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 6 files changed.
[0m21:58:56.731040 [debug] [MainThread]: Partial parsing: added file: uber_transformations://models/udp_transf/source.yml
[0m21:58:56.732221 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_base_names_by_total_pickups.sql
[0m21:58:56.733722 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/total_pickups_in_may_by_base.sql
[0m21:58:56.734892 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/pickup_percentile_by_base_per_month.sql
[0m21:58:56.736024 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m21:58:56.737087 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_pickup_dates_per_base.sql
[0m21:58:56.738210 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/pickup_count_vs_average_per_base.sql
[0m21:58:57.105276 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/top_3_base_names_by_total_pickups.sql
[0m21:58:57.142505 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/total_pickups_in_may_by_base.sql
[0m21:58:57.149857 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/pickup_percentile_by_base_per_month.sql
[0m21:58:57.156035 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/unter_grun_pickups_in_bronx.sql
[0m21:58:57.162210 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/top_3_pickup_dates_per_base.sql
[0m21:58:57.168419 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/pickup_count_vs_average_per_base.sql
[0m21:58:57.539069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afe44265-f265-4f04-834c-51f1e6aa3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb427ae0da0>]}
[0m21:58:57.555027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afe44265-f265-4f04-834c-51f1e6aa3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb427c0b860>]}
[0m21:58:57.556103 [info ] [MainThread]: Found 6 models, 3 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m21:58:57.559699 [info ] [MainThread]: 
[0m21:58:57.561581 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:58:57.565455 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m21:58:57.566806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:58.165152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m21:58:58.167404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:58.652879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afe44265-f265-4f04-834c-51f1e6aa3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb427bab800>]}
[0m21:58:58.654690 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:58:58.655728 [info ] [MainThread]: 
[0m21:58:58.660590 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m21:58:58.663105 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m21:58:58.666047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m21:58:58.668028 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m21:58:58.715217 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m21:58:58.717324 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 21:58:58.669340 => 21:58:58.716320
[0m21:58:58.721498 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m21:58:58.779332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:59.335636 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m21:58:59.337322 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM raw_data_janjune_15 AS raw
    JOIN base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m21:58:59.503861 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e580018f-9a17-4111-8f35-56d4a127be0c&page=queryresults
[0m21:58:59.505224 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: base_num_and_name, message: Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).')
[0m21:58:59.942150 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:894749a5-cda0-47e7-9cf4-f6d3b41e8ee6&page=queryresults
[0m21:58:59.943412 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:894749a5-cda0-47e7-9cf4-f6d3b41e8ee6&page=queryresults
[0m21:58:59.945071 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 21:58:58.725395 => 21:58:59.944431
[0m21:59:00.081760 [debug] [Thread-1 (]: Database Error in model pickup_count_vs_average_per_base (models/udp_transf/pickup_count_vs_average_per_base.sql)
  Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/pickup_count_vs_average_per_base.sql
[0m21:59:00.082909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe44265-f265-4f04-834c-51f1e6aa3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb427c58d70>]}
[0m21:59:00.084274 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[31mERROR[0m in 1.42s]
[0m21:59:00.086047 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m21:59:00.087169 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m21:59:00.088542 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [RUN]
[0m21:59:00.090311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_count_vs_average_per_base, now model.uber_transformations.pickup_percentile_by_base_per_month)
[0m21:59:00.092228 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_percentile_by_base_per_month
[0m21:59:00.099239 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m21:59:00.101998 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (compile): 21:59:00.093605 => 21:59:00.100854
[0m21:59:00.103969 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_percentile_by_base_per_month
[0m21:59:00.113238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:00.604330 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m21:59:00.605909 [debug] [Thread-1 (]: On model.uber_transformations.pickup_percentile_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_percentile_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM raw_data_janjune_15 AS raw
    JOIN base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m21:59:00.730475 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0fba5358-fc8f-4db0-b496-133accd36285&page=queryresults
[0m21:59:00.731761 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: base_num_and_name, message: Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).')
[0m21:59:00.945518 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7464842b-2db8-42f7-9659-accfff0ef117&page=queryresults
[0m21:59:00.951972 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7464842b-2db8-42f7-9659-accfff0ef117&page=queryresults
[0m21:59:00.954349 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (execute): 21:59:00.105131 => 21:59:00.953458
[0m21:59:00.966626 [debug] [Thread-1 (]: Database Error in model pickup_percentile_by_base_per_month (models/udp_transf/pickup_percentile_by_base_per_month.sql)
  Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/pickup_percentile_by_base_per_month.sql
[0m21:59:00.968044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe44265-f265-4f04-834c-51f1e6aa3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4271d78f0>]}
[0m21:59:00.969683 [error] [Thread-1 (]: 2 of 6 ERROR creating sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [[31mERROR[0m in 0.88s]
[0m21:59:00.971904 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m21:59:00.973245 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m21:59:00.974855 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [RUN]
[0m21:59:00.977904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_percentile_by_base_per_month, now model.uber_transformations.top_3_base_names_by_total_pickups)
[0m21:59:00.979171 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_by_total_pickups
[0m21:59:00.983331 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m21:59:00.986180 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (compile): 21:59:00.979865 => 21:59:00.984855
[0m21:59:00.988118 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_by_total_pickups
[0m21:59:01.000045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:01.513195 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m21:59:01.514978 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_by_total_pickups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_by_total_pickups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM raw_data_janjune_15 AS raw
JOIN base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m21:59:01.621000 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:6092a36e-4cfe-46e2-bf29-5d1d24c3c606&page=queryresults
[0m21:59:01.622740 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: base_num_and_name, message: Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).')
[0m21:59:02.068504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4f675854-f860-48a4-a5d3-ab6c9e2f95f6&page=queryresults
[0m21:59:02.069849 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4f675854-f860-48a4-a5d3-ab6c9e2f95f6&page=queryresults
[0m21:59:02.072113 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (execute): 21:59:00.989340 => 21:59:02.071293
[0m21:59:02.081279 [debug] [Thread-1 (]: Database Error in model top_3_base_names_by_total_pickups (models/udp_transf/top_3_base_names_by_total_pickups.sql)
  Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_base_names_by_total_pickups.sql
[0m21:59:02.082911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe44265-f265-4f04-834c-51f1e6aa3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb424fdbce0>]}
[0m21:59:02.085011 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [[31mERROR[0m in 1.11s]
[0m21:59:02.087418 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m21:59:02.089289 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_pickup_dates_per_base
[0m21:59:02.091173 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_pickup_dates_per_base ..... [RUN]
[0m21:59:02.094268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_by_total_pickups, now model.uber_transformations.top_3_pickup_dates_per_base)
[0m21:59:02.097556 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_pickup_dates_per_base
[0m21:59:02.112103 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m21:59:02.118928 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (compile): 21:59:02.099399 => 21:59:02.117694
[0m21:59:02.121426 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_pickup_dates_per_base
[0m21:59:02.128763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:02.699100 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m21:59:02.700914 [debug] [Thread-1 (]: On model.uber_transformations.top_3_pickup_dates_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_pickup_dates_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM raw_data_janjune_15 AS raw
    JOIN base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m21:59:02.862141 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c6e4135a-452b-45c0-8d88-518296c95cc0&page=queryresults
[0m21:59:02.863562 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: base_num_and_name, message: Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).')
[0m21:59:03.350060 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ad4df061-82e2-4aa2-b78c-c2d933d8564c&page=queryresults
[0m21:59:03.351367 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ad4df061-82e2-4aa2-b78c-c2d933d8564c&page=queryresults
[0m21:59:03.352974 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (execute): 21:59:02.123988 => 21:59:03.352396
[0m21:59:03.359590 [debug] [Thread-1 (]: Database Error in model top_3_pickup_dates_per_base (models/udp_transf/top_3_pickup_dates_per_base.sql)
  Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_pickup_dates_per_base.sql
[0m21:59:03.360883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe44265-f265-4f04-834c-51f1e6aa3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb427c08350>]}
[0m21:59:03.362386 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model airbyte_uber_data.top_3_pickup_dates_per_base  [[31mERROR[0m in 1.27s]
[0m21:59:03.364309 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_pickup_dates_per_base
[0m21:59:03.365693 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_pickups_in_may_by_base
[0m21:59:03.367007 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_pickups_in_may_by_base .... [RUN]
[0m21:59:03.369240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_pickup_dates_per_base, now model.uber_transformations.total_pickups_in_may_by_base)
[0m21:59:03.370943 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_pickups_in_may_by_base
[0m21:59:03.379716 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m21:59:03.384325 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (compile): 21:59:03.372609 => 21:59:03.383449
[0m21:59:03.385615 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_pickups_in_may_by_base
[0m21:59:03.438507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:03.945142 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m21:59:03.947019 [debug] [Thread-1 (]: On model.uber_transformations.total_pickups_in_may_by_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_pickups_in_may_by_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM raw_data_janjune_15 AS raw
JOIN base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m21:59:04.062726 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a76664ff-14fc-4b39-aeb5-fe044023a542&page=queryresults
[0m21:59:04.064156 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: base_num_and_name, message: Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).')
[0m21:59:04.753153 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:2a211612-c92b-478c-9111-147fe6daf8e4&page=queryresults
[0m21:59:04.755877 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:2a211612-c92b-478c-9111-147fe6daf8e4&page=queryresults
[0m21:59:04.758945 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (execute): 21:59:03.386370 => 21:59:04.757816
[0m21:59:04.769711 [debug] [Thread-1 (]: Database Error in model total_pickups_in_may_by_base (models/udp_transf/total_pickups_in_may_by_base.sql)
  Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/total_pickups_in_may_by_base.sql
[0m21:59:04.771753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe44265-f265-4f04-834c-51f1e6aa3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb427105160>]}
[0m21:59:04.773233 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model airbyte_uber_data.total_pickups_in_may_by_base  [[31mERROR[0m in 1.40s]
[0m21:59:04.776498 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_pickups_in_may_by_base
[0m21:59:04.778695 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:59:04.781877 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m21:59:04.785872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_pickups_in_may_by_base, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m21:59:04.787884 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:59:04.798782 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:59:04.804198 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 21:59:04.789434 => 21:59:04.803280
[0m21:59:04.805692 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:59:04.817608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:05.359620 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m21:59:05.363101 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM raw_data_janjune_15 AS raw
JOIN base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m21:59:05.501861 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8bcc08e4-e341-4c55-97de-6274071c73fb&page=queryresults
[0m21:59:05.503060 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: base_num_and_name, message: Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).')
[0m21:59:06.221025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a3d1cf00-72fe-4666-8420-aa8fbe2bf433&page=queryresults
[0m21:59:06.223734 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a3d1cf00-72fe-4666-8420-aa8fbe2bf433&page=queryresults
[0m21:59:06.227847 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 21:59:04.806838 => 21:59:06.225982
[0m21:59:06.240347 [debug] [Thread-1 (]: Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m21:59:06.242986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe44265-f265-4f04-834c-51f1e6aa3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb425008050>]}
[0m21:59:06.245802 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[31mERROR[0m in 1.46s]
[0m21:59:06.249290 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m21:59:06.259675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:59:06.263815 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m21:59:06.268096 [info ] [MainThread]: 
[0m21:59:06.270508 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 8.71 seconds (8.71s).
[0m21:59:06.278966 [debug] [MainThread]: Command end result
[0m21:59:06.322602 [info ] [MainThread]: 
[0m21:59:06.326406 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m21:59:06.332486 [info ] [MainThread]: 
[0m21:59:06.338397 [error] [MainThread]:   Database Error in model pickup_count_vs_average_per_base (models/udp_transf/pickup_count_vs_average_per_base.sql)
  Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/pickup_count_vs_average_per_base.sql
[0m21:59:06.343352 [info ] [MainThread]: 
[0m21:59:06.346881 [error] [MainThread]:   Database Error in model pickup_percentile_by_base_per_month (models/udp_transf/pickup_percentile_by_base_per_month.sql)
  Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/pickup_percentile_by_base_per_month.sql
[0m21:59:06.352483 [info ] [MainThread]: 
[0m21:59:06.355202 [error] [MainThread]:   Database Error in model top_3_base_names_by_total_pickups (models/udp_transf/top_3_base_names_by_total_pickups.sql)
  Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_base_names_by_total_pickups.sql
[0m21:59:06.361339 [info ] [MainThread]: 
[0m21:59:06.364753 [error] [MainThread]:   Database Error in model top_3_pickup_dates_per_base (models/udp_transf/top_3_pickup_dates_per_base.sql)
  Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/top_3_pickup_dates_per_base.sql
[0m21:59:06.367169 [info ] [MainThread]: 
[0m21:59:06.371107 [error] [MainThread]:   Database Error in model total_pickups_in_may_by_base (models/udp_transf/total_pickups_in_may_by_base.sql)
  Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/total_pickups_in_may_by_base.sql
[0m21:59:06.375400 [info ] [MainThread]: 
[0m21:59:06.379956 [error] [MainThread]:   Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Table "base_num_and_name" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m21:59:06.383250 [info ] [MainThread]: 
[0m21:59:06.385658 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m21:59:06.388984 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 11.774625, "process_user_time": 9.13978, "process_kernel_time": 0.672587, "process_mem_max_rss": "200288", "process_in_blocks": "832", "process_out_blocks": "3016", "command_success": false}
[0m21:59:06.395341 [debug] [MainThread]: Command `dbt build` failed at 21:59:06.394219 after 11.78 seconds
[0m21:59:06.398517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb43725ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb427c0ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb427ae1040>]}
[0m21:59:06.401226 [debug] [MainThread]: Flushing usage events
[0m21:59:56.539257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feea10648c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feea177b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feea1eda720>]}


============================== 21:59:56.544160 | 7a6aea79-16e5-40e4-9d19-1712be535499 ==============================
[0m21:59:56.544160 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:59:56.545677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:59:58.111988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a6aea79-16e5-40e4-9d19-1712be535499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee92923680>]}
[0m21:59:58.415679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a6aea79-16e5-40e4-9d19-1712be535499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee9206cd70>]}
[0m21:59:58.417222 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m21:59:58.437704 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:59:58.522745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m21:59:58.524029 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/pickup_count_vs_average_per_base.sql
[0m21:59:58.525210 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_base_names_by_total_pickups.sql
[0m21:59:58.526295 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/pickup_percentile_by_base_per_month.sql
[0m21:59:58.527353 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_pickup_dates_per_base.sql
[0m21:59:58.528433 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/total_pickups_in_may_by_base.sql
[0m21:59:58.529442 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m21:59:58.899153 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/pickup_count_vs_average_per_base.sql
[0m21:59:58.936217 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/top_3_base_names_by_total_pickups.sql
[0m21:59:58.942404 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/pickup_percentile_by_base_per_month.sql
[0m21:59:58.948716 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/top_3_pickup_dates_per_base.sql
[0m21:59:58.955955 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/total_pickups_in_may_by_base.sql
[0m21:59:58.962171 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/unter_grun_pickups_in_bronx.sql
[0m21:59:58.986146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a6aea79-16e5-40e4-9d19-1712be535499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee91d15af0>]}
[0m21:59:59.002581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a6aea79-16e5-40e4-9d19-1712be535499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee91f1efc0>]}
[0m21:59:59.003614 [info ] [MainThread]: Found 6 models, 3 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m21:59:59.007256 [info ] [MainThread]: 
[0m21:59:59.009317 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:59:59.014024 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m21:59:59.015302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:59.572423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m21:59:59.573480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:00.068019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a6aea79-16e5-40e4-9d19-1712be535499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee91f70a10>]}
[0m22:00:00.069717 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:00:00.070800 [info ] [MainThread]: 
[0m22:00:00.079884 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:00:00.081615 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m22:00:00.083723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m22:00:00.085228 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:00:00.109609 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:00:00.115656 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 22:00:00.086198 => 22:00:00.114407
[0m22:00:00.118631 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:00:00.182864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:00.697160 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:00:00.699652 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:00:00.925484 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:678f7a00-d7e8-4bac-92c0-acff17c53556&page=queryresults
[0m22:00:02.955472 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 22:00:00.121795 => 22:00:02.954938
[0m22:00:02.957367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6aea79-16e5-40e4-9d19-1712be535499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee91f1c080>]}
[0m22:00:02.958807 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.87s]
[0m22:00:02.960491 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:00:02.961671 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:00:02.962991 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [RUN]
[0m22:00:02.964839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_count_vs_average_per_base, now model.uber_transformations.pickup_percentile_by_base_per_month)
[0m22:00:02.966520 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:00:02.974050 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:00:02.977007 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (compile): 22:00:02.967917 => 22:00:02.975774
[0m22:00:02.979063 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:00:02.987168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:03.480213 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:00:03.482096 [debug] [Thread-1 (]: On model.uber_transformations.pickup_percentile_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_percentile_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m22:00:03.721561 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:71ef6eab-f2be-44af-85ec-4af552364d54&page=queryresults
[0m22:00:09.444117 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (execute): 22:00:02.980320 => 22:00:09.442958
[0m22:00:09.448452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6aea79-16e5-40e4-9d19-1712be535499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee91f1c6b0>]}
[0m22:00:09.451596 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 6.48s]
[0m22:00:09.455407 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:00:09.458095 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:00:09.462006 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [RUN]
[0m22:00:09.466963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_percentile_by_base_per_month, now model.uber_transformations.top_3_base_names_by_total_pickups)
[0m22:00:09.470299 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:00:09.475584 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:00:09.477141 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (compile): 22:00:09.471929 => 22:00:09.476530
[0m22:00:09.478270 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:00:09.485767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:10.033016 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:00:10.035193 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_by_total_pickups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_by_total_pickups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:00:10.313657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:82a62783-fcab-44c8-b714-86374509e5a2&page=queryresults
[0m22:00:12.198779 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (execute): 22:00:09.478978 => 22:00:12.197554
[0m22:00:12.203097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6aea79-16e5-40e4-9d19-1712be535499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee91de7fb0>]}
[0m22:00:12.206249 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.74s]
[0m22:00:12.209786 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:00:12.212843 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:00:12.216935 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_pickup_dates_per_base ..... [RUN]
[0m22:00:12.221730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_by_total_pickups, now model.uber_transformations.top_3_pickup_dates_per_base)
[0m22:00:12.224815 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:00:12.229860 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:00:12.231683 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (compile): 22:00:12.226162 => 22:00:12.230875
[0m22:00:12.232794 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:00:12.240819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:12.805712 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:00:12.807838 [debug] [Thread-1 (]: On model.uber_transformations.top_3_pickup_dates_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_pickup_dates_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:00:13.056282 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b986e120-264a-4c7a-9b57-34146146084f&page=queryresults
[0m22:00:14.946204 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (execute): 22:00:12.233554 => 22:00:14.945710
[0m22:00:14.949153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6aea79-16e5-40e4-9d19-1712be535499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee91de7fb0>]}
[0m22:00:14.952197 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_pickup_dates_per_base  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.73s]
[0m22:00:14.955745 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:00:14.958344 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:00:14.961632 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_pickups_in_may_by_base .... [RUN]
[0m22:00:14.967027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_pickup_dates_per_base, now model.uber_transformations.total_pickups_in_may_by_base)
[0m22:00:14.968701 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_pickups_in_may_by_base
[0m22:00:14.972698 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:00:14.974707 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (compile): 22:00:14.969409 => 22:00:14.973859
[0m22:00:14.975828 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_pickups_in_may_by_base
[0m22:00:14.982944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:15.484733 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:00:15.486378 [debug] [Thread-1 (]: On model.uber_transformations.total_pickups_in_may_by_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_pickups_in_may_by_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:00:16.230507 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a8cf88f4-312d-4d7c-9fbf-c0459b0fb4f5&page=queryresults
[0m22:00:17.841959 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (execute): 22:00:14.976468 => 22:00:17.841445
[0m22:00:17.843902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6aea79-16e5-40e4-9d19-1712be535499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee9168e4b0>]}
[0m22:00:17.850353 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_pickups_in_may_by_base  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.88s]
[0m22:00:17.853618 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:00:17.856233 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:00:17.857928 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:00:17.860193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_pickups_in_may_by_base, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:00:17.862591 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:00:17.934622 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:00:17.945814 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:00:17.867455 => 22:00:17.941633
[0m22:00:17.954346 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:00:17.978480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:18.772401 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:00:18.775317 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:00:18.980968 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:bcf13d44-bf3e-474a-9eca-53e3c574cb29&page=queryresults
[0m22:00:20.829037 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:00:17.958905 => 22:00:20.828529
[0m22:00:20.831165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6aea79-16e5-40e4-9d19-1712be535499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee91687590>]}
[0m22:00:20.832578 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.97s]
[0m22:00:20.834151 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:00:20.837342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:20.838277 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:00:20.839801 [info ] [MainThread]: 
[0m22:00:20.841671 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 21.83 seconds (21.83s).
[0m22:00:20.845524 [debug] [MainThread]: Command end result
[0m22:00:20.867540 [info ] [MainThread]: 
[0m22:00:20.870996 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:00:20.876387 [info ] [MainThread]: 
[0m22:00:20.879183 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:00:20.883173 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 24.459806, "process_user_time": 9.100015, "process_kernel_time": 0.659743, "process_mem_max_rss": "200200", "process_out_blocks": "3000", "process_in_blocks": "0"}
[0m22:00:20.888418 [debug] [MainThread]: Command `dbt build` succeeded at 22:00:20.887618 after 24.47 seconds
[0m22:00:20.890578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feea59c36e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee916a5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee91e8e300>]}
[0m22:00:20.892616 [debug] [MainThread]: Flushing usage events
[0m22:08:22.364038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085993d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0859a895b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085993e6c0>]}


============================== 22:08:22.369005 | 2a339d13-17e4-40d2-ab03-ba84e7de943f ==============================
[0m22:08:22.369005 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:08:22.370785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:08:23.929225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a339d13-17e4-40d2-ab03-ba84e7de943f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f084c941580>]}
[0m22:08:24.224065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a339d13-17e4-40d2-ab03-ba84e7de943f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0857d52570>]}
[0m22:08:24.225582 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:08:24.241259 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:08:24.322981 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m22:08:24.324312 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:08:24.683393 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:08:24.737793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a339d13-17e4-40d2-ab03-ba84e7de943f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0849e34f50>]}
[0m22:08:24.752942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a339d13-17e4-40d2-ab03-ba84e7de943f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f084a72aba0>]}
[0m22:08:24.753998 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:08:24.757520 [info ] [MainThread]: 
[0m22:08:24.759530 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:08:24.763252 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:08:24.764556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:25.341337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:08:25.342521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:25.850083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a339d13-17e4-40d2-ab03-ba84e7de943f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f084a83d460>]}
[0m22:08:25.852130 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:08:25.853369 [info ] [MainThread]: 
[0m22:08:25.865321 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:08:25.867198 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m22:08:25.869726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m22:08:25.870893 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:08:25.898500 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:08:25.907547 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 22:08:25.871620 => 22:08:25.906103
[0m22:08:25.910559 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:08:25.972681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:26.532852 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:08:26.535373 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:08:26.815052 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b0a387ca-104c-4833-a06b-f0caa1042328&page=queryresults
[0m22:08:29.069979 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 22:08:25.912733 => 22:08:29.069465
[0m22:08:29.071763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a339d13-17e4-40d2-ab03-ba84e7de943f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f084a83fb30>]}
[0m22:08:29.073112 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.20s]
[0m22:08:29.074796 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:08:29.075887 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:08:29.077174 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [RUN]
[0m22:08:29.079000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_count_vs_average_per_base, now model.uber_transformations.pickup_percentile_by_base_per_month)
[0m22:08:29.080671 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:08:29.096379 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:08:29.099487 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (compile): 22:08:29.081686 => 22:08:29.098432
[0m22:08:29.101507 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:08:29.252609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:29.755308 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:08:29.756859 [debug] [Thread-1 (]: On model.uber_transformations.pickup_percentile_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_percentile_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m22:08:30.009019 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:61812770-8664-4d9a-8a9b-7065802799f6&page=queryresults
[0m22:08:35.355999 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (execute): 22:08:29.102885 => 22:08:35.354849
[0m22:08:35.360039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a339d13-17e4-40d2-ab03-ba84e7de943f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f084a7281d0>]}
[0m22:08:35.363064 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 6.28s]
[0m22:08:35.366525 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:08:35.368393 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:08:35.369625 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [RUN]
[0m22:08:35.372317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_percentile_by_base_per_month, now model.uber_transformations.top_3_base_names_by_total_pickups)
[0m22:08:35.373593 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:08:35.378091 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:08:35.379828 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (compile): 22:08:35.374430 => 22:08:35.379136
[0m22:08:35.380983 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:08:35.385712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:35.906056 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:08:35.907802 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_by_total_pickups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_by_total_pickups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:08:36.102891 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:02170947-ada3-4b39-8633-df2a768977ea&page=queryresults
[0m22:08:37.983401 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (execute): 22:08:35.381751 => 22:08:37.982893
[0m22:08:37.985238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a339d13-17e4-40d2-ab03-ba84e7de943f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f084a729b80>]}
[0m22:08:37.986610 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.61s]
[0m22:08:37.988302 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:08:37.989598 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:08:37.990815 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_pickup_dates_per_base ..... [RUN]
[0m22:08:37.992989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_by_total_pickups, now model.uber_transformations.top_3_pickup_dates_per_base)
[0m22:08:37.995073 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:08:38.002773 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:08:38.005614 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (compile): 22:08:37.996371 => 22:08:38.004435
[0m22:08:38.007722 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:08:38.016112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:38.506746 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:08:38.508446 [debug] [Thread-1 (]: On model.uber_transformations.top_3_pickup_dates_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_pickup_dates_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:08:39.271630 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:e63fab85-17fa-4023-93b2-5c3f36b2e700&page=queryresults
[0m22:08:41.164260 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (execute): 22:08:38.008935 => 22:08:41.163050
[0m22:08:41.169860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a339d13-17e4-40d2-ab03-ba84e7de943f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f084a729b20>]}
[0m22:08:41.172598 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_pickup_dates_per_base  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 3.18s]
[0m22:08:41.174511 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:08:41.175640 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:08:41.177096 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_pickups_in_may_by_base .... [RUN]
[0m22:08:41.179443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_pickup_dates_per_base, now model.uber_transformations.total_pickups_in_may_by_base)
[0m22:08:41.180700 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_pickups_in_may_by_base
[0m22:08:41.184909 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:08:41.188008 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (compile): 22:08:41.181480 => 22:08:41.186850
[0m22:08:41.189210 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_pickups_in_may_by_base
[0m22:08:41.193790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:41.699591 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:08:41.701107 [debug] [Thread-1 (]: On model.uber_transformations.total_pickups_in_may_by_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_pickups_in_may_by_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:08:41.916066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d592c56f-4765-4f96-ad4a-1aadcc37db48&page=queryresults
[0m22:08:43.750815 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (execute): 22:08:41.189925 => 22:08:43.749952
[0m22:08:43.753000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a339d13-17e4-40d2-ab03-ba84e7de943f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f084a728560>]}
[0m22:08:43.754326 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_pickups_in_may_by_base  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.57s]
[0m22:08:43.755950 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:08:43.757049 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:08:43.759097 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:08:43.761519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_pickups_in_may_by_base, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:08:43.762974 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:08:43.767479 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:08:43.769330 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:08:43.763675 => 22:08:43.768574
[0m22:08:43.770432 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:08:43.774901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:44.335102 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:08:44.336727 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw_data_janjune_15.pickup_date AS `Pickup Date`,
       base_num_and_name.base_name AS `Base Name`,
       taxi_zone_lookup.borough AS `Borough`,
       taxi_zone_lookup.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw_data_janjune_15
JOIN airbyte_uber_data.base_num_and_name AS base_num_and_name ON base_num_and_name.base_num = raw_data_janjune_15.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS taxi_zone_lookup ON taxi_zone_lookup.locationid = raw_data_janjune_15.locationid
WHERE base_num_and_name.base_name IN ('Unter', 'Grun') AND taxi_zone_lookup.Borough = 'Bronx'
    );
  
[0m22:08:44.554297 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:672797f6-e5ea-4f58-9b9a-52053838699b&page=queryresults
[0m22:08:46.397315 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:08:43.771161 => 22:08:46.396815
[0m22:08:46.399173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a339d13-17e4-40d2-ab03-ba84e7de943f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0849e8f860>]}
[0m22:08:46.401178 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.64s]
[0m22:08:46.404645 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:08:46.413614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:46.415754 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:08:46.417783 [info ] [MainThread]: 
[0m22:08:46.419569 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 21.66 seconds (21.66s).
[0m22:08:46.424812 [debug] [MainThread]: Command end result
[0m22:08:46.460444 [info ] [MainThread]: 
[0m22:08:46.467156 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:08:46.469975 [info ] [MainThread]: 
[0m22:08:46.472169 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:08:46.475942 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 24.238758, "process_user_time": 8.628946, "process_kernel_time": 0.678416, "process_mem_max_rss": "199828", "process_out_blocks": "2968", "process_in_blocks": "0"}
[0m22:08:46.478436 [debug] [MainThread]: Command `dbt build` succeeded at 22:08:46.477827 after 24.24 seconds
[0m22:08:46.480184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0859815910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f084a7e57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f084a522090>]}
[0m22:08:46.482183 [debug] [MainThread]: Flushing usage events
[0m22:16:56.508477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cfe94caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cfd0f3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cfd3c7a70>]}


============================== 22:16:56.513426 | f8b36304-b5b0-4979-8e4c-910c02f2f0f8 ==============================
[0m22:16:56.513426 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:16:56.514846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:16:58.076153 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'airbyte_uber_data', 'tables': [{'name': 'raw_data_janjune_15', 'identifier': 'airbyte_uber_data.raw_data_janjune_15'}, {'name': 'base_num_and_name', 'identifier': 'airbyte_uber_data.base_num_and_name'}, {'name': 'taxi_zone_lookup', 'identifier': 'airbyte_uber_data.taxi_zone_lookup'}], 'source_type': 'bq'}] is not of type 'object'

Error encountered in /home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/dbt_project.yml
[0m22:16:58.078495 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 1.706867, "process_user_time": 5.573667, "process_kernel_time": 0.619223, "process_mem_max_rss": "176508", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:16:58.079917 [debug] [MainThread]: Command `dbt build` failed at 22:16:58.079562 after 1.71 seconds
[0m22:16:58.081161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cee8ac3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cee35ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cfe22e9f0>]}
[0m22:16:58.082225 [debug] [MainThread]: Flushing usage events
[0m22:20:03.331282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd234c2ce60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd234c2caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd234c2c560>]}


============================== 22:20:03.336312 | aad6b0b0-c12e-451a-90c4-b5d54c332b51 ==============================
[0m22:20:03.336312 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:20:03.337737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:20:04.938522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aad6b0b0-c12e-451a-90c4-b5d54c332b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22600ee40>]}
[0m22:20:05.308595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aad6b0b0-c12e-451a-90c4-b5d54c332b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd225c2d7f0>]}
[0m22:20:05.310095 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:20:05.326387 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:20:05.360040 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:20:05.361321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aad6b0b0-c12e-451a-90c4-b5d54c332b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd225dcc830>]}
[0m22:20:07.271807 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/top_3_pickup_dates_per_base.sql
[0m22:20:07.308542 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/pickup_count_vs_average_per_base.sql
[0m22:20:07.314776 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/total_pickups_in_may_by_base.sql
[0m22:20:07.321057 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/top_3_base_names_by_total_pickups.sql
[0m22:20:07.327272 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/pickup_percentile_by_base_per_month.sql
[0m22:20:07.333818 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:20:07.428199 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.airbyte_uber_data
[0m22:20:07.438858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aad6b0b0-c12e-451a-90c4-b5d54c332b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2259be120>]}
[0m22:20:07.457446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aad6b0b0-c12e-451a-90c4-b5d54c332b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd225948590>]}
[0m22:20:07.459500 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:20:07.466660 [info ] [MainThread]: 
[0m22:20:07.470263 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:20:07.484519 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:20:07.488613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:08.067739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:20:08.068756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:20:08.566123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aad6b0b0-c12e-451a-90c4-b5d54c332b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd225bee060>]}
[0m22:20:08.568402 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:20:08.569521 [info ] [MainThread]: 
[0m22:20:08.579045 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:20:08.580587 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m22:20:08.582774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m22:20:08.583897 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:20:08.611737 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:20:08.617353 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 22:20:08.584601 => 22:20:08.613784
[0m22:20:08.619242 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:20:08.689430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:09.239989 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:20:09.242036 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:20:09.520844 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:acfc5773-e881-4aea-887a-718b32bd0d76&page=queryresults
[0m22:20:11.747674 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 22:20:08.620278 => 22:20:11.747106
[0m22:20:11.749427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad6b0b0-c12e-451a-90c4-b5d54c332b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd225948ce0>]}
[0m22:20:11.750776 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.17s]
[0m22:20:11.752445 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:20:11.753550 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:20:11.754861 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [RUN]
[0m22:20:11.756604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_count_vs_average_per_base, now model.uber_transformations.pickup_percentile_by_base_per_month)
[0m22:20:11.758416 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:20:11.763032 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:20:11.765250 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (compile): 22:20:11.759303 => 22:20:11.764181
[0m22:20:11.766618 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:20:11.772220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:12.294748 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:20:12.296915 [debug] [Thread-1 (]: On model.uber_transformations.pickup_percentile_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_percentile_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m22:20:12.651023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f4b6cf95-7ac5-42c5-9068-8000d63fade7&page=queryresults
[0m22:20:18.339349 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (execute): 22:20:11.767259 => 22:20:18.338850
[0m22:20:18.341446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad6b0b0-c12e-451a-90c4-b5d54c332b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22593d250>]}
[0m22:20:18.343344 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 6.59s]
[0m22:20:18.346354 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:20:18.348655 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:20:18.351340 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [RUN]
[0m22:20:18.356605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_percentile_by_base_per_month, now model.uber_transformations.top_3_base_names_by_total_pickups)
[0m22:20:18.360298 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:20:18.368248 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:20:18.370895 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (compile): 22:20:18.361906 => 22:20:18.369829
[0m22:20:18.372777 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:20:18.382993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:18.881601 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:20:18.883074 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_by_total_pickups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_by_total_pickups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:20:19.109401 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ee0f7813-0d50-4abf-b9e1-3243b28bb582&page=queryresults
[0m22:20:21.046167 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (execute): 22:20:18.374808 => 22:20:21.045667
[0m22:20:21.048149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad6b0b0-c12e-451a-90c4-b5d54c332b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd225b17290>]}
[0m22:20:21.049509 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.69s]
[0m22:20:21.051074 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:20:21.052164 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:20:21.053387 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_pickup_dates_per_base ..... [RUN]
[0m22:20:21.055204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_by_total_pickups, now model.uber_transformations.top_3_pickup_dates_per_base)
[0m22:20:21.056972 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:20:21.061231 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:20:21.062979 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (compile): 22:20:21.057817 => 22:20:21.062306
[0m22:20:21.064126 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:20:21.069387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:21.590309 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:20:21.591891 [debug] [Thread-1 (]: On model.uber_transformations.top_3_pickup_dates_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_pickup_dates_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:20:21.866266 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:305074b0-ccf4-4340-ac03-49e222c1d272&page=queryresults
[0m22:20:24.107712 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (execute): 22:20:21.064822 => 22:20:24.106516
[0m22:20:24.111623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad6b0b0-c12e-451a-90c4-b5d54c332b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd225264590>]}
[0m22:20:24.114647 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_pickup_dates_per_base  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 3.06s]
[0m22:20:24.118200 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:20:24.120865 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:20:24.124858 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_pickups_in_may_by_base .... [RUN]
[0m22:20:24.129647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_pickup_dates_per_base, now model.uber_transformations.total_pickups_in_may_by_base)
[0m22:20:24.131805 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_pickups_in_may_by_base
[0m22:20:24.136562 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:20:24.138345 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (compile): 22:20:24.132716 => 22:20:24.137575
[0m22:20:24.139705 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_pickups_in_may_by_base
[0m22:20:24.201335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:24.679454 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:20:24.681213 [debug] [Thread-1 (]: On model.uber_transformations.total_pickups_in_may_by_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_pickups_in_may_by_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:20:24.898646 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c0838a4a-6342-4aae-abbb-db980b9e454d&page=queryresults
[0m22:20:26.768900 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (execute): 22:20:24.140986 => 22:20:26.768405
[0m22:20:26.770698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad6b0b0-c12e-451a-90c4-b5d54c332b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd225299dc0>]}
[0m22:20:26.772401 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_pickups_in_may_by_base  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.64s]
[0m22:20:26.773974 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:20:26.775119 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:20:26.776415 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:20:26.778143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_pickups_in_may_by_base, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:20:26.779822 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:20:26.784651 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:20:26.786821 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:20:26.780727 => 22:20:26.785981
[0m22:20:26.788136 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:20:26.793253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:27.331855 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:20:27.333331 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:20:27.562385 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ad22c375-2e3e-4d0c-b09b-43bee3cfa158&page=queryresults
[0m22:20:29.468558 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:20:26.788831 => 22:20:29.468059
[0m22:20:29.470486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad6b0b0-c12e-451a-90c4-b5d54c332b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd225285220>]}
[0m22:20:29.472035 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.69s]
[0m22:20:29.473667 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:20:29.478108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:20:29.479586 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:20:29.480691 [info ] [MainThread]: 
[0m22:20:29.481794 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 22.01 seconds (22.01s).
[0m22:20:29.484864 [debug] [MainThread]: Command end result
[0m22:20:29.506357 [info ] [MainThread]: 
[0m22:20:29.507554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:20:29.509338 [info ] [MainThread]: 
[0m22:20:29.511666 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:20:29.515138 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 26.330534, "process_user_time": 10.627393, "process_kernel_time": 0.624709, "process_mem_max_rss": "198304", "process_out_blocks": "2984", "process_in_blocks": "0"}
[0m22:20:29.517869 [debug] [MainThread]: Command `dbt build` succeeded at 22:20:29.517100 after 26.33 seconds
[0m22:20:29.520137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd234c2cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2259be120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2259ecb00>]}
[0m22:20:29.522426 [debug] [MainThread]: Flushing usage events
[0m22:21:49.158729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5e9a4a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e62d33530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5e9a40b0>]}


============================== 22:21:49.190451 | e1b50df3-d198-4f3c-9889-c3eac779df48 ==============================
[0m22:21:49.190451 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:21:49.191978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m22:21:52.189577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1b50df3-d198-4f3c-9889-c3eac779df48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e4fd9a750>]}
[0m22:21:52.482872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1b50df3-d198-4f3c-9889-c3eac779df48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e4fb87110>]}
[0m22:21:52.484363 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:21:52.547488 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:21:52.713412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:21:52.714762 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/source.yml
[0m22:21:52.951279 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/udp_transf/source.yml @ sources: {'name': 'airbyte_uber_data', 'tables': [{'name': 'raw_data_janjune_15', 'identifier': 'airbyte_uber_data.raw_data_janjune_15'}, {'name': 'base_num_and_name', 'identifier': 'airbyte_uber_data.base_num_and_name'}, {'name': 'taxi_zone_lookup', 'identifier': 'airbyte_uber_data.taxi_zone_lookup'}], 'source_type': 'bq'} - at path []: Additional properties are not allowed ('source_type' was unexpected)
[0m22:21:52.953750 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 3.9126973, "process_user_time": 6.106864, "process_kernel_time": 0.556803, "process_mem_max_rss": "181944", "process_in_blocks": "4928", "process_out_blocks": "16", "command_success": false}
[0m22:21:52.955200 [debug] [MainThread]: Command `dbt build` failed at 22:21:52.954823 after 3.91 seconds
[0m22:21:52.956195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e60bebf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e50c37230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e4f861c40>]}
[0m22:21:52.957359 [debug] [MainThread]: Flushing usage events
[0m22:23:07.497328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54731e9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54731504a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54733b72f0>]}


============================== 22:23:07.502350 | cba081fe-3754-4005-8796-2ca98f5d4662 ==============================
[0m22:23:07.502350 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:23:07.503684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:23:09.101029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cba081fe-3754-4005-8796-2ca98f5d4662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f546439d9a0>]}
[0m22:23:09.406753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cba081fe-3754-4005-8796-2ca98f5d4662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5464135d60>]}
[0m22:23:09.408296 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:23:09.425760 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:23:09.481128 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:23:09.482446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cba081fe-3754-4005-8796-2ca98f5d4662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5463f08110>]}
[0m22:23:11.321647 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/top_3_pickup_dates_per_base.sql
[0m22:23:11.359448 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/pickup_count_vs_average_per_base.sql
[0m22:23:11.366105 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/total_pickups_in_may_by_base.sql
[0m22:23:11.372845 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/top_3_base_names_by_total_pickups.sql
[0m22:23:11.379272 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/pickup_percentile_by_base_per_month.sql
[0m22:23:11.385703 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:23:11.476145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cba081fe-3754-4005-8796-2ca98f5d4662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f546406f650>]}
[0m22:23:11.492675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cba081fe-3754-4005-8796-2ca98f5d4662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5463eb2510>]}
[0m22:23:11.493876 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:23:11.497555 [info ] [MainThread]: 
[0m22:23:11.499646 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:23:11.503720 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:23:11.504945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:12.061302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:23:12.062492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:23:12.556683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cba081fe-3754-4005-8796-2ca98f5d4662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54640eec60>]}
[0m22:23:12.558707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:23:12.559842 [info ] [MainThread]: 
[0m22:23:12.608433 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:23:12.614229 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m22:23:12.618288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m22:23:12.619734 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:23:12.637178 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:23:12.639071 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 22:23:12.620413 => 22:23:12.638245
[0m22:23:12.640249 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:23:12.698053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:13.221254 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:23:13.222832 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:23:13.442093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a9e0c47e-1484-441e-947e-a2633fe3c4f8&page=queryresults
[0m22:23:15.614349 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 22:23:12.641176 => 22:23:15.613758
[0m22:23:15.616397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba081fe-3754-4005-8796-2ca98f5d4662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5463ed6b70>]}
[0m22:23:15.617855 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.00s]
[0m22:23:15.619873 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:23:15.621134 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:23:15.622535 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [RUN]
[0m22:23:15.624437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_count_vs_average_per_base, now model.uber_transformations.pickup_percentile_by_base_per_month)
[0m22:23:15.626554 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:23:15.631663 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:23:15.634014 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (compile): 22:23:15.627481 => 22:23:15.633084
[0m22:23:15.635192 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:23:15.642871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:16.134232 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:23:16.136041 [debug] [Thread-1 (]: On model.uber_transformations.pickup_percentile_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_percentile_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m22:23:16.370116 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ccd8d2c8-418f-4224-8a3f-e72a62660913&page=queryresults
[0m22:23:21.762307 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (execute): 22:23:15.635871 => 22:23:21.761783
[0m22:23:21.764140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba081fe-3754-4005-8796-2ca98f5d4662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5463e9cda0>]}
[0m22:23:21.765497 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 6.14s]
[0m22:23:21.767095 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:23:21.768260 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:23:21.769597 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [RUN]
[0m22:23:21.771377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_percentile_by_base_per_month, now model.uber_transformations.top_3_base_names_by_total_pickups)
[0m22:23:21.772946 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:23:21.777427 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:23:21.779623 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (compile): 22:23:21.773960 => 22:23:21.778635
[0m22:23:21.780957 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:23:21.816861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:22.289353 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:23:22.291129 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_by_total_pickups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_by_total_pickups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:23:23.108098 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:8d7c77a4-64f9-4a28-8f3a-30101a7570c7&page=queryresults
[0m22:23:24.692150 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (execute): 22:23:21.781640 => 22:23:24.691668
[0m22:23:24.693863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba081fe-3754-4005-8796-2ca98f5d4662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f546144a150>]}
[0m22:23:24.695199 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.92s]
[0m22:23:24.696846 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:23:24.697978 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:23:24.699210 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_pickup_dates_per_base ..... [RUN]
[0m22:23:24.700886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_by_total_pickups, now model.uber_transformations.top_3_pickup_dates_per_base)
[0m22:23:24.702607 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:23:24.710111 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:23:24.712666 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (compile): 22:23:24.703991 => 22:23:24.711635
[0m22:23:24.714588 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:23:24.722988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:25.227368 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:23:25.229426 [debug] [Thread-1 (]: On model.uber_transformations.top_3_pickup_dates_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_pickup_dates_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:23:25.424078 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:896ad224-9ce7-43da-a27e-dcdefd8042fb&page=queryresults
[0m22:23:27.603663 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (execute): 22:23:24.715749 => 22:23:27.603145
[0m22:23:27.605583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba081fe-3754-4005-8796-2ca98f5d4662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5461448470>]}
[0m22:23:27.607511 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_pickup_dates_per_base  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.91s]
[0m22:23:27.610071 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:23:27.611828 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:23:27.613517 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_pickups_in_may_by_base .... [RUN]
[0m22:23:27.616810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_pickup_dates_per_base, now model.uber_transformations.total_pickups_in_may_by_base)
[0m22:23:27.618067 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_pickups_in_may_by_base
[0m22:23:27.622540 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:23:27.624342 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (compile): 22:23:27.618750 => 22:23:27.623605
[0m22:23:27.626248 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_pickups_in_may_by_base
[0m22:23:27.632566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:28.120063 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:23:28.121505 [debug] [Thread-1 (]: On model.uber_transformations.total_pickups_in_may_by_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_pickups_in_may_by_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:23:28.337381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:2d10a432-5b00-4a9d-b564-ac282151b755&page=queryresults
[0m22:23:30.194867 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (execute): 22:23:27.627144 => 22:23:30.194117
[0m22:23:30.198093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba081fe-3754-4005-8796-2ca98f5d4662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5463ed56a0>]}
[0m22:23:30.201180 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_pickups_in_may_by_base  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.58s]
[0m22:23:30.205484 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:23:30.208178 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:23:30.212264 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:23:30.217274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_pickups_in_may_by_base, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:23:30.220329 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:23:30.228276 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:23:30.231332 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:23:30.222054 => 22:23:30.230293
[0m22:23:30.232960 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:23:30.240909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:30.790432 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:23:30.792112 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.affiliated_base_num
JOIN airbyte_uber_data.taxi_zone_lookup AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:23:31.007867 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c89af702-b2d6-4d2a-9833-4c32c46a126c&page=queryresults
[0m22:23:32.853944 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:23:30.233981 => 22:23:32.853446
[0m22:23:32.855829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba081fe-3754-4005-8796-2ca98f5d4662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5461449ac0>]}
[0m22:23:32.857216 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.64s]
[0m22:23:32.858926 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:23:32.862214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:32.863144 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:23:32.864907 [info ] [MainThread]: 
[0m22:23:32.866223 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 21.37 seconds (21.37s).
[0m22:23:32.870128 [debug] [MainThread]: Command end result
[0m22:23:32.950434 [info ] [MainThread]: 
[0m22:23:32.954110 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:23:32.959002 [info ] [MainThread]: 
[0m22:23:32.964040 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:23:32.969821 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 25.589945, "process_user_time": 10.247548, "process_kernel_time": 0.629624, "process_mem_max_rss": "198172", "process_in_blocks": "8", "process_out_blocks": "2984"}
[0m22:23:32.976862 [debug] [MainThread]: Command `dbt build` succeeded at 22:23:32.975418 after 25.60 seconds
[0m22:23:32.980480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54735d4cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f546529d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f546439d040>]}
[0m22:23:32.982861 [debug] [MainThread]: Flushing usage events
[0m22:33:01.980768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1600ee420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1621342f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc15ff8f590>]}


============================== 22:33:02.011211 | 0695efe4-b6db-4e56-aa09-d6fb9ad20604 ==============================
[0m22:33:02.011211 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:33:02.012600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:33:03.930336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0695efe4-b6db-4e56-aa09-d6fb9ad20604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1510db140>]}
[0m22:33:04.226731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0695efe4-b6db-4e56-aa09-d6fb9ad20604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1513ed4c0>]}
[0m22:33:04.228262 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:33:04.249540 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:33:04.316188 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading uber_transformations: udp_transf/sources.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  |   sources:
    4  |     - name: airbyte_uber_data
    5  |       database: uber-data-pipeline-417021
    6  |       schema: source
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 10
[0m22:33:04.318200 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 2.4568353, "process_user_time": 5.701274, "process_kernel_time": 0.548884, "process_mem_max_rss": "180480", "process_in_blocks": "3480", "process_out_blocks": "16", "command_success": false}
[0m22:33:04.319455 [debug] [MainThread]: Command `dbt build` failed at 22:33:04.319117 after 2.46 seconds
[0m22:33:04.320367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1606b6930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1510da8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc15101df10>]}
[0m22:33:04.321341 [debug] [MainThread]: Flushing usage events
[0m22:33:53.791429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d899c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d91f8fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d899c9e0>]}


============================== 22:33:53.796528 | 40a25e3c-65f2-4b93-b0dd-bebfb61d7fa5 ==============================
[0m22:33:53.796528 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:33:53.797978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:33:55.383800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40a25e3c-65f2-4b93-b0dd-bebfb61d7fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5ca53bcb0>]}
[0m22:33:55.671993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40a25e3c-65f2-4b93-b0dd-bebfb61d7fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c9f829c0>]}
[0m22:33:55.673534 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:33:55.690071 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:33:55.819580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m22:33:55.821519 [debug] [MainThread]: Partial parsing: added file: uber_transformations://models/udp_transf/sources.yml
[0m22:33:55.822631 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:33:56.180153 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:33:56.577875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40a25e3c-65f2-4b93-b0dd-bebfb61d7fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c973ac90>]}
[0m22:33:56.599864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40a25e3c-65f2-4b93-b0dd-bebfb61d7fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c9876780>]}
[0m22:33:56.601171 [info ] [MainThread]: Found 6 models, 3 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:33:56.605176 [info ] [MainThread]: 
[0m22:33:56.607248 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:33:56.611412 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:33:56.612689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:57.219827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:33:57.221466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:33:57.704587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40a25e3c-65f2-4b93-b0dd-bebfb61d7fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c97f74d0>]}
[0m22:33:57.706625 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:33:57.707891 [info ] [MainThread]: 
[0m22:33:57.765246 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:33:57.768664 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m22:33:57.770903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m22:33:57.772026 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:33:57.789031 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:33:57.790730 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 22:33:57.772650 => 22:33:57.790063
[0m22:33:57.792034 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:33:57.853235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:58.387786 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:33:58.389416 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:33:58.664946 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4f007b2c-5deb-4104-8729-fc19bd95d0cd&page=queryresults
[0m22:34:00.898411 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 22:33:57.792811 => 22:34:00.897446
[0m22:34:00.901560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a25e3c-65f2-4b93-b0dd-bebfb61d7fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c987d790>]}
[0m22:34:00.903677 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.13s]
[0m22:34:00.906193 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:34:00.907965 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:34:00.910150 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [RUN]
[0m22:34:00.913631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_count_vs_average_per_base, now model.uber_transformations.pickup_percentile_by_base_per_month)
[0m22:34:00.915407 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:34:00.922677 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:34:00.924920 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (compile): 22:34:00.916531 => 22:34:00.924032
[0m22:34:00.926286 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:34:00.936453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:01.442199 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:34:01.443712 [debug] [Thread-1 (]: On model.uber_transformations.pickup_percentile_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_percentile_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m22:34:01.709939 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:3d790078-45de-406e-877e-5955c1d56ad6&page=queryresults
[0m22:34:06.045773 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (execute): 22:34:00.927111 => 22:34:06.045257
[0m22:34:06.047766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a25e3c-65f2-4b93-b0dd-bebfb61d7fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c97d31d0>]}
[0m22:34:06.049758 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 5.14s]
[0m22:34:06.053366 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:34:06.056053 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:34:06.059947 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [RUN]
[0m22:34:06.064461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_percentile_by_base_per_month, now model.uber_transformations.top_3_base_names_by_total_pickups)
[0m22:34:06.067229 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:34:06.071979 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:34:06.073567 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (compile): 22:34:06.068577 => 22:34:06.072956
[0m22:34:06.074616 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:34:06.081990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:06.604901 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:34:06.606441 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_by_total_pickups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_by_total_pickups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:34:06.820733 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:294cde4a-311f-4ab9-a6f8-0c8cbc29fd58&page=queryresults
[0m22:34:08.745551 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (execute): 22:34:06.075306 => 22:34:08.744389
[0m22:34:08.748075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a25e3c-65f2-4b93-b0dd-bebfb61d7fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c904f800>]}
[0m22:34:08.749394 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.69s]
[0m22:34:08.750928 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:34:08.752016 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:34:08.753283 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_pickup_dates_per_base ..... [RUN]
[0m22:34:08.754992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_by_total_pickups, now model.uber_transformations.top_3_pickup_dates_per_base)
[0m22:34:08.756507 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:34:08.760657 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:34:08.762401 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (compile): 22:34:08.757415 => 22:34:08.761730
[0m22:34:08.763819 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:34:08.769144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:09.277811 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:34:09.280758 [debug] [Thread-1 (]: On model.uber_transformations.top_3_pickup_dates_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_pickup_dates_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:34:09.510832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:62d97d45-8b82-4e51-8bd9-be26103d5678&page=queryresults
[0m22:34:11.413899 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (execute): 22:34:08.764727 => 22:34:11.413408
[0m22:34:11.415806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a25e3c-65f2-4b93-b0dd-bebfb61d7fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c904f800>]}
[0m22:34:11.417204 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_pickup_dates_per_base  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.66s]
[0m22:34:11.419183 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:34:11.420812 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:34:11.422130 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_pickups_in_may_by_base .... [RUN]
[0m22:34:11.424517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_pickup_dates_per_base, now model.uber_transformations.total_pickups_in_may_by_base)
[0m22:34:11.425844 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_pickups_in_may_by_base
[0m22:34:11.430509 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:34:11.432586 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (compile): 22:34:11.426615 => 22:34:11.431916
[0m22:34:11.433786 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_pickups_in_may_by_base
[0m22:34:11.492992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:11.990465 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:34:11.992053 [debug] [Thread-1 (]: On model.uber_transformations.total_pickups_in_may_by_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_pickups_in_may_by_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:34:12.203257 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:87df45d2-cba2-4937-b2d6-e590a51d4aa1&page=queryresults
[0m22:34:13.797842 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (execute): 22:34:11.434485 => 22:34:13.797230
[0m22:34:13.799618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a25e3c-65f2-4b93-b0dd-bebfb61d7fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c8eaf770>]}
[0m22:34:13.800974 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_pickups_in_may_by_base  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.38s]
[0m22:34:13.802549 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:34:13.803634 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:34:13.805186 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:34:13.806867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_pickups_in_may_by_base, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:34:13.808398 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:34:13.821619 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:34:13.824180 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:34:13.809832 => 22:34:13.823143
[0m22:34:13.826220 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:34:13.841104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:14.320913 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:34:14.322899 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM `uber-data-pipeline-417021`.`source`.`raw_data_janjune_15` AS raw
JOIN `uber-data-pipeline-417021`.`source`.`base_num_and_name` AS base ON base.base_num = raw.affiliated_base_num
JOIN `uber-data-pipeline-417021`.`source`.`taxi_zone_lookup` AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:34:14.886447 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:0cae3b7e-f43a-4e27-8b88-32f343fe12d4&page=queryresults
[0m22:34:14.892658 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM `uber-data-pipeline-417021`.`source`.`raw_data_janjune_15` AS raw
JOIN `uber-data-pipeline-417021`.`source`.`base_num_and_name` AS base ON base.base_num = raw.affiliated_base_num
JOIN `uber-data-pipeline-417021`.`source`.`taxi_zone_lookup` AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:34:14.898441 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2; reason: notFound, message: Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2

Location: europe-west2
Job ID: 0cae3b7e-f43a-4e27-8b88-32f343fe12d4

[0m22:34:14.904780 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:34:13.827813 => 22:34:14.900182
[0m22:34:15.037008 [debug] [Thread-1 (]: Runtime Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  404 Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2; reason: notFound, message: Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2
  
  Location: europe-west2
  Job ID: 0cae3b7e-f43a-4e27-8b88-32f343fe12d4
  
[0m22:34:15.038245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a25e3c-65f2-4b93-b0dd-bebfb61d7fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c8ead6d0>]}
[0m22:34:15.039599 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[31mERROR[0m in 1.23s]
[0m22:34:15.041913 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:34:15.045742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:15.047036 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:34:15.048016 [info ] [MainThread]: 
[0m22:34:15.049123 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 18.44 seconds (18.44s).
[0m22:34:15.052939 [debug] [MainThread]: Command end result
[0m22:34:15.074985 [info ] [MainThread]: 
[0m22:34:15.077963 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:34:15.079839 [info ] [MainThread]: 
[0m22:34:15.081818 [error] [MainThread]:   Runtime Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  404 Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2; reason: notFound, message: Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2
  
  Location: europe-west2
  Job ID: 0cae3b7e-f43a-4e27-8b88-32f343fe12d4
  
[0m22:34:15.087034 [info ] [MainThread]: 
[0m22:34:15.090515 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m22:34:15.093739 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 21.4176, "process_user_time": 8.962237, "process_kernel_time": 0.65298, "process_mem_max_rss": "200240", "process_in_blocks": "1144", "process_out_blocks": "3008", "command_success": false}
[0m22:34:15.096185 [debug] [MainThread]: Command `dbt build` failed at 22:34:15.095420 after 21.42 seconds
[0m22:34:15.098683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d8a90740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c97f74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c9027ad0>]}
[0m22:34:15.101060 [debug] [MainThread]: Flushing usage events
[0m22:35:01.785246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e331af1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e333a20c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e3346e5a0>]}


============================== 22:35:01.791263 | b7d0d21c-fdd5-42f3-adba-f2084c2b12ce ==============================
[0m22:35:01.791263 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:35:01.793330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:35:03.609371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7d0d21c-fdd5-42f3-adba-f2084c2b12ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e243f5160>]}
[0m22:35:03.916361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7d0d21c-fdd5-42f3-adba-f2084c2b12ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e253f8170>]}
[0m22:35:03.917881 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:35:03.937003 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:35:04.036612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:35:04.038497 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/sources.yml
[0m22:35:04.418571 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:35:04.876861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7d0d21c-fdd5-42f3-adba-f2084c2b12ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e243db1a0>]}
[0m22:35:04.893292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7d0d21c-fdd5-42f3-adba-f2084c2b12ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e24130320>]}
[0m22:35:04.894478 [info ] [MainThread]: Found 6 models, 3 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:35:04.898188 [info ] [MainThread]: 
[0m22:35:04.900250 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:35:04.904277 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:35:04.905512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:05.499072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:35:05.500236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:35:06.124887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7d0d21c-fdd5-42f3-adba-f2084c2b12ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2364f770>]}
[0m22:35:06.127165 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:35:06.128371 [info ] [MainThread]: 
[0m22:35:06.133237 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:35:06.136020 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m22:35:06.138376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m22:35:06.139676 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:35:06.157810 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:35:06.163267 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 22:35:06.140434 => 22:35:06.160269
[0m22:35:06.165266 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:35:06.284045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:06.840194 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:35:06.842119 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:35:07.077460 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:bf99bf40-333c-440b-91af-c74461137d9a&page=queryresults
[0m22:35:09.014628 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 22:35:06.166915 => 22:35:09.013485
[0m22:35:09.017982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d0d21c-fdd5-42f3-adba-f2084c2b12ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e240dd370>]}
[0m22:35:09.019951 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.88s]
[0m22:35:09.022405 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:35:09.023802 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:35:09.025720 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [RUN]
[0m22:35:09.030209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_count_vs_average_per_base, now model.uber_transformations.pickup_percentile_by_base_per_month)
[0m22:35:09.032590 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:35:09.041687 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:35:09.050507 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (compile): 22:35:09.035353 => 22:35:09.047852
[0m22:35:09.053800 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:35:09.068183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:09.863053 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:35:09.865601 [debug] [Thread-1 (]: On model.uber_transformations.pickup_percentile_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_percentile_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m22:35:10.061799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:cda027d3-9058-4c0d-9dc3-4cb352ca3934&page=queryresults
[0m22:35:14.342106 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (execute): 22:35:09.056706 => 22:35:14.341322
[0m22:35:14.344892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d0d21c-fdd5-42f3-adba-f2084c2b12ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e24085cd0>]}
[0m22:35:14.346760 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 5.32s]
[0m22:35:14.348955 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:35:14.350476 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:35:14.351999 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [RUN]
[0m22:35:14.354556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_percentile_by_base_per_month, now model.uber_transformations.top_3_base_names_by_total_pickups)
[0m22:35:14.356620 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:35:14.364130 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:35:14.367285 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (compile): 22:35:14.357870 => 22:35:14.365821
[0m22:35:14.369260 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:35:14.383783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:14.917175 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:35:14.919465 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_by_total_pickups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_by_total_pickups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:35:15.107345 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:025da812-c6aa-4bdf-9aec-bae1f3c12147&page=queryresults
[0m22:35:16.976672 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (execute): 22:35:14.370407 => 22:35:16.976165
[0m22:35:16.979522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d0d21c-fdd5-42f3-adba-f2084c2b12ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e23f945f0>]}
[0m22:35:16.982419 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.63s]
[0m22:35:16.986273 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:35:16.988902 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:35:16.992397 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_pickup_dates_per_base ..... [RUN]
[0m22:35:16.997171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_by_total_pickups, now model.uber_transformations.top_3_pickup_dates_per_base)
[0m22:35:17.000742 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:35:17.008888 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:35:17.012817 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (compile): 22:35:17.002655 => 22:35:17.011085
[0m22:35:17.015049 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:35:17.029518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:17.549056 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:35:17.550552 [debug] [Thread-1 (]: On model.uber_transformations.top_3_pickup_dates_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_pickup_dates_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:35:17.791932 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:cab17f69-b273-4b0c-a734-bf5263c658ae&page=queryresults
[0m22:35:19.626247 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (execute): 22:35:17.016873 => 22:35:19.625745
[0m22:35:19.629697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d0d21c-fdd5-42f3-adba-f2084c2b12ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e23f95310>]}
[0m22:35:19.632624 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_pickup_dates_per_base  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.63s]
[0m22:35:19.636035 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:35:19.638467 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:35:19.641925 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_pickups_in_may_by_base .... [RUN]
[0m22:35:19.646963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_pickup_dates_per_base, now model.uber_transformations.total_pickups_in_may_by_base)
[0m22:35:19.649520 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_pickups_in_may_by_base
[0m22:35:19.663334 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:35:19.666161 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (compile): 22:35:19.652312 => 22:35:19.665121
[0m22:35:19.668103 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_pickups_in_may_by_base
[0m22:35:19.727442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:20.246222 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:35:20.247931 [debug] [Thread-1 (]: On model.uber_transformations.total_pickups_in_may_by_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_pickups_in_may_by_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:35:20.442160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:94fd8b15-9721-49f0-a1c2-b6f9c2e86a67&page=queryresults
[0m22:35:22.013526 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (execute): 22:35:19.669513 => 22:35:22.012264
[0m22:35:22.015767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d0d21c-fdd5-42f3-adba-f2084c2b12ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e23515430>]}
[0m22:35:22.017063 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_pickups_in_may_by_base  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.37s]
[0m22:35:22.018656 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:35:22.019743 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:35:22.020970 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:35:22.022629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_pickups_in_may_by_base, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:35:22.023994 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:35:22.031723 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:35:22.033246 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:35:22.025053 => 22:35:22.032659
[0m22:35:22.034238 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:35:22.041625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:22.579351 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:35:22.580902 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM `airbyte_uber_data`.`source`.`raw_data_janjune_15` AS raw
JOIN `airbyte_uber_data`.`source`.`base_num_and_name` AS base ON base.base_num = raw.affiliated_base_num
JOIN `airbyte_uber_data`.`source`.`taxi_zone_lookup` AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:35:22.686402 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:61b0436b-ad98-49e4-8ea0-8383ec817a2e&page=queryresults
[0m22:35:22.687669 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid project ID 'airbyte_uber_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.; reason: invalid, location: airbyte_uber_data.source.base_num_and_name, message: Invalid project ID 'airbyte_uber_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m22:35:23.813289 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:18306e5d-fdad-4baa-a18e-34b9928b8c96&page=queryresults
[0m22:35:23.816330 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:18306e5d-fdad-4baa-a18e-34b9928b8c96&page=queryresults
[0m22:35:23.820241 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:35:22.035114 => 22:35:23.818923
[0m22:35:23.847046 [debug] [Thread-1 (]: Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Invalid project ID 'airbyte_uber_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:35:23.849074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d0d21c-fdd5-42f3-adba-f2084c2b12ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e23515430>]}
[0m22:35:23.851648 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[31mERROR[0m in 1.83s]
[0m22:35:23.854546 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:35:23.859884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:35:23.861450 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:35:23.863024 [info ] [MainThread]: 
[0m22:35:23.864870 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 18.96 seconds (18.96s).
[0m22:35:23.871005 [debug] [MainThread]: Command end result
[0m22:35:23.895333 [info ] [MainThread]: 
[0m22:35:23.897075 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:35:23.898716 [info ] [MainThread]: 
[0m22:35:23.900385 [error] [MainThread]:   Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Invalid project ID 'airbyte_uber_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:35:23.902398 [info ] [MainThread]: 
[0m22:35:23.904136 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m22:35:23.907142 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 22.245785, "process_user_time": 10.257338, "process_kernel_time": 0.699863, "process_mem_max_rss": "198464", "process_out_blocks": "3008", "command_success": false, "process_in_blocks": "0"}
[0m22:35:23.909678 [debug] [MainThread]: Command `dbt build` failed at 22:35:23.908996 after 22.25 seconds
[0m22:35:23.911485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e3328fa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e24cd6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e331d4380>]}
[0m22:35:23.913255 [debug] [MainThread]: Flushing usage events
[0m22:35:51.045181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda3626ccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda36058470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda36862ab0>]}


============================== 22:35:51.050211 | 5ee15932-8435-4e9e-9447-ee25786041e4 ==============================
[0m22:35:51.050211 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:35:51.051635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:35:53.707241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ee15932-8435-4e9e-9447-ee25786041e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda273c6840>]}
[0m22:35:54.015553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ee15932-8435-4e9e-9447-ee25786041e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda270f0590>]}
[0m22:35:54.016976 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:35:54.033378 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:35:54.114978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:35:54.116453 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/sources.yml
[0m22:35:54.484416 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:35:54.889443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ee15932-8435-4e9e-9447-ee25786041e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda26ee7860>]}
[0m22:35:54.908566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ee15932-8435-4e9e-9447-ee25786041e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda2719ecf0>]}
[0m22:35:54.910558 [info ] [MainThread]: Found 6 models, 3 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:35:54.916073 [info ] [MainThread]: 
[0m22:35:54.919687 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:35:54.925293 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:35:54.927449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:55.532631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:35:55.533743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:35:56.078905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ee15932-8435-4e9e-9447-ee25786041e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda2719ec90>]}
[0m22:35:56.082393 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:35:56.084796 [info ] [MainThread]: 
[0m22:35:56.111477 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:35:56.115666 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m22:35:56.126583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m22:35:56.129144 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:35:56.163763 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:35:56.177469 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 22:35:56.132969 => 22:35:56.172461
[0m22:35:56.180653 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:35:56.314579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:57.208424 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:35:57.211101 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:35:57.369124 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m22:35:57.425501 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:50c25b3e-d913-44f9-9ae4-0d5c346796f5&page=queryresults
[0m22:35:59.356842 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 22:35:56.182461 => 22:35:59.356329
[0m22:35:59.358722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee15932-8435-4e9e-9447-ee25786041e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda27321970>]}
[0m22:35:59.360093 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.24s]
[0m22:35:59.361842 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:35:59.362884 [info ] [MainThread]: 
[0m22:35:59.363979 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m22:35:59.365013 [info ] [MainThread]: 
[0m22:35:59.366174 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m22:35:59.367975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:35:59.369661 [debug] [MainThread]: Connection 'model.uber_transformations.pickup_count_vs_average_per_base' was properly closed.
[0m22:35:59.371399 [info ] [MainThread]: 
[0m22:35:59.373257 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m22:35:59.375651 [error] [MainThread]: Encountered an error:

[0m22:35:59.454863 [error] [MainThread]: Traceback (most recent call last):
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/cli/main.py", line 220, in build
    results = task.run()
              ^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/home/kimiko/miniconda3/envs/uber_data_pipeline_env/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m22:35:59.463780 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.546365, "process_user_time": 9.123633, "process_kernel_time": 0.669107, "process_mem_max_rss": "193416", "process_in_blocks": "272", "process_out_blocks": "1944", "command_success": false}
[0m22:35:59.468319 [debug] [MainThread]: Command `dbt build` failed at 22:35:59.466810 after 8.55 seconds
[0m22:35:59.475485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda36862630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda27388f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda271f7830>]}
[0m22:35:59.479898 [debug] [MainThread]: Flushing usage events
[0m22:36:14.680735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f5a78a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f6282810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f6282b10>]}


============================== 22:36:14.686067 | 605c8e0b-51aa-48eb-9029-39a4b064728f ==============================
[0m22:36:14.686067 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:36:14.687458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m22:36:16.293549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '605c8e0b-51aa-48eb-9029-39a4b064728f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e828bc50>]}
[0m22:36:16.617028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '605c8e0b-51aa-48eb-9029-39a4b064728f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f5aa0fe0>]}
[0m22:36:16.618544 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:36:16.634824 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:36:16.728403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:36:16.729791 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/sources.yml
[0m22:36:17.105733 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:36:17.511019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '605c8e0b-51aa-48eb-9029-39a4b064728f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e68dc7a0>]}
[0m22:36:17.527045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '605c8e0b-51aa-48eb-9029-39a4b064728f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e6b6b8f0>]}
[0m22:36:17.528149 [info ] [MainThread]: Found 6 models, 3 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:36:17.531529 [info ] [MainThread]: 
[0m22:36:17.533375 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:36:17.537214 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:36:17.538720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:18.114502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:36:18.115677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:36:18.592717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '605c8e0b-51aa-48eb-9029-39a4b064728f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e6b6bb90>]}
[0m22:36:18.594558 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:36:18.595667 [info ] [MainThread]: 
[0m22:36:18.600216 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:36:18.602072 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m22:36:18.604006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m22:36:18.605221 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:36:18.623419 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:36:18.626524 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 22:36:18.606031 => 22:36:18.625506
[0m22:36:18.627912 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:36:18.699690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:19.236345 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:36:19.238420 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:36:19.464374 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:5b269e10-46c7-43e7-a68b-3a63d804e31c&page=queryresults
[0m22:36:21.359101 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 22:36:18.628677 => 22:36:21.358511
[0m22:36:21.361390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '605c8e0b-51aa-48eb-9029-39a4b064728f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e69749b0>]}
[0m22:36:21.362863 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.76s]
[0m22:36:21.364773 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:36:21.366136 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:36:21.367641 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [RUN]
[0m22:36:21.369386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_count_vs_average_per_base, now model.uber_transformations.pickup_percentile_by_base_per_month)
[0m22:36:21.370551 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:36:21.375238 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:36:21.378270 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (compile): 22:36:21.371356 => 22:36:21.377029
[0m22:36:21.380480 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:36:21.389335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:21.920935 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:36:21.922826 [debug] [Thread-1 (]: On model.uber_transformations.pickup_percentile_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_percentile_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m22:36:22.127860 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:d6546c0d-0375-4f0e-959c-701ea389e0e7&page=queryresults
[0m22:36:26.083857 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (execute): 22:36:21.381936 => 22:36:26.083357
[0m22:36:26.086002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '605c8e0b-51aa-48eb-9029-39a4b064728f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e6a1e1b0>]}
[0m22:36:26.087379 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 4.72s]
[0m22:36:26.089038 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:36:26.090121 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:36:26.091473 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [RUN]
[0m22:36:26.093215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_percentile_by_base_per_month, now model.uber_transformations.top_3_base_names_by_total_pickups)
[0m22:36:26.095159 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:36:26.103201 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:36:26.106430 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (compile): 22:36:26.096599 => 22:36:26.105254
[0m22:36:26.108389 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:36:26.119496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:26.675109 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:36:26.677589 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_by_total_pickups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_by_total_pickups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:36:26.855858 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:7dd19395-86fe-41cc-9301-6483b12ac176&page=queryresults
[0m22:36:28.706530 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (execute): 22:36:26.109580 => 22:36:28.706033
[0m22:36:28.708314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '605c8e0b-51aa-48eb-9029-39a4b064728f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e5f81940>]}
[0m22:36:28.709672 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.62s]
[0m22:36:28.711523 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:36:28.712815 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:36:28.714254 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_pickup_dates_per_base ..... [RUN]
[0m22:36:28.717290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_by_total_pickups, now model.uber_transformations.top_3_pickup_dates_per_base)
[0m22:36:28.719731 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:36:28.727365 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:36:28.730239 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (compile): 22:36:28.721230 => 22:36:28.729143
[0m22:36:28.732140 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:36:28.749080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:29.277238 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:36:29.278997 [debug] [Thread-1 (]: On model.uber_transformations.top_3_pickup_dates_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_pickup_dates_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:36:29.477653 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b6e12172-1b90-447a-a409-9c59678b9ac0&page=queryresults
[0m22:36:31.380234 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (execute): 22:36:28.733396 => 22:36:31.379674
[0m22:36:31.382427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '605c8e0b-51aa-48eb-9029-39a4b064728f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e6b69970>]}
[0m22:36:31.383887 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_pickup_dates_per_base  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.67s]
[0m22:36:31.385839 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:36:31.387442 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:36:31.389081 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_pickups_in_may_by_base .... [RUN]
[0m22:36:31.392441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_pickup_dates_per_base, now model.uber_transformations.total_pickups_in_may_by_base)
[0m22:36:31.393746 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_pickups_in_may_by_base
[0m22:36:31.398420 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:36:31.400492 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (compile): 22:36:31.394572 => 22:36:31.399633
[0m22:36:31.401751 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_pickups_in_may_by_base
[0m22:36:31.449230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:31.948550 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:36:31.950334 [debug] [Thread-1 (]: On model.uber_transformations.total_pickups_in_may_by_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_pickups_in_may_by_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:36:32.142517 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:16f36954-53c5-4367-99bd-2ff322906321&page=queryresults
[0m22:36:33.707741 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (execute): 22:36:31.402640 => 22:36:33.706811
[0m22:36:33.709525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '605c8e0b-51aa-48eb-9029-39a4b064728f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e5fb57f0>]}
[0m22:36:33.710831 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_pickups_in_may_by_base  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.32s]
[0m22:36:33.712456 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:36:33.713564 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:36:33.715049 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:36:33.717035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_pickups_in_may_by_base, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:36:33.718996 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:36:33.727560 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:36:33.729390 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:36:33.720045 => 22:36:33.728585
[0m22:36:33.730696 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:36:33.739165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:34.215579 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:36:34.217218 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM `uber-data-pipeline-417021.airbyte_uber_data`.`source`.`raw_data_janjune_15` AS raw
JOIN `uber-data-pipeline-417021.airbyte_uber_data`.`source`.`base_num_and_name` AS base ON base.base_num = raw.affiliated_base_num
JOIN `uber-data-pipeline-417021.airbyte_uber_data`.`source`.`taxi_zone_lookup` AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:36:34.324972 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ca0f3d3a-dafa-4a21-bbd1-cb990b9a8dbd&page=queryresults
[0m22:36:34.326244 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid project ID 'uber-data-pipeline-417021.airbyte_uber_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.; reason: invalid, location: uber-data-pipeline-417021.airbyte_uber_data.source.base_num_and_name, message: Invalid project ID 'uber-data-pipeline-417021.airbyte_uber_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m22:36:34.606329 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4dc7c03b-e374-4c3f-a4e7-10d0558b1910&page=queryresults
[0m22:36:34.609175 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4dc7c03b-e374-4c3f-a4e7-10d0558b1910&page=queryresults
[0m22:36:34.612712 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:36:33.732105 => 22:36:34.611454
[0m22:36:34.627808 [debug] [Thread-1 (]: Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Invalid project ID 'uber-data-pipeline-417021.airbyte_uber_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:36:34.629039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '605c8e0b-51aa-48eb-9029-39a4b064728f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e5fb2fc0>]}
[0m22:36:34.630424 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[31mERROR[0m in 0.91s]
[0m22:36:34.632829 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:36:34.646686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:36:34.649285 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:36:34.653657 [info ] [MainThread]: 
[0m22:36:34.659903 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 17.12 seconds (17.12s).
[0m22:36:34.673162 [debug] [MainThread]: Command end result
[0m22:36:34.702366 [info ] [MainThread]: 
[0m22:36:34.704839 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:36:34.710489 [info ] [MainThread]: 
[0m22:36:34.714605 [error] [MainThread]:   Database Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  Invalid project ID 'uber-data-pipeline-417021.airbyte_uber_data'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled Code at target/run/uber_transformations/models/udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:36:34.718904 [info ] [MainThread]: 
[0m22:36:34.721808 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m22:36:34.730732 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 20.16821, "process_user_time": 9.174034, "process_kernel_time": 0.621802, "process_mem_max_rss": "200932", "process_out_blocks": "3008", "command_success": false, "process_in_blocks": "0"}
[0m22:36:34.734365 [debug] [MainThread]: Command `dbt build` failed at 22:36:34.733446 after 20.17 seconds
[0m22:36:34.737004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f9e1f680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e6bc9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e68e6570>]}
[0m22:36:34.739231 [debug] [MainThread]: Flushing usage events
[0m22:36:55.665221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3d94d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3d3a4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3f608170>]}


============================== 22:36:55.670684 | d0980368-c323-4261-8d17-56c3bcc87248 ==============================
[0m22:36:55.670684 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:36:55.672166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:36:57.323732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0980368-c323-4261-8d17-56c3bcc87248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e716e40>]}
[0m22:36:57.612981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0980368-c323-4261-8d17-56c3bcc87248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e812570>]}
[0m22:36:57.614480 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:36:57.630161 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:36:57.725038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:36:57.726584 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/sources.yml
[0m22:36:58.118375 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:36:58.537703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0980368-c323-4261-8d17-56c3bcc87248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e144710>]}
[0m22:36:58.554486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0980368-c323-4261-8d17-56c3bcc87248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e2d4260>]}
[0m22:36:58.556096 [info ] [MainThread]: Found 6 models, 3 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:36:58.560015 [info ] [MainThread]: 
[0m22:36:58.562179 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:36:58.565900 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:36:58.567034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:59.116348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:36:59.117409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:36:59.619240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0980368-c323-4261-8d17-56c3bcc87248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e2d7d70>]}
[0m22:36:59.621055 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:36:59.622121 [info ] [MainThread]: 
[0m22:36:59.626685 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:36:59.628661 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m22:36:59.631811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m22:36:59.633744 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:36:59.664617 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:36:59.668181 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 22:36:59.635095 => 22:36:59.666807
[0m22:36:59.670498 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:36:59.750713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:00.274153 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:37:00.275832 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:37:00.513795 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:21975748-2bf6-4d41-aef1-6c3ec8d73805&page=queryresults
[0m22:37:02.417030 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 22:36:59.672258 => 22:37:02.416506
[0m22:37:02.418991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0980368-c323-4261-8d17-56c3bcc87248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e34e1e0>]}
[0m22:37:02.420352 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.79s]
[0m22:37:02.422293 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:37:02.423676 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:37:02.425132 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [RUN]
[0m22:37:02.427855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_count_vs_average_per_base, now model.uber_transformations.pickup_percentile_by_base_per_month)
[0m22:37:02.429940 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:37:02.437572 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:37:02.440493 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (compile): 22:37:02.431259 => 22:37:02.439403
[0m22:37:02.442475 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:37:02.451762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:02.944761 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:37:02.946327 [debug] [Thread-1 (]: On model.uber_transformations.pickup_percentile_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_percentile_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m22:37:03.170758 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:46575dfd-ff94-476c-9600-94f092bf44e9&page=queryresults
[0m22:37:07.808174 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (execute): 22:37:02.443748 => 22:37:07.807653
[0m22:37:07.810109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0980368-c323-4261-8d17-56c3bcc87248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e34fe00>]}
[0m22:37:07.811487 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 5.38s]
[0m22:37:07.813048 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:37:07.814192 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:37:07.815513 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [RUN]
[0m22:37:07.817302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_percentile_by_base_per_month, now model.uber_transformations.top_3_base_names_by_total_pickups)
[0m22:37:07.818971 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:37:07.822685 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:37:07.824562 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (compile): 22:37:07.819737 => 22:37:07.823834
[0m22:37:07.825757 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:37:07.831094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:08.357320 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:37:08.358821 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_by_total_pickups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_by_total_pickups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:37:08.558933 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:f9597ced-33a5-40c7-bc87-bcd70c193a48&page=queryresults
[0m22:37:10.416331 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (execute): 22:37:07.826411 => 22:37:10.415834
[0m22:37:10.418146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0980368-c323-4261-8d17-56c3bcc87248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e1440b0>]}
[0m22:37:10.419475 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.60s]
[0m22:37:10.421082 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:37:10.422251 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:37:10.425186 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_pickup_dates_per_base ..... [RUN]
[0m22:37:10.430710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_by_total_pickups, now model.uber_transformations.top_3_pickup_dates_per_base)
[0m22:37:10.434540 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:37:10.447045 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:37:10.451500 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (compile): 22:37:10.436845 => 22:37:10.449674
[0m22:37:10.454550 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:37:10.466907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:10.946393 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:37:10.948107 [debug] [Thread-1 (]: On model.uber_transformations.top_3_pickup_dates_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_pickup_dates_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:37:11.206636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:c62f37a5-448e-4cd1-a769-1959affe4fc1&page=queryresults
[0m22:37:13.044038 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (execute): 22:37:10.456408 => 22:37:13.043540
[0m22:37:13.045947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0980368-c323-4261-8d17-56c3bcc87248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e1447d0>]}
[0m22:37:13.047329 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_pickup_dates_per_base  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.62s]
[0m22:37:13.049159 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:37:13.050424 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:37:13.052132 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_pickups_in_may_by_base .... [RUN]
[0m22:37:13.055559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_pickup_dates_per_base, now model.uber_transformations.total_pickups_in_may_by_base)
[0m22:37:13.057328 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_pickups_in_may_by_base
[0m22:37:13.063783 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:37:13.065860 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (compile): 22:37:13.058873 => 22:37:13.065207
[0m22:37:13.067181 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_pickups_in_may_by_base
[0m22:37:13.116544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:13.631181 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:37:13.632867 [debug] [Thread-1 (]: On model.uber_transformations.total_pickups_in_may_by_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_pickups_in_may_by_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:37:13.855848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:913cbcf4-51a3-4cd9-89f0-72de9bb07d3c&page=queryresults
[0m22:37:15.714076 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (execute): 22:37:13.068022 => 22:37:15.713573
[0m22:37:15.716262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0980368-c323-4261-8d17-56c3bcc87248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2d8bdf40>]}
[0m22:37:15.718842 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_pickups_in_may_by_base  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.66s]
[0m22:37:15.721589 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:37:15.723389 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:37:15.724692 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:37:15.727350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_pickups_in_may_by_base, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:37:15.729497 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:37:15.742246 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:37:15.744986 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:37:15.730701 => 22:37:15.743828
[0m22:37:15.747460 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:37:15.756392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:16.243114 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:37:16.244611 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM `uber-data-pipeline-417021`.`source`.`raw_data_janjune_15` AS raw
JOIN `uber-data-pipeline-417021`.`source`.`base_num_and_name` AS base ON base.base_num = raw.affiliated_base_num
JOIN `uber-data-pipeline-417021`.`source`.`taxi_zone_lookup` AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:37:16.689368 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:b8b6cab1-c6ca-4112-a7e3-8ea21ae240af&page=queryresults
[0m22:37:16.692899 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM `uber-data-pipeline-417021`.`source`.`raw_data_janjune_15` AS raw
JOIN `uber-data-pipeline-417021`.`source`.`base_num_and_name` AS base ON base.base_num = raw.affiliated_base_num
JOIN `uber-data-pipeline-417021`.`source`.`taxi_zone_lookup` AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:37:16.694565 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2; reason: notFound, message: Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2

Location: europe-west2
Job ID: b8b6cab1-c6ca-4112-a7e3-8ea21ae240af

[0m22:37:16.696490 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:37:15.749039 => 22:37:16.695737
[0m22:37:16.710638 [debug] [Thread-1 (]: Runtime Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  404 Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2; reason: notFound, message: Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2
  
  Location: europe-west2
  Job ID: b8b6cab1-c6ca-4112-a7e3-8ea21ae240af
  
[0m22:37:16.711803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0980368-c323-4261-8d17-56c3bcc87248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2d8be780>]}
[0m22:37:16.713094 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[31mERROR[0m in 0.99s]
[0m22:37:16.714681 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:37:16.719394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:16.721355 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:37:16.723289 [info ] [MainThread]: 
[0m22:37:16.724865 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 18.16 seconds (18.16s).
[0m22:37:16.728973 [debug] [MainThread]: Command end result
[0m22:37:16.753214 [info ] [MainThread]: 
[0m22:37:16.757384 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:37:16.760063 [info ] [MainThread]: 
[0m22:37:16.765133 [error] [MainThread]:   Runtime Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  404 Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2; reason: notFound, message: Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2
  
  Location: europe-west2
  Job ID: b8b6cab1-c6ca-4112-a7e3-8ea21ae240af
  
[0m22:37:16.769065 [info ] [MainThread]: 
[0m22:37:16.773275 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m22:37:16.776365 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 21.228588, "process_user_time": 9.217346, "process_kernel_time": 0.547179, "process_mem_max_rss": "200808", "process_out_blocks": "3008", "command_success": false, "process_in_blocks": "0"}
[0m22:37:16.779107 [debug] [MainThread]: Command `dbt build` failed at 22:37:16.778322 after 21.23 seconds
[0m22:37:16.781486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3d94d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e1e4e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e567cb0>]}
[0m22:37:16.783724 [debug] [MainThread]: Flushing usage events
[0m22:38:04.463514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4137548c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe413f5aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe413f5a720>]}


============================== 22:38:04.468542 | 9e0d9bc5-014a-4d0f-b76d-77672bf8627f ==============================
[0m22:38:04.468542 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:38:04.470029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:38:06.048505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e0d9bc5-014a-4d0f-b76d-77672bf8627f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe404a5eed0>]}
[0m22:38:06.353852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e0d9bc5-014a-4d0f-b76d-77672bf8627f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe413779970>]}
[0m22:38:06.355360 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:38:06.372354 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:38:06.458656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:38:06.460055 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/sources.yml
[0m22:38:06.819923 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:38:07.214628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e0d9bc5-014a-4d0f-b76d-77672bf8627f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40451ea20>]}
[0m22:38:07.231044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e0d9bc5-014a-4d0f-b76d-77672bf8627f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4046b0410>]}
[0m22:38:07.232117 [info ] [MainThread]: Found 6 models, 3 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:38:07.235641 [info ] [MainThread]: 
[0m22:38:07.237746 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:38:07.241620 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:38:07.242731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:07.783301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:38:07.784439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:38:08.253194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e0d9bc5-014a-4d0f-b76d-77672bf8627f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ffbaf320>]}
[0m22:38:08.255071 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:38:08.256107 [info ] [MainThread]: 
[0m22:38:08.260619 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:38:08.262710 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m22:38:08.265007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m22:38:08.266251 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:38:08.281213 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:38:08.286256 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 22:38:08.267004 => 22:38:08.283151
[0m22:38:08.290090 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:38:08.368268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:08.926653 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:38:08.928420 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:38:09.140123 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:afe72a28-5ceb-470e-80ae-24e33a3a2252&page=queryresults
[0m22:38:11.016499 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 22:38:08.291385 => 22:38:11.015980
[0m22:38:11.018335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e0d9bc5-014a-4d0f-b76d-77672bf8627f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40465cbc0>]}
[0m22:38:11.019700 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.75s]
[0m22:38:11.021350 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:38:11.022508 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:38:11.024152 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [RUN]
[0m22:38:11.026505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_count_vs_average_per_base, now model.uber_transformations.pickup_percentile_by_base_per_month)
[0m22:38:11.027918 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:38:11.032566 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:38:11.034692 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (compile): 22:38:11.028659 => 22:38:11.033728
[0m22:38:11.035912 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:38:11.040867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:11.524522 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:38:11.526211 [debug] [Thread-1 (]: On model.uber_transformations.pickup_percentile_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_percentile_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m22:38:11.766763 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ce6e8310-f0c4-46bb-905b-16c872d52fa9&page=queryresults
[0m22:38:15.430677 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (execute): 22:38:11.036610 => 22:38:15.430129
[0m22:38:15.432661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e0d9bc5-014a-4d0f-b76d-77672bf8627f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe404527c20>]}
[0m22:38:15.434011 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 4.41s]
[0m22:38:15.435665 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:38:15.436807 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:38:15.438120 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [RUN]
[0m22:38:15.440035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_percentile_by_base_per_month, now model.uber_transformations.top_3_base_names_by_total_pickups)
[0m22:38:15.442033 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:38:15.446773 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:38:15.449371 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (compile): 22:38:15.442991 => 22:38:15.448234
[0m22:38:15.450823 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:38:15.456850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:15.957316 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:38:15.959051 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_by_total_pickups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_by_total_pickups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:38:16.189485 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:ca1d6f54-f945-4dea-bc7a-fb0b02c92dc8&page=queryresults
[0m22:38:18.036188 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (execute): 22:38:15.451641 => 22:38:18.035688
[0m22:38:18.038041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e0d9bc5-014a-4d0f-b76d-77672bf8627f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ffa3a120>]}
[0m22:38:18.039396 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.60s]
[0m22:38:18.041010 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:38:18.042178 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:38:18.043683 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_pickup_dates_per_base ..... [RUN]
[0m22:38:18.045421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_by_total_pickups, now model.uber_transformations.top_3_pickup_dates_per_base)
[0m22:38:18.047079 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:38:18.053957 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:38:18.056867 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (compile): 22:38:18.048500 => 22:38:18.055765
[0m22:38:18.058957 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:38:18.067977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:18.549887 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:38:18.551628 [debug] [Thread-1 (]: On model.uber_transformations.top_3_pickup_dates_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_pickup_dates_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:38:18.725829 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:847cd9f8-dfe6-4830-8dd9-311a6e1ef0d5&page=queryresults
[0m22:38:20.838330 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (execute): 22:38:18.060216 => 22:38:20.837100
[0m22:38:20.842456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e0d9bc5-014a-4d0f-b76d-77672bf8627f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40451dee0>]}
[0m22:38:20.844573 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_pickup_dates_per_base  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.80s]
[0m22:38:20.846931 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:38:20.848758 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:38:20.850585 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_pickups_in_may_by_base .... [RUN]
[0m22:38:20.853951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_pickup_dates_per_base, now model.uber_transformations.total_pickups_in_may_by_base)
[0m22:38:20.855489 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_pickups_in_may_by_base
[0m22:38:20.861577 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:38:20.864293 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (compile): 22:38:20.856256 => 22:38:20.862949
[0m22:38:20.866219 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_pickups_in_may_by_base
[0m22:38:20.929602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:21.439410 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:38:21.441171 [debug] [Thread-1 (]: On model.uber_transformations.total_pickups_in_may_by_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_pickups_in_may_by_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:38:21.635009 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:cccf1370-b463-4fd6-856e-4be30d7ccc08&page=queryresults
[0m22:38:23.211257 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (execute): 22:38:20.867019 => 22:38:23.210080
[0m22:38:23.215200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e0d9bc5-014a-4d0f-b76d-77672bf8627f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe404458a40>]}
[0m22:38:23.218230 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_pickups_in_may_by_base  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.36s]
[0m22:38:23.221798 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:38:23.224390 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:38:23.227861 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:38:23.235669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_pickups_in_may_by_base, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:38:23.240866 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:38:23.255651 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:38:23.259883 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:38:23.242334 => 22:38:23.258400
[0m22:38:23.267020 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:38:23.275974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:23.751869 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:38:23.753608 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM `uber-data-pipeline-417021`.`source`.`raw_data_janjune_15` AS raw
JOIN `uber-data-pipeline-417021`.`source`.`base_num_and_name` AS base ON base.base_num = raw.affiliated_base_num
JOIN `uber-data-pipeline-417021`.`source`.`taxi_zone_lookup` AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:38:24.254971 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:16db19d0-d50d-4ebc-b2e4-f56ac5bb7463&page=queryresults
[0m22:38:24.256318 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM `uber-data-pipeline-417021`.`source`.`raw_data_janjune_15` AS raw
JOIN `uber-data-pipeline-417021`.`source`.`base_num_and_name` AS base ON base.base_num = raw.affiliated_base_num
JOIN `uber-data-pipeline-417021`.`source`.`taxi_zone_lookup` AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:38:24.257408 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2; reason: notFound, message: Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2

Location: europe-west2
Job ID: 16db19d0-d50d-4ebc-b2e4-f56ac5bb7463

[0m22:38:24.258796 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:38:23.269280 => 22:38:24.258256
[0m22:38:24.267549 [debug] [Thread-1 (]: Runtime Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  404 Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2; reason: notFound, message: Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2
  
  Location: europe-west2
  Job ID: 16db19d0-d50d-4ebc-b2e4-f56ac5bb7463
  
[0m22:38:24.268680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e0d9bc5-014a-4d0f-b76d-77672bf8627f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ffa70d70>]}
[0m22:38:24.269959 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[31mERROR[0m in 1.04s]
[0m22:38:24.272020 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:38:24.277248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:38:24.279087 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:38:24.280794 [info ] [MainThread]: 
[0m22:38:24.282460 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 17.04 seconds (17.04s).
[0m22:38:24.288014 [debug] [MainThread]: Command end result
[0m22:38:24.312105 [info ] [MainThread]: 
[0m22:38:24.319116 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:38:24.321689 [info ] [MainThread]: 
[0m22:38:24.324683 [error] [MainThread]:   Runtime Error in model unter_grun_pickups_in_bronx (models/udp_transf/unter_grun_pickups_in_bronx.sql)
  404 Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2; reason: notFound, message: Not found: Dataset uber-data-pipeline-417021:source was not found in location europe-west2
  
  Location: europe-west2
  Job ID: 16db19d0-d50d-4ebc-b2e4-f56ac5bb7463
  
[0m22:38:24.328784 [info ] [MainThread]: 
[0m22:38:24.333558 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m22:38:24.338295 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 19.992016, "process_user_time": 8.984408, "process_kernel_time": 0.672859, "process_mem_max_rss": "200512", "process_out_blocks": "3008", "command_success": false, "process_in_blocks": "0"}
[0m22:38:24.339768 [debug] [MainThread]: Command `dbt build` failed at 22:38:24.339303 after 19.99 seconds
[0m22:38:24.342012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe413991670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ffb2e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40497c1d0>]}
[0m22:38:24.344345 [debug] [MainThread]: Flushing usage events
[0m22:39:22.166926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93afa41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93b7b6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93afa4080>]}


============================== 22:39:22.171943 | 710bbf48-fc04-4b33-a1f8-3d4521ce0744 ==============================
[0m22:39:22.171943 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:39:22.173336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'debug': 'False', 'profiles_dir': '/home/kimiko/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:39:23.759677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '710bbf48-fc04-4b33-a1f8-3d4521ce0744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92c7d2f90>]}
[0m22:39:24.075892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '710bbf48-fc04-4b33-a1f8-3d4521ce0744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93afa4230>]}
[0m22:39:24.077398 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:39:24.100989 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:39:24.181312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:39:24.182807 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/sources.yml
[0m22:39:24.543716 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/unter_grun_pickups_in_bronx.sql
[0m22:39:24.945023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '710bbf48-fc04-4b33-a1f8-3d4521ce0744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92bde6f90>]}
[0m22:39:24.961928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '710bbf48-fc04-4b33-a1f8-3d4521ce0744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92c01cdd0>]}
[0m22:39:24.963007 [info ] [MainThread]: Found 6 models, 3 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:39:24.966739 [info ] [MainThread]: 
[0m22:39:24.968564 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:39:24.972366 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:39:24.974369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:25.545918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:39:25.547096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:39:26.041259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '710bbf48-fc04-4b33-a1f8-3d4521ce0744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92c01ffb0>]}
[0m22:39:26.043028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:39:26.044050 [info ] [MainThread]: 
[0m22:39:26.048672 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:39:26.050676 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m22:39:26.053838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m22:39:26.055797 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:39:26.087421 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:39:26.093196 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 22:39:26.057044 => 22:39:26.091289
[0m22:39:26.099419 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:39:26.171727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:26.651866 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:39:26.653452 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:39:26.881163 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:6a92063a-2c76-4b62-b23f-0cb93343302c&page=queryresults
[0m22:39:29.073062 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 22:39:26.101694 => 22:39:29.072531
[0m22:39:29.074901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '710bbf48-fc04-4b33-a1f8-3d4521ce0744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92c0cfaa0>]}
[0m22:39:29.076283 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 3.02s]
[0m22:39:29.078015 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:39:29.079158 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:39:29.080459 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [RUN]
[0m22:39:29.082270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_count_vs_average_per_base, now model.uber_transformations.pickup_percentile_by_base_per_month)
[0m22:39:29.084123 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:39:29.088468 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:39:29.090246 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (compile): 22:39:29.085058 => 22:39:29.089598
[0m22:39:29.091430 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:39:29.096940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:29.570730 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:39:29.582065 [debug] [Thread-1 (]: On model.uber_transformations.pickup_percentile_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_percentile_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m22:39:29.767699 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:52458f0d-73af-4ef0-ac71-a0e22698beb8&page=queryresults
[0m22:39:33.724138 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (execute): 22:39:29.092074 => 22:39:33.723606
[0m22:39:33.726158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '710bbf48-fc04-4b33-a1f8-3d4521ce0744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92b45b680>]}
[0m22:39:33.727529 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 4.64s]
[0m22:39:33.729439 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:39:33.730557 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:39:33.731876 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [RUN]
[0m22:39:33.734539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_percentile_by_base_per_month, now model.uber_transformations.top_3_base_names_by_total_pickups)
[0m22:39:33.736357 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:39:33.740108 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:39:33.741673 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (compile): 22:39:33.737040 => 22:39:33.741073
[0m22:39:33.742727 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:39:33.747010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:34.272642 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:39:34.274093 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_by_total_pickups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_by_total_pickups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:39:34.459985 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:dc542921-1fd9-424f-b53b-bc099ad13c79&page=queryresults
[0m22:39:36.069568 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (execute): 22:39:33.743325 => 22:39:36.069073
[0m22:39:36.071375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '710bbf48-fc04-4b33-a1f8-3d4521ce0744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92be92030>]}
[0m22:39:36.072748 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.34s]
[0m22:39:36.074367 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:39:36.075507 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:39:36.076888 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_pickup_dates_per_base ..... [RUN]
[0m22:39:36.080310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_by_total_pickups, now model.uber_transformations.top_3_pickup_dates_per_base)
[0m22:39:36.082413 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:39:36.088130 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:39:36.089915 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (compile): 22:39:36.083861 => 22:39:36.089231
[0m22:39:36.091051 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:39:36.096727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:36.610186 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:39:36.611734 [debug] [Thread-1 (]: On model.uber_transformations.top_3_pickup_dates_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_pickup_dates_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM airbyte_uber_data.raw_data_janjune_15 AS raw
    JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:39:36.806507 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:17bed6b4-4353-44fc-a73c-1940183573b3&page=queryresults
[0m22:39:38.665634 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (execute): 22:39:36.091715 => 22:39:38.665145
[0m22:39:38.667408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '710bbf48-fc04-4b33-a1f8-3d4521ce0744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92be90890>]}
[0m22:39:38.668787 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_pickup_dates_per_base  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.59s]
[0m22:39:38.670400 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:39:38.671535 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:39:38.672837 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_pickups_in_may_by_base .... [RUN]
[0m22:39:38.674723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_pickup_dates_per_base, now model.uber_transformations.total_pickups_in_may_by_base)
[0m22:39:38.676257 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_pickups_in_may_by_base
[0m22:39:38.683806 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:39:38.686665 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (compile): 22:39:38.677646 => 22:39:38.685552
[0m22:39:38.688572 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_pickups_in_may_by_base
[0m22:39:38.745505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:39.294532 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:39:39.296006 [debug] [Thread-1 (]: On model.uber_transformations.total_pickups_in_may_by_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_pickups_in_may_by_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM airbyte_uber_data.raw_data_janjune_15 AS raw
JOIN airbyte_uber_data.base_num_and_name AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:39:39.534313 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:a73b1472-2947-49bb-a428-3616b39a59a4&page=queryresults
[0m22:39:41.078277 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (execute): 22:39:38.689684 => 22:39:41.077769
[0m22:39:41.079984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '710bbf48-fc04-4b33-a1f8-3d4521ce0744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92b2bf1a0>]}
[0m22:39:41.081322 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_pickups_in_may_by_base  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.41s]
[0m22:39:41.082913 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:39:41.084013 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:39:41.085240 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:39:41.086888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_pickups_in_may_by_base, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:39:41.088280 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:39:41.096226 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:39:41.098040 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:39:41.089431 => 22:39:41.097228
[0m22:39:41.099137 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:39:41.107025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:41.570365 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:39:41.572372 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw
JOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.affiliated_base_num
JOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`taxi_zone_lookup` AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:39:41.789153 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:3884c958-e298-4bd4-acd4-0ce060e7aabd&page=queryresults
[0m22:39:43.366425 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:39:41.099916 => 22:39:43.365909
[0m22:39:43.368306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '710bbf48-fc04-4b33-a1f8-3d4521ce0744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92b2bed80>]}
[0m22:39:43.370084 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.28s]
[0m22:39:43.371807 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:39:43.375066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:39:43.376002 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:39:43.377417 [info ] [MainThread]: 
[0m22:39:43.379100 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 18.41 seconds (18.41s).
[0m22:39:43.382987 [debug] [MainThread]: Command end result
[0m22:39:43.401373 [info ] [MainThread]: 
[0m22:39:43.402717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:39:43.404088 [info ] [MainThread]: 
[0m22:39:43.410238 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:39:43.414957 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 21.365917, "process_user_time": 8.930515, "process_kernel_time": 0.682252, "process_mem_max_rss": "197980", "process_out_blocks": "3000", "process_in_blocks": "0"}
[0m22:39:43.419968 [debug] [MainThread]: Command `dbt build` succeeded at 22:39:43.418932 after 21.37 seconds
[0m22:39:43.424655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93b19de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92d5fa6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92b2d1a60>]}
[0m22:39:43.428914 [debug] [MainThread]: Flushing usage events
[0m22:43:24.665469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bed14cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bebc28560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2beb8f0260>]}


============================== 22:43:24.686972 | 09ccee7d-6f4a-4122-a922-7eceeff9e6a9 ==============================
[0m22:43:24.686972 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:43:24.688422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kimiko/.dbt', 'log_path': '/home/kimiko/Desktop/Uber_Data_Pipeline/uber_transformations/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:26.820604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09ccee7d-6f4a-4122-a922-7eceeff9e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdc9de0c0>]}
[0m22:43:27.106344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09ccee7d-6f4a-4122-a922-7eceeff9e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdc6c4a10>]}
[0m22:43:27.107942 [info ] [MainThread]: Registered adapter: bigquery=1.7.6
[0m22:43:27.124380 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:43:27.284206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m22:43:27.285506 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/total_pickups_in_may_by_base.sql
[0m22:43:27.286585 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_pickup_dates_per_base.sql
[0m22:43:27.287671 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/top_3_base_names_by_total_pickups.sql
[0m22:43:27.288774 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/pickup_percentile_by_base_per_month.sql
[0m22:43:27.289870 [debug] [MainThread]: Partial parsing: updated file: uber_transformations://models/udp_transf/pickup_count_vs_average_per_base.sql
[0m22:43:27.645771 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/total_pickups_in_may_by_base.sql
[0m22:43:27.683484 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/top_3_pickup_dates_per_base.sql
[0m22:43:27.689977 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/top_3_base_names_by_total_pickups.sql
[0m22:43:27.696546 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/pickup_percentile_by_base_per_month.sql
[0m22:43:27.703282 [debug] [MainThread]: 1699: static parser successfully parsed udp_transf/pickup_count_vs_average_per_base.sql
[0m22:43:27.727666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09ccee7d-6f4a-4122-a922-7eceeff9e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdc3fbdd0>]}
[0m22:43:27.744026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09ccee7d-6f4a-4122-a922-7eceeff9e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdc71af90>]}
[0m22:43:27.745207 [info ] [MainThread]: Found 6 models, 3 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m22:43:27.748634 [info ] [MainThread]: 
[0m22:43:27.750459 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:43:27.754364 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-pipeline-417021'
[0m22:43:27.755828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:28.381601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021, now list_uber-data-pipeline-417021_airbyte_uber_data)
[0m22:43:28.382777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:28.878080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09ccee7d-6f4a-4122-a922-7eceeff9e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdc392840>]}
[0m22:43:28.879819 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:43:28.880896 [info ] [MainThread]: 
[0m22:43:28.905315 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:43:28.909302 [info ] [Thread-1 (]: 1 of 6 START sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [RUN]
[0m22:43:28.916789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-pipeline-417021_airbyte_uber_data, now model.uber_transformations.pickup_count_vs_average_per_base)
[0m22:43:28.919378 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:43:28.963531 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:43:28.991961 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (compile): 22:43:28.922683 => 22:43:28.986473
[0m22:43:29.001110 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:43:29.048620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:29.594356 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_count_vs_average_per_base"
[0m22:43:29.597998 [debug] [Thread-1 (]: On model.uber_transformations.pickup_count_vs_average_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_count_vs_average_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_count_vs_average_per_base`
      
    
    

    OPTIONS()
    as (
      -- How does the pickup count (per month) for each base compare with the average pickup per month count across all bases?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw
    JOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.dispatching_base_num
),

monthly_counts_and_avg AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num,
           month_extract.Month AS `Month`,
           COUNT(*) AS `Monthly Count`,
           AVG(COUNT(*)) OVER (PARTITION BY month_extract.month) AS `Average for Month`
    FROM month_extract
    GROUP BY month_extract.`Dispatching Base Name`, month_extract.Month, month_extract.month_num
)

SELECT monthly_counts_and_avg.`Dispatching Base Name` AS `Dispatching Base Name`,
       monthly_counts_and_avg.month,
       monthly_counts_and_avg.`Monthly Count`,
       monthly_counts_and_avg.`Average for Month`,
       ((monthly_counts_and_avg.`Monthly Count` / monthly_counts_and_avg.`Average for Month`) - 1) * 100 AS `Percentage Difference`
FROM monthly_counts_and_avg
ORDER BY monthly_counts_and_avg.month_num ASC, monthly_counts_and_avg.`Monthly Count` DESC
    );
  
[0m22:43:29.829173 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:87111c9e-9edb-4b42-9f49-204a9703f956&page=queryresults
[0m22:43:31.808522 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_count_vs_average_per_base (execute): 22:43:29.003005 => 22:43:31.807996
[0m22:43:31.810357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09ccee7d-6f4a-4122-a922-7eceeff9e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdbc9b440>]}
[0m22:43:31.811813 [info ] [Thread-1 (]: 1 of 6 OK created sql table model airbyte_uber_data.pickup_count_vs_average_per_base  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 2.90s]
[0m22:43:31.813476 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_count_vs_average_per_base
[0m22:43:31.814622 [debug] [Thread-1 (]: Began running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:43:31.816020 [info ] [Thread-1 (]: 2 of 6 START sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [RUN]
[0m22:43:31.817882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_count_vs_average_per_base, now model.uber_transformations.pickup_percentile_by_base_per_month)
[0m22:43:31.819756 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:43:31.832131 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:43:31.835059 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (compile): 22:43:31.821138 => 22:43:31.833856
[0m22:43:31.836973 [debug] [Thread-1 (]: Began executing node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:43:31.845130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:32.336031 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.pickup_percentile_by_base_per_month"
[0m22:43:32.337890 [debug] [Thread-1 (]: On model.uber_transformations.pickup_percentile_by_base_per_month: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.pickup_percentile_by_base_per_month"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`pickup_percentile_by_base_per_month`
      
    
    

    OPTIONS()
    as (
      -- Determine the percentile of each base number based on the total number of pickups per month in the raw_data_janjune_15 table?

WITH month_extract AS (
    SELECT base.base_name AS `Dispatching Base Name`,
           EXTRACT(MONTH FROM raw.pickup_date) AS `Month_num`,
           CASE
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM raw.pickup_date) = 6 THEN 'June'
            END AS `Month`
    FROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw
    JOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.dispatching_base_num
),

counting_cte AS (
    SELECT month_extract.`Dispatching Base Name` AS `Dispatching Base Name`,
           month_extract.month_num AS month_num,
           month_extract.month AS `Month`,
           COUNT(*) AS `Count per Base per Month`,
           (SELECT COUNT(*) FROM month_extract AS sub WHERE sub.month = month_extract.month) AS `Count per Month`
    FROM month_extract
    GROUP BY month_extract.month, month_extract.`Dispatching Base Name`, month_extract.month_num
)

SELECT counting_cte.`Dispatching Base Name`,
       counting_cte.month,
       counting_cte.`Count per Base per Month`,
       (counting_cte.`Count per Base per Month` / counting_cte.`Count per Month`) * 100 AS `Percentile of Pick Ups`
FROM counting_cte
ORDER BY counting_cte.month_num ASC, counting_cte.`Count per Base per Month` DESC
    );
  
[0m22:43:32.549262 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:92778109-ca44-4cab-a93e-6ce052f09079&page=queryresults
[0m22:43:36.846698 [debug] [Thread-1 (]: Timing info for model.uber_transformations.pickup_percentile_by_base_per_month (execute): 22:43:31.838140 => 22:43:36.846187
[0m22:43:36.848586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09ccee7d-6f4a-4122-a922-7eceeff9e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdc4e5820>]}
[0m22:43:36.849955 [info ] [Thread-1 (]: 2 of 6 OK created sql table model airbyte_uber_data.pickup_percentile_by_base_per_month  [[32mCREATE TABLE (38.0 rows, 217.8 MiB processed)[0m in 5.03s]
[0m22:43:36.851737 [debug] [Thread-1 (]: Finished running node model.uber_transformations.pickup_percentile_by_base_per_month
[0m22:43:36.852879 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:43:36.854269 [info ] [Thread-1 (]: 3 of 6 START sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [RUN]
[0m22:43:36.856357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.pickup_percentile_by_base_per_month, now model.uber_transformations.top_3_base_names_by_total_pickups)
[0m22:43:36.858502 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:43:36.866796 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:43:36.869132 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (compile): 22:43:36.859619 => 22:43:36.868159
[0m22:43:36.870478 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:43:36.875561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:37.360952 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_base_names_by_total_pickups"
[0m22:43:37.363113 [debug] [Thread-1 (]: On model.uber_transformations.top_3_base_names_by_total_pickups: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_base_names_by_total_pickups"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_base_names_by_total_pickups`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 base numbers along with their associated names from the base_num_and_name table based on the total number of pickups recorded in the raw_data_janjune_15 table.

SELECT base.base_num AS `Dispatching Base Number`,
       base.base_name AS `Base Name`,
       COUNT(raw.pickup_date) AS `Total Number of Pick Ups`
FROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw
JOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.dispatching_base_num
GROUP BY base.base_num, base.base_name
ORDER BY COUNT(raw.pickup_date) DESC
LIMIT 3
    );
  
[0m22:43:37.575485 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:dd48d748-9990-482c-ba5f-ca3de4de74fa&page=queryresults
[0m22:43:39.417313 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_base_names_by_total_pickups (execute): 22:43:36.871284 => 22:43:39.416821
[0m22:43:39.419284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09ccee7d-6f4a-4122-a922-7eceeff9e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdc4e4e30>]}
[0m22:43:39.420672 [info ] [Thread-1 (]: 3 of 6 OK created sql table model airbyte_uber_data.top_3_base_names_by_total_pickups  [[32mCREATE TABLE (3.0 rows, 217.8 MiB processed)[0m in 2.56s]
[0m22:43:39.422319 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_base_names_by_total_pickups
[0m22:43:39.423409 [debug] [Thread-1 (]: Began running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:43:39.424593 [info ] [Thread-1 (]: 4 of 6 START sql table model airbyte_uber_data.top_3_pickup_dates_per_base ..... [RUN]
[0m22:43:39.426459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_base_names_by_total_pickups, now model.uber_transformations.top_3_pickup_dates_per_base)
[0m22:43:39.428038 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:43:39.435623 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:43:39.437608 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (compile): 22:43:39.429117 => 22:43:39.436767
[0m22:43:39.438915 [debug] [Thread-1 (]: Began executing node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:43:39.443777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:39.947766 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.top_3_pickup_dates_per_base"
[0m22:43:39.949301 [debug] [Thread-1 (]: On model.uber_transformations.top_3_pickup_dates_per_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.top_3_pickup_dates_per_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`top_3_pickup_dates_per_base`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the top 3 most common pickup dates for each base number in the raw_data_janjune_15 table, ranked by the number of pickups on each date?

WITH date_extract_cte AS (
    SELECT base.base_name AS `base_name`,
          raw.dispatching_base_num AS `dispatching_base_num`,
          DATE(raw.pickup_date) AS `pick_up_date`
    FROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw
    JOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.dispatching_base_num
),
ranked_cte AS (
    SELECT base_name AS `Base Name`,
           dispatching_base_num AS `Dispatching Base Number`,
           RANK() OVER(PARTITION BY dispatching_base_num ORDER BY COUNT(*) DESC) AS `Rank`,
           COUNT(*) AS `Count`,
           pick_up_date AS `Pick Up Date`
    FROM date_extract_cte
    GROUP BY base_name, dispatching_base_num, pick_up_date
)

SELECT *
FROM ranked_cte
WHERE ranked_cte.rank IN (1,2,3)
ORDER BY ranked_cte.`Base NAME` ASC, ranked_cte.rank ASC
    );
  
[0m22:43:40.148740 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1446b675-1150-472e-a802-4834961cc3d4&page=queryresults
[0m22:43:42.008759 [debug] [Thread-1 (]: Timing info for model.uber_transformations.top_3_pickup_dates_per_base (execute): 22:43:39.439669 => 22:43:42.008269
[0m22:43:42.011931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09ccee7d-6f4a-4122-a922-7eceeff9e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdc4e4e30>]}
[0m22:43:42.014935 [info ] [Thread-1 (]: 4 of 6 OK created sql table model airbyte_uber_data.top_3_pickup_dates_per_base  [[32mCREATE TABLE (25.0 rows, 217.8 MiB processed)[0m in 2.59s]
[0m22:43:42.018319 [debug] [Thread-1 (]: Finished running node model.uber_transformations.top_3_pickup_dates_per_base
[0m22:43:42.021286 [debug] [Thread-1 (]: Began running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:43:42.025212 [info ] [Thread-1 (]: 5 of 6 START sql table model airbyte_uber_data.total_pickups_in_may_by_base .... [RUN]
[0m22:43:42.030572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.top_3_pickup_dates_per_base, now model.uber_transformations.total_pickups_in_may_by_base)
[0m22:43:42.033617 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.total_pickups_in_may_by_base
[0m22:43:42.049589 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:43:42.052899 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (compile): 22:43:42.036211 => 22:43:42.051443
[0m22:43:42.055016 [debug] [Thread-1 (]: Began executing node model.uber_transformations.total_pickups_in_may_by_base
[0m22:43:42.071109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:42.580002 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.total_pickups_in_may_by_base"
[0m22:43:42.581520 [debug] [Thread-1 (]: On model.uber_transformations.total_pickups_in_may_by_base: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.total_pickups_in_may_by_base"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`total_pickups_in_may_by_base`
      
    
    

    OPTIONS()
    as (
      -- Calculate the total number of pickups for each base name in the raw_data_janjune_15 table, considering only records where the pickup date is within the month of May.

SELECT base.base_name AS `Dispatching Base Name`,
       COUNT(*) AS `Number of Pick Ups for Base`
FROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw
JOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.dispatching_base_num
WHERE EXTRACT(MONTH FROM raw.pickup_date) = 5
GROUP BY base.base_name
ORDER BY COUNT(*) DESC
    );
  
[0m22:43:42.779620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:1b0c8ed8-1a52-4f64-9a77-b1d3e5085bdd&page=queryresults
[0m22:43:44.620166 [debug] [Thread-1 (]: Timing info for model.uber_transformations.total_pickups_in_may_by_base (execute): 22:43:42.056782 => 22:43:44.619037
[0m22:43:44.624587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09ccee7d-6f4a-4122-a922-7eceeff9e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdbce3c80>]}
[0m22:43:44.627629 [info ] [Thread-1 (]: 5 of 6 OK created sql table model airbyte_uber_data.total_pickups_in_may_by_base  [[32mCREATE TABLE (6.0 rows, 217.8 MiB processed)[0m in 2.60s]
[0m22:43:44.631422 [debug] [Thread-1 (]: Finished running node model.uber_transformations.total_pickups_in_may_by_base
[0m22:43:44.633992 [debug] [Thread-1 (]: Began running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:43:44.637420 [info ] [Thread-1 (]: 6 of 6 START sql table model airbyte_uber_data.unter_grun_pickups_in_bronx ..... [RUN]
[0m22:43:44.642641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber_transformations.total_pickups_in_may_by_base, now model.uber_transformations.unter_grun_pickups_in_bronx)
[0m22:43:44.645465 [debug] [Thread-1 (]: Began compiling node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:43:44.686580 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:43:44.691778 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (compile): 22:43:44.647939 => 22:43:44.690006
[0m22:43:44.694606 [debug] [Thread-1 (]: Began executing node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:43:44.709468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:45.190663 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber_transformations.unter_grun_pickups_in_bronx"
[0m22:43:45.193566 [debug] [Thread-1 (]: On model.uber_transformations.unter_grun_pickups_in_bronx: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "uber_transformations", "target_name": "dev", "node_id": "model.uber_transformations.unter_grun_pickups_in_bronx"} */

  
    

    create or replace table `uber-data-pipeline-417021`.`airbyte_uber_data`.`unter_grun_pickups_in_bronx`
      
    
    

    OPTIONS()
    as (
      -- Retrieve the pickup date, affiliated base name, borough, and zone for all records in the raw_data_janjune_15 table where the affiliated base name is Unter and Grun, and the pickup location is the Bronx borough.

SELECT raw.pickup_date AS `Pickup Date`,
       base.base_name AS `Base Name`,
       t_zone.borough AS `Borough`,
       t_zone.zone AS `Zone`
FROM `uber-data-pipeline-417021`.`airbyte_uber_data`.`raw_data_janjune_15` AS raw
JOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`base_num_and_name` AS base ON base.base_num = raw.affiliated_base_num
JOIN `uber-data-pipeline-417021`.`airbyte_uber_data`.`taxi_zone_lookup` AS t_zone ON t_zone.locationid = raw.locationid
WHERE base.base_name IN ('Unter', 'Grun') AND t_zone.Borough = 'Bronx'
    );
  
[0m22:43:45.439633 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-pipeline-417021&j=bq:europe-west2:4e32d2f6-2523-4b5b-a7fd-3130328c004b&page=queryresults
[0m22:43:47.285173 [debug] [Thread-1 (]: Timing info for model.uber_transformations.unter_grun_pickups_in_bronx (execute): 22:43:44.696939 => 22:43:47.283970
[0m22:43:47.288926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09ccee7d-6f4a-4122-a922-7eceeff9e6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdbc868d0>]}
[0m22:43:47.291818 [info ] [Thread-1 (]: 6 of 6 OK created sql table model airbyte_uber_data.unter_grun_pickups_in_bronx  [[32mCREATE TABLE (19.6k rows, 325.4 MiB processed)[0m in 2.65s]
[0m22:43:47.295298 [debug] [Thread-1 (]: Finished running node model.uber_transformations.unter_grun_pickups_in_bronx
[0m22:43:47.304558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:47.307036 [debug] [MainThread]: Connection 'model.uber_transformations.unter_grun_pickups_in_bronx' was properly closed.
[0m22:43:47.309883 [info ] [MainThread]: 
[0m22:43:47.312735 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 19.56 seconds (19.56s).
[0m22:43:47.322721 [debug] [MainThread]: Command end result
[0m22:43:47.376119 [info ] [MainThread]: 
[0m22:43:47.378841 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:47.384767 [info ] [MainThread]: 
[0m22:43:47.391289 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:43:47.395764 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 22.88094, "process_user_time": 8.914984, "process_kernel_time": 0.742157, "process_mem_max_rss": "200032", "process_in_blocks": "26256", "process_out_blocks": "3032"}
[0m22:43:47.399700 [debug] [MainThread]: Command `dbt build` succeeded at 22:43:47.398910 after 22.89 seconds
[0m22:43:47.401720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bebeb6ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2beb872f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdbcd52e0>]}
[0m22:43:47.406331 [debug] [MainThread]: Flushing usage events
